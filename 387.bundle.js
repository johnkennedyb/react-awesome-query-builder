"use strict";(self.webpackChunk_react_awesome_query_builder_examples=self.webpackChunk_react_awesome_query_builder_examples||[]).push([[387],{85387:(e,t,r)=>{r.r(t),r.d(t,{default:()=>V});var n=r(79570),l=r(42181),o=r(83438),i=r(67308),a=r(39703),u=r(22579),s=r(68193),c=r(65387),p=function(e){var t=e.k,r=e.value,n=e.setValue,l=e.listValues,o=(0,i.useMemo)((function(){return null==l?void 0:l.map((function(e){var t=e.value,r=e.title;return{id:null==t?void 0:t.toString(),label:null!=r?r:"",properties:["REQUIRED","CREATE","UPDATE"],type:{format:"INTEGER"}}}))}),[l]),a=(0,i.useCallback)((function(e,t){var r=e.map((function(e){return{value:e.id||e.label,type:e.__isNew__?"const":"property"}}));return n(r),r}),[n]),u=(0,i.useCallback)((function(e){return e.id}),[]),s=(0,i.useCallback)((function(e){return e.label}),[]),p=(0,i.useMemo)((function(){return e=o,(t=r)?t.map((function(t){var r="const"!=t.type&&e&&e.find((function(e){return e.id===t.value}));return r||(r={id:t.value,label:t.value,__isNew__:!0}),r})):[];var e,t}),[r]);return i.createElement(c.A,{menuPortalTarget:document.body,menuPosition:"fixed",key:t,isMulti:!0,options:o,value:p,getOptionValue:u,getOptionLabel:s,onChange:a})};const m=(0,i.memo)(p);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,l.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e})).filter((function(e){return null!=e})):void 0},v=function(e){if(null!=e){var t=[],r=(Array.isArray(e)?e:[e]).filter((function(e){return null!=e})).map((function(t){return{type:"property",value:e}}));if(t.length)throw new Error(t.join("\n"));return r}},b=r(59225);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,l.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){(0,l.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}u.A.use();var S,w,j,P,A,_,k=(w=E(E({},(S=s.WQ).widgets),{},{case_value:(_=S,d(d({},_.widgets.case_value),{},{spelFormatValue:a.Aq.ExportUtils.spelFormatConcat,spelImportValue:a.Aq.ExportUtils.spelImportConcat,jsonLogic:g,jsonLogicImport:v,factory:function(e){var t,r=e.value,n=e.setValue,l=e.id,o=e.fieldDefinition;return i.createElement(m,{value:r,setValue:n,listValues:null===(t=o.fieldSettings)||void 0===t?void 0:t.listValues,k:l})}}))}),j={text:{label:"Text",type:"text",valueSources:["value","field"],excludeOperators:["proximity"]},qty:{label:"Qty",type:"number",valueSources:["value"],fieldSettings:{min:0,max:1e3},preferWidgets:["number"]},discount:{label:"Discount",type:"number",valueSources:["value"],fieldSettings:{min:0,max:100,step:5},preferWidgets:["slider","rangeslider"],widgets:{slider:{widgetProps:{customProps:{input:{InputProps:{endAdornment:i.createElement(b.A,{position:"end"},"%")}}}}}}},price:{label:"Price",type:"number",valueSources:["value"],fieldSettings:{min:10,max:100},preferWidgets:["slider","rangeslider"],isSpelVariable:!0},color:{label:"Color",type:"select",valueSources:["value"],fieldSettings:{listValues:[{value:"yellow",title:"Yellow"},{value:"blue",title:"Blue"},{value:"green",title:"Green"},{value:"orange",title:"Orange"}]}},is_promotion:{label:"Promotoion",type:"boolean",operators:["equal"],valueSources:["value"],mainWidgetProps:{hideOperator:!0,operatorInlineLabel:"is"}}},P=E(E({},S.settings),{},{caseValueField:{type:"select",valueSources:["value"],fieldSettings:{listValues:[{value:"Hot",title:"Hot"},{value:"In stock",title:"In stock"},{value:"other",title:"other"}]},mainWidgetProps:{valueLabel:"Then",valuePlaceholder:"Then"}},maxNumberOfCases:5,canRegroupCases:!0,maxNesting:3,canLeaveEmptyCase:!1,showErrorMessage:!0}),A={LOWER:a.uu.LOWER,UPPER:a.uu.UPPER,LINEAR_REGRESSION:a.uu.LINEAR_REGRESSION},E(E({},S),{},{funcs:A,widgets:w,fields:j,settings:P})),q={backgroundColor:"darkgrey",margin:"10px",padding:"10px"},x={backgroundColor:"lightpink",margin:"10px",padding:"10px"},N={id:a.Aq.uuid(),type:"switch_group"},C=(a.Aq.loadTree(N),a.Aq.loadFromJsonLogic({if:[{and:[{">":[{var:"discount"},50]},{"==":[{var:"is_promotion"},!0]}]},"Hot",{if:[{">":[{var:"qty"},0]},"In stock","other"]}]},k)),D=a.Aq.validateTree(C,k);null!=D&&D.length&&console.warn("Validation errors:",D);var I=a.Aq.loadFromSpel("((discount > 50 && is_promotion == true) ? 'Hot' : (qty > 0 ? 'In stock' : 'other'))",k),L=(0,o.A)(I,2),R=(L[0],L[1]);null!=R&&R.length&&console.warn("Errors while importing from SpEL: ",R);const V=function(){var e,t,r,l,u,s,c,p,m,f=(0,i.useState)({tree:C,config:k,spelStr:"",spelErrors:[]}),d=(0,o.A)(f,2),g=d[0],v=d[1],b=(0,i.useCallback)((function(e,t){v((function(r){return h(h({},r),{},{tree:e,config:t})}))}),[]),y=(0,i.useCallback)((function(e){return i.createElement("div",{className:"query-builder-container",style:{padding:"10px"}},i.createElement("div",{className:"query-builder qb-lite"},i.createElement(a.M$,e)))}),[]);return i.createElement("div",null,i.createElement("div",{className:"query-import-spel"},"Input SpEL:",i.createElement("input",{type:"text",size:150,value:g.spelStr,onChange:function(e){var t=e.target.value;v(h(h({},g),{},{spelStr:t}))}}),i.createElement("button",{onClick:function(){var e=a.Aq.loadFromSpel(g.spelStr,g.config),t=(0,o.A)(e,2),r=t[0],n=t[1],l=a.Aq.sanitizeTree(r,g.config),i=l.fixedTree,u=l.fixedErrors;u.length&&console.warn("Fixed errors after import from SpEL:",u),v(h(h({},g),{},{tree:null!=i?i:g.tree,spelErrors:n}))}},"import"),i.createElement("br",null),g.spelErrors.length>0&&i.createElement("pre",{style:x},JSON.stringify(g.spelErrors,void 0,2))),i.createElement(a.XK,(0,n.A)({},k,{value:g.tree,onInit:b,onChange:b,renderBuilder:y})),i.createElement("div",{className:"query-builder-result"},(s=a.Aq._spelFormat(g.tree,g.config),p=(c=(0,o.A)(s,2))[0],m=c[1],i.createElement(i.Fragment,null,i.createElement("div",null,"spelFormat:",m.length>0&&i.createElement("pre",{style:x},JSON.stringify(m,void 0,2)),i.createElement("pre",{style:q},JSON.stringify(p,void 0,2)),"Values:",i.createElement("pre",null,JSON.stringify(a.Aq.getSwitchValues(g.tree),void 0,2))),i.createElement("hr",null))),(r=(t=a.Aq.jsonLogicFormat(g.tree,g.config)).logic,l=t.data,u=t.errors,i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement("a",{href:"http://jsonlogic.com/play.html",target:"_blank",rel:"noopener noreferrer"},"jsonLogicFormat"),":",((null==u?void 0:u.length)||0)>0&&i.createElement("pre",{style:x},JSON.stringify(u,void 0,2)),!!r&&i.createElement("pre",{style:q},"// Rule",":",i.createElement("br",null),JSON.stringify(r,void 0,2),i.createElement("br",null),i.createElement("hr",null),"// Data",":",i.createElement("br",null),JSON.stringify(l,void 0,2))),i.createElement("hr",null))),(e=a.Aq.getTree(g.tree),i.createElement(i.Fragment,null,"Tree:",i.createElement("pre",null,JSON.stringify(e,void 0,2)),i.createElement("br",null),i.createElement("hr",null),i.createElement("br",null)))))}}}]);
//# sourceMappingURL=387.bundle.js.map
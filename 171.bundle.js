(self.webpackChunk_react_awesome_query_builder_examples=self.webpackChunk_react_awesome_query_builder_examples||[]).push([[171],{68193:(e,t,r)=>{"use strict";r.d(t,{WQ:()=>Ye});var n,o,l,i,a,u,s=r(42181),c=r(67308),d=r(79570),p=r(43496),f=r(46114),v=r(37054),g=r(77533),h=r(87439),y=r(98163),m=r(77680),b=r(21169),O=r(54230),A=r(39703),S=A.Aq.moment,F=parseInt(null!==(n=null==y||null===(o=y.version)||void 0===o||null===(o=o.split("."))||void 0===o?void 0:o[0])&&void 0!==n?n:"0"),w=r(28380),j=A.Aq.moment,E=parseInt(null!==(l=null==y||null===(i=y.version)||void 0===i||null===(i=i.split("."))||void 0===i?void 0:i[0])&&void 0!==l?l:"0"),C=r(58239),L=A.Aq.moment,k=parseInt(null!==(a=null==y||null===(u=y.version)||void 0===u||null===(u=u.split("."))||void 0===u?void 0:u[0])&&void 0!==a?a:"0"),_=r(76297),T=r(80742),P=r(64234),V=r.n(P),I=A.Aq.ListUtils.mapListValues,x=r(51554),D=r(68127),N=r(81289),R=["width"],M=r(86322),q=r(83438),W=["width"],B=r(57683),G=r(27873),z=r(77683),U=r(40164),$=r(46607),J=A.Aq.ListUtils.mapListValues,H=r(56545),K=r(78712),Y=r(30143),Q=r(14600),X=r(64992),Z=r(18727),ee=r(25797),te=r(73365),re=["width"];function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,s.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var le=A.Rj.W,ie=[];const ae=function(e){var t=e.allowCustomValues,r=e.multiple,n=e.disableClearable,o=e.value,l=e.customProps,i=e.readonly,a=e.config,u=e.filterOptionsConfig,s=e.errorText,p=e.tooltipText,f=e.isFieldAutocomplete,v={stringify:(0,c.useCallback)((function(e){return a.settings.listKeysForSearch.map((function(t){return"string"==typeof e[t]?e[t]:""})).join("\0")}),[a])},g=(0,H.Z)(u||v),h=le(e,{debounceTimeout:100,multiple:r,uif:"mui",isFieldAutocomplete:f}),y=h.open,O=h.onOpen,A=h.onClose,S=h.onChange,F=h.onInputChange,w=h.inputValue,j=h.options,E=h.isInitialLoading,C=h.isLoading,L=h.aPlaceholder,k=h.extendOptions,_=(h.getOptionSelected,h.getOptionDisabled),P=h.getOptionIsCustom,I=h.getOptionLabel,x=h.selectedListValue,N=a.settings,R=N.defaultSelectWidth,M=(N.defaultSearchWidth,l||{}),q=M.width,W=(0,D.A)(M,re),B=W.input||{};B.width,B=V()(B,["width"]);var G=V()(W,["showSearch","showCheckboxes"]),z=!1,U=q||R,J={width:r?void 0:U,minWidth:U},ne=i?"":L,ae=ne||a.settings.fieldPlaceholder,ue=null!=o?o:r?ie:null,se=(0,te.A)(),ce=function(e){var t=e.groupMaybeJson;if(!t)return null;var r={label:t};if("string"==typeof t&&"{"===t[0])try{r=JSON.parse(t)}catch(e){}var n=r.label;return n&&r.tooltip&&(n=c.createElement(ee.A,{title:r.tooltip,placement:"left-start"},c.createElement("span",null,n))),c.createElement("div",{style:{position:"sticky",top:"-8px",padding:"4px 10px",color:se.palette.primary.main,backgroundColor:se.palette.background.default}},n)},de=function(e){var t=e.children;return c.createElement(c.Fragment,null,t)},pe=c.createElement(K.A,(0,d.A)({disableClearable:n,disableCloseOnSelect:r,fullWidth:z,multiple:r,style:J,freeSolo:t,loading:E,open:y,onOpen:O,onClose:A,inputValue:w,onInputChange:F,label:ne,onChange:S,value:ue,disabled:i,readOnly:i,options:j,groupBy:function(e){return null!=e&&e.group?JSON.stringify(e.group):null==e?void 0:e.groupTitle},getOptionLabel:I,getOptionDisabled:_,renderInput:function(e){var t,n,o,l=!r&&!y,a=null!==(t=null!==(n=null==x?void 0:x.title)&&void 0!==n?n:null==ue?void 0:ue.toString())&&void 0!==t?t:"",u=l?a:r&&!y?"":null!==(o=null!=w?w:null==ue?void 0:ue.toString())&&void 0!==o?o:"";return c.createElement(m.A,(0,d.A)({variant:"standard"},e,{inputProps:oe(oe({"aria-label":ae},e.inputProps),{},{value:u}),InputProps:oe(oe({},e.InputProps),{},{readOnly:i,endAdornment:c.createElement(c.Fragment,null,C?c.createElement(Y.A,{color:"inherit",size:20}):null,e.InputProps.endAdornment)}),disabled:i,placeholder:ne,error:!!s},B))},renderGroup:function(e){return c.createElement("div",{key:e.key},c.createElement(ce,{groupMaybeJson:e.group}),c.createElement(de,null,e.children))},renderTags:function(e,t){return e.map((function(e,r){return c.createElement(Q.A,(0,d.A)({key:e.value,label:I(e),size:"small",variant:P(e)?"outlined":"filled"},t({index:r})))}))},renderOption:function(e,t){var n=t.title,l=t.renderTitle,i=t.value,a=t.isHidden,u=t.tooltip,s=t.group,p=t.groupTitle||s,v=r?(o||[]).includes(i):o==i,g=P(t)?"customSelectOption":void 0,h=l||(!f&&p?"  ":"")+n,y=c.createElement("span",{className:g},h);if(u&&(y=c.createElement(ee.A,{title:u,placement:"left-start"},y)),a)return null;if(t.specialValue)return c.createElement("div",e,h);if(r){var m=v?c.createElement(c.Fragment,null,c.createElement(Z.A,null,c.createElement(X.A,null)),y):c.createElement($.A,{inset:!0},y);return c.createElement(T.A,(0,d.A)({},e,{size:"small",selected:v}),m)}return c.createElement("div",e,y)},filterOptions:function(e,t){var r=g(e,t);return k(r)},isOptionEqualToValue:function(e,t){return(null==e?void 0:e.value)==t},size:"small"},G));return p&&(pe=c.createElement(ee.A,{title:y?null:p,placement:"top-start"},pe)),c.createElement(b.A,{fullWidth:z},pe)};var ue=r(79960),se=["items","selectedKey","setField","isValueField","selectedLabel","selectedOpts","selectedAltLabel","selectedFullLabel"];function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){(0,s.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var pe={key:"_value2",path:"value",label:"title",altLabel:"_altLabel",tooltip:"tooltip",grouplabel:"groupTitle"},fe=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.map((function(t){var n=t.items,o=t.path,l=t.key,i=t.label,a=t.altLabel,u=t.disabled,s=t.grouplabel,d=t.group,p=t.matchesType,f=t.tooltip,v="  ".repeat(r);return n?e(n,r+1):{title:i,renderTitle:p?c.createElement("b",null,v+i):v+i,value:o,disabled:u,groupTitle:r>0?v+s:null,group:r>0?de(de({},d),{},{label:v+d.label}):null,tooltip:f,_value2:l,_altLabel:a}})).flat(1/0)},ve=function(e,t){var r=e.items,n=e.selectedKey,o=e.setField,l=e.isValueField,i=e.selectedLabel,a=(e.selectedOpts,e.selectedAltLabel),u=e.selectedFullLabel,s=(0,D.A)(e,se),d=a||u;d==i&&(d=null);var p=fe(r),f=n,v={stringify:(0,c.useCallback)((function(e){return t.settings.fieldItemKeysForSearch.map((function(e){return pe[e]})).map((function(t){return"string"==typeof e[t]?e[t]:""})).join("\0")}),[t])};return de(de({},s),{},{tooltipText:d,listValues:p,setValue:function(e,t){if(e||l)return o(e)},filterOptionsConfig:v,allowCustomValues:!1,multiple:!1,disableClearable:!l,value:f,isFieldAutocomplete:!0})},ge=r(38242),he=r(82921),ye=r(10871),me=r(56838),be=A.Aq.DragIcon,Oe={delGroup:c.createElement(he.A,null),delRuleGroup:c.createElement(he.A,null),delRule:c.createElement(he.A,null),addRuleGroup:c.createElement(ye.A,null),addRuleGroupExt:c.createElement(ye.A,null),addRule:c.createElement(ye.A,null),addGroup:c.createElement(ye.A,null),drag:c.createElement(ge.A,null)},Ae={drag:"primary"},Se=r(67146),Fe=r(76755),we={addRuleGroup:!0,addRuleGroupExt:!0,delGroup:!0,delRuleGroup:!0,delRule:!0},je={addRule:"primary",addGroup:"primary",delGroup:"secondary",delRuleGroup:"secondary",delRule:"secondary"};const Ee=(0,c.memo)((function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,l=e.renderIcon,i=null==l?void 0:l({type:t,readonly:o});return!r||we[t]?c.createElement(Fe.A,{size:"small",disabled:o,onClick:n,color:je[t],"aria-label":r},i):c.createElement(Se.A,{size:"small",disabled:o,onClick:n,color:je[t],startIcon:i},r)}));var Ce=r(50030),Le=c.memo((function(e){var t=e.conjKey,r=e.id,n=(e.name,e.label),o=e.checked,l=e.setConjunction,i=e.readonly,a=e.disabled,u=(0,c.useCallback)((function(){l(t)}),[t,l]),s=l.isDummyFn?"__dummy":"";return!i&&!a||o?c.createElement(Se.A,{key:r+s,id:r+s,color:o?"primary":"inherit",value:t,onClick:u,disabled:i||a},n):null})),ke=c.memo((function(e){var t=e.id,r=e.not,n=e.setNot,o=e.conjunctionOptions,l=e.setConjunction,i=e.disabled,a=e.readonly,u=e.config,s=e.showNot,p=e.notLabel,f=Object.keys(o).length,v=i,g=u.settings.forceShowConj||f>1&&!v,h=(0,c.useCallback)((function(){n(!r)}),[r,n]);return c.createElement(b.A,null,c.createElement(Ce.A,{disableElevation:!0,variant:"contained",size:"small",disabled:a},s&&(a&&!r?null:c.createElement(Se.A,{key:t,id:t+"__not",color:r?"error":"inherit",onClick:h,disabled:a},p||"NOT")),g&&Object.keys(o).map((function(e){var t=o[e],r=t.id,n={conjKey:e,id:r,name:t.name,label:t.label,checked:t.checked,setConjunction:l,readonly:a,disabled:i};return c.createElement(Le,(0,d.A)({key:r},n))}))))}));const _e=ke;var Te=r(24995),Pe=r(22889),Ve=r(71329),Ie=r(11179),xe=r(35041),De=r(41728),Ne=c.memo((function(e){var t=e.valueSrc,r=e.srcKey,n=e.handleChange,o=e.info,l=t==r||!t&&"value"==r,i=(0,c.useCallback)((function(e){return n(e,r)}),[n,r]);return c.createElement(T.A,{value:r,selected:l,onClick:i},!l&&c.createElement($.A,{inset:!0},o.label),l&&c.createElement(c.Fragment,null,c.createElement(Z.A,null,c.createElement(X.A,null)),o.label))}));const Re=c.memo((function(e){var t=e.valueSources,r=e.valueSrc,n=e.title,o=e.setValueSrc,l=(e.readonly,c.useState(null)),i=(0,q.A)(l,2),a=i[0],u=i[1],s=(0,c.useCallback)((function(e){u(e.currentTarget)}),[u]),d=(0,c.useCallback)((function(){u(null)}),[u]),p=(0,c.useCallback)((function(e){a?d():s(e)}),[d,s,a]),f=(0,c.useCallback)((function(e,t){o(t),d()}),[d,o]),v=Boolean(a);return c.createElement("div",null,c.createElement(Fe.A,{size:"small",onClick:p},c.createElement(Ie.A,null)),c.createElement(De.A,{anchorEl:a,open:v,onClose:d},c.createElement(b.A,{component:"fieldset",sx:{p:0}},c.createElement(xe.A,{component:"legend",sx:{p:2,pt:0,pb:1}},n),function(e){return e.map((function(e){var t=(0,q.A)(e,2),n=t[0],o=t[1];return c.createElement(Ne,{key:n,valueSrc:r,srcKey:n,handleChange:f,info:o})}))}(t))))}));var Me,qe,We=parseInt(null!==(Me=null==y||null===(qe=y.version)||void 0===qe||null===(qe=qe.split("."))||void 0===qe?void 0:qe[0])&&void 0!==Me?Me:"0");const Be={MuiTextWidget:function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,l=e.customProps,i=e.maxLength,a=(e.errorMessage,(0,c.useCallback)((function(e){var t=e.target.value;""===t&&(t=void 0),r(t)}),[r])),u=t||"";return c.createElement(b.A,null,c.createElement(m.A,(0,d.A)({variant:"standard",value:u,placeholder:n?"":o,InputProps:{readOnly:n},inputProps:{maxLength:i},disabled:n,onChange:a,size:"small"},l)))},MuiTextAreaWidget:function(e){var t=e.value,r=e.setValue,n=e.config,o=e.readonly,l=e.placeholder,i=e.customProps,a=e.maxLength,u=e.maxRows,s=e.fullWidth,p=n.settings.defaultMaxRows,f=t||"";return c.createElement(b.A,{fullWidth:s},c.createElement(m.A,(0,d.A)({variant:"standard",fullWidth:s,maxRows:u||p,multiline:!0,value:f,placeholder:o?"":l,InputProps:{readOnly:o},inputProps:{maxLength:a},disabled:o,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},size:"small"},i)))},MuiDateWidget:function(e){var t=e.value,r=e.setValue,n=e.readonly,o=e.customProps,l=e.dateFormat,i=e.valueFormat,a=e.placeholder,u=F>=6?{format:l,slotProps:{textField:{size:"small",variant:"standard"},toolbar:{toolbarPlaceholder:n?"":a}}}:{inputFormat:l,renderInput:function(e){return c.createElement(m.A,(0,d.A)({size:"small",variant:"standard"},e))},toolbarPlaceholder:n?"":a},s=t?F>=6?S(t,i):t:null;return c.createElement(b.A,null,c.createElement(O.l,(0,d.A)({desktopModeMediaQuery:"@media (pointer: fine), (pointer: none)",readOnly:n,disabled:n,value:s,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(i):void 0}(e))}},u,o)))},MuiDateTimeWidget:function(e){var t=e.value,r=e.setValue,n=e.use12Hours,o=e.readonly,l=e.placeholder,i=e.dateFormat,a=e.timeFormat,u=e.valueFormat,s=e.customProps,p=i+" "+a,f=E>=6?{format:p,slotProps:{textField:{size:"small",variant:"standard"},toolbar:{toolbarPlaceholder:o?"":l}}}:{inputFormat:p,renderInput:function(e){return c.createElement(m.A,(0,d.A)({size:"small",variant:"standard"},e))},toolbarPlaceholder:o?"":l},v=t?E>=6?j(t,u):t:null;return c.createElement(b.A,null,c.createElement(w.K,(0,d.A)({desktopModeMediaQuery:"@media (pointer: fine), (pointer: none)",readOnly:o,disabled:o,ampm:!!n,value:v,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(u):void 0}(e))}},f,s)))},MuiTimeWidget:function(e){var t=e.value,r=e.setValue,n=e.use12Hours,o=e.readonly,l=e.placeholder,i=e.timeFormat,a=e.valueFormat,u=e.customProps,s=-1!=i.indexOf(":ss"),p=t?L(t,i):null,f=k>=6?{format:i,slotProps:{textField:{size:"small",variant:"standard"},toolbar:{toolbarPlaceholder:o?"":l}}}:{inputFormat:i,renderInput:function(e){return c.createElement(m.A,(0,d.A)({size:"small",variant:"standard"},e))},toolbarPlaceholder:o?"":l};return c.createElement(b.A,null,c.createElement(C.A,(0,d.A)({desktopModeMediaQuery:"@media (pointer: fine), (pointer: none)",readOnly:o,disabled:o,ampm:!!n,value:p,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(a):void 0}(e))},views:s?["hours","minutes","seconds"]:["hours","minutes"]},f,u)))},MuiSelectWidget:function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),l=e.placeholder,i=e.customProps,a=null!=r;return c.createElement(b.A,null,c.createElement(_.A,(0,d.A)({variant:"standard",autoWidth:!0,displayEmpty:!0,placeholder:o?"":l,onChange:function(e){void 0!==e.target.value&&n(e.target.value)},value:a?r:"",disabled:o,readOnly:o,renderValue:function(e){return o||null!=e?function(e){return I(t,(function(t){var r=t.title;return t.value===e?r:null})).filter((function(e){return null!==e})).shift()}(e):l},size:"small"},V()(i,["showSearch","input"])),I(t,(function(e){var t=e.title,r=e.value;return c.createElement(T.A,{key:r,value:r},t)}))))},MuiNumberWidget:function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,l=e.max,i=e.step,a=e.placeholder,u=e.customProps,s=null==t?"":t,p=(0,c.useMemo)((function(){return{readOnly:n}}),[n]),f=(0,c.useMemo)((function(){return{min:o,max:l,step:i}}),[o,l,i]);return c.createElement(b.A,null,c.createElement(m.A,(0,d.A)({variant:"standard",type:"number",value:s,placeholder:n?"":a,InputProps:p,inputProps:f,disabled:n,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},size:"small"},u)))},MuiSliderWidget:function(e){var t=e.config,r=e.placeholder,n=e.customProps,o=e.value,l=e.setValue,i=e.min,a=e.max,u=e.step,s=e.marks,p=e.readonly,f=t.settings.defaultSliderWidth,v=(0,c.useCallback)((function(e,t){l(t)}),[l]),g=(0,c.useCallback)((function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),l(t)}),[l]),h=(0,c.useCallback)((function(e){var t=e.target.value;(t=""===t||null===t?void 0:Number(t))<i?l(i):t>a&&l(a)}),[l,i,a]),y=n||{},O=y.width,A=(0,D.A)(y,R),S=A.input||{},F=A.slider||A,w="number"==typeof o?o:"",j="number"==typeof o?o:null,E=(0,c.useMemo)((function(){return!!s&&Object.keys(s).map((function(e){return{value:Number(e),label:"object"===(0,x.A)(s[e])||void 0===s[e]?s[e]:c.createElement("p",null,s[e])}}))}),[s]),C=(0,c.useMemo)((function(){return{readOnly:p}}),[p]),L=(0,c.useMemo)((function(){return{min:i,max:a,step:u}}),[i,a,u]),k=c.createElement(m.A,(0,d.A)({variant:"standard",type:"number",value:w,placeholder:r,InputProps:C,inputProps:L,disabled:p,onChange:g,onBlur:h,size:"small"},S)),_=c.createElement(N.Ay,(0,d.A)({value:j,onChange:v,disabled:p,min:i,max:a,step:u,marks:E,valueLabelDisplay:"auto",size:"small"},F)),T={marginLeft:"5px",paddingLeft:"12px",marginBottom:E&&"-16px",width:O||f};return c.createElement(b.A,null,c.createElement("div",{style:{display:"inline-flex",alignItems:"center",flexWrap:"wrap"}},c.createElement("div",{style:{marginLeft:"5px"}},k),c.createElement("div",{style:T},_)))},MuiRangeWidget:function(e){var t=e.config,r=e.placeholders,n=e.customProps,o=e.value,l=e.setValue,i=e.min,a=e.max,u=e.step,s=e.marks,p=e.readonly,f=e.textSeparators,v=t.settings.defaultSliderWidth;(0,c.useEffect)((function(){var t=e.value||[void 0,void 0],r=(0,q.A)(t,2);r[0],r[1],e.value}),[]);var g=function(){o&&(o[0]<i?l([i,o[1]]):o[1]>a&&l([o[0],a]))},h=n||{},y=h.width,O=(0,D.A)(h,W),A=O.input||{},S=O.slider||O,F=!!s&&Object.keys(s).map((function(e){return{value:Number(e),label:"object"===(0,x.A)(s[e])||void 0===s[e]?s[e]:c.createElement("p",null,s[e])}})),w=o?(0,M.A)(o):[void 0,void 0],j=(0,q.A)(w,2),E=j[0],C=j[1];null==E&&(E="",w[0]=0),null==C&&(C="",w[1]=0);var L=c.createElement(m.A,(0,d.A)({variant:"standard",type:"number",value:E,placeholder:r[0],InputProps:{readOnly:p},inputProps:{min:i,max:a,step:u},disabled:p,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,M.A)(e.value):[void 0,void 0];n[0]=r,l(n)},onBlur:g,size:"small"},A)),k=c.createElement(m.A,(0,d.A)({variant:"standard",type:"number",value:C,placeholder:r[1],InputProps:{readOnly:p},inputProps:{min:i,max:a,step:u},disabled:p,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,M.A)(e.value):[void 0,void 0];n[1]=r,l(n)},onBlur:g,size:"small"},A)),_=c.createElement(N.Ay,(0,d.A)({value:w,onChange:function(e,t){l(t)},disabled:p,min:i,max:a,step:u,marks:F,valueLabelDisplay:"auto",size:"small"},S)),T={marginLeft:"5px"},P={marginLeft:"5px",paddingLeft:"12px",marginBottom:F&&"-16px",width:y||v};return c.createElement(b.A,null,c.createElement("div",{style:{display:"inline-flex",flexWrap:"wrap"}},c.createElement("div",{style:T},L),c.createElement("div",{className:"widget--sep"},c.createElement("span",null,f[1])),c.createElement("div",{style:T},k),c.createElement("div",{style:P},_)))},MuiBooleanWidget:function(e){var t=e.customProps,r=e.value,n=e.setValue,o=e.labelYes,l=e.labelNo,i=e.readonly;return c.createElement(b.A,null,c.createElement(z.A,{component:"div"},c.createElement(G.Ay,{component:"label",container:!0,alignItems:"center",spacing:0},c.createElement(G.Ay,{item:!0,component:"span"},l),c.createElement(G.Ay,{item:!0,component:"span"},c.createElement(B.A,(0,d.A)({checked:!!r,onChange:function(){n(!r)},disabled:i},t))),c.createElement(G.Ay,{item:!0,component:"span"},o))))},MuiMultiSelectWidget:function(e){var t,r=e.listValues,n=e.value,o=e.setValue,l=(e.allowCustomValues,e.readonly),i=e.placeholder,a=e.customProps,u=null!=n&&n.length>0;return c.createElement(b.A,null,c.createElement(_.A,(0,d.A)({multiple:!0,variant:"standard",autoWidth:!0,displayEmpty:!0,label:l?"":i,onChange:function(e){void 0!==e.target.value&&o(e.target.value)},value:u?n:[],disabled:l,readOnly:l,renderValue:function(e){if(!l&&!e.length)return i;var t=J(r,(function(t){var r=t.title,n=t.value;return e.indexOf(n)>-1?r:null})).filter((function(e){return null!==e}));return t.join(", ")},size:"small"},V()(a,["showSearch","input","showCheckboxes"])),(t=u?n:[],J(r,(function(e){var r=e.title,n=e.value;return c.createElement(T.A,{key:n,value:n},c.createElement(U.A,{checked:t.indexOf(n)>-1}),c.createElement($.A,{primary:r}))})))))},MuiAutocompleteWidget:ae,MuiFieldSelect:function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,l=e.placeholder,i=e.errorText,a=e.selectedLabel,u=(e.selectedOpts,e.selectedAltLabel),s=e.selectedFullLabel,d=(0,c.useState)(!1),p=(0,q.A)(d,2),f=p[0],v=p[1],g=(0,c.useCallback)((function(){v(!0)}),[v]),h=(0,c.useCallback)((function(){v(!1)}),[v]),y=(0,c.useCallback)((function(e){void 0!==e.target.value&&r(e.target.value)}),[r]),m=(0,c.useCallback)((function(e){return o||e?function t(r){return r.map((function(r){return r.items?t(r.items):r.path===e?r.label:null}))}(t).filter((function(e){return Array.isArray(e)?e.some((function(e){return null!==e})):null!==e})).pop():l}),[o,l,t]),O=null!=n,A=u||s;A==a&&(A=null);var S=c.createElement(_.A,{error:!!i,variant:"standard",autoWidth:!0,displayEmpty:!0,placeholder:l,onChange:y,value:O?n:"",disabled:o,renderValue:m,size:"small",open:f,onOpen:g,onClose:h},function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object.keys(t).map((function(n){var o=t[n],l=o.items,i=o.path,a=o.label,u=o.disabled,s=o.matchesType,d=o.tooltip,p="  ".repeat(r),f=c.createElement("span",null,p&&c.createElement("span",null,p),s?c.createElement("b",null,a):a);return d&&(f=c.createElement(ee.A,{title:d,placement:"left-start"},f)),l?[c.createElement(ue.A,{disabled:u,key:i,disableSticky:!0},f),e(l,r+1)]:c.createElement(T.A,{disabled:u,key:i,value:i},f)}))}(t));return A&&(S=c.createElement(ee.A,{title:f?null:A},S)),c.createElement(b.A,null,S)},MuiFieldAutocomplete:function(e){return c.createElement(ae,ve(e,e.config))},MuiIcon:function(e){var t=e.type,r=e.readonly,n=Oe[t]||null;return n||"drag"!==t?"drag"===t?c.createElement(me.A,{size:"small",disabled:r,color:Ae[t]},n):n:c.createElement(be,null)},MuiButton:Ee,MuiButtonGroup:function(e){var t=e.children;return e.config,c.createElement(c.Fragment,null,t)},MuiConjs:_e,MuiSwitch:function(e){var t=e.value,r=e.setValue,n=e.label,o=e.checkedLabel,l=e.hideLabel,i=e.id,a=e.config,u=e.type,s=(a.settings.renderSize,function(){return r(!t)}),d=u,p=t&&o||n,f=t?c.createElement(Ve.A,null):c.createElement(Pe.A,null);return"lock"==u?l?c.createElement(Fe.A,{key:i+d,onClick:s,size:"small"},f):c.createElement(Se.A,{key:i+d,onClick:s,size:"small",startIcon:f},p):c.createElement(Te.A,{control:c.createElement(B.A,{checked:!!t,size:"small",onChange:function(e){return r(e.target.checked)}}),label:p})},MuiValueSources:Re,MuiConfirm:function(e){var t=e.onOk,r=e.okText,n=e.cancelText,o=e.title;(0,e.confirmFn)({description:o||"Are you sure?",title:null,confirmationText:r||"Ok",cancellationText:n||"Cancel"}).then(t).catch((function(){}))},MuiUseConfirm:v.S,MuiProvider:function(e){var t=e.config,r=e.children,n=t.settings.theme||{},o=t.settings.locale||{},l=o.moment,i=n.mui,a=o.mui,u=(0,p.A)(i,a,{palette:{}}),s=We>=6?{locale:l}:{adapterLocale:l},y=c.createElement("div",{className:"mui"},r),m=c.createElement(g.$,(0,d.A)({dateAdapter:h.Y},s),c.createElement(v.a,null,y));return u?c.createElement(f.A,{theme:u},m):m}};function Ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(r),!0).forEach((function(t){(0,s.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ue=ze(ze({},A.d$.settings),{},{renderField:function(e,t){var r,n=t.RCE,o=t.W,l=o.MuiFieldAutocomplete,i=o.MuiFieldSelect;return null!=e&&null!==(r=e.customProps)&&void 0!==r&&r.showSearch?n(l,e):n(i,e)},renderOperator:function(e,t){var r,n=t.RCE,o=t.W,l=o.MuiFieldAutocomplete,i=o.MuiFieldSelect;return null!=e&&null!==(r=e.customProps)&&void 0!==r&&r.showSearch?n(l,e):n(i,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.MuiFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.MuiConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.MuiSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.MuiButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.MuiIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.MuiButtonGroup,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.MuiValueSources,e)},renderFieldSources:function(e,t){return(0,t.RCE)(t.W.MuiValueSources,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.MuiProvider,e)},renderConfirm:function(e,t){return(0,t.W.MuiConfirm)(e)},useConfirm:function(e){return(0,e.W.MuiUseConfirm)()}}),$e=ze(ze({},A.d$.widgets),{},{text:ze(ze({},A.d$.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiTextWidget,e)}}),textarea:ze(ze({},A.d$.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiTextAreaWidget,e)}}),number:ze(ze({},A.d$.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiNumberWidget,e)}}),multiselect:ze(ze({},A.d$.widgets.multiselect),{},{factory:function(e,t){var r=t.RCE,n=t.W,o=n.MuiAutocompleteWidget,l=n.MuiMultiSelectWidget;return e.asyncFetch||e.showSearch?r(o,ze(ze({},e),{},{multiple:!0})):r(l,e)}}),select:ze(ze({},A.d$.widgets.select),{},{factory:function(e,t){var r=t.RCE,n=t.W,o=n.MuiAutocompleteWidget,l=n.MuiSelectWidget;return e.asyncFetch||e.showSearch?r(o,e):r(l,e)}}),slider:ze(ze({},A.d$.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiSliderWidget,e)}}),boolean:ze(ze({},A.d$.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiBooleanWidget,e)}}),date:ze(ze({},A.d$.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiDateWidget,e)}}),time:ze(ze({},A.d$.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiTimeWidget,e)}}),datetime:ze(ze({},A.d$.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiDateTimeWidget,e)}}),rangeslider:ze(ze({},A.d$.widgets.rangeslider),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiRangeWidget,e)}})}),Je=ze({},A.d$.types),He=ze(ze({},A.d$.ctx),{},{W:ze(ze({},A.d$.ctx.W),Be)}),Ke=ze(ze({},A.d$),{},{ctx:He,types:Je,widgets:$e,settings:Ue});const Ye=Ke=A.Aq.ConfigMixins.addMixins(Ke,["rangeslider"])},39703:(e,t,r)=>{"use strict";r.d(t,{d$:()=>nv,uu:()=>h,M$:()=>gf,Rj:()=>F,XK:()=>qs,Aq:()=>wv});var n={};r.r(n),r.d(n,{applyToJS:()=>K,cleanJSX:()=>X,deepEqual:()=>z,deepFreeze:()=>oe,escapeRegExp:()=>Y,getFirstDefined:()=>ae,getLogger:()=>ie,getOpCardinality:()=>G,isDirtyJSX:()=>Z,isImmutable:()=>$,isImmutableList:()=>J,isJSX:()=>ee,isJsonCompatible:()=>le,isJsonLogic:()=>te,isObject:()=>q,logger:()=>ue,mergeArraysSmart:()=>ne,mergeCustomizerNoArrays:()=>Q,omit:()=>B,opDefKeysToOmit:()=>M,shallowCopy:()=>W,shallowEqual:()=>U,sleep:()=>re,toImmutableList:()=>H,uuid:()=>D,widgetDefKeysToOmit:()=>R});var o={};r.r(o),r.d(o,{getItemInListValues:()=>we,getListValue:()=>ke,getTitleInListValues:()=>je,getValueInListValues:()=>Ee,listValuesToArray:()=>Fe,makeCustomListValue:()=>Se,mapListValues:()=>Ce,searchListValue:()=>Le,toListValue:()=>Ae});var l={};r.r(l),r.d(l,{_fixImmutableValue:()=>Ge,expandTreePath:()=>_e,expandTreeSubpath:()=>Te,fixEmptyGroupsInTree:()=>xe,fixPathsInTree:()=>Ie,getFlatTree:()=>De,getItemByPath:()=>Pe,getLightTree:()=>Me,getSwitchValues:()=>qe,getTotalReordableNodesCountInTree:()=>Ne,getTotalRulesCountInTree:()=>Re,hasChildren:()=>Be,immutableToJs:()=>K,isEmptyTree:()=>We,isImmutable:()=>$,jsToImmutable:()=>He,removeIsLockedInTree:()=>Ve,toImmutableList:()=>H});var i={};r.r(i),r.d(i,{SqlString:()=>Ct,mongoEmptyValue:()=>kt,spelEscape:()=>Tt,spelFixList:()=>_t,spelFormatConcat:()=>Pt,spelImportConcat:()=>Vt,sqlEmptyValue:()=>Lt,stringifyForDisplay:()=>It,wrapWithBrackets:()=>xt});var a={};r.r(a),r.d(a,{_loadFromJsonLogic:()=>st,_loadFromSpel:()=>cr,getTree:()=>ze,isImmutableTree:()=>$e,isJsonLogic:()=>te,isTree:()=>Je,jsToImmutable:()=>He,loadFromJsonLogic:()=>ut,loadFromSpel:()=>sr,loadTree:()=>Ue});var u={};r.r(u),r.d(u,{createListFromArray:()=>Ur,createListWithOneElement:()=>zr,defaultConjunction:()=>Mr,defaultGroupConjunction:()=>Rr,defaultGroupProperties:()=>qr,defaultItemProperties:()=>Wr,defaultOperatorOptions:()=>Dr,defaultRoot:()=>Gr,defaultRule:()=>Br,defaultRuleProperties:()=>Nr,emptyProperties:()=>$r,getDefaultField:()=>Pr,getDefaultFieldSrc:()=>Ir,getDefaultOperator:()=>xr,getDefaultSubField:()=>Vr});var s={};r.r(s),r.d(s,{_validateTree:()=>no,checkTree:()=>Zn,getNewValueForFieldOp:()=>vo,getTreeBadFields:()=>Xn,isValidTree:()=>Qn,sanitizeTree:()=>to,translateValidation:()=>$n,validateAndFixTree:()=>ro,validateRange:()=>fo,validateTree:()=>eo,validateValue:()=>uo});var c={};r.r(c),r.d(c,{completeFuncValue:()=>ho,getCompatibleArgsOnFuncChange:()=>Fo,setArgValue:()=>Ao,setArgValueSrc:()=>So,setFunc:()=>yo,setFuncDefaultArg:()=>bo});var d={};r.r(d),r.d(d,{calculateValueType:()=>Lo,completeValue:()=>Ho,filterValueSourcesForField:()=>xo,formatFieldName:()=>Ro,getFieldPartsConfigs:()=>To,getFieldPathLabels:()=>_o,getFirstOperator:()=>Co,getFuncPathLabels:()=>ko,getOneChildOrDescendant:()=>Ko,getOperatorsForField:()=>Eo,getOperatorsForType:()=>jo,getValueLabel:()=>Po,getValueSourcesForFieldOp:()=>Do,getWidgetForFieldOp:()=>No,getWidgetsForFieldOp:()=>Io,isEmptyGroupChildren:()=>Go,isEmptyItem:()=>Mo,isEmptyRuleGroupExtPropertiesAndChildren:()=>Wo,isEmptyRuleProperties:()=>Uo,selectTypes:()=>wo,whatRulePropertiesAreCompleted:()=>$o});var p={};r.r(p),r.d(p,{_getFromConfigCache:()=>fi,_saveToConfigCache:()=>vi,_widgetDefKeysToOmit:()=>Zl,applyJsonLogic:()=>ol,cleanJSX:()=>X,compileConfig:()=>Fl,compressConfig:()=>Al,configKeys:()=>dl,createConfigMemo:()=>Ml,decompressConfig:()=>Sl,extendConfig:()=>zl,findExtendedConfigInAllMemos:()=>Rl,getCommonMemo:()=>Nl,getFieldConfig:()=>hi,getFieldId:()=>pi,getFieldParts:()=>ci,getFieldPath:()=>si,getFieldPathParts:()=>di,getFieldRawConfig:()=>ni,getFieldSrc:()=>gi,getFieldWidgetConfig:()=>mi,getFirstField:()=>bi,getFuncArgConfig:()=>ai,getFuncConfig:()=>ii,getFuncSignature:()=>li,getOperatorConfig:()=>yi,isDirtyJSX:()=>Z,isFieldDescendantOfField:()=>ui,isJSX:()=>ee,iterateFields:()=>ti,iterateFuncs:()=>ei,normalizeField:()=>oi});var f={};r.r(f),r.d(f,{_mongodbFormat:()=>Ji,_spelFormat:()=>Gt,_sqlFormat:()=>la,elasticSearchFormat:()=>ya,jsonLogicFormat:()=>_i,mongodbFormat:()=>$i,queryBuilderFormat:()=>Si,queryString:()=>Xr,spelFormat:()=>Bt,sqlFormat:()=>oa});var v={};r.r(v),r.d(v,{fixListValuesGroupOrder:()=>ka,getListValue:()=>ke,listValueToOption:()=>La,mergeListValues:()=>ja,optionToListValue:()=>Ea,optionsToListValues:()=>Ca,simulateAsyncFetch:()=>wa});var g={};r.r(g),r.d(g,{Autocomplete:()=>v,ConfigUtils:()=>p,DefaultUtils:()=>u,ExportUtils:()=>i,FuncUtils:()=>c,ListUtils:()=>o,OtherUtils:()=>n,RuleUtils:()=>d,TreeUtils:()=>l,Validation:()=>s,checkTree:()=>Zn,clone:()=>Zo(),compressConfig:()=>Al,decompressConfig:()=>Sl,getSwitchValues:()=>qe,i18n:()=>Jn,isValidTree:()=>Qn,moment:()=>Qe(),sanitizeTree:()=>to,uuid:()=>D,validateAndFixTree:()=>ro,validateTree:()=>eo});var h={};r.r(h),r.d(h,{LINEAR_REGRESSION:()=>Ia,LOWER:()=>Pa,NOW:()=>_a,RELATIVE_DATETIME:()=>Ta,UPPER:()=>Va});var y={};r.r(y),r.d(y,{addCaseGroup:()=>Mu,addDefaultCaseGroup:()=>Ru,addGroup:()=>qu,addRule:()=>Du,moveItem:()=>Bu,removeGroup:()=>Wu,removeRule:()=>Nu,setTree:()=>xu});var m={};r.r(m),r.d(m,{setConjunction:()=>Gu,setLock:()=>Uu,setNot:()=>zu});var b={};r.r(b),r.d(b,{setField:()=>$u,setFieldSrc:()=>Ju,setFuncValue:()=>Qu,setOperator:()=>Hu,setOperatorOption:()=>Xu,setValue:()=>Ku,setValueSrc:()=>Yu});var O={};r.r(O),r.d(O,{bindActionCreators:()=>Ls,isUsingLegacyReactDomRender:()=>ws,liteShouldComponentUpdate:()=>js,pureShouldComponentUpdate:()=>Es,useOnPropsChanged:()=>Cs});var A={};r.r(A),r.d(A,{FuncWidget:()=>wd,ValueFieldWidget:()=>Cf,VanillaBooleanWidget:()=>Lf,VanillaButton:()=>zf,VanillaButtonGroup:()=>$f,VanillaConjs:()=>Bf,VanillaDateTimeWidget:()=>If,VanillaDateWidget:()=>Tf,VanillaFieldSelect:()=>Wf,VanillaIcon:()=>Uf,VanillaMultiSelectWidget:()=>Df,VanillaNumberWidget:()=>Mf,VanillaProvider:()=>Yf,VanillaSelectWidget:()=>Rf,VanillaSliderWidget:()=>qf,VanillaSwitch:()=>Hf,VanillaTextAreaWidget:()=>_f,VanillaTextWidget:()=>kf,VanillaTimeWidget:()=>Pf,VanillaValueSources:()=>Jf,vanillaConfirm:()=>Kf});var S={};r.r(S),r.d(S,{ProximityOperator:()=>Zf});var F={};r.r(F),r.d(F,{W:()=>Av});var w=r(53295),j=r(84267),E=r(93532),C=r(3512),L=r(47999),k=r(67308),_=r(42181),T=r(83438),P=r(86322),V=r(51554),I=r(80280),x=0;const D=function(){var e=((new Date).getTime().toString(16)+"FF").substr(0,11);return"ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,(function(e){var t="s"===e?Math.floor(16*Math.random()):15&x++;return("x"===e?t:3&t|8).toString(16)}))+e};r(20039);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var R=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],M=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],q=function(e){return"object"===(0,V.A)(e)&&null!==e&&"[object Object]"===Object.prototype.toString.call(e)},W=function(e){if("object"===(0,V.A)(e)&&null!==e){if(Array.isArray(e))return(0,P.A)(e);if(q(e))return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e)}return e},B=function(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){var r=(0,T.A)(e,1)[0];return!t.includes(r)})))},G=function(e){var t;return null!==(t=null==e?void 0:e.cardinality)&&void 0!==t?t:1},z=function(e,t){return e===t||(I.T5.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t))},U=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?U(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):I.T5.isMap(e)?e.equals(t):"object"==(0,V.A)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),l=n.length;if(o.length!==l)return!1;for(var i=0;i<l;i++){var a=n[i];if(!(r?U(e[a],t[a],r):e[a]===t[a]))return!1}return!0}(e,t,r):e===t)};var $=function(e){return"object"===(0,V.A)(e)&&null!==e&&"function"==typeof e.toJS},J=function(e){return $(e)&&I.Ay.isList(e)};function H(e){return J(e)?e:new I.Ay.List(e)}function K(e){return $(e)?e.toJS():e}var Y=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},Q=function(e,t,r,n,o,l){if(Array.isArray(e))return t},X=function e(t){var r;if(t instanceof Array)return t.map((function(t,r){return e(t)}));if("object"===(0,V.A)(t)&&null!==t&&Z(t)){var n,o=B(t,["$$typeof","_owner","_store","ref","key"]);return o.type&&(o.type="string"==typeof(r=o.type)?r:"function"==typeof r?r.name:r),null!=o&&null!==(n=o.props)&&void 0!==n&&n.children&&(o.props.children=e(o.props.children)),o}return t},Z=function(e){return"object"===(0,V.A)(e)&&null!==e&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},ee=function(e){return"object"===(0,V.A)(e)&&null!==e&&!Array.isArray(e)&&"string"==typeof e.type&&Object.keys(e).includes("props")},te=function(e){return"object"===(0,V.A)(e)&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length};function re(e){return new Promise((function(t){setTimeout(t,e)}))}function ne(e,t){return e||(e=[]),t||(t=[]),t.map((function(t){return[t,e.indexOf(t)]})).map((function(e,t,r){var n=(0,T.A)(e,2),o=n[0];if(-1==n[1]){var l=r.slice(t+1),i=r.slice(0,t).reverse().find((function(e){var t=(0,T.A)(e,2);return t[0],-1!=t[1]})),a=l.find((function(e){var t=(0,T.A)(e,2);return t[0],-1!=t[1]}));return a?[o,"before",a[0]]:i?[o,"after",i[0]]:[o,"append",null]}return null})).filter((function(e){return null!==e})).reduce((function(e,t){var r=(0,T.A)(t,3),n=r[0],o=r[1],l=r[2],i=e.indexOf(l);return-1==e.indexOf(n)&&(i>-1?e.splice(i+("after"==o?1:0),0,n):e.splice("append"==o?1/0:0,0,n)),e}),e.slice())}var oe=function e(t){"object"!==(0,V.A)(t)||null===t||Z(t)||(Object.keys(t).forEach((function(r){"__cache"!==r&&e(t[r])})),Object.freeze(t))},le=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(q(t)){if(t.var)return n[t.var]=r,!0;if(!q(r))return!1;for(var l in t)if(!e(t[l],r[l],n,[].concat((0,P.A)(o),[l])))return!1;return!0}if(Array.isArray(t)){if(!Array.isArray(r))return!1;for(var i=0;i<t.length;i++)if(!e(t[i],r[i],n,[].concat((0,P.A)(o),[i])))return!1;return!0}return t===r},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null!=e&&e?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},ae=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0;r<t.length;r++){var n=t[r];if(void 0!==n){e=n;break}}return e},ue=ie(),se=r(77058),ce=r.n(se),de=r(40222),pe=r.n(de),fe=r(75179),ve=r.n(fe),ge=r(64234),he=r.n(ge);function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Oe=function(e){return"object"==(0,V.A)(e)&&null!==e&&!Array.isArray(e)},Ae=function(e,t){return null==e||""==e?void 0:Oe(e)?be(be({},e),{},{title:e.title||e.value}):{value:e,title:void 0!==t?t:""+e}},Se=function(e){var t=Ae(e);return Oe(t)?be(be({},Ae(e)),{},{isCustom:!0}):t},Fe=function(e){if(Array.isArray(e))return e.map((function(e){return Ae(e)}));if(!Oe(e))return e;var t=[];for(var r in e){var n=e[r];t.push(Ae(r,n))}return t},we=function(e,t){return Array.isArray(e)?e.map((function(e){return Ae(e)})).find((function(e){return""+e.value==""+t})):void 0!==e[t]?Ae(t,e[t]):void 0},je=function(e,t){if(null==e)return t;var r=we(e,t);return void 0!==r?r.title:t},Ee=function(e,t){if(null==e)return t;var r=we(e,t);return void 0!==r?r.value:t},Ce=function(e,t){var r=[];if(Array.isArray(e)){var n,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ye(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ye(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}(e);try{for(o.s();!(n=o.n()).done;){var l=n.value,i=t(Ae(l));null!=i&&r.push(i)}}catch(e){o.e(e)}finally{o.f()}}else for(var a in e){var u=t(Ae(a,e[a]));null!=u&&r.push(u)}return r},Le=function(e,t){return Ce(t,(function(t){return-1!="".concat(t.value).indexOf(e)||-1!=t.title.indexOf(e)?t:null})).filter((function(e){return null!==e})).shift()},ke=function(e,t){return Ce(t,(function(t){return""+t.value==""+e?t:null})).filter((function(e){return null!==e})).shift()},_e=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.skip(1),e.push.apply(e,r),e}))},Te=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.push.apply(e,r),e}))},Pe=function(e,t){var r=new I.Ay.OrderedMap((0,_.A)({},e.get("id"),e)),n=e;return t.forEach((function(e){var t;n=r.get(e),r=null===(t=n)||void 0===t?void 0:t.get("children1")})),n},Ve=function(e){var t=e;return function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=n.push(r.get("id")),i=r.getIn(["properties","isLocked"]);o&&i&&(t=t.deleteIn(_e(l,"properties","isLocked")));var a=r.get("children1");a&&a.map((function(t,r){e(t,l,i||o)}))}(e,new I.Ay.List),t},Ie=function(e){var t=e;return function e(r,n,o,l){if(r){var i=r.get("path"),a=r.get("id"),u=a||l||D(),s=n.push(u);i&&i.equals(s)||(t=t.setIn(_e(s,"path"),s)),a||(t=t.setIn(_e(s,"id"),u));var c=r.get("children1");c&&("Map"===c.constructor.name&&(t=t.setIn(_e(s,"children1"),new I.Ay.OrderedMap(c))),c.map((function(t,r){e(t,s,o+1,r)})))}}(e,new I.Ay.List,0),t},xe=function(e){var t=e;return function e(r,n,o,l){if(!r)return!1;var i=r.get("id")||l,a=n.push(i),u=r.get("children1");if(u){var s=u.map((function(t,r){return e(t,a,o+1,r)})).reduce((function(e,t){return e&&t}),!0);if((0==u.size||s)&&o>0)return t=t.deleteIn(_e(a)),!0}return!1}(e,new I.Ay.List,0),t},De=function(e){var t=[],r={},n=[],o=0,l=0,i=0,a={};!function u(s,c,d,p,f,v,g,h){var y=s===e,m=s.get("type"),b=s.get("collapsed"),O=s.get("id"),A=s.get("children1"),S=s.getIn(["properties","isLocked"]),F=A?A.map((function(e,t){return t})).valueSeq().toArray():null,w="rule_group"===m,j="rule"===m,E="group"===m,C="case_group"===m,L=!f&&(!A||w),k=(null==F?void 0:F.length)>0,_=c.length?c[c.length-1]:null,T=C?O:g;C&&(n.push(O),l=0,i=0,a={});var V,I=T?n.indexOf(T):null,x=t.length,D=o;y||((V={}).caseNo=I,V.globalNoByType=C?I:a[m]||0,V.indexPath=[].concat((0,P.A)(c.slice(1).map((function(e){return r[e].childNo}))),[h]),j?V.globalLeafNo=l:E&&(V.globalGroupNo=i)),t.push(O),r[O]={node:s,index:x,id:O,type:m,parent:_,parentType:_?r[_].type:null,children:F,childNo:h,caseId:T,caseNo:I,path:c.concat(O),lev:v,isLeaf:!A,isAtomicRule:L,isLocked:S||p,top:d?null:D,isDefaultCase:C?!A:void 0,atomicRulesCountInCase:C?0:void 0,position:V,collapsed:b,_top:x,leaf:!A};var N=0,R=0;d||(o+=1,N+=1,!k||b||w||(R+=1),y||C||(E&&i++,j&&l++,a[m]=(a[m]||0)+1)),g&&L&&r[g].atomicRulesCountInCase++;var M=0,q=0;if(k){var W=0;A.map((function(e,t){if(e){u(e,c.concat(O),d||b,p||S,f||w,v+1,T,W);var n=r[t];M=Math.max(M,n.depth||0),q+=n.height,W++}}))}N+=q,R+=M;var B=t.length-x,G=d?null:D+N;Object.assign(r[O],{depth:A?R:void 0,_height:B,height:N,bottom:G})}(e,[],!1,!1,!1,0,null,null);for(var u=0;u<t.length;u++){var s=u>0?t[u-1]:null,c=u<t.length-1?t[u+1]:null,d=r[t[u]];d.prev=s,d.next=c}return{flat:t,items:r,cases:n}},Ne=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var l,i,a;"function"==typeof r.get?(l=r.get("id"),i=r.get("children1"),a=r.get("type")):(l=r.id,i=r.children1,a=r.type),t++,i&&"rule_group"!=a&&i.map((function(t,r){t&&e(t,n.concat(l),o+1)}))}(e,[],0),t-1},Re=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var l,i,a;"function"==typeof r.get?(l=r.get("id"),i=r.get("children1"),a=r.get("type")):(l=r.id,i=r.children1,a=r.type),"rule"==a||"rule_group"==a?t++:i&&i.map((function(t,r){t&&e(t,n.concat(l),o+1)}))}(e,[],0),t},Me=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return function e(n,o){t&&n.path&&delete n.path,t&&!r&&o&&delete n.id;var l=n.properties;l&&null==l.operatorOptions&&delete l.operatorOptions;var i=n.children1;if(i){for(var a in i)i[a]&&e(i[a],a);r&&(n.children1=Object.values(i))}}(e,null),n},qe=function(e){var t=[],r=e.get("children1");return r&&r.map((function(e){var r,n=e.getIn(["properties","value"]);n&&1==n.size?(r=n.get(0),Array.isArray(r)&&0==r.length&&(r=null)):r=null,t=[].concat((0,P.A)(t),[r])})),t},We=function(e){return!e.get("children1")||0==e.get("children1").size},Be=function(e,t){return e.getIn(_e(t,"children1")).size>0},Ge=function(e){if(null!=e&&e.toJS){var t,r=null==e||null===(t=e.toJS)||void 0===t?void 0:t.call(e);return null!=r&&r.func?e.toOrderedMap():r}return e},ze=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e){var n=e;return n=n.toJS(),Me(n,t,r)}},Ue=function(e){if($e(e))return e;if(Je(e))return Ie(He(e));if("string"==typeof e&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if("string"==typeof e)return Ie(He(JSON.parse(e)));throw new Error("Can't load tree!")},$e=function(e){return I.T5.isMap(e)},Je=function(e){return"object"==(0,V.A)(e)&&("group"==e.type||"switch_group"==e.type)};function He(e){return(0,I.ss)(e,(function(e,t,r){var n,o=r&&r.length>3&&"value"===r[r.length-1]&&"args"===r[r.length-3],l=r&&r.length>3&&"value"===r[r.length-1]&&"properties"===r[r.length-2];if("properties"==e){n=t.toOrderedMap();for(var i=0;i<2;i++){var a,u,s;null===(null===(a=n.get("value"))||void 0===a||null===(u=(s=a).get)||void 0===u?void 0:u.call(s,i))&&(n=n.setIn(["value",i],void 0))}}else n=o?Ge(t):(r?l:"value"==e)&&I.Ay.Iterable.isIndexed(t)?t.map(Ge).toList():"asyncListValues"==e?t.toJS():"children1"==e&&I.Ay.Iterable.isIndexed(t)?new I.Ay.OrderedMap(t.map((function(e){return[(null==e?void 0:e.get("id"))||D(),e]}))):I.Ay.Iterable.isIndexed(t)?t.toList():t.toOrderedMap();return n}))}var Ke=r(77213),Ye=r(5866),Qe=r.n(Ye);function Xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function et(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return tt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var rt="jlField",nt="jlArgs",ot=["==","!="],lt=["<","<=",">",">="],it=["multiselect_equals","multiselect_not_equals","multiselect_contains","multiselect_not_contains"],at=function(e){return{errors:[],settings:null==e?void 0:e.settings}},ut=function(e,t){return st(e,t,!1)},st=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=at();n.settings={allowUnknownFields:!1,returnErrors:r};var o=zl(t,void 0,!1),l=ct(o),i=e?ft(e,l,o,["rule","group","switch"],n):void 0,a=i?Ue(i):void 0;return r?[a,n.errors]:(n.errors.length&&console.warn("Errors while importing from JsonLogic:",n.errors),a)},ct=function(e){var t={},r={};for(var n in e.operators){var o=e.operators[n];if("string"==typeof o.jsonLogic){var l=o.jsonLogic+"/"+G(o);t[l]||(t[l]=[]),t[l].push(n)}else if("string"==typeof o.jsonLogic2){var i=o.jsonLogic2+"/"+G(o);t[i]||(t[i]=[]),t[i].push(n),r[n]||(r[n]={}),r[n]={template:o.jsonLogic(rt,n,nt),jsonLogic2:o.jsonLogic2,_jsonLogicIsExclamationOp:!!o._jsonLogicIsExclamationOp}}}var a={};for(var u in e.conjunctions)a[e.conjunctions[u].jsonLogicConj||u.toLowerCase()]=u;var s,c={},d=et(ei(e));try{for(d.s();!(s=d.n()).done;){var p=(0,T.A)(s.value,2),f=p[0],v=p[1],g=void 0;v.jsonLogicIsMethod?g="#"+v.jsonLogic:"string"==typeof v.jsonLogic&&(g=v.jsonLogic),g&&(c[g]||(c[g]=[]),c[g].push(f))}}catch(e){d.e(e)}finally{d.f()}var h=e.settings.jsonLogic;return{operators:t,conjunctions:a,funcs:c,varKeys:["var",h.groupVarKey,h.altVarKey],combinationOperators:r}},dt=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null!=t&&t.combinationOperators)for(var l=0,i=Object.entries(t.combinationOperators);l<i.length;l++){var a=(0,T.A)(i[l],2),u=a[0],s=a[1];if(null==o||o.includes(u)){var c=pt(s.template,e);c.match&&(n?r.errors.push("Operator matched against 2 templates: ".concat(n.newOp," and ").concat(u)):n=c,n.newOp=s.jsonLogic2)}}return n},pt=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{match:!0,jlField:null,jlArgs:[]};if(null==t||null==r)return n.match=!1,n;var o=Object.keys(t),l=Object.keys(r);if(o.length!==l.length)return n.match=!1,n;for(var i=0;i<o.length;i++){var a=o[i],u=t[a];if(a!==l[i])return n.match=!1,n;if(u===rt&&te(r[a]))n.jlField=r[a];else if(u===nt)n.jlArgs.push(r[a]);else if("object"===(0,V.A)(u)&&null!==u||Array.isArray(u))n=e(u,r[a],n);else if(u!==r[a])return n.match=!1,n}return n},ft=function e(t,r,n,o,l){var i,a,u,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;te(t)&&(i=Object.keys(t)[0],a=t[i],Array.isArray(a)||(a=[a]));var f=l.errors.length,v=n.settings.jsonLogic.lockedOp,g="!"==i&&1==a.length&&a[0]&&te(a[0])&&r.varKeys.includes(Object.keys(a[0])[0]),h=dt(t,r,l);h&&((a=[])[0]=h.jlField,h.jlArgs.forEach((function(e){return a.push(e)})),i=h.newOp);var y="!"==i&&!g,m=v&&i==v,b=o.includes("switch");m?u=e(a[0],r,n,o,l,s,c,d,p,!0):y?u=e(a[0],r,n,o,l,!s,c,d,p):o.includes("val")?u=gt(i,a,r,n,s,l,p)||ht(i,a,r,n,s,c,l,p)||vt(t,c,d,n,l):(o.includes("switch")&&(u=At(i,a,r,n,s,l,p)),null==u&&o.includes("group")&&(u=yt(i,a,r,n,s,l,p,!1)),null==u&&o.includes("rule")&&(u=Ot(i,a,r,n,s,l,p)),u&&b&&!["group","switch_group"].includes(u.type)&&(u=mt(u,n)));var O=l.errors.length;return"!"!=i&&void 0===u&&O==f&&l.errors.push("Can't parse logic ".concat(JSON.stringify(t))),m&&(u.properties.isLocked=!0),u},vt=function(e,t,r,n,o){var l;if(void 0===e&&(e=null==t?void 0:t.defaultValue),void 0!==e){r=r||(null==t?void 0:t.mainWidget);var i=n.widgets[r],a=null==t?void 0:t.type;if(!a||i){if(!te(e)){if("time"===a&&"number"==typeof e){var u=Math.floor(e/60/60)%24,s=Math.floor(e/60)%60,c=e%60,d=i.valueFormat;if(d){var p=new Date(e);p.setMilliseconds(0),p.setHours(u),p.setMinutes(s),p.setSeconds(c),e=Qe()(p).format(d)}else e="".concat(u,":").concat(s,":").concat(c)}if(["date","datetime"].includes(a)&&e&&!(e instanceof Date))try{var f=new Date(e);f instanceof Date&&f.toISOString()===e&&(e=f)}catch(t){o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}if(e instanceof Date&&t){var v=i.valueFormat;v&&(e=Qe()(e).format(v))}var g;if(e&&null!=t&&null!==(l=t.fieldSettings)&&void 0!==l&&l.asyncFetch&&(g=Array.isArray(e)?e:[e]),null!=i&&i.jsonLogicImport)try{e=i.jsonLogicImport.call(n.ctx,e)}catch(t){var h;o.errors.push("Can't import value ".concat(e," using import func of widget ").concat(r,": ").concat(null!==(h=null==t?void 0:t.message)&&void 0!==h?h:t)),e=void 0}return{valueSrc:"value",value:e,valueType:null==i?void 0:i.type,asyncListValues:g}}o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)))}else o.errors.push("No widget for type ".concat(a))}},gt=function(e,t,r,n,o,l){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(r.varKeys.includes(e)&&"string"==typeof t[0]){var a,u=oi(n,t[0],i),s=hi(n,u);return s||null!==(a=l.settings)&&void 0!==a&&a.allowUnknownFields?{valueSrc:"field",value:u,valueType:null==s?void 0:s.type}:void l.errors.push("No config for field ".concat(u))}},ht=function(e,t,r,n,o){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(e){var u,s,c,d="method"==e;if(d){var p,f,v=(0,Ke.A)(t);p=v[0],u=v[1],f=v.slice(2),s=[p].concat((0,P.A)(f))}else u=e,s=t;var g=(d?"#":"")+u,h=(null==l?void 0:l.type)||(null==l?void 0:l.returnType),y=(r.funcs[g]||[]).filter((function(e){return!l||ii(n,e).returnType==h}));if(y.length)c=y[0];else{var m,b=(0,_.A)({},e,t),O=et(ei(n));try{for(O.s();!(m=O.n()).done;){var A=(0,T.A)(m.value,2),S=A[0],F=A[1];if(F.jsonLogicImport&&(!h||F.returnType==h)){var w=void 0;try{w=F.jsonLogicImport(b)}catch(e){}w&&(c=S,s=w)}}}catch(e){O.e(e)}finally{O.f()}}if(c&&c){var j=ii(n,c),E=Object.keys(j.args||{}),C=s.reduce((function(e,t,o){var l,u=E[o],s=j.args[u];return s&&(l=ft(t,r,n,["val"],i,!1,s,null,a)),void 0!==l?Ze(Ze({},e),{},(0,_.A)({},u,l)):e}),{});for(var L in j.args){var k,V=j.args[L],I=C[L];if(void 0===I)if(void 0!==(I=null==V?void 0:V.defaultValue)&&(I={value:I,valueSrc:null!==(k=I)&&void 0!==k&&k.func?"func":"value",valueType:V.type}),void 0===I){if(null==V||!V.isOptional)return void i.errors.push("No value for arg ".concat(L," of func ").concat(c))}else C[L]=I}return{valueSrc:"func",value:{func:c,args:C},valueType:j.returnType}}}},yt=function(e,t,r,n,o,l){var i,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=r.conjunctions[e],s=n.settings.fieldSeparator;if(u){var c=t.map((function(e){return ft(e,r,n,["rule","group"],l,!1,null,null,a)})).filter((function(e){return void 0!==e})).reduce((function(e,t){return Ze(Ze({},e),{},(0,_.A)({},t.id,t))}),{}),d=Object.values(c).map((function(e){var t,r;return"field"==(null==e||null===(t=e.properties)||void 0===t?void 0:t.fieldSrc)&&(null==e||null===(r=e.properties)||void 0===r?void 0:r.field)})).filter((function(e){var t;return null==e||null===(t=e.includes)||void 0===t?void 0:t.call(e,s)})),p=Object.fromEntries((i=d,Array.from(new Set(i))).map((function(e){var t=e.split(s),r=Object.fromEntries(t.slice(0,-1).map((function(e,t,r){return[].concat((0,P.A)(r.slice(0,t)),[e])})).map((function(e){return[e.join(s),hi(n,e)]})).filter((function(e){var t=(0,T.A)(e,2),r=(t[0],t[1]);return"!group"==(null==r?void 0:r.type)})));return[e,Object.keys(r)]}))),f={conjunction:u,not:o},v=D(),g={},h={};return Object.entries(c).map((function(e){var t=(0,T.A)(e,2),r=t[0],o=t[1];if("group"==(null==o?void 0:o.type)||"rule_group"==(null==o?void 0:o.type))g[r]=o;else{var l,i=null==o||null===(l=o.properties)||void 0===l?void 0:l.field,c=p[i]||[],d=c[c.length-1];if(d){var f=g,v=ci(a,n),y=ci(d,n);U(v,y.slice(0,v.length))||(v=[]),d.split(s).slice(v.length).map((function(e,t,r){return[].concat((0,P.A)(v),(0,P.A)(r.slice(0,t)),[e]).join(s)})).map((function(e){return{f:e,fc:hi(n,e)||{}}})).filter((function(e){return"!struct"!=e.fc.type})).map((function(e,t){var r=e.f,n=e.fc,o=h[r];o||(o=D(),h[r]=o,f[o]={type:"rule_group",id:o,children1:{},properties:{conjunction:u,not:!1,field:r,fieldSrc:"field",mode:n.mode}}),f=f[o].children1})),f[r]=o}else o&&(g[r]=o)}})),{type:"group",id:v,children1:g,properties:f}}},mt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:D(),children1:(0,_.A)({},e.id,e),properties:{conjunction:Mr(t),not:r}}},bt=function(e,t,r,n,o,l,i){var a,u=it.map((function(e){var t;return null===(t=l.operators[e])||void 0===t?void 0:t.jsonLogic2})).includes(e),s=l.settings.groupOperators.includes(e)&&!u,c=s?0:t-1;s?c=0:ot.includes(e)&&1==c&&null===r[1]&&(t=1,c=0,r=[r[0]]);var d=e+"/"+c,p=o.operators[d];if(p){var f,v=[];if(lt.includes(e)&&3==t)f=r[1],v=[r[0],r[2]];else{var g=r,h=(0,Ke.A)(g);f=h[0],v=h.slice(1)}if(te(f)){var y=function(e,t,r,n,o){var l,i,a,u,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,d=arguments.length>7?arguments[7]:void 0,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,f=Object.keys(t)[0],v=Object.values(t)[0],g=function(e,t){return function(e,t,r,n,o,l){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Array.isArray(t)||(t=[t]);var a=gt(e,t,r,n,o,l,i);if(a)return{fieldSrc:"field",field:a.value}}(e,t,n,o,s,d,p)||function(e,t,r,n,o){var l=ht(e,t,r,n,o,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6?arguments[6]:void 0,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null);if(l)return{fieldSrc:"func",field:l.value}}(e,t,n,o,s,c,d,p)},h=d.errors.length,y=g(f,v);if(y&&(l=y.field,i=y.fieldSrc),e&&(u=!0,a=r[0],r=[]),"reduce"==f&&Array.isArray(v)&&3==v.length){var m=v,b=(0,T.A)(m,3),O=b[0],A=b[1],S=b[2];if(te(O)&&0==S&&te(A)&&Array.isArray(A["+"])&&1==A["+"][0]&&te(A["+"][1])&&"accumulator"==A["+"][1].var)if(f=Object.keys(O)[0],v=Object.values(O)[0],"filter"==f){var F=v,w=(0,T.A)(F,2),j=w[0],E=w[1];if(te(j)){var C=g(f=Object.keys(j)[0],v=Object.values(j)[0]);C&&(l=C.field,i=C.fieldSrc,a=E,u=!0)}}else{var L=g(f,v);L&&(l=L.field,i=L.fieldSrc,u=!0)}}var k=d.errors.length;if(l||k!=h||d.errors.push("Unknown LHS ".concat(JSON.stringify(t))),l)return{field:l,fieldSrc:i,having:a,isGroup:u,args:r}}(s,f,v,o,l,null,null,i,n);if(y){var m=y.field,b=y.fieldSrc,O=y.having,A=(y.isGroup,y.args),S=hi(l,m);if(S||null!==(a=i.settings)&&void 0!==a&&a.allowUnknownFields){var F=p[0];if(p.length>1&&S&&S.operators){if(0==(p=p.filter((function(e){return S.operators.includes(e)}))).length)return void i.errors.push("No corresponding ops for LHS ".concat(m));F=p[0]}return{field:m,fieldSrc:b,fieldConfig:S,opKey:F,args:A,having:O}}i.errors.push("No config for LHS ".concat(m))}}else i.errors.push("Incorrect operands for ".concat(e,": ").concat(JSON.stringify(r)))}},Ot=function e(t,r,n,o,l,i){var a,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(t){var c=Object.values(o.conjunctions).map((function(e){return e.jsonLogicConj})),d=function(e,t,r,n,o,l,i){var a=at(i),u=bt(e,t,r,n,o,l,a);if(u)return u;i.errors.push(a.errors.join("; ")||"Unknown op ".concat(e,"/").concat(t))}(t,r.length,r,u,n,o,i);if(d){var p,f,v=d.field,g=d.fieldSrc,h=d.fieldConfig,y=d.opKey,m=d.args,b=d.having,O=hi(o,u),A=o.operators[y],S=!!o.operators[null===(a=A)||void 0===a?void 0:a.reversedOp],F="!group"==h.type,w="!group"==(null==O?void 0:O.type),j=S&&(!!o.settings.reverseOperatorsForNot||F&&!b||!F&&w&&!s),E=l&&j||!1,C=!1,L=!!o.settings.reverseOperatorsForNot;if("!group"==(null==h?void 0:h.type)&&b){p=Object.keys(b)[0],f=b[p],Array.isArray(f)||(f=[f]);for(var k=dt(b,n,i);"!"==p&&!k&&!("!"==p&&1==f.length&&f[0]&&te(f[0])&&n.varKeys.includes(Object.keys(f[0])[0]));){C=!C,b=b["!"],p=Object.keys(b)[0],f=b[p],L&&c.includes(p)&&1==f.length&&(b=b[p][0],p=Object.keys(b)[0],f=b[p]),k=dt(b,n,i)||k}Array.isArray(f)||(f=[f]),k&&((f=[])[0]=k.jlField,k.jlArgs.forEach((function(e){return f.push(e)})),p=k.newOp)}E&&(l=!l,y=A.reversedOp,A=o.operators[y]);var T=No(o,v,y,null),P=m.map((function(e){return ft(e,n,o,["val"],i,!1,h,T,u)}));if(!P.filter((function(e){return void 0===e})).length){var V,I=null==h?void 0:h.type;if("!group"!==I&&"!struct"!==I||(I=null),"!group"==(null==h?void 0:h.type)&&b){var x;if(void 0!==n.conjunctions[p]?V=yt(p,f,n,o,C,i,v,!0):(V=e(p,f,n,o,C,i,v,!0))&&("rule_group"===V.type&&(null===(x=V.properties)||void 0===x?void 0:x.field)!==v&&(V=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e)return{type:"rule_group",id:D(),children1:(0,_.A)({},e.id,e),properties:{conjunction:o||Rr(n,r),not:l,field:t}}}(V,v,h,o)),Object.assign(V.properties,{conjunction:Rr(o,h)})),!V)return;V.type="rule_group",Object.assign(V.properties,{field:v,mode:h.mode,operator:y}),"array"==h.mode&&Object.assign(V.properties,{value:P.map((function(e){return e.value})),valueSrc:P.map((function(e){return e.valueSrc})),valueType:P.map((function(e){return e.valueType}))}),l&&(V=mt(V,o,l))}else if("!group"!=(null==h?void 0:h.type)||b){var N=P.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),R=N.length?N[0]:void 0;V={type:"rule",id:D(),properties:Ze({field:v,fieldSrc:g,operator:y,value:P.map((function(e){return e.value})),valueSrc:P.map((function(e){return e.valueSrc})),valueType:P.map((function(e){return e.valueType}))},R?{asyncListValues:R}:{})},(l||s)&&(V=mt(V,o,l))}else V={type:"rule_group",id:D(),children1:{},properties:{conjunction:Rr(o,h),not:!1,mode:h.mode,field:v,operator:y}},"array"===h.mode&&Object.assign(V.properties,{value:P.map((function(e){return e.value})),valueSrc:P.map((function(e){return e.valueSrc})),valueType:P.map((function(e){return e.valueType}))}),l&&(V=mt(V,o,l));return V}}}},At=function(e,t,r,n,o,l){var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("if"===(null==e?void 0:e.toLowerCase())){var a=St(t).map((function(e){var t=(0,T.A)(e,2),o=t[0],a=t[1];return[o?ft(o,r,n,["rule","group"],l,!1,null,null,i):null,wt(n,l,r,a)]})).map((function(e){var t=(0,T.A)(e,2),r=t[0],o=t[1];return Ft(r,o,n,l)}));return{type:"switch_group",id:D(),children1:a,properties:{}}}},St=function(e){var t=[];return function e(r){var n=(0,T.A)(r,3),o=n[0],l=n[1],i=n[2];t.push([o,l]);var a=te(i)?Object.keys(i)[0]:null;"if"===(null==a?void 0:a.toLowerCase())?e(i[a]):t.push([void 0,i])}(e),t},Ft=function(e,t,r,n){var o;return e?(o=Ze({},e)).type?("group"!=o.type&&(o=mt(o,r)),o.type="case_group"):(n.errors.push("Unexpected case: ".concat(JSON.stringify(o))),o=void 0):o={id:D(),type:"case_group",properties:{}},o&&(o.properties=Ze(Ze({},o.properties),t)),o},wt=function(e,t,r,n){var o=hi(e,"!case_value");if(o){var l=o.mainWidget,i=e.widgets[l];if(i){var a=ft(n,r,e,["val","case_val"],t,!1,o,l);if(null!=a){var u=a.value,s=a.valueSrc,c=a.valueType;return{value:[u],valueSrc:[null!=s?s:"value"],valueType:[null!=c?c:null==i?void 0:i.type],field:"!case_value"}}}else t.errors.push("No widget ".concat(l," for case value"))}else t.errors.push("Missing caseValueField in settings")},jt=r(47768),Et=r(95122),Ct=r.n(Et)();Ct.trim=function(e){return"'"==e.charAt(0)?e.substring(1,e.length-1):e},Ct.escapeLike=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Ct.escape(e);return"'"+(n=(t?"%":"")+(n=(n=Ct.trim(n)).replace(/[%_]/g,"\\$&"))+(r?"%":""))+"'"};var Lt=function(e){var t="''",r=null==e?void 0:e.type;return"date"==r?t="'0000-00-00'":"datetime"==r?t="'0000-00-00 00:00'":"time"==r?t="'00:00'":"number"==r&&(t="0"),t},kt=function(e){var t="";return"number"==(null==e?void 0:e.type)&&(t=0),t},_t=function(e){return"".concat(e,".?[true]")},Tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e)return"null";switch((0,V.A)(e)){case"boolean":return e?"true":"false";case"number":if(!Number.isFinite(e)||isNaN(e))return;return e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=["int","float"];return e.map((function(e){if(null!=e){if("string"==typeof e)r="String";else{if("number"!=typeof e)throw new Error("spelEscape: Can't use value ".concat(e," in array"));r=Number.isInteger(e)?"int":"float"}if(t){if(t!=r){if(!l.includes(t)||!l.includes(r))throw new Error("spelEscape: Can't use different types in array: found ".concat(t," and ").concat(r));t="float"}}else t=r}})),t||(t="String"),n="float"==t?e.map((function(e){return Tt(e,!0)})):e.map((function(e){return Tt(e)})),o?"new ".concat(t,"[]{").concat(n.join(", "),"}"):"{".concat(n.join(", "),"}")}(e,r);throw new Error("spelEscape: Object is not supported");default:return function(e){return"'"+e.replace(/'/g,"''")+"'"}(e)}},Pt=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){return"const"==e.type?Tt(e.value):"property"==e.type?""+e.value:"variable"==e.type?"#"+e.value:void 0})).filter((function(e){return null!=e})).join(" + "):"null"},Vt=function(e){if(null==e)return[void 0,[]];var t=[],r="case_value"==e.valueType?e.value:e;return[(Array.isArray(r)?r:[r]).map((function(e){return"value"===e.valueSrc?null===e.value?void 0:{type:"const",value:e.value}:"field"===e.valueSrc?{type:e.isVariable?"variable":"property",value:e.value}:void t.push("Unsupported valueSrc ".concat(e.valueSrc," in concatenation"))})).filter((function(e){return null!=e})),t]},It=function(e){return null==e?"NULL":e.toString()},xt=function(e){return null==e||"("===(null==e?void 0:e[0])&&")"===(null==e?void 0:e[(null==e?void 0:e.length)-1])?e:"("+e+")"};function Dt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var qt="${0}.compareTo(${1})",Wt={datetime:!0,time:!0,date:!0},Bt=function(e,t){return Gt(e,t,!1)},Gt=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=zl(t,void 0,!1),l=zt(e,o,n,null);return r?[l,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SpEL:",n.errors),l)},zt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return"group"===o||"rule_group"===o?Jt(e,t,r,n):"rule"===o?Yt(e,t,r,n):"switch_group"==o?$t(e,t,r,n):"case_group"==o?Ut(e,t,r,n):void 0}},Ut=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type");if("case_group"==o){var l=e.get("properties")||new I.T5,i=Xt(t,l,r,null,n,"!case_value"),a=(0,T.A)(i,3),u=a[0];return a[1],a[2],[Jt(e,t,r,n),u]}r.errors.push("Unexpected child of type ".concat(o," inside switch"))},$t=function(e,t,r){e.get("properties")||new I.T5;var n=e.get("children1");if(n){var o=n.map((function(e){return Ut(e,t,r,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray();if(o.length){if(1==o.length&&!o[0][0])return o[0][1];for(var l=[],i=0;i<o.length;i++)i==o.length-1||o[i][0]?(l.push(o[i]),i==o.length-1&&o[i][0]&&l.push([void 0,null])):r.errors.push("No condition for case ".concat(i));for(var a="",u="",s=0;s<l.length;s++){var c=(0,T.A)(l[s],2),d=c[0],p=c[1];null==p&&(p="null"),null==d&&(d="true"),s!=l.length-1?(a+="(".concat(d," ? ").concat(p," : "),u+=")"):a+="".concat(p)}return a+u}}},Jt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type"),l=e.get("properties")||new I.T5,i=l.get("mode"),a=e.get("children1")||new I.B8,u=l.get("field"),s=l.get("conjunction");s||(s=Mr(t));var c=t.conjunctions[s],d=l.get("not"),p="rule_group"===o,f=p&&"struct"!=i,v=f?u:n,g=(hi(t,v)||{}).isSpelArray,h=t.settings.fieldSeparator,y=l.get("operator");y||i&&"some"!=i||(y="some");var m=Kt(t,y,u),b=m!=y,O=y&&yi(t,m,u)||null,A=p&&(!m||0==O.cardinality),S=Xt(t,l,r,m,n,null),F=(0,T.A)(S,3),w=F[0],j=F[1],E=F[2],C=a.map((function(e){return zt(e,t,r,v)})).filter((function(e){return void 0!==e}));if(f&&!A){if(null==w)return}else if(!C.size)return;var L,k=p,_=C.size?c.spelFormatConj.call(t.ctx,C,s,d,k):null;if(f){var P=er(r,t,u,n),V=(h||".")+(g?"length":"size()"),x="".concat(P).concat(V),D=_?"".concat(P,".?[").concat(_,"]").concat(V):x;L=Ht(r,t,l,D,A?x:w,m,j,E,b)}else L=_;return L},Ht=function(e,t,r,n,o,l,i,a){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],s=r.get("field"),c=yi(t,l,s)||{},d=hi(t,s)||{},p=r.get("operatorOptions"),f=c.spelFormatOp||function(e,t,r){var n=t.spelOp;if(n){var o,l=n.includes("${0}"),i=Wt[r],a=n,u=G(t);return i?o=function(e,t,r,n,o,l,i,s){var c=qt.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:u>1?r[n-1]:r}));return"".concat(c," ").concat(a," 0")}:l?o=function(e,t,r,o,l,i,a,s){return n.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:u>1?r[n-1]:r}))}:0==u?o=function(e,t,r,n,o,l,i,u){return"".concat(e," ").concat(a)}:1==u&&(o=function(e,t,r,n,o,l,i,u){return"".concat(e," ").concat(a," ").concat(r)}),o}}(0,c,a);if(f){var v,g=[n,l,o,i,a,B(c,M),p,d];return v=f.call.apply(f,[t.ctx].concat(g)),u&&(v=t.settings.spelFormatReverse.call(t.ctx,v)),void 0===v&&e.errors.push("Operator ".concat(l," is not supported for value source ").concat(i)),v}e.errors.push("Operator ".concat(l," is not supported"))},Kt=function(e,t,r){if(t){var n=yi(e,t,r)||{},o=n.reversedOp,l=yi(e,o,r)||{},i=n.spelOp||n.spelFormatOp,a=l.spelOp||l.spelFormatOp;if(i||a){if(!i&&a){var u=[o,t];t=u[0],o=u[1];var s=[l,n];n=s[0],l=s[1]}return t}}},Yt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("properties")||new I.T5,l=o.get("field"),i=o.get("fieldSrc"),a=o.get("operator");if(null!=l&&null!=a){var u=Kt(t,a,l);if(u){var s=u!=a,c=Xt(t,o,r,u,n,null),d=(0,T.A)(c,3),p=d[0],f=d[1],v=d[2];if(void 0!==p){var g=Qt(r,t,l,i,n);if(void 0!==g)return Ht(r,t,o,g,p,u,f,v,s)}}else r.errors.push("Operator ".concat(a," is not supported"))}},Qt=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"func"===n?tr(e,t,r,o):er(e,t,r,o)},Xt=function(e,t,r,n,o){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=t.get("field"),a=t.get("valueSrc"),u=t.get("valueType");("!case_value"==l||u&&"case_value"==u.get(0))&&(i="!case_value");var s,c=hi(e,i)||{},d=yi(e,n,i)||{},p=G(d),f=t.get("value"),v=t.get("asyncListValues"),g=[],h=[];if(null!=f){var y=f.map((function(t,l){var s=a?a.get(l):null,p=u?u.get(l):null,f=Ho(t,s,e),y=No(e,i,n,s),m=mi(e,i,n,y,s,{forExport:!0}),b=Zt(r,e,f,s,p,m,c,n,d,o,v);return void 0!==b&&(g.push(s),h.push(p)),b})),m=y.filter((function(e){return void 0===e})).size>0;y.size<p||m||(s=p>1?y.toArray():1==p?y.first():null)}return[s,g.length>1?g:g[0],h.length>1?h:h[0]]},Zt=function(e,t,r,n,o,l,i,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var d;if("field"===n)d=er(e,t,r,s);else if("func"===n)d=tr(e,t,r,s);else if("function"==typeof(null==l?void 0:l.spelFormatValue)){var p=l.spelFormatValue,f=[r,Mt(Mt({},pe()(i,["fieldSettings","listValues"])),{},{asyncListValues:c}),B(l,R)];if(a&&(f.push(a),f.push(u)),"field"==n){var v=hi(t,r)||{};f.push(v)}d=p.call.apply(p,[t.ctx].concat(f))}else d=Tt(r);return d}},er=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,l=hi(t,r)||{},i=ci(r,t),a=To(r,t,n),u=t.settings.formatSpelField,s=Ro(r,t,e,n),c=a.map((function(e){var t,r=(0,T.A)(e,3),n=r[0],l=r[1],i=r[2];return i&&(t="!struct"==i.type||"!group"==i.type&&"struct"==i.mode?l.isSpelMap?"map":"class":"!group"==i.type?l.isSpelItemMap?"[map]":"[class]":"class"),{key:n,parent:t,isSpelVariable:null==l?void 0:l.isSpelVariable,fieldSeparator:o}}));return u.call(t.ctx,s,n,i,c,l,t)}},tr=function(e,t,r){var n,o,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),u=ii(t,i);if(u){var s={},c=[],d=[];for(var p in u.args){var f,v,g=u.args[p],h=hi(t,g),y=g.defaultValue,m=g.isOptional,b=null!=y&&y.func?"func":"value",O=a?a.get(p):void 0,A=O?O.get("value"):void 0,S=O?O.get("valueSrc"):void 0;"func"!==S&&null!==(f=A)&&void 0!==f&&f.toJS&&(A=A.toJS());var F=O?O.get("asyncListValues"):void 0,w=null===(v=g.spelEscapeForFormat)||void 0===v||v,j=null,E=No(t,g,j,S),C=mi(t,g,j,E,S,{forExport:!0}),L=Zt(e,t,A,S,g.type,C,h,null,null,l,F);if(null!=A&&void 0===L)return void("func"!=S&&e.errors.push("Can't format value of arg ".concat(p," for func ").concat(i)));var k=void 0;if(void 0===L&&!m&&null!=y){var _=No(t,g,j,b),T=mi(t,g,j,_,b,{forExport:!0});if(void 0===(k=Zt(e,t,y,b,g.type,T,h,null,null,l,F)))return void("func"!=b&&e.errors.push("Can't format default value of arg ".concat(p," for func ").concat(i)))}var P=null!=L?L:k;if(void 0!==P){var V;if(c.length){var I,x=Dt(c);try{for(x.s();!(I=x.n()).done;){var D=I.value;s[D]=void 0}}catch(e){x.e(e)}finally{x.f()}c=[]}s[p]=w?P:null!==(V=A)&&void 0!==V?V:y}else m||d.push(p),c.push(p)}if(!d.length){var N;if("function"==typeof u.spelFormatFunc){var R=u.spelFormatFunc,M=[s];N=R.call.apply(R,[t.ctx].concat(M))}else if(u.spelFunc){N=u.spelFunc.replace(/\${(\w+)}/g,(function(e,t){var r;return null!==(r=s[t])&&void 0!==r?r:e}));var q,W=Object.keys(u.args||{}).reverse().filter((function(e){return!!u.args[e].isOptional})),B=Dt(W);try{for(B.s();!(q=B.n()).done;){var G=q.value;if(null!=s[G])break;N=N.replace(new RegExp("(, )?\\${"+G+"}","g"),"")}}catch(e){B.e(e)}finally{B.f()}N=N.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(i," is not supported"));return N}}else e.errors.push("Func ".concat(i," is not defined in config"))};function rr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return nr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function or(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?or(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):or(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ir={number:"number",string:"text",boolean:"boolean",null:"null"},ar={String:"text"},ur=function(e){return"object"==(0,V.A)(e)&&null!==e&&!Array.isArray(e)},sr=function(e,t){return cr(e,t,!0)},cr=function(e,t){var r,n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l={errors:[]},i=zl(t,void 0,!1),a=fr(i),u=void 0;try{r=jt.SpelExpressionEvaluator.compile(e)._compiledExpression}catch(e){l.errors.push(e)}r&&(n=dr(r,l),ue.debug("convertedObj:",n,l),(u=vr(n,a,i,l))&&"group"!=u.type&&"switch_group"!=u.type&&(u=kr(u,i,n.not)),ue.debug("jsTree:",u));var s=u?Ue(u):void 0;return o?[s,l.errors]:(l.errors.length&&console.warn("Errors while importing from SpEL:",l.errors),s)},dr=function e(t,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=t.getType(),i=t.getChildren().map((function(n){return e(n,r,t)}));if("op-or"!=l&&"op-and"!=l||(i=i.reduce((function(e,t){var r=t.type!=l||t.not?[t]:t.children;return[].concat((0,P.A)(e),(0,P.A)(r))}),[])),"op-not"==l)return 1!=i.length&&r.errors.push("Operator NOT should have 1 child, but got ".concat(i.length,"}")),lr(lr({},i[0]),{},{not:!i[0].not});if("compound"==l){var a=(i=i.filter((function(e){return!("selection"==e.type&&1==e.children.length&&"boolean"==e.children[0].type&&1==e.children[0].val)}))).find((function(e){return"selection"==e.type}));a&&1!=a.children.length&&r.errors.push("Selection should have 1 child, but got ".concat(a.children.length));var u=a?a.children[0]:null,s=i[i.length-1],c="method"==s.type&&"size"==s.val.methodName||"!func"==s.type&&"size"==s.methodName,d="property"==s.type&&"length"==s.val,p=i.filter((function(e){return e!==a&&e!==s})),f={type:"compound",children:p};if((c||d)&&null!=hr(p))return{type:"!aggr",filter:u,source:f};if(i=(i=i.filter((function(e){var t="variable"==e.type&&"this"==e.val,r="variable"==e.type&&"root"==e.val;return!(t||r)}))).map((function(e){return"indexer"==e.type&&1==e.children.length?{type:"indexer",val:e.children[0].val,itype:e.children[0].type}:e})),"!func"==s.type){var v={},g=v;do{var h,y;Object.assign(g,s),i=i.filter((function(e){return e!==s})),"!func"==(null===(y=s=i[i.length-1])||void 0===y?void 0:y.type)?(g.obj={},g=g.obj):i.length>1?g.obj={type:"compound",children:i}:g.obj=s}while("!func"==(null===(h=s)||void 0===h?void 0:h.type));return v}}try{t.getRaw?n=t.getRaw():0==t.getValue.length&&(n=t.getValue())}catch(e){ue.error("[spel2js] Error in getValue()",e)}if("ternary"==l&&(n=pr(i)),"object"===(0,V.A)(n)&&null!==n&&(n.methodName||n.functionName)&&(n.args=n.args.map((function(n){return e(n,r,t)}))),"list"==l&&(n=n.map((function(n){return e(n,r,t)})),!o&&1==n.length))return n[0];if("constructorref"==l){var m=i.find((function(e){return"qualifiedidentifier"==e.type})),b=null==m?void 0:m.val;return b?{type:"!new",cls:b,args:i.filter((function(e){return"qualifiedidentifier"!=e.type}))}:void r.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(i)))}if("typeref"==l){var O=i.find((function(e){return"qualifiedidentifier"==e.type})),A=null==O?void 0:O.val;return A?(i.filter((function(e){return"qualifiedidentifier"!=e.type})),{type:"!type",cls:A}):void r.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(i)))}if("function"==l||"method"==l){var S=n,F=S.functionName,w=S.methodName,j=S.args;return{type:"!func",methodName:F||w,isVar:"function"==l,args:j}}return{type:l,children:i,val:n}},pr=function(e){var t=[];return function e(r){var n=(0,T.A)(r,3),o=n[0],l=n[1],i=n[2];t.push([o,l]),"ternary"==(null==i?void 0:i.type)?e(i.children):t.push([void 0,i])}(e),t},fr=function(e){var t={},r=function(r){var n=e.operators[r];if(n.spelOps)n.spelOps.forEach((function(e){var n=e;t[n]||(t[n]=[]),t[n].push(r)}));else if(n.spelOp){var o=n.spelOp;t[o]||(t[o]=[]),t[o].push(r)}else ue.log("[spel] No spelOp for operator ".concat(r))};for(var n in e.operators)r(n);var o={};for(var l in e.conjunctions)o[e.conjunctions[l].spelConj||l.toLowerCase()]=l;var i,a={},u=rr(ei(e));try{var s=function(){var e=(0,T.A)(i.value,2),t=e[0],r=e[1],n=[],o=r.spelFunc;if("string"==typeof o){var l=Object.keys(r.args||{}).reverse().filter((function(e){return!!r.args[e].isOptional||null!=r.args[e].defaultValue})),u=o.replace(/\${(\w+)}/g,(function(e,t){return"?"})),s=l.reduce((function(e,t){return[].concat((0,P.A)(e),[[t].concat((0,P.A)(e[e.length-1]||[]))])}),[]).map((function(e){return o.replace(/(?:, )?\${(\w+)}/g,(function(t,r){return e.includes(r)?"":t})).replace(/\${(\w+)}/g,(function(e,t){return"?"}))}));n=[u].concat((0,P.A)(s))}var c,d=rr(n);try{for(d.s();!(c=d.n()).done;){var p=c.value;a[p]||(a[p]=[]),a[p].push(t)}}catch(e){d.e(e)}finally{d.f()}};for(u.s();!(i=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}var c={};for(var d in e.widgets){var p=e.widgets[d],f=p.spelImportFuncs;if(p.type,f){var v,g=rr(f);try{for(g.s();!(v=g.n()).done;){var h=v.value;if("string"==typeof h){var y=h.replace(/\${(\w+)}/g,(function(e,t){return"?"})),m=(0,P.A)(h.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,T.A)(e,2);return t[0],t[1]}));c[y]||(c[y]=[]),c[y].push({w:d,argsOrder:m})}}}catch(e){g.e(e)}finally{g.f()}}}var b={};for(var O in e.operators){var A=e.operators[O].spelOp;if(null!=A&&A.includes("${0}")){var S=A.replace(/\${(\w+)}/g,(function(e,t){return"?"})),F=(0,P.A)(A.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,T.A)(e,2);return t[0],t[1]}));b[S]||(b[S]=[]),b[S].push({op:O,argsOrder:F})}}return b[qt.replace(/\${(\w+)}/g,(function(e,t){return"?"}))]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:a,valueFuncs:c,opFuncs:b}},vr=function e(t,r,n,o){var l,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(t){t._groupField=null!==(l=t._groupField)&&void 0!==l?l:null==i?void 0:i._groupField;var a,u=!0;if(0===t.type.indexOf("op-")||"matches"===t.type)a=gr(t,r,n,o,i);else if("!aggr"==t.type){var s,c=e(t.source,r,n,o,t);t._groupField=null==c?void 0:c.value;var d=e(t.filter,r,n,o,t);"rule"==(null===(s=d)||void 0===s?void 0:s.type)&&(d=kr(d,n,t.filter.not)),a={groupFilter:d,groupFieldValue:c},i||(a=void 0,o.errors.push("Unexpected !aggr in root"),u=!1)}else if("ternary"==t.type){var p={};t.val.forEach((function(e){var l=(0,T.A)(e,2),i=l[0],a=l[1],u=Er(i,a,r,n,o,t);u&&(p[u.id]=u)})),a={type:"switch_group",id:D(),children1:p,properties:{}}}if(!a&&u&&(a=yr(t,r,n,o,i)),a&&!a.type&&!i){var f=jr(t,r,n,o);f?a=f:(a=void 0,o.errors.push("Can't convert rule of type ".concat(t.type,", it looks like var/literal")))}return a}},gr=function e(t,r,n,o){var l,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=t.type.startsWith("op-")?t.type.slice(3):t.type;if(("minus"==a||"plus"==a)&&1==t.children.length){var u=t.negative;return"minus"==a&&(u=!u),t.children[0].negative=u,vr(t.children[0],r,n,o,i)}var s="and"==a&&2==t.children.length&&"op-ge"==t.children[0].type&&"op-le"==t.children[1].type,c="or"==a&&2==t.children.length&&"op-lt"==t.children[0].type&&"op-gt"==t.children[1].type;if(s||c){var d=(0,T.A)(t.children[0].children,2),p=d[0],f=d[1],v=(0,T.A)(t.children[1].children,2),g=v[0],h=v[1];if(wr(p,g,t,r,n,o,i)){f.val,h.val;var y={type:"op-between",children:[p,f,h],not:c};return y._groupField=null==i?void 0:i._groupField,e(y,r,n,o,i)}}var m=r.operators[a];"eq"==a&&"null"==t.children[1].type?m=["is_null"]:"ne"==a&&"null"==t.children[1].type?m=["is_not_null"]:"le"==a&&"string"==t.children[1].type&&""==t.children[1].val?m=["is_empty"]:"gt"==a&&"string"==t.children[1].type&&""==t.children[1].val?m=["is_not_empty"]:"between"==a&&(m=["between"]);var b=function(){var e,l=t.children.map((function(e){return vr(e,r,n,o,t)}));return l.length>=2&&"!compare"==(null===(e=l)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.type)&&(l=l[0].children),l};if("and"==a||"or"==a){var O={};b().forEach((function(e){if(e){var t=D();e.id=t,null!=e.type?O[t]=e:o.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(e)))}})),l={type:"group",id:D(),children1:O,properties:{conjunction:r.conjunctions[a],not:t.not}}}else if(m){var A,S,F,w=b(),j=w[0],E=w.slice(1),C=null==j||null===(A=j.groupFieldValue)||void 0===A?void 0:A.value,L=null===(S=E)||void 0===S?void 0:S[0],k=m[0];if(m.length>1){var _,P,V=(null===(_=w[0])||void 0===_?void 0:_.valueType)||(null===(P=w[1])||void 0===P?void 0:P.valueType),I=null==j?void 0:j.value,x=m.map((function(e){return{op:e,widget:No(n,I,e)}}));if(ue.warn("[spel] Spel operator ".concat(a," can be mapped to ").concat(m,"."),"widgets:",x,"vals:",w,"valueType=",V),"eq"==a||"ne"==a){var N=x.find((function(e){e.op;var t=e.widget;return t&&"field"!=t}));N&&(k=N.op)}}null!=j&&j.groupFieldValue&&(L&&L.groupFieldValue&&"field"==L.groupFieldValue.valueSrc&&L.groupFieldValue.value==C?(k="all",E=[]):"equal"==k&&"value"==L.valueSrc&&"number"==L.valueType&&0==L.value?(k="none",E=[]):"greater"==k&&"value"==L.valueSrc&&"number"==L.valueType&&0==L.value&&(k="some",E=[]));var R=n.operators[k],M=n.operators[null===(F=R)||void 0===F?void 0:F.reversedOp],q=t.not&&["between"].includes(k),W=!!M&&(!!n.settings.reverseOperatorsForNot||q);(t.not&&W||q)&&(k=R.reversedOp,R=n.operators[k],t.not=!t.not);var B=!!t.not;if(t.not=!1,j)if(j.groupFieldValue)"field"!=j.groupFieldValue.valueSrc&&o.errors.push("Expected group field ".concat(JSON.stringify(j))),l=Fr(j,k,E,n,o);else{"field"!=j.valueSrc&&"func"!=j.valueSrc&&o.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(j)));var G=j.value;l=Sr(n,o,G,k,E,t)}B&&("group"!==l.type?l=kr(l,n,!0):l.properties.not=!l.properties.not)}else i||(l=jr(t,r,n,o));return l},hr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=e.map((function(e){if("variable"==e.type||"property"==e.type||"indexer"==e.type&&"string"==e.itype)return e.val;var o,l;n=!0,r&&(null==t||null===(o=t.errors)||void 0===o||null===(l=o.push)||void 0===l||l.call(o,"Unexpected item in field path compound: ".concat(JSON.stringify(e))))}));return n?void 0:o},yr=function e(t,r,n,o){var l,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null!=t){var u=n.settings.fieldSeparator;if(t._groupField=null!==(l=t._groupField)&&void 0!==l?l:null==a?void 0:a._groupField,"variable"==t.type||"property"==t.type){var s=oi(n,t.val,t._groupField),c=hi(n,s),d="variable"==t.type;return{valueSrc:"field",valueType:null==c?void 0:c.type,isVariable:d,value:s}}if("compound"==t.type){var p=hr(t.children,o);if(p){var f,v=oi(n,p.join(u),t._groupField),g=hi(n,v),h="variable"==(null===(f=t.children)||void 0===f||null===(f=f[0])||void 0===f?void 0:f.type);return{valueSrc:"field",valueType:null==g?void 0:g.type,isVariable:h,value:v}}}else{if(ir[t.type]){var y=t.val,m=ir[t.type];return t.negative&&(y=-y),{valueSrc:"value",valueType:m,value:y}}if("!new"==t.type&&ar[t.cls.at(-1)]){var b=t.args.map((function(l){return e(l,r,n,o,t)})),O=null==b?void 0:b[0],A=ar[t.cls.at(-1)];return lr(lr({},O),{},{valueType:A})}if("list"==t.type){var S,F=t.val.map((function(l){return e(l,r,n,o,t)}));return F.length&&(null===(S=F[0])||void 0===S||S.valueType),{valueSrc:"value",valueType:"multiselect",value:F.map((function(e){return null==e?void 0:e.value}))}}if("op-plus"===t.type&&"ternary"===(null==a?void 0:a.type)&&"case_value"===(null===(i=n.settings.caseValueField)||void 0===i?void 0:i.type))return Cr(t,r,n,o)}var w=br(t,r,n,o,a);if(void 0!==w)return w;o.errors.push("Can't convert arg of type ".concat(t.type))}},mr=function e(t,r){var n,o=[],l="",i=t.type,a=t.methodName,u=(t.val,t.obj),s=t.args,c=t.isVar,d=t.cls,p=t.children,f=null==p?void 0:p[p.length-1],v=r[r.length-1];if("!func"===i){for(var g=u;g;){var h,y=e(lr(lr({},g),{},{obj:null}),[{}]),m=(0,T.A)(y,2),b=m[0],O=m[1];if("?"!==b){var A={s:v.s,params:(0,P.A)(v.params),objs:(0,P.A)(v.objs)};v.objs.unshift("?"),v.params.unshift(g),r.push(A),v=r[r.length-1]}v.objs.unshift(b),(h=v.params).unshift.apply(h,(0,P.A)(O)),g="!func"===g.type?g.obj:null}var S,F=rr(r);try{for(F.s();!(S=F.n()).done;){var w,j=S.value;o=[].concat((0,P.A)((null==j?void 0:j.params)||[]),(0,P.A)(s||[])),l="",null!=j&&null!==(w=j.objs)&&void 0!==w&&w.length&&(l+=j.objs.join(".")+"."),l+=(c?"#":"")+a,l+="("+(s||[]).map((function(e){return"?"})).join(", ")+")",j.s=l,j.params=o}}catch(e){F.e(e)}finally{F.f()}}else"!new"===i?(o=s||[],l="new ".concat(d.join("."),"(").concat(o.map((function(e){return"?"})).join(", "),")")):"!type"===i?l="T(".concat(d.join("."),")"):"compound"===i&&"property"===f.type&&(n=f.val,["length"].includes(n))?l=p.map((function(t){var r;if(t===f)return t.val;var n=e(lr(lr({},t),{},{obj:null}),[{}]),l=(0,T.A)(n,2),i=l[0],a=l[1];return(r=o).push.apply(r,(0,P.A)(a)),i})).join("."):(o=[t],l="?");return v&&(v.s=l,v.params=o),[l,o]},br=function(e,t,r,n){var o,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=function(o){return vr(o,t,r,n,e)},a=function(e){var t=[{s:"",params:[],objs:[]}];return mr(e,t),t.map((function(e){return{s:e.s,params:e.params}})).reverse().filter((function(e){var t=e.s;return""!==t&&"?"!==t}))}(e),u=null==a||null===(o=a[0])||void 0===o?void 0:o.s;a.length&&ue.debug("Signatures for ",e,":",u,a);var s=Or(e,t,r,n,l,a,i);if(void 0!==s)return s;var c,d,p,f=Ar(e,t,r,n,l,a,i);if(void 0!==f)return f;var v,g=rr(a);try{var h=function(){var e=v.value,n=e.s,o=e.params,l=t.funcs[n];if(l){c=l[0];var a=(d=ii(r,c)).spelFunc,u=o.map(i),s=(0,P.A)(a.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,T.A)(e,2);return t[0],t[1]}));return p=Object.fromEntries(s.map((function(e,t){return[e,u[t]]}))),1}};for(g.s();!(v=g.n()).done&&!h(););}catch(e){g.e(e)}finally{g.f()}if(!c){var y,m=rr(ei(r));try{for(m.s();!(y=m.n()).done;){var b=(0,T.A)(y.value,2),O=b[0],A=b[1];if(A.spelImport){var S=void 0;try{S=A.spelImport(e)}catch(e){}if(S)for(var F in d=ii(r,c=O),p={},S)p[F]=i(S[F])}}}catch(e){m.e(e)}finally{m.f()}}if(c){var w={};for(var j in d.args){var E,C=d.args[j],L=p[j];if(void 0===L)if(void 0===(L=null==C?void 0:C.defaultValue)){if(null==C||!C.isOptional)return void n.errors.push("No value for arg ".concat(j," of func ").concat(c))}else L={value:L,valueSrc:null!==(E=L)&&void 0!==E&&E.func?"func":"value",valueType:C.type};L&&(w[j]=L)}return{valueSrc:"func",value:{func:c,args:w},valueType:d.returnType}}e.methodName&&n.errors.push("Signature ".concat(u," - failed to convert"))},Or=function(e,t,r,n,o,l,i){var a,u,s,c=[];for(var d in r.widgets){var p=r.widgets[d].spelImportFuncs;if(p)for(var f=0;f<p.length;f++){var v=p[f];if(ur(v)){var g={};if(le(v,e,g)){for(var h in g)g[h]=i(g[h]);c.push({s:"widgets.".concat(d,".spelImportFuncs[").concat(f,"]"),w:d,argsObj:g})}}}}var y,m=rr(l);try{for(m.s();!(y=m.n()).done;){var b,O=y.value,A=O.s,S=O.params,F=rr(t.valueFuncs[A]||[]);try{var w=function(){var e=b.value,t=e.w,r=e.argsOrder,n=S.map(i),o=Object.fromEntries(r.map((function(e,t){return[e,n[t]]})));c.push({s:A,w:t,argsObj:o})};for(F.s();!(b=F.n()).done;)w()}catch(e){F.e(e)}finally{F.f()}}}catch(e){m.e(e)}finally{m.f()}for(var j=0,E=c;j<E.length;j++){var C=E[j],L=C.s,k=C.w,_=C.argsObj,P=r.widgets[k],V=P.spelImportValue,I=P.type;for(var x in s=k,u=L,a=[],_)["value"].includes(_[x].valueSrc)||a.push("".concat(x," has unsupported value src ").concat(_[x].valueSrc));var D=_.v.value;if(V&&!a.length){var N=V.call(r.ctx,_.v,P,_),R=(0,T.A)(N,2);D=R[0],(a=R[1])&&!Array.isArray(a)&&(a=[a])}if(!a.length)return{valueSrc:"value",valueType:I,value:D}}s&&a.length&&n.errors.push("Signature ".concat(u," - looks like convertable to ").concat(s,", but: ").concat(a.join("; ")))},Ar=function(e,t,r,n,o,l,i){var a,u,s,c,d=rr(l);try{for(d.s();!(c=d.n()).done;){var p,f=c.value,v=f.s,g=f.params,h=rr(t.opFuncs[v]||[]);try{var y,m=function(){var t,l=p.value,c=l.op,d=l.argsOrder,f=g.map(i);if(u=c,"!compare"===c){if(o.type.startsWith("op-")&&2==o.children.length&&"number"==o.children[1].type&&0===o.children[1].val)return{v:{type:"!compare",children:f}};a.push("Result of compareTo() should be compared to 0")}s=v,a=[];var h=r.operators[u],y=(h.spelOp,h.valueTypes),m=Object.fromEntries(d.map((function(e,t){return[e,f[t]]}))),b=m[0],O=Object.keys(m).filter((function(e){return parseInt(e)>0})).map((function(e){return m[e]})),A=null===(t=f.filter((function(e){return!!e})).find((function(e){return"value"===e.valueSrc})))||void 0===t?void 0:t.valueType;if(y&&A&&!y.includes(A)&&a.push("Op supports types ".concat(y,", but got ").concat(A)),!a.length)return{v:Sr(r,n,b,u,O,e)}};for(h.s();!(p=h.n()).done;)if(y=m())return y.v}catch(e){h.e(e)}finally{h.f()}}}catch(e){d.e(e)}finally{d.f()}u&&a.length&&n.errors.push("Signature ".concat(s," - looks like convertable to ").concat(u,", but: ").concat(a.join("; ")))},Sr=function(e,t,r,n,o,l){var i,a;if(!o.filter((function(e){return void 0===e})).length){var u=null!==(i=r)&&void 0!==i&&i.func?"func":"field";ur(r)&&r.valueSrc&&(u=r.valueSrc,r=r.value);var s=hi(e,r);if(s){var c=hi(e,null==l?void 0:l._groupField),d="!group"==s.type,p=(d&&s.mode,"!group"==(null==c?void 0:c.type)),f=e.operators[n],v=e.operators[null===(a=f)||void 0===a?void 0:a.reversedOp],g=(null==l?void 0:l.not)&&["between"].includes(n),h=!!v&&(!!e.settings.reverseOperatorsForNot||g||!d&&p);((null==l?void 0:l.not)&&h||g)&&(n=f.reversedOp,f=e.operators[n],l.not=!l.not);var y=!(null==l||!l.not),m=No(e,r,n),b=e.widgets[m||s.mainWidget],O=o.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),A=O.length?O[0]:void 0,S={type:"rule",id:D(),properties:lr({field:r,fieldSrc:u,operator:n,value:o.map((function(e){return e.value})),valueSrc:o.map((function(e){return e.valueSrc})),valueType:o.map((function(e){return"value"==e.valueSrc&&((null==b?void 0:b.type)||(null==s?void 0:s.type))||e.valueType}))},A?{asyncListValues:A}:{})};return y&&(S=kr(S,e,l.not)),S}t.errors.push("No config for field ".concat(r))}},Fr=function(e,t,r,n,o){var l=e.groupFilter,i=e.groupFieldValue;if("field"!=i.valueSrc)throw"Bad groupFieldValue: ".concat(JSON.stringify(i));var a=i.value,u=Sr(n,o,a,t,r);if(u){var s,c=hi(n,a),d=null==c?void 0:c.mode;return(s="group"===(null==l?void 0:l.type)?lr(lr({},l||{}),{},{type:"rule_group",properties:lr(lr(lr({},u.properties),(null==l?void 0:l.properties)||{}),{},{mode:d})}):lr(lr({},u||{}),{},l?{type:"rule_group",children1:[l],properties:lr(lr({},u.properties),{},{mode:d})}:{type:"rule_group",properties:lr(lr({},u.properties),{},{mode:d})})).id||(s.id=D()),s}},wr=function(e,t,r,n,o,l){if(e.type==t.type){if("!aggr"==e.type){var i=[e.source,t.source].map((function(e){return yr(e,n,o,l,r)})),a=(0,T.A)(i,2),u=a[0],s=a[1];return u.value==s.value}var c=[e,t].map((function(e){return yr(e,n,o,l,r)})),d=(0,T.A)(c,2),p=d[0],f=d[1];return p.value==f.value}return!1},jr=function(e,t,r,n){var o={},l=Er(null,e,t,r,n);return l&&(o[l.id]=l),{type:"switch_group",id:D(),children1:o,properties:{}}},Er=function(e,t,r,n,o){var l,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=Lr(n,o,r,t,i);return e?(l=vr(e,r,n,o,i))&&l.type?("group"!=l.type&&(l=kr(l,n)),l.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(l))),l=void 0):l={id:D(),type:"case_group",properties:{}},l&&(l.properties=lr(lr({},l.properties),a)),l},Cr=function(e,t,r,n){var o=[];return function l(i){i.map((function(i){if("op-plus"===i.type)l(i.children);else{var a=yr(i,t,r,n,e);a?o.push(a):n.errors.push("Can't convert ".concat(i.type," in concatenation"))}}))}(e.children),{valueSrc:"value",valueType:"case_value",value:o}},Lr=function(e,t,r,n){var o,l,i,a,u,s,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,d={},p=hi(e,"!case_value");"op-plus"===(null==n?void 0:n.type)&&"case_value"===(null===(o=e.settings.caseValueField)||void 0===o?void 0:o.type)?(a="case_value",i=Cr(n,r,e,t)):(a=null==p?void 0:p.mainWidget,u=e.widgets[a],(i=yr(n,r,e,t,c))&&"value"===i.valueSrc&&(i.valueType=(null===(s=u)||void 0===s?void 0:s.type)||(null==p?void 0:p.type)||i.valueType));var f=e.widgets[a];if("case_value"===a){var v=null==f?void 0:f.spelImportValue;if(v){var g,h=v.call(e.ctx,i),y=(0,T.A)(h,2),m=y[0];y[1].map((function(e){return t.errors.push(e)})),null!=m&&(d={value:[m],valueSrc:["value"],valueType:[null!==(g=null==f?void 0:f.type)&&void 0!==g?g:"case_value"],field:"!case_value"})}}else null!=i&&null!=(null===(l=i)||void 0===l?void 0:l.value)&&(d={value:[i.value],valueSrc:[i.valueSrc],valueType:[i.valueType],field:"!case_value"});return d},kr=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:D(),children1:(0,_.A)({},e.id,e),properties:{conjunction:Mr(t),not:r||!1}}};function _r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pr=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.settings.defaultField,o=(r?Vr(e,r):n)||t&&bi(e,r)||null;return null==o||"string"==typeof o||$(o)||(o=He(o)),o},Vr=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r)return null;var n=(null==e||null===(t=e.settings)||void 0===t?void 0:t.fieldSeparator)||".",o=hi(e,r),l=null==o?void 0:o.defaultField;return l&&(l=[].concat((0,P.A)(ci(r)),[l]).join(n)),l},Ir=function(e){var t;return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=e.settings.fieldSources)||void 0===t?void 0:t[0])||"field"},xr=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=hi(e,t),o=(null==n?void 0:n.operators)||[],l=e.settings.defaultOperator;l&&!o.includes(l)&&(l=null);var i=null==n?void 0:n.defaultOperator,a=null==n?void 0:n.ownDefaultOperator,u=r?Co(e,t):null;return a||l||i||u},Dr=function(e,t,r){var n=t?yi(e,t,r):null;return n&&n.options?new I.Ay.Map(n.options&&n.options.defaults||{}):null},Nr=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=null,s=null,c=null,d=e.settings.showErrorMessage;l?(c=null==l||null===(t=l.properties)||void 0===t?void 0:t.fieldSrc,u=null==l||null===(r=l.properties)||void 0===r?void 0:r.field,s=null==l||null===(n=l.properties)||void 0===n?void 0:n.operator):i?(c=(u=Pr(e,a,o))?$(u)?"func":"field":Ir(e),s=xr(e,u,!0)):c=Ir(e);var p=new I.Ay.Map({fieldSrc:c,field:u,operator:s,value:new I.Ay.List,valueSrc:new I.Ay.List,operatorOptions:Dr(e,s,u)});if(d&&(p=p.set("valueError",new I.Ay.List)),u&&s){var f=vo(e,e,p,u,s,"operator",!1),v=f.newValue,g=f.newValueSrc,h=f.newValueType,y=f.newValueError,m=f.newFieldError;p=p.set("value",v).set("valueSrc",g).set("valueType",h),d&&(p=p.set("valueError",y).set("fieldError",m))}return p},Rr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(t=hi(e,t))&&t.conjunctions||Object.keys(e.conjunctions);return 1==r.length?r[0]:e.settings.defaultGroupConjunction||e.settings.defaultConjunction||r[0]},Mr=function(e){return e.settings.defaultConjunction||Object.keys(e.conjunctions)[0]},qr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new I.Ay.Map({conjunction:Rr(e,t),not:!1})},Wr=function(e,t){var r;return t&&"group"==t.type?qr(e,null==t||null===(r=t.properties)||void 0===r?void 0:r.field):Nr(e,null,t)},Br=function(e,t){return(0,_.A)({},e,new I.Ay.Map({type:"rule",id:e,properties:Nr(t)}))},Gr=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new I.Ay.Map({type:"group",id:D(),children1:new I.Ay.OrderedMap(t?Tr({},Br(D(),e)):{}),properties:qr(e)})},zr=function(e){return J(e)?e:Ur([e])},Ur=function(e){return J(e)?e:new I.Ay.List(e)},$r=function(){return new I.Ay.Map};function Jr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Hr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Hr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function Hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Kr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kr(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Qr,Xr=function(e,t){var r={errors:[],settings:{isForDisplay:arguments.length>2&&void 0!==arguments[2]&&arguments[2],isDebugMode:arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},n=zl(t,void 0,!1),o=Zr(e,n,r,null);return r.errors.length&&console.warn("Errors while exporting to string:",r.errors),o},Zr=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return e.get("children1"),"group"===o||"rule_group"===o?en(e,t,r,n):"rule"===o?tn(e,t,r,n):void 0}},en=function(e,t,r){var n,o,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=r.settings,a=i.isForDisplay,u=i.isDebugMode,s=e.get("type"),c=e.get("properties")||new I.T5,d=c.get("mode"),p=e.get("children1")||new I.B8,f="rule_group"===s,v=f&&"array"==d?c.get("field"):null,g="rule_group"===s?c.get("operator"):null,h=g?null!==(n=null===(o=t.operators[g])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1:void 0,y=f&&"array"===d&&h>=1,m=c.get("not"),b=p.map((function(e){return Zr(e,t,r,v)})).filter((function(e){return void 0!==e}));if(y||b.size||u){var O=c.get("conjunction");O||(O=Mr(t));var A,S=t.conjunctions[O],F=b.size?S.formatConj.call(t.ctx,b,O,m,a):null;if(v){var w=tn(e,t,r,l,!0);if(w){var j,E=w.pop(),C=[F].concat((0,P.A)(w));A=(j=t.settings.formatAggr).call.apply(j,[t.ctx].concat((0,P.A)(C))),E&&(A=t.settings.formatReverse.call(t.ctx,A,null,null,null,null,a))}}else A=F;return u&&null==A&&(A="?"),A}},tn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=r.settings,i=l.isForDisplay,a=l.isDebugMode,u=e.get("properties")||new I.T5,s=u.get("field"),c=u.get("fieldSrc"),d=u.get("operator"),p=u.get("operatorOptions");if(null!=s&&null!=d||a){var f=hi(t,s)||{},v=yi(t,d,s)||{},g=v.reversedOp,h=yi(t,g,s)||{},y=!1,m=v.formatOp;if(!m&&g&&(m=h.formatOp)){y=!0;var b=[g,d];d=b[0],g=b[1];var O=[h,v];v=O[0],h=O[1]}if(a&&!d&&(d="?"),m||(m=function(e,t,r){var n,o=r.settings.isDebugMode,l=(null==t?void 0:t.labelForFormat)||e,i=G(t);return 0==i?n=function(e,t,r,n,o,i,a,u){return"".concat(e," ").concat(l)}:1==i?n=function(e,t,r,n,i,a,u,s){return o&&"?"===t&&"?"===r?e&&"?"!==e?"".concat(e," ?"):"?":"".concat(e," ").concat(l," ").concat(r)}:2==i&&(n=function(e,t,r,n,o,i,a,u){var s,c,d=null==r||null===(s=r.first)||void 0===s?void 0:s.call(r),p=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(l," ").concat(d," AND ").concat(p)}),n}(d,v,r)),m){var A="func"===c?on(t,r,s,n):nn(t,r,s,n);if(null!=A){var S=function(e,t,r,n,o){var l,i,a=r.settings,u=(a.isForDisplay,a.isDebugMode),s=t.get("field"),c=t.get("valueSrc"),d=t.get("valueType"),p=hi(e,s)||{},f=n||t.get("operator"),v=yi(e,f,s)||{},g=G(v),h=t.get("value"),y=t.get("asyncListValues"),m=[],b=[];return null!=h&&!((i=h.map((function(t,n){var l=c?c.get(n):null,i=d?d.get(n):null,a=u?t:Ho(t,l,e),g=No(e,s,f,l),h=mi(e,s,f,g,l,{forExport:!0}),O=rn(e,r,a,l,i,h,p,f,v,o,y);return void 0!==O&&(m.push(l),b.push(i)),O}))).filter((function(e){return void 0===e})).size>0)&&i.size===g&&(l=1==g?i.first():i),u&&!l&&(l=g>1?new I.B8(Array.from({length:g}).map((function(e,t){var r,n;return null!==(r=null===(n=i)||void 0===n?void 0:n.get(t))&&void 0!==r?r:"?"}))):"?"),[l,m.length>1?m:m[0],b.length>1?b:b[0]]}(t,u,r,d,n),F=(0,T.A)(S,3),w=F[0],j=F[1],E=F[2];if(void 0!==w){var C=[A,d,w,j,E,B(v,M),p,i,f,y];if(o)return C;var L,k=(L=m).call.apply(L,[t.ctx].concat(C));return y&&(k=t.settings.formatReverse.call(t.ctx,k,d,g,v,h,i)),k}}}}},rn=function(e,t,r,n,o,l,i,a,u){var s,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0,p=t.settings,f=p.isForDisplay,v=p.isDebugMode;if(void 0===r)return v?"array"===(null==l?void 0:l.jsType)?[]:"?":void 0;if("field"==n)s=nn(e,t,r,c);else if("func"==n)s=on(e,t,r,c);else if("function"==typeof(null==l?void 0:l.formatValue)){var g=l.formatValue,h=[r,Yr(Yr({},pe()(i,["fieldSettings","listValues"])),{},{asyncListValues:d}),B(l,R),f];if(a&&(h.push(a),h.push(u)),"field"==n){var y=hi(e,r)||{};h.push(y)}s=g.call.apply(g,[e.ctx].concat(h))}else s=r;return s},nn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=t.settings,i=l.isForDisplay,a=l.isDebugMode,u=e.settings,s=(u.fieldSeparator,u.fieldSeparatorDisplay),c=null;if(r){var d=hi(e,r)||{},p=ci(r,e),f=_o(r,e,o?n:null),v=f?f.join(s):null,g=d.label2||v;c=(0,e.settings.formatField)(Ro(r,e,t,o?n:null,{useTableName:!0}),p,g,d,e,i)}else a&&(c="?");return c},on=function(e,t,r){var n,o,l,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.settings,u=a.isForDisplay,s=a.isDebugMode,c=null==r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func");if(!c)return s?"?()":void 0;var d=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),p=ii(e,c);if(p||s){var f,v=ci(c,e),g=v[v.length-1],h=u&&(null==p?void 0:p.label)||g,y={},m=[],b=[],O={},A=Jr(p?Object.keys(p.args||{}):(null==d||null===(l=d.keySeq)||void 0===l?void 0:l.call(d).toArray())||[]);try{for(A.s();!(f=A.n()).done;){var S,F=f.value,w=null==p?void 0:p.args[F],j=hi(e,w),E=w||{},C=E.defaultValue,L=E.isOptional,k=null!=C&&C.func?"func":"value",_=u&&(null==w?void 0:w.label)||F,P=d?d.get(F):void 0,V=P?P.get("value"):void 0,I=P?P.get("valueSrc"):void 0;"func"!==I&&null!==(S=V)&&void 0!==S&&S.toJS&&(V=V.toJS());var x=P?P.get("asyncListValues"):void 0,D=rn(e,t,V,I,null==w?void 0:w.type,j,w,null,null,i,x);null!=V&&void 0===D&&"func"!=I&&t.errors.push("Can't format value of arg ".concat(F," for func ").concat(c));var N=void 0;if(void 0===D&&!L&&null!=C&&void 0===(N=rn(e,t,C,k,null==w?void 0:w.type,j,w,null,null,i,x)))return void("func"!=k&&t.errors.push("Can't format default value of arg ".concat(F," for func ").concat(c)));var R=null!=D?D:N;if(void 0!==R){if(m.length){var M,q=Jr(F);try{for(q.s();!(M=q.n()).done;){var W=(0,T.A)(M.value,2),B=W[0];W[1],y[B]=void 0}}catch(e){q.e(e)}finally{q.f()}m=[]}y[F]=R,O[_]=R}else L||b.push(F),m.push([F,_])}}catch(e){A.e(e)}finally{A.f()}if(!b.length||s){var G=null;if("function"==typeof(null==p?void 0:p.formatFunc)){var z=p.formatFunc,U=[y,u];G=z.call.apply(z,[e.ctx].concat(U))}else{var $=Object.entries(u?O:y).map((function(e){var t=(0,T.A)(e,2),r=t[0],n=t[1];return u?"".concat(r,": ").concat(n):"".concat(n)})).join(", ");G="".concat(h,"(").concat($,")")}return G}}else t.errors.push("Func ".concat(c," is not defined in config"))},ln="EMPTY_GROUP",an="EMPTY_RULE_GROUP",un="EMPTY_QUERY",sn="EMPTY_CASE",cn="NO_CONFIG_FOR_FIELD",dn="NO_CONFIG_FOR_OPERATOR",pn="NO_CONFIG_FOR_FUNCTION",fn="INVALID_VALUE",vn="INVALID_FUNC_ARG_VALUE",gn="UNSUPPORTED_FIELD_TYPE",hn="UNSUPPORTED_OPERATOR_FOR_FIELD",yn="INVALID_VALUE_SRC",mn="INCOMPLETE_RULE",bn="INCOMPLETE_LHS",On="INCOMPLETE_RHS",An="BAD_MULTISELECT_VALUES",Sn="BAD_SELECT_VALUE",Fn="INCORRECT_VALUE_TYPE",wn="INCORRECT_VALUE_JS_TYPE",jn="VALUE_LENGTH_CONSTRAINT_FAIL",En="VALUE_MIN_CONSTRAINT_FAIL",Cn="VALUE_MAX_CONSTRAINT_FAIL",Ln="NO_CONFIG_FOR_FIELD_VALUE",kn="CANT_COMPARE_FIELD_WITH_ITSELF",_n="CANT_COMPARE_FIELD_WITH_FIELD",Tn="INCORRECT_FIELD_TYPE",Pn="UNSUPPORTED_FUNCTION_FOR_FIELD",Vn="REQUIRED_FUNCTION_ARG",In="INCORRECT_FUNCTION_RETURN_TYPE",xn="INVALID_RANGE",Dn="ITEM_POSITION",Nn="ITEM_POSITION_ROOT",Rn="ITEM_POSITION_WITH_INDEX_PATH",Mn="ITEM_POSITION_IN_CASE",qn="range",Wn=r(27893),Bn=(Qr={},(0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)(Qr,ln,"Empty group"),an,"No conditions for group field {{field}}"),un,"Empty query"),sn,"Empty case"),cn,"No config for field {{field}}"),"FIXED_OPERATOR","Fixed operator {{from}} to {{to}} for field {{field}}"),dn,"No config for operator {{operator}}"),pn,"No config for function {{funcKey}}"),fn,"Invalid value"),vn,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)(Qr,gn,"Type of field {{field}} is not supported"),hn,"Operator {{operator}} is not supported for field {{field}}"),mn,"Incomplete rule"),bn,"Incomplete LHS"),On,"Incomplete RHS"),yn,"Invalid value src {{valueSrcs, list}}"),An+"_one","Value {{badValues, list}} is not in the list of allowed values"),An+"_other","Values {{badValues, list}} are not in the list of allowed values"),Sn,"Value {{value}} is not in the list of allowed values"),Fn,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)(Qr,wn,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),jn,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),En,"Value {{value}} should be greater than or equal to {{fieldSettings.min}}"),En+"_"+qn,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Cn,"Value {{value}} should be less than or equal to {{fieldSettings.max}}"),Cn+"_"+qn,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Ln,"No config for field {{field}}"),kn,"Can't compare field {{field}} with itself"),_n,"Can't compare field {{leftField}} with {{rightField}}"),Tn,"Field {{field}} is of type {{type}}, but expected {{expected}}"),(0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)(Qr,Pn,"Unsupported function {{funcKey}} for field {{field}}"),Vn,"Value of arg {{argName}} for func {{funcName}} is required"),In,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),xn,"Invalid range"),Nn,"Root"),Dn+"__rule","Leaf #{{globalLeafNo}}"),Dn+"__group","Group #{{globalGroupNo}}"),Dn+"__rule_group","Rule-group #{{globalNoByType}}"),Dn+"__case_group","Case #{{globalNoByType}}"),Dn+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),(0,_.A)((0,_.A)((0,_.A)((0,_.A)((0,_.A)(Qr,Dn+"__group__deleted","Deleted group #{{globalGroupNo}}"),Dn+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),Dn+"__case_group__deleted","Deleted case #{{globalNoByType}}"),Mn,"{{str}} in case #{{caseNo}}"),Rn,"{{str}} (index path: {{indexPath, list}})")),Gn="raqbvalidation",zn="".concat(Gn,":"),Un=Wn.Ay.createInstance();Un.init({fallbackLng:"en"}),Un.addResources("en",Gn,Bn);var $n=function e(t,r){return null!=t&&t.str?t.str:null!=t&&t.key?e(t.key,t.args):null===r?t:Un.t(t.includes(":")?t:zn+t,r)};const Jn=Un;function Hn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Kn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hn(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Yn=function(e){return"object"===(0,V.A)(e)&&null!==e&&Array.isArray(e)?"array":(0,V.A)(e)},Qn=function(e,t){return 0===Xn(e,t).length},Xn=function(e,t){var r=t.settings.showErrorMessage,n=[];return e&&function e(t,o,l){var i,a,u=t.get("id"),s=t.get("children1"),c=t.getIn(["properties","valueError"]),d=t.getIn(["properties","fieldError"]),p=t.getIn(["properties","field"]),f=null!==(i=null==p||null===(a=p.get)||void 0===a?void 0:a.call(p,"func"))&&void 0!==i?i:p;((null==c?void 0:c.size)>0&&c.filter((function(e){return null!=e})).size>0||!!d)&&r&&n.push(f),s&&s.map((function(t,r){t&&e(t,o.concat(u),l+1)}))}(e,[],0),Array.from(new Set(n))},Zn=function(e,t){var r=zl(t,void 0,!0),n={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=no(e,null,r,r,n),l=o.fixedTree,i=o.allErrors;return o.isSanitized&&i.length&&console.warn("Tree check errors: ",i),l},eo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=zl(t,void 0,!0),o=Kn(Kn({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1});return no(e,null,n,n,o).allErrors},to=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=zl(t,void 0,!0),o=Kn({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),l=no(e,null,n,n,o);return{fixedTree:l.fixedTree,fixedErrors:l.fixedErrors,nonFixedErrors:l.nonFixedErrors,allErrors:l.allErrors}},ro=function(e,t,r,n,o,l,i){void 0===o&&(o=r.settings.removeEmptyGroupsOnLoad),void 0===l&&(l=r.settings.removeEmptyRulesOnLoad),void 0===i&&(i=r.settings.removeIncompleteRulesOnLoad);var a=no(e,t,r,n,{removeEmptyGroups:o,removeEmptyRules:l,removeIncompleteRules:i,forceFix:!1}),u=a.fixedTree,s=(a.allErrors,a.fixedErrors);return a.nonFixedErrors,a.isSanitized&&s.length&&console.warn("Fixed tree errors: ",s),Ie(u)},no=function(e,t,r,n,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var l,i,a=o||{},u=a.removeEmptyGroups,s=a.removeEmptyRules,c=a.removeIncompleteRules,d=a.forceFix,p=a.translateErrors,f=void 0===p||p,v=a.includeStringifiedItems,g=void 0===v||v,h=a.stringifyFixedItems,y=void 0!==h&&h,m=a.stringifyItemsUserFriendly,b=void 0===m||m,O=a.includeItemsPositions,A=void 0===O||O,S={errors:{}},F=io(e,[],null,S,{config:r,oldConfig:n,removeEmptyGroups:u,removeEmptyRules:s,removeIncompleteRules:c,forceFix:d}),w=S.sanitized,j=[];for(var E in A&&(l=De(F).items),S.errors){var C=S.errors[E],L=C.path,k=C.errors;f&&(k=k.map((function(e){return Kn(Kn({},e),{},{str:$n(e)})})));var _={path:L,errors:k};if(g){var T=Pe(y?F:e,L);if(1!==L.length&&"group"!==T.get("type")){var P=Xr(T,r,b,!0);_.itemStr=P}}if(A){var V=l[E],I=!V;if(I&&(i||(i=De(e).items),V=i[E]),V){var x=Kn(Kn({},V.position),{},{index:V.index,type:V.type,isDeleted:I});_.itemPosition=x;var D=V.index?Dn+"__"+V.type+(I?"__deleted":""):Nn,N=Kn({},x);if(b){for(var R,M=0,q=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];M<q.length;M++){var W=q[M];null!=N[W]&&(N[W]=N[W]+1)}N.indexPath=null===(R=x.indexPath)||void 0===R?void 0:R.map((function(e){return e+1}))}_.itemPositionStr=$n(D,N),V.index&&(V.caseId&&"case_group"!==V.type&&(_.itemPositionStr=$n(Mn,Kn(Kn({},N),{},{str:_.itemPositionStr}))),"case_group"!==V.type&&(_.itemPositionStr=$n(Rn,Kn(Kn({},N),{},{str:_.itemPositionStr}))))}}j.push(_)}for(var B=[],G=[],z=0,U=j;z<U.length;z++){var $=U[z],J=$.errors.filter((function(e){return!!e.fixed})),H=$.errors.filter((function(e){return!e.fixed&&"EMPTY_QUERY"!==e.key}));J.length&&B.push(Kn(Kn({},$),{},{errors:J})),H.length&&G.push(Kn(Kn({},$),{},{errors:H}))}return{fixedTree:F,allErrors:j,fixedErrors:B,nonFixedErrors:G,isSanitized:w}};function oo(e,t,r,n){var o=t.get("id");e.errors[o]||(e.errors[o]={path:[].concat((0,P.A)(r),[o]),errors:[]}),e.errors[o].errors.push(n)}function lo(e,t){var r=t.get("id");e.errors[r]&&e.errors[r].errors.map((function(e){e.fixed=!0}))}function io(e,t,r,n,o){var l=null==e?void 0:e.get("type");return"group"===l||"rule_group"===l||"case_group"==l||"switch_group"==l?function(e,t,r,n,o){var l,i,a,u,s,c,d=o.removeEmptyGroups,p=o.removeIncompleteRules,f=(o.forceFix,o.config),v=(f.settings.showErrorMessage,e.get("id")),g=e.get("children1"),h=!t.length,y=g,m=e.get("type"),b=e.get("properties"),O=null==b?void 0:b.get("field"),A=null==b?void 0:b.get("mode"),S=null==b||null===(l=b.get)||void 0===l?void 0:l.call(b,"operator"),F="rule_group"===m&&"array"===A,w="case_group"===m,j=w&&null==g,E=S?null!==(i=null===(a=f.operators[S])||void 0===a?void 0:a.cardinality)&&void 0!==i?i:1:void 0,C=w?!j:F?0==E:d,L=F||w;!v&&r&&(v=r,e=e.set("id",v),n.sanitized=!0),L&&(e=ao(e,t,r,n,o));var k={errors:{}},_=null===(s=g=null===(u=g)||void 0===u?void 0:u.map((function(e,r){return io(e,t.concat(v),r,k,o)})))||void 0===s?void 0:s.filter((function(e){return null!=e}));d&&(g=_);var T=k.sanitized||(null==y?void 0:y.size)!=(null===(c=g)||void 0===c?void 0:c.size),P=d&&!h;return F&&O&&(P=p),!(null!=_&&_.size)&&C&&(oo(n,e,t,{key:h?un:w?sn:F?an:ln,args:{field:O},fixed:P}),P&&(lo(n,e),e=void 0)),T&&(n.sanitized=!0),T&&e&&(e=e.set("children1",g)),n.errors=Kn(Kn({},n.errors),(null==k?void 0:k.errors)||{}),e}(e,t,r,n,o):"rule"===l?ao(e,t,r,n,o):e}function ao(e,t,r,n,o){var l=o.removeIncompleteRules,i=o.removeEmptyRules,a=o.forceFix,u=o.config,s=o.oldConfig,c=u.settings.showErrorMessage,d=!c||a,p=e.get("id"),f="case_group"===e.get("type"),v=e.get("properties");if(!v){if(!f)return void oo(n,e,t,{key:mn,args:{},fixed:l||i});v=new I.Ay.Map}var g=v.get("field")||null;f&&(g="!case_value");var h=v.get("fieldSrc")||null,y=v.get("operator")||null,m=v.get("operatorOptions"),b=v.get("valueSrc"),O=v.get("value"),A=v.get("valueError"),S=v.get("fieldError"),F=function(){var e,t;return{field:(null===(e=g)||void 0===e||null===(t=e.toJS)||void 0===t?void 0:t.call(e))||g,fieldSrc:h,operator:y,operatorOptions:m?m.toJS():{},valueSrc:b?b.toJS():null,value:O?O.toJS():null,valueError:A?A.toJS():null,fieldError:S||null}},w=F();!p&&r&&(p=r,e=e.set("id",p),n.sanitized=!0);var j=g?hi(u,g):null;g&&!j&&(oo(n,e,t,{key:cn,args:{field:g},side:"lhs",fixed:l||i}),g=null),null!=g||f||(v=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce((function(e,t){return e.delete(t)}),v),y=null),h||!g||f||(h=gi(g),v=v.set("fieldSrc",h)),"range_between"!==y&&"range_not_between"!==y||(y="range_between"===y?"between":"not_between",v=v.set("operator",y));var E=y?yi(u,y,g):null;y&&!E&&(oo(n,e,t,{key:dn,args:{operator:y},side:"op",fixed:l||i}),y=null);var C=g?Eo(u,g):[];g&&!f&&(null!=C&&C.length?y&&-1==C.indexOf(y)&&("is_empty"===y||"is_not_empty"===y?(y="is_empty"===y?"is_null":"is_not_null",v=v.set("operator",y)):(oo(n,e,t,{key:hn,args:{operator:y,field:g},side:"lhs",fixed:l||i}),y=null)):(oo(n,e,t,{key:gn,args:{field:g},side:"lhs",fixed:l||i}),y=null)),null!=y||f||(v=["operatorOptions","valueSrc","value","valueError"].reduce((function(e,t){return e.delete(t)}),v)),m=v.get("operatorOptions"),!y||m&&!E.options?(m=null,v=v.delete("operatorOptions")):y&&!m&&E.options&&(m=Dr(u,y,g),v=v.set("operatorOptions",m)),b=v.get("valueSrc"),O=v.get("value");var L=vo(u,s,v,g,y,null,d,!0),k=L.newValue,_=L.newValueSrc,T=L.newValueError,P=L.validationErrors,V=L.newFieldError,x=L.fixedField;O=k,b=_,A=T,S=V,g=x,v=(v=(v=v.set("field",g)).set("value",O)).set("valueSrc",b),v=c?v.set("valueError",A).set("fieldError",S):v.delete("valueError").delete("fieldError");var D=F(),N=!z(w,D),R=$o(v.toObject(),u),M=f?R.parts.value:R.score>=3;if(N&&(n.sanitized=!0,e=e.set("properties",v)),null==P||P.map((function(r){return oo(n,e,t,r)})),!M)if(f);else{var q=R.score?l:i,W={key:mn,args:{}};if(R.parts.field){if(!R.parts.value){var B,G,U,$;W.key=On,W.side="rhs",null!==(B=D.valueSrc)&&void 0!==B&&B[0]&&(null===(G=D.valueSrc)||void 0===G?void 0:G[0])!=(null===(U=w.valueSrc)||void 0===U?void 0:U[0])&&null!=(null===($=D.value)||void 0===$?void 0:$[0])&&(W.key=yn,W.args={valueSrcs:D.valueSrc})}}else W.key=bn,W.side="lhs";W.fixed=q,oo(n,e,t,W),q&&(lo(n,e),e=void 0)}return e}var uo=function(e,t,r,n,o,l,i,a){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],s=arguments.length>9&&void 0!==arguments[9]&&arguments[9],c=arguments.length>10&&void 0!==arguments[10]&&arguments[10],d=[],p=o;if(null!=o){var f,v,g,h;if("field"===i){var y=co(t,r,o,i,l,a,e,n,u,s),m=(0,T.A)(y,2);p=m[0],d=m[1]}else if("func"===i){var b=po(t,r,o,i,l,a,e,n,u,s,c),O=(0,T.A)(b,2);p=O[0],d=O[1]}else if("value"===i||!i){var A=so(r,o,i,l,a,e,n,u,s),S=(0,T.A)(A,2);p=S[0],d=S[1]}var F=!(null!==(f=d)&&void 0!==f&&f.find((function(e){return!e.fixed})));if(r&&!["field","func"].includes(i)&&(null===(v=d)||void 0===v||!v.length||F)){var w=No(e,r,n,i),j=n?yi(e,n,r):null,E=mi(e,r,n,w,i,{forExport:!0}),C="field"===i?hi(e,o):null,L=E,k=E.validateValue;if("function"==typeof k){var _=[p,L,n,j];"field"===i&&_.push(C);var P,I,x=k.call.apply(k,[e.ctx].concat(_));"object"!==(0,V.A)(x)||null===x||Array.isArray(x)?"boolean"==typeof x?0==x&&d.push({key:fn,args:{}}):"string"==typeof x&&d.push({key:x,args:null}):(I=null!==(P=x.error)&&void 0!==P&&P.key?Kn({},x.error):{key:x.error,args:null},void 0!==x.fixedValue&&u&&(I.fixed=!0,I.fixedFrom=p,I.fixedTo=x.fixedValue,p=x.fixedValue),d.push(I))}}if(F=!(null!==(g=d)&&void 0!==g&&g.find((function(e){return!e.fixed}))),null!==(h=d)&&void 0!==h&&h.length&&!F&&u){var D=hi(e,r),N=null==D?void 0:D.fieldSettings,R=null==N?void 0:N.defaultValue;if(void 0!==R){var M=d[d.length-1];M.fixed=!0,M.fixedFrom=p,M.fixedTo=R,p=R,d.map((function(e){e.fixed=!0}))}}}return[p,d]},so=function(e,t,r,n,o,l){var i,a,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=[],d=t;if(e){var p=hi(l,e),f=No(l,e,u,r),v=l.widgets[f],g=null==v?void 0:v.type,h=null==v?void 0:v.jsType,y=null==p?void 0:p.fieldSettings,m=(null==y?void 0:y.treeValues)||(null==y?void 0:y.listValues),b=!(null==y||!y.asyncFetch),O=m||b;if(n&&g&&n!=g)return c.push({key:Fn,args:{wType:g,valueType:n}}),[t,c];if(h&&(a=h,Yn(i=t)!==a&&("number"!==a||isNaN(i)))&&!O)return c.push({key:wn,args:{jsType:h,valueTypeof:Yn(t)}}),[t,c];if(y){var A=o||m;if(A&&!y.allowCustomValues&&"case_value"!==f){var S=function(e,t,r,n,o){var l=I.Ay.List.isList(e)?e.toJS():e instanceof Array?(0,P.A)(e):void 0,i=e,a=[];if(l){var u=l.reduce((function(e,r){var n=(0,T.A)(e,2),o=n[0],l=n[1],i=we(t,r);return null==i?[o,[].concat((0,P.A)(l),[r])]:[[].concat((0,P.A)(o),[i.value]),l]}),[[],[]]),s=(0,T.A)(u,2),c=s[0],d=s[1],p=d.length>0;if(i=(r=r||!0===o)&&p?c:e,d.length){var f=r&&p;a.push({key:An,args:{badValues:d,count:d.length},fixed:f,fixedFrom:f?l:void 0,fixedTo:f?i:void 0})}return[i,a]}var v=we(t,e);return null==v?(i=r?null:e,a.push({key:Sn,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?i:void 0})):i=v.value,[i,a]}(t,A,s,0,l.settings.removeInvalidMultiSelectValuesOnLoad),F=(0,T.A)(S,2);d=F[0],c=F[1]}y.maxLength>0&&null!=t&&String(t).length>y.maxLength&&(d=s?String(t).substring(0,y.maxLength):t,c.push({key:jn,args:{value:t,length:String(t).length,fieldSettings:y},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?d:void 0}));var w=null!=y.min&&null!=y.max?qn:void 0;null!=y.min&&t<y.min&&(d=s?y.min:t,c.push({key:En,args:{value:t,fieldSettings:y,context:w},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?d:void 0})),null!=y.max&&t>y.max&&(d=s?y.max:t,c.push({key:Cn,args:{value:t,fieldSettings:y,context:w},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?d:void 0}))}}return[d,c]},co=function(e,t,r,n,o,l,i){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=[],s=i.settings,c=s.fieldSeparator,d=s.canCompareFieldWithField,p="object"==(0,V.A)(t)&&(null==t?void 0:t._isFuncArg),f=Array.isArray(e)?e.join(c):e,v=hi(i,e),g=Array.isArray(r)?r.join(c):r,h=hi(i,r);return h?e&&g===f&&!p?(u.push({key:kn,args:{field:f}}),[r,u]):o&&o!=h.type?(u.push({key:Tn,args:{field:g,type:h.type,expected:o}}),[r,u]):e&&!p&&d&&!d(f,v,g,h,a)?(u.push({key:_n,args:{leftField:f,rightField:g}}),[r,u]):[r]:(u.push({key:Ln,args:{field:g}}),[r,u])},po=function(e,t,r,n,o,l,i){var a,u,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9&&void 0!==arguments[9]&&arguments[9],p=arguments.length>10&&void 0!==arguments[10]&&arguments[10],f=r,v=[];if(!r)return[r];var g=null===(a=r.get)||void 0===a?void 0:a.call(r,"func");if(!g)return[r];var h=hi(i,t);if(null!=h&&h.funcs&&!h.funcs.includes(g))return v.push({key:Pn,args:{funcKey:g,field:t}}),[r,v];var y=ii(i,g);if(!y)return v.push({key:pn,args:{funcKey:g}}),[r,v];var m=null!==(u=y.label)&&void 0!==u?u:g;if(o&&y.returnType!=o)return v.push({key:In,args:{funcKey:g,funcName:m,returnType:y.returnType,valueType:o}}),[r,v];for(var b in c=c||p,y.args){var O,A=y.args[b],S=f.get("args"),F=S?S.get(b):void 0,w=hi(i,A),j=null!==(O=null==w?void 0:w.label)&&void 0!==O?O:b,E=F?F.get("value"):void 0,C=F?F.get("valueSrc"):void 0;if(void 0!==E){var L=uo(i,e,w,s,E,A.type,C,l,c,d,p),k=(0,T.A)(L,2),_=k[0],P=k[1],V=!(null!=P&&P.length),I=c&&_!==E,x=c&&!V&&!I&&(d||p);if(I&&(f=f.setIn(["args",b,"value"],_)),x&&(f=f.deleteIn(["args",b]),f=bo(i,f,y,b)),!V){var D,N,R=null!==(D=null!==(N=P.find((function(e){return!e.fixed&&!e.ignore})))&&void 0!==N?N:P.find((function(e){return!e.fixed})))&&void 0!==D?D:P[0],M=I||x,q=0===P.filter((function(e){return!e.ignore})).length;if(R){var W=$n(R);v.push({key:vn,args:{funcKey:g,funcName:m,argKey:b,argName:j,argValidationError:W,argErrors:P},ignore:q,fixed:M,fixedFrom:M?E:void 0,fixedTo:M?I?_:A.defaultValue:void 0})}}}else if(!A.isOptional&&(d||p)){var B=c&&void 0!==A.defaultValue&&(d||p);d&&v.push({key:Vn,args:{funcKey:g,funcName:m,argKey:b,argName:j},fixed:B,fixedTo:B?A.defaultValue:void 0,ignore:!B}),B&&(f=f.deleteIn(["args",b]),f=bo(i,f,y,b))}}return[f,v]},fo=function(e,t,r,n,o){var l,i=yi(e,r,t),a=r?G(i):null,u=o.toJS?o.toJS():o,s=n.toJS?n.toJS():n,c=u.filter((function(e){return"value"==e||null==e})).length==a;if(null!=i&&i.validateValues&&c){var d=u[0],p=No(e,t,r,d),f=mi(e,t,r,p,d),v=null!=f&&f.toJS?s.map((function(t){var r=f.toJS.call(e.ctx,t,f);return r instanceof Date&&(r=r.getTime()),r})):s,g=i.validateValues(v);"boolean"==typeof g&&0==g&&(l={key:xn,args:{jsValues:v,values:s}})}return l},vo=function(e){var t,r,n,o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],d=arguments.length>7&&void 0!==arguments[7]&&arguments[7],p=arguments.length>8&&void 0!==arguments[8]&&arguments[8];l||(l=e);var f=e.settings,v=f.keepInputOnChangeFieldSrc,g=f.convertableWidgets,h=f.clearValueOnChangeField,y=f.clearValueOnChangeOp,m="!case_value"==a,b=i.get("field");!b&&m&&(b=a);var O,A=i.get("fieldType"),S=i.get("fieldSrc"),F=i.get("operator"),w=i.get("value"),j=i.get("valueSrc",new I.Ay.List),E=i.get("valueType",new I.Ay.List),C=i.get("valueError",new I.Ay.List),L=i.get("asyncListValues"),k=m,_=yi(l,F),P=yi(e,u,a),V=m?1:F?G(_):null,x=m?1:u?G(P):null,D=hi(l,b),N=hi(e,a),R=!b&&A&&v,M=(null==D?void 0:D.type)||A,q=(null==N?void 0:N.type)||!a&&R&&M,W=null==D?void 0:D.listValuesType,B=null==N?void 0:N.listValuesType,z=(null===(t=b)||void 0===t||null===(r=t.get)||void 0===r?void 0:r.call(t,"func"))||b,U=((null===(n=a)||void 0===n||null===(o=n.get)||void 0===o?void 0:o.call(n,"func"))||a)!=z,$=[],J=(b||R)&&(F&&u||k)&&null!=w;if((!M||!q||M!=q||"field"===s&&U&&h||"operator"===s&&y)&&(J=!1),U&&wo.includes(q)&&(B&&B===W||(J=!1)),k||(null!=w&&w.size||!x)&&(null==w||!w.size||x)||(J=!1),"func"===S&&a){var H=uo(e,null,null,u,a,q,S,L,c,d,p),K=(0,T.A)(H,2),Y=K[0],Q=K[1],X=!(null!=Q&&Q.length),Z=Y!==a,ee=!X&&Z&&!Q.find((function(e){return!e.fixed})),te=c&&!X&&!ee&&!!s&&a!==b;if(te?a=b:Z&&(a=Y),!X){var re=!X&&!ee&&!te,ne=Q.find((function(e){return!e.fixed&&!e.ignore}));re&&ne&&(O=$n(ne)),Q.map((function(e){return $.push(Kn(Kn({side:"lhs"},e),{},{fixed:e.fixed||te||false}))}))}}for(var oe=0;oe<x;oe++){var le=j.get(oe)||null,ie=No(l,b,F,le),ue=No(e,a,u,le),se="value"===le?ie:No(l,b,F,"value"),ce="value"===le?ue:No(e,a,u,"value");ce==se||(g[se]||[]).includes(ce)||!se&&R||(J=!1)}F!=u&&[F,u].includes("proximity")&&(J=!1);var de=j.first(),pe=mi(e,a,u,null,de),fe=Do(e,a,u,null);!a&&R&&(fe=Object.keys(e.settings.valueSourcesInfo));var ve,ge=fe[0];1===x&&pe&&void 0!==pe.type?ve=pe.type:1===x&&N&&void 0!==N.type&&(ve="!group"===N.type?"number":N.type);var he=J&&"operator"===s&&1===V&&2===x,ye=[],me=[],be=[],Oe=Array.from({length:x},(function(){return null}));if(J)for(var Ae=function(t){var r=w.get(t),n=E.get(t)||null,o=j.get(t)||null;he&&1===t&&(r=void 0!==ye[0]?ye[0]:w.get(0),ye[t]=r,n=E.get(0)||null,o=j.get(0)||null);var l=!o||void 0!==fe.find((function(e){return e==o})),i=uo(e,a,a,u,r,n,o,L,c,d,p),s=(0,T.A)(i,2),f=s[0],v=s[1],g=!(null!=v&&v.length),h=f!==r,y=!g&&h&&!(null!=v&&v.find((function(e){return!e.fixed}))),m=!(null!=v&&v.find((function(e){return!e.fixed&&!e.ignore}))),b=!l||c&&!g&&!y&&(!m||U);g||null==v||v.map((function(e){return $.push(Kn(Kn({side:"rhs",delta:t},e),{},{fixed:e.fixed||b}))})),b&&(ye[t]=null,0===t&&delete ye[1]);var O=!g&&!h,A=null==v?void 0:v.find((function(e){return!e.fixed&&!e.ignore}));O&&A&&(Oe[t]=$n(A)),h&&(ye[t]=f),!he||0!==t||g||h||(he=!1),he&&0===t&&["func","field"].includes(o)&&(he=!1)},Se=0;Se<x;Se++)Ae(Se);if(!J)for(var Fe=0;Fe<x;Fe++)if(1===x){var we,je=ae([null==N?void 0:N.defaultValue,null==N||null===(we=N.fieldSettings)||void 0===we?void 0:we.defaultValue,null==pe?void 0:pe.defaultValue]);ye[Fe]=je,null!=je&&je.func&&(me[Fe]="func")}for(var Ee=0;Ee<x;Ee++){var Ce,Le,ke=J&&j.get(Ee)||null,_e=J&&E.get(Ee)||null;J&&he&&1===Ee&&(ke=null!==(Ce=me[Ee])&&void 0!==Ce?Ce:j.get(0),_e=null!==(Le=be[Ee])&&void 0!==Le?Le:E.get(0),me[Ee]=ke,be[Ee]=_e),fe.includes(ke)||(me[Ee]=ge),_e||(be[Ee]=ve)}var Te=w;(ye.length>0||!J)&&(Te=new I.Ay.List(Array.from({length:x},(function(e,t){return void 0!==ye[t]?ye[t]:J?w.get(t):void 0}))));var Pe=j;(me.length>0||!J)&&(Pe=new I.Ay.List(Array.from({length:x},(function(e,t){var r;return null!==(r=me[t])&&void 0!==r?r:J&&j.get(t)||null}))));var Ve=E;(be.length>0||!J)&&(Ve=new I.Ay.List(Array.from({length:x},(function(e,t){var r;return null!==(r=be[t])&&void 0!==r?r:J&&E.get(t)||null}))));var Ie=fo(e,a,u,Te,Pe);if(Ie){var xe=$n(Ie),De=c&&x>=2,Ne=Te;De&&(ye[1]=Te.get(0),Te=Te.set(1,ye[1]),Oe[1]=Oe[0]),!De&&Oe.push(xe),$.push(Kn(Kn({side:"rhs",delta:-1},Ie),{},{fixed:De,fixedFrom:De?[Ne.get(0),Ne.get(1)]:void 0,fixedTo:De?[Te.get(0),Te.get(1)]:void 0}))}var Re=C,Me=(null==C?void 0:C.size)!==Oe.length||Oe.filter((function(e,t){return e!=C.get(t)})).length>0;return Me&&(Re=new I.Ay.List(Oe)),{canReuseValue:J,newValue:Te,newValueSrc:Pe,newValueType:Ve,operatorCardinality:x,fixedField:a,newValueError:Re,newFieldError:O,validationErrors:$}},go=function(e){return"object"==(0,V.A)(e)&&null!==e&&!Array.isArray(e)},ho=function(e,t){if(e){var r=e.get("func"),n=r&&ii(t,r);if(n){var o=e,l=!1;for(var i in n.args){var a=n.args[i],u=a.valueSources,s=a.isOptional,c=a.defaultValue,d=xo(t,u,a),p=o.get("args"),f=1==d.length?d[0]:void 0,v=p?p.get(i):void 0,g=v?v.get("value"):void 0,h=(v?v.get("valueSrc"):void 0)||f;if(void 0!==g){var y=Ho(g,h,t);if(void 0===y)return;if(y!==g&&(o=o.setIn(["args",i,"value"],y)),l)return}else if(void 0===c||go(c)){if(!s)return;l=!0}else o=(o=o.setIn(["args",i,"value"],Oo(a))).setIn(["args",i,"valueSrc"],"value")}return o}}},yo=function(e,t,r,n){var o=r.settings.fieldSeparator;e=e||new I.Ay.Map,Array.isArray(t)&&(t=t.join(o));var l=e.get("func"),i=e.get("args");e=e.set("func",t);var a=t&&ii(r,t),u=t&&li(r,t),s=l&&li(r,l),c=Fo(s,u,i,r,n);return e=c.length?Object.keys(u.args).filter((function(e){return!c.includes(e)})).reduce((function(e,t){return e.deleteIn(["args",t])}),e):e.set("args",new I.Ay.Map),mo(r,e,a)},mo=function(e,t,r){if(r)for(var n in r.args)t=bo(e,t,r,n);return t},bo=function(e,t,r,n){var o=r.args[n],l=o.valueSources,i=o.defaultValue,a=xo(e,l,o),u=a.length?a[0]:void 0,s=(i?go(i)&&i.func?"func":"value":void 0)||u;return t.getIn(["args",n])||(void 0!==i&&(t=t.setIn(["args",n,"value"],Oo(o))),s&&(t=t.setIn(["args",n,"valueSrc"],s))),t},Oo=function(e){var t=e.defaultValue;return go(t)&&!I.Ay.Map.isMap(t)&&t.func?I.Ay.fromJS(t,(function(e,t){return I.Ay.Iterable.isIndexed(t)?t.toList():t.toOrderedMap()})):t},Ao=function(e,t,r,n,o){if(e&&e.get("func")){var l=(e=e.setIn(["args",t,"value"],r)).getIn(["args",t,"valueSrc"]),i=n.valueSources,a=xo(o,i,n),u=1==a.length?a[0]:void 0;!u&&a.includes("value")&&(u="value"),!l&&u&&(e=e.setIn(["args",t,"valueSrc"],u))}return e},So=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new I.Ay.Map({valueSrc:r}))),e},Fo=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(null==e?void 0:e.returnType)!=(null==t?void 0:t.returnType)?[]:Object.keys(t.args).filter((function(l,i){var a=t.args[l],u=e.args[l];if(Object.keys(e.args).indexOf(l),!u&&(void 0!==a.defaultValue||a.isOptional))return!0;if((null==u?void 0:u.type)!=a.type)return!1;if(wo.includes(a.type)&&(!u.listValuesType||u.listValuesType!==a.listValuesType))return!1;if(r){var s,c=r.get(l),d=null==c?void 0:c.get("value"),p=null==c?void 0:c.get("valueSrc");if(p&&a.valueSources&&!a.valueSources.includes(p))return!1;var f=uo(n,null,a,null,d,a.type,p,null,o,!0),v=(0,T.A)(f,2),g=(v[0],v[1]);if(null!=g&&null!==(s=g.filter((function(e){return!e.fixed})))&&void 0!==s&&s.length)return!1}return!0}))},wo=["select","multiselect","treeselect","treemultiselect"],jo=function(e,t){var r;return(null===(r=e.types[t])||void 0===r?void 0:r.operators)||null},Eo=function(e,t){var r=hi(e,t);return r?r.operators:[]},Co=function(e,t){var r,n=Eo(e,t);return null!==(r=null==n?void 0:n[0])&&void 0!==r?r:null},Lo=function(e,t,r){var n=null;if(e)if("field"===t){var o=hi(r,e);o&&(n=o.type)}else if("func"===t){var l=e.get("func");if(l){var i=ii(r,l);i&&(n=i.returnType||i.type)}}return n},ko=function(e,t){return _o(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,"funcs","subfields")},_o=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fields",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"subfields";if(!e)return null;var l=t.settings.fieldSeparator,i=ci(e,t),a=ci(r,t);return i.slice(a.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return[].concat((0,P.A)(a),(0,P.A)(e)).join(l)})).map((function(e){var r=ni(t,e,n,o);return r&&r.label||ve()(e.split(l))})).filter((function(e){return null!=e}))},To=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;var n=r&&ni(t,r)||null,o=t.settings.fieldSeparator,l=ci(e,t),i=ui(e,r,t)?ci(r,t):[];return l.slice(i.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return{part:[].concat((0,P.A)(i),(0,P.A)(e)).join(o),key:e[e.length-1]}})).map((function(e){var r=e.part;return{key:e.key,cnf:ni(t,r)}})).map((function(e,t,r){return[e.key,e.cnf,t>0?r[t-1].cnf:n]}))},Po=function(e,t,r,n){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=mi(e,t,r,null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:null)||{},i=yi(e,r,t)||{},a=null;if((o?1:i.cardinality)>1){var u=l.valueLabels||i.valueLabels;u&&(a=u[n]),a&&"object"!==(0,V.A)(a)&&(a={label:a,placeholder:a}),a||(a={label:e.settings.valueLabel+" "+(n+1),placeholder:e.settings.valuePlaceholder+" "+(n+1)})}else{var s=l.valueLabel,c=l.valuePlaceholder;a={label:s||e.settings.valueLabel,placeholder:c||e.settings.valuePlaceholder}}return a};function Vo(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],l=[];if(!t)return{widgets:o,valueSrcs:l};var i=pi(t),a=i?"".concat(i,"__").concat(r,"__").concat(n):null,u=fi(e,"_getWidgetsAndSrcsForFieldOp",a);if(u)return u;var s="object"===(0,V.A)(t)&&(!!t.func&&!!t.arg||t._isFuncArg),c=hi(e,t),d=r?e.operators[r]:null;if(null!=c&&c.widgets){var p=function(){var i=c.widgets[f];if(!e.widgets[f])return 1;var a=e.widgets[f].valueSrc||"value",u=!0;if("field"===f&&(u=u&&xo(e,["field"],c).length>0),"func"===f&&(u=u&&xo(e,["func"],c).length>0),"value"!==n||i.operators||s||"!case_value"===t||(u=!1),i.operators&&r&&(u=u&&-1!=i.operators.indexOf(r)),n&&n!=a&&"const"!==n&&(u=!1),d&&0==d.cardinality&&"value"!==a&&(u=!1),u){var p,v;o.push(f);var g=-1!=(null===(p=c.valueSources)||void 0===p?void 0:p.indexOf(a));-1==(null==d||null===(v=d.valueSources)||void 0===v?void 0:v.indexOf(a))&&(g=!1),g&&!l.find((function(e){return e==a}))&&l.push(a)}};for(var f in c.widgets)p()}var v=function(e){var t=0;return c.preferWidgets?c.preferWidgets.includes(e)&&(t+=10-c.preferWidgets.indexOf(e)):e==c.mainWidget&&(t+=100),"field"===e&&(t-=1),"func"===e&&(t-=2),t};o.sort((function(e,t){return v(t)-v(e)}));var g={widgets:o,valueSrcs:l};return vi(e,"_getWidgetsAndSrcsForFieldOp",a,g),g}var Io=function(e,t,r){return Vo(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets},xo=function(e,t,r){var n;if(!r)return t;var o=null!==(n=r.type)&&void 0!==n?n:r.returnType;return"!group"===o&&(o="number"),t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter((function(t){var n=!0;if("field"===t&&e.__fieldsCntByType){var l=r._isFuncArg?0:1;n=n&&e.__fieldsCntByType[o]>l}return"func"===t&&(r.funcs&&(n=n&&r.funcs.length>0),e.__funcsCntByType&&(n=n&&e.__funcsCntByType[o]>0)),n}))},Do=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=Vo(e,t,r,null).valueSrcs;return xo(e,o,n)},No=function(e,t,r){var n=Vo(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets,o=null;return n.length&&(o=n[0]),o},Ro=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(e){var l=hi(t,e)||{},i=t.settings.fieldSeparator,a=ci(e,t),u=Array.isArray(e)?e.join(i):e;if(null!=o&&o.useTableName&&l.tableName){var s=(0,P.A)(a);s[0]=l.tableName,u=s.join(i)}if(l.fieldName&&(u=l.fieldName),n){hi(t,n);var c=n;0==u.indexOf(c+i)?u=u.slice((c+i).length):l.fieldName||r.errors.push("Can't cut group ".concat(c," from field ").concat(u))}return u}},Mo=function(e,t){var r=e.get("type"),n=e.getIn(["properties","mode"]);return"rule_group"==r&&"array"==n?qo(e,t):"group"==r||"rule_group"==r?Bo(e,t):zo(e,t)},qo=function(e,t){var r=e.get("children1"),n=e.get("properties");return Wo(n.toObject(),r,t)},Wo=function(e,t,r){var n,o,l=e.operator,i=0==(null!==(n=null===(o=r.operators[l])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1),a=!Uo(e,r),u=!Go(t,r);return!(a&&(!i||u))},Bo=function(e,t){var r=e.get("children1");return Go(r,t)},Go=function(e,t){return!((null==e?void 0:e.size)>0&&e.filter((function(e){return!Mo(e,t)})).size>0)},zo=function(e,t){var r=e.get("properties");return Uo((null==r?void 0:r.toObject())||{},t)},Uo=function(e,t){return!($o(e,t,!0).score>=3)},$o=function(e,t){var r,n,o,l=e.field,i=e.fieldSrc,a=(e.fieldType,e.operator),u=e.value,s=e.valueSrc,c=(e.valueType,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),d=null!==(r=null===(n=t.operators[a])||void 0===n?void 0:n.cardinality)&&void 0!==r?r:1,p=null!=s&&s.get?s.toJS():s,f={parts:{},score:0};if(f.parts.field=c?null!=l:Jo(l,i,t),f.parts.operator=!!a,f.parts.value=(null==u||null===(o=u.filter((function(e,r){return Jo(e,null==p?void 0:p[r],t,c)})))||void 0===o?void 0:o.size)>=(c?Math.min(d,1):d),f.score=Object.keys(f.parts).filter((function(e){return!!f.parts[e]})).length,c&&f.score<3){var v=!0;!f.parts.value&&"func"===i&&Jo(l,i,t,!1,v)&&f.score++,f.parts.field||null==u||u.map((function(e,r){"func"===(null==p?void 0:p[r])&&Jo(e,null==p?void 0:p[r],t,!1,v)&&f.score++}))}return f},Jo=function e(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(!o&&"func"==r&&t){var i,a=null===(i=t.get)||void 0===i?void 0:i.call(t,"func"),u=ii(n,a);if(u){var s=t.get("args");for(var c in u.args){var d=u.args[c],p=s?s.get(c):void 0,f=p?p.get("value"):void 0,v=p?p.get("valueSrc"):void 0;if(null==f&&void 0===(null==d?void 0:d.defaultValue)&&(null==d||!d.isOptional))return!1;if(null!=f&&!e(f,v,n,!l||o))return!1}return!0}}return null!=t},Ho=function(e,t,r){return"func"==t?ho(e,r):e},Ko=function e(t){var r=t.get("children1");if(1==(null==r?void 0:r.size)){var n=r.first();return"group"===n.get("type")?e(n):n}return null},Yo=r(12495),Qo=r.n(Yo),Xo=r(99804),Zo=r.n(Xo),el=r(26462),tl=r.n(el);function rl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function nl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rl(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ol(e,t){return tl().apply(e,t)}var ll={CALL:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return e.call.apply(e,[t].concat(n))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return nl(nl({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},strlen:function(e){return(null==e?void 0:e.length)||0},regexTest:function(e,t,r){return null!=(null==e?void 0:e.match(new RegExp(t,r)))},now:function(){return new Date},date_add:function(e,t,r){return Qe()(e).add(t,r).toDate()},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()}};function il(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function al(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ul(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?al(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):al(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sl(e,t,r){var n;try{n=tl().apply(e,t)}catch(e){throw e.message="".concat(r.join(".")," :: ").concat(e.message),e}return n}function cl(e,t,r,n){var o;try{o=t.call.apply(t,[e].concat((0,P.A)(r)))}catch(e){throw e.message="".concat(n.join(".")," :: ").concat(e.message),e}return o}!function(){for(var e in ll)t=e,r=ll[e],tl().add_operation(t,r);var t,r}();var dl=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],pl={asyncFetch:{type:"f",args:["search","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},fl=ul(ul({},pl),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},jsonLogicImport:{type:"f",args:["val"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),vl={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},gl={widgetProps:fl,opProps:vl},hl=ul(ul({},pl),{},{fieldSettings:pl}),yl=ul(ul({},pl),{},{fieldSettings:pl,widgets:{x:gl},mainWidgetProps:fl}),ml={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},caseValueField:yl,canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderBeforeCaseValue:{type:"rf"},renderAfterCaseValue:{type:"rf"},renderRuleError:{type:"rf"}},bl={fields:{x:yl},widgets:{x:fl},conjunctions:{x:{formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}}},operators:{x:vl},types:{x:{widgets:{x:gl}}},funcs:{x:ul(ul(ul({},hl),{renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}}),{},{args:{x:ul({},hl)}})},settings:ml},Ol=function(e){return"object"==(0,V.A)(e)&&null!==e&&!Array.isArray(e)},Al=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=pe()(e,dl);delete r.ctx;for(var n=function e(t,r,n,o){if(Ol(t)){if(Z(t)&&(t=X(t)),"funcs"===n[0]&&!r){var l=n[n.length-1];(r=ni({funcs:o.BasicFuncs},l,"funcs","subfields")||void 0)&&(t.$$key=l)}if(void 0!==r&&Ol(r))for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(!Object.keys(t).includes(i)||void 0===t[i]&&void 0!==r[i]?t[i]="$$deleted":(t[i]=e(t[i],r[i],[].concat((0,P.A)(n),[i]),o),void 0===t[i]&&delete t[i]));for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u;r&&Object.keys(r).includes(a)||(t[a]=e(t[a],null===(u=r)||void 0===u?void 0:u[a],[].concat((0,P.A)(n),[a]),o)),void 0===t[a]&&delete t[a]}0===Object.keys(t).length&&(t=void 0)}else Array.isArray(t)&&t.forEach((function(r,l){t[l]=e(t[l],void 0,[].concat((0,P.A)(n),[l]),o)}));if(void 0===r||!U(t,r,!0)){if("function"==typeof t)throw new Error("compressConfig: function at ".concat(n.join(".")," should be converted to JsonLogic"));return t}},o=0,l=dl;o<l.length;o++){var i=l[o];if("ctx"===i);else if("fields"===i)r[i]=Zo()(r[i]),n(r[i],{},[i]);else if("funcs"===i)for(var a in r[i]=Zo()(r[i]||{}),r[i])n(r[i][a],null,[i,a],{BasicFuncs:h});else r[i]=Zo()(r[i]),n(r[i],t[i],[i])}return r},Sl=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");for(var n={},o=function e(t,r,n){if(Ol(r))for(var o in Ol(t)||(t={}),r)Object.prototype.hasOwnProperty.call(r,o)&&("$$deleted"===r[o]?delete t[o]:t[o]=e(t[o],r[o],[].concat((0,P.A)(n),[o])));else t=Array.isArray(r)?Zo()(r):r;return t},l=function e(t,r,n){var l=!1;if(Ol(t)&&Object.prototype.hasOwnProperty.call(t,"$$key")&&t.$$key){var i=ni({funcs:n.BasicFuncs},t.$$key,"funcs","subfields");if(!i)throw new Error("decompressConfig: basic function not found by key ".concat(t.$$key," at ").concat(r.join(".")));delete t.$$key,t=o(Zo()(i),t,r),l=!0}if(!l)if(Ol(t))for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]=e(t[a],[].concat((0,P.A)(r),[a]),n));else if(Array.isArray(t)){var u,s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return il(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?il(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}(t);try{for(s.s();!(u=s.n()).done;){var c=u.value;t[c]=e(t[c],[].concat((0,P.A)(r),[c]),n)}}catch(e){s.e(e)}finally{s.f()}}return t},i=0,a=dl;i<a.length;i++){var u=a[i];"ctx"===u?n[u]=Qo()({},t.ctx||{},r||{}):"funcs"===u?(n[u]=Zo()(e[u]||{}),l(n[u],[u],{BasicFuncs:h})):"fields"===u?n[u]=Zo()(e[u]||{}):(n[u]=Zo()(t[u]||{}),o(n[u],e[u]||{},[u]))}return n},Fl=function(e){return e.__compliled||(wl(e=Zo()(e),e,{ctx:e.ctx},bl,[]),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0})),e};function wl(e,t,r,n,o){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(t)for(var i in l.length,n){var a=n[i],u="x"===i?l:[].concat((0,P.A)(l),[i]);if("r"===a.type){var s=t,c=s[i];if(a.isArr)for(var d in c){var p=Cl(c[d],r,[].concat((0,P.A)(u),[d]));p!==c[d]&&(o.push("Compiled ".concat(u.join("."),"[").concat(d,"]")),c[d]=p)}else{var f=Cl(c,r,u,void 0);f!==c&&(o.push("Compiled R ".concat(u.join("."))),s[i]=f)}}else if("rf"===a.type){var v=t,g=v[i],h=jl(g,r,u,a.ignore);h!==g&&(o.push("Compiled JL-RF ".concat(u.join("."))),v[i]=h)}else if("f"===a.type){var y,m=t,b=m[i],O=El(b,r,u,a.args,a.ignore);a.invokeWith&&O&&"function"==typeof O&&(O=(y=O).call.apply(y,[null].concat((0,P.A)(a.invokeWith)))),O!==b&&(o.push("Compiled JL-F ".concat(u.join("."))),m[i]=O)}else if("x"===i)for(var A in t){u=[].concat((0,P.A)(l),[A]);var S=t[A];wl(e,S,r,a,o,u),S.subfields&&wl(e,S.subfields,r,n,o,u)}else wl(e,t[i],r,a,o,u)}}function jl(e,t,r){return te(e)?function(n,o){o=o||(null==t?void 0:t.ctx);var l=sl(e,{props:n,ctx:o},r);return"string"==typeof l&&(l={type:l,props:n}),Cl(l,{ctx:o},r)}:"string"==typeof e?function(n,o){o=o||(null==t?void 0:t.ctx);var l=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),o);return l?cl(this,l,[n,o],r):Cl({type:e,props:n},{ctx:o},r)}:e}function El(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return te(e)&&"jl"!==o?function(){for(var o=arguments.length,l=new Array(o),i=0;i<o;i++)l[i]=arguments[i];var a=this||(null==t?void 0:t.ctx),u=(n||[]).reduce((function(e,t,r){return ul(ul({},e),{},(0,_.A)({},t,l[r]))}),{args:l,ctx:a});return sl(e,u,r)}.bind(null==t?void 0:t.ctx):"string"==typeof e&&"string"!==o?function(){var n=this||(null==t?void 0:t.ctx),o=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),n);if(o){for(var l=arguments.length,i=new Array(l),a=0;a<l;a++)i[a]=arguments[a];return cl(this,o,i,r)}throw new Error("".concat(r.join(".")," :: Function ").concat(e," is not found in ctx"))}.bind(null==t?void 0:t.ctx):e}function Cl(e,t,r){var n,o,l,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(ee(e)){var a,u=e.type,s=e.props;if("string"!=typeof u)throw new Error("renderReactElement for ".concat(r.join("."),": type should be string"));var c,d=(n=u,(null==(o=t.ctx)||null===(l=o.components)||void 0===l?void 0:l[n])||o.W[n]||o.O[n]||u.toLowerCase());return void 0!==i&&(s=ul(ul({},s),{},{key:i})),null!==(a=s)&&void 0!==a&&a.children&&(c=Cl(s.children,t,r),s=ul(ul({},s),{},{children:c})),t.ctx.RCE(d,s)}return e instanceof Array?e.map((function(e,n){return Cl(e,t,r,""+n)})):e}var Ll=r(39847),kl=r.n(Ll),_l={reverseOperatorsForNot:!1,canShortMongoQuery:!0,formatField:function(e,t,r,n,o,l){return l?r:e},caseValueField:{type:"case_value"},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,exportPreserveGroups:!1,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null};function Tl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Pl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function Pl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Vl,Il=0,xl=0,Dl={},Nl=function(){return Vl||(Vl=Ml({reactIndex:void 0,maxSize:3,canCompile:void 0})),Vl},Rl=function(e,t){var r;for(var n in Dl){var o=Dl[n].findExtendedConfig(e,t);if(o){r=o;break}}return r},Ml=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{reactIndex:void 0,maxSize:2,canCompile:!0},r=new Map,n=t.maxSize||2,o=++Il,l=function(e,t){r.size+1>n&&r.delete(r.keys().next().value),r.set(e,t)},i=function(e,t){var n,o=Tl(r.keys());try{var l,i=function(){var o=n.value;if(dl.filter((function(t){return o[t]===e[t]})).length===dl.length&&(!t||o.__compliled))return{v:r.get(o)}};for(o.s();!(n=o.n()).done;)if(l=i())return l.v}catch(e){o.e(e)}finally{o.f()}var a,u=Tl(r.values());try{var s,c=function(){var r=a.value;if(dl.filter((function(t){return r[t]===e[t]})).length===dl.length&&(!t||r.__compliled))return{v:r}};for(u.s();!(a=u.n()).done;)if(s=c())return s.v}catch(e){u.e(e)}finally{u.f()}return null};return e={getExtendedConfig:function(e){return function(e){return i(e)||function(e){var r=zl(e,++xl,t.canCompile);return l(e,r),r}(e)}(function(e){return pe()(e,dl)}(e))},findExtendedConfig:i,getBasicConfig:function(e){var t,n=Tl(r.keys());try{var o,l=function(){var n=t.value,o=r.get(n);if(0===dl.map((function(t){return o[t]===e[t]})).filter((function(e){return!e})).length)return{v:n}};for(n.s();!(t=n.n()).done;)if(o=l())return o.v}catch(e){n.e(e)}finally{n.f()}return e},clearConfigMemo:function(){r.clear(),delete Dl[o],Vl===e&&(Vl=void 0)},configId:xl,storeConfigPair:l,getSize:function(){return r.size},configStore:r,memoId:o,meta:t},void 0===t.reactIndex&&(Vl=e),Dl[o]=e,e};function ql(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Wl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function Wl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Bl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bl(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var zl=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(r=r&&e.settings.useConfigCompress,e.__configId)return e;var n=Rl(e,r);if(n)return n;var o=e;(e=r?e.__compliled?Zo()(e):Fl(e):Zo()(e)).settings=kl()({},_l,e.settings,Q),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},function(e,t){for(var r in e)Ul(0,e[r],t)}(e.types,e),$l(e.fields,e),Jl(e.funcs,e);var l=e.settings.caseValueField;l&&Hl(l,e,[],!1,!0);var i=e.settings.locale.moment;return i&&Qe().locale(i),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||D()}),e.__cache={},oe(e),Nl().storeConfigPair(o,e),e};function Ul(e,t,r){var n=null,o=null;t.mainWidget=t.mainWidget||Object.keys(t.widgets).filter((function(e){return"field"!=e&&"func"!=e}))[0];var l=t.excludeOperators||[];for(var i in t.widgets){var a=t.widgets[i],u=a.defaultOperator;a.operators&&(n=ne(n,a.operators.filter((function(e){return!l.includes(e)})))),u&&!l.includes(u)&&(o&&i!==t.mainWidget||(o=u)),i==t.mainWidget&&(a.widgetProps=Gl(Gl({},t.mainWidgetProps||{}),a.widgetProps||{})),t.widgets[i]=a}t.valueSources||(t.valueSources=Object.keys(r.settings.valueSourcesInfo));var s,c=ql(t.valueSources);try{for(c.s();!(s=c.n()).done;){var d=s.value;"value"==d||t.widgets[d]||(t.widgets[d]={})}}catch(e){c.e(e)}finally{c.f()}!t.operators&&n&&(t.operators=Array.from(new Set(n))),!t.defaultOperator&&o&&(t.defaultOperator=o)}function $l(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var n in e){var o=[].concat((0,P.A)(r),[n]);Hl(e[n],t,o),e[n].subfields&&$l(e[n].subfields,t,o)}}function Jl(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){var o=(null==t||null===(r=t.settings)||void 0===r?void 0:r.fieldSeparator)||".";for(var l in e){var i=[].concat((0,P.A)(n),[l]),a=i.join(o),u=e[l];if(u.returnType&&(u.type=u.returnType,t.__funcsCntByType[u.returnType]||(t.__funcsCntByType[u.returnType]=0),t.__funcsCntByType[u.returnType]++),Hl(u,t,i,!1),u.args){for(var s in u.args)Hl(u.args[s],t,[].concat((0,P.A)(i),[s]),!0);var c,d=!0,p=ql(Object.keys(u.args).reverse());try{for(p.s();!(c=p.n()).done;){var f=c.value,v=u.args[f];!d&&v.isOptional&&(ue.info("Arg ".concat(f," for func ").concat(a," can't be optional")),delete v.isOptional),v.isOptional||(d=!1)}}catch(e){p.e(e)}finally{p.f()}}u.subfields&&Jl(u.subfields,t,[].concat((0,P.A)(n),[l]))}}}function Hl(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.settings,a=i.showLabels,u=i.fieldSeparator;u=null!==(r=u)&&void 0!==r?r:".";var s=n[n.length-1],c=o?n.slice(0,n.length-1).join(u):n.join(u),d=!!e.returnType,p=e.type||e.returnType,f=t.types[p],v=e.excludeOperators||[],g=(e.operators||(null==f?void 0:f.operators)||[]).filter((function(e){return!v.includes(e)})),h=e.defaultOperator||(null==f?void 0:f.defaultOperator);v.includes(h)&&(h=void 0);var y=!!h&&h==e.defaultOperator;if(y&&(e.ownDefaultOperator=e.defaultOperator),f){o||d||l||(t.__fieldsCntByType[p]||(t.__fieldsCntByType[p]=0),t.__fieldsCntByType[p]++),o&&(e._isFuncArg=!0,e._argKey=s,e._funcKey=c),d&&(e._isFunc=!0,e._funcKey=c),l&&(e._isCaseValue=!0),function(e,t,r){for(var n,o,l=0,i=["listValues","treeValues","allowCustomValues","validateValue"];l<i.length;l++){var a=i[l];e[a]&&(e.fieldSettings||(e.fieldSettings={}),e.fieldSettings[a]=e[a],delete e[a])}null!==(n=e.fieldSettings)&&void 0!==n&&n.listValues&&t.settings.normalizeListValues&&(e.fieldSettings.listValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.listValues,r,e.fieldSettings)),null!==(o=e.fieldSettings)&&void 0!==o&&o.treeValues&&t.settings.normalizeListValues&&(e.fieldSettings.treeValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.treeValues,r,e.fieldSettings))}(e,t,p);var m=["widgets","operators","defaultOperator"];Object.keys(f).filter((function(e){return!m.includes(e)})).map((function(t){e[t]||(e[t]=W(f[t]))}));var b=f.excludeOperators||[];e.operators&&(b=b.filter((function(t){return!e.operators.includes(t)}))),e.widgets||(e.widgets={});var O=function(){var t=Gl({},e.widgets[A]||{}),r=f.widgets[A]||{};if(!o){var n=t.defaultOperator,l=[].concat((0,P.A)(v),(0,P.A)(b)),i=e.preferWidgets&&("field"===A||e.preferWidgets.includes(A))||l.length>0;if(t.operators){var u=t.operators.filter((function(e){return!l.includes(e)}));t.operators=u,g=ne(g,u)}else if(i&&r.operators){var c=r.operators.filter((function(e){return!l.includes(e)}));t.operators=c,g=ne(g,c)}n&&!l.includes(n)&&(h&&(y||A!==e.mainWidget)||(h=n))}A===e.mainWidget?t.widgetProps=Gl(Gl(Gl({},r.widgetProps||{}),e.mainWidgetProps||{}),t.widgetProps||{}):t.widgetProps=Gl(Gl({},r.widgetProps||{}),t.widgetProps||{});var d=Array.from(new Set([].concat((0,P.A)(Object.keys(r.opProps||{})),(0,P.A)(Object.keys(t.opProps||{})))));if(d.length){var p,m={},O=ql(d);try{for(O.s();!(p=O.n()).done;){var S,F,w=p.value;m[w]=Gl(Gl({},(null===(S=r.opProps)||void 0===S?void 0:S[w])||{}),(null===(F=t.opProps)||void 0===F?void 0:F[w])||{})}}catch(e){O.e(e)}finally{O.f()}t.opProps=m}var j=t,E=j.valueLabel,C=j.valuePlaceholder;o&&(E||(t.valueLabel=e.label||s),C||a||(t.valuePlaceholder=e.label||s)),t=Gl(Gl({},r),t),e.widgets[A]=t};for(var A in f.widgets)O();if(o||(e.operators||(e.operators=Array.from(new Set(g))),e.defaultOperator||(e.defaultOperator=h)),!o&&!d&&!l){var S=function(e,t){if(!t)return{};var r=e.settings.fieldSeparator,n=(0,P.A)(t).reduce((function(t,n,o,l){var i=t.computedPath,a=t.computed,u=t.inGroup,s=[].concat((0,P.A)(l.slice(0,o)),[n]),c=ni(e,s);return"!group"===(null==c?void 0:c.type)&&o<l.length-1?(u=s.join(r),i=[]):null!=c&&c.fieldName?(a=!0,i=[c.fieldName]):i=[].concat((0,P.A)(i),[n]),{computedPath:i,computed:a,inGroup:u}}),{computedPath:[],computed:!1,inGroup:void 0}),o=n.computedPath,l=n.computed,i=n.inGroup;return l?{fieldName:o.join(r),inGroup:i}:{}}(t,n),F=S.fieldName,w=S.inGroup;F&&(e.fieldName=F,t.__fieldNames[F]||(t.__fieldNames[F]=[]),t.__fieldNames[F].push({fullPath:n,inGroup:w}))}}else e.disabled=!0}function Kl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kl(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ql=ce().mark(ei),Xl=ce().mark(ti),Zl=R;function ei(e){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(ri(e,e.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}}),Ql)}function ti(e){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(ri(e,e.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}}),Xl)}function ri(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";return ce().mark((function o(l){var i,a,u;return ce().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=(null==e||null===(l=e.settings)||void 0===l?void 0:l.fieldSeparator)||".",o.t0=ce().keys(t);case 2:if((o.t1=o.t0()).done){o.next=13;break}if(a=o.t1.value,!(u=t[a])[n]){o.next=9;break}return o.delegateYield(ri(e,u[n],[].concat((0,P.A)(r),[a]),n),"t2",7);case 7:o.next=11;break;case 9:return o.next=11,[[].concat((0,P.A)(r),[a]).join(i),u];case 11:o.next=2;break;case 13:case"end":return o.stop()}}),o)}))()}var ni=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fields",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";if(!t)return null;if("!case_value"===t)return null==e||null===(n=e.settings)||void 0===n?void 0:n.caseValueField;var i=(null==e||null===(r=e.settings)||void 0===r?void 0:r.fieldSeparator)||".",a=ci(t,e),u=e[o];if(!u)return null;for(var s=u,c=null,d=[],p=0;p<a.length;p++){var f=a[p];d.push(f),c=s[d.join(i)],p<a.length-1&&(c&&c[l]?(s=c[l],d=[]):c=null)}return c},oi=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=e.settings.fieldSeparator,i=[o].concat((0,P.A)(t.split(l))).filter((function(e){return null!=e})),a=t;return((null===(r=e.__fieldNames[a])||void 0===r||null===(n=r.find)||void 0===n||null===(n=n.call(r,(function(e){var t=e.inGroup;return!t||(null==o?void 0:o.startsWith(t))})))||void 0===n?void 0:n.fullPath)||i).join(l)},li=function(e,t){if(!t)return null;var r=ni(e,t,"funcs","subfields");if(!r)return null;var n=r.returnType,o=r.args;return{returnType:n,args:Object.fromEntries(Object.entries(o||{}).map((function(e){var t=(0,T.A)(e,2),r=t[0],n=t[1];return[r,pe()(n,["type","valueSources","defaultValue","fieldSettings","isOptional","_funcKey","_argKey","_isFuncArg"])]})))}},ii=function(e,t){return t&&ni(e,t,"funcs","subfields")||null},ai=function(e,t,r){var n=ii(e,t);return n&&(n.args&&n.args[r]||null)||null},ui=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;var o=(null==n||null===(r=n.settings)||void 0===r?void 0:r.fieldSeparator)||".",l=si(e,n),i=si(t,n);return l.startsWith(i+o)},si=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e)return e;var n=(null==r||null===(t=r.settings)||void 0===t?void 0:t.fieldSeparator)||".";return ci(e,r).join(n)},ci=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var l,i=(null==o||null===(t=o.settings)||void 0===t?void 0:t.fieldSeparator)||".";return null!=e&&e.func?Array.isArray(e.func)?e.func:e.func.split(i):null!=e&&null!==(r=e.get)&&void 0!==r&&r.call(e,"func")?null==e||null===(l=e.get)||void 0===l?void 0:l.call(e,"func").split(i):(null==e||null===(n=e.split)||void 0===n?void 0:n.call(e,i))||[]},di=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;var n=t.settings.fieldSeparator,o=ci(e,t);return r?o:o.map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return e.join(n)}))},pi=function(e){var t;if("string"==typeof e||Array.isArray(e))return"field:".concat(si(e));if("object"===(0,V.A)(e)&&e){if(e._funcKey&&e._argKey)return"arg:".concat(si(e._funcKey),"__").concat(e._argKey);if(e._funcKey)return"func:".concat(si(e._funcKey));if(e.func&&e.arg)return"arg:".concat(si(e.func),"__").concat(e.arg);if(e.func)return"func:".concat(si(e.func));if(e.type)return null}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?"arg:".concat(si(e.get("func")),"__").concat(e.get("arg")):"func:".concat(si(e.get("func"))):null},fi=function(e,t,r){var n;return null===(n=e.__cache)||void 0===n||null===(n=n[t])||void 0===n?void 0:n[r]},vi=function(e,t,r,n){e.__cache&&r&&(e.__cache[t]||(e.__cache[t]={}),e.__cache[t][r]=n)},gi=function(e){var t;if(!e)return null;if("object"===(0,V.A)(e)){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?null:"func":"field"},hi=function(e,t){var r;if(!t)return null;if("object"==(0,V.A)(t)){if(!t.func&&t.type)return t;if(t.func)return t.func&&t.arg?ai(e,t.func,t.arg):ii(e,t.func)}return null!=t&&null!==(r=t.get)&&void 0!==r&&r.call(t,"func")?null!=t&&t.get("arg")?ai(e,t.get("func"),t.get("arg")):ii(e,t.get("func")):ni(e,t)||null},yi=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return null;var n=e.operators[t];if(r){var o,l,i=pi(r),a=i?"".concat(i,"__").concat(t):null,u=fi(e,"getOperatorConfig",a);if(u)return u;var s=hi(e,r),c=No(e,r,t,null),d=e.widgets[c]||{},p=(s&&s.widgets?s.widgets[c]:{})||{},f=(null===(o=d.opProps)||void 0===o?void 0:o[t])||{},v=(null===(l=p.opProps)||void 0===l?void 0:l[t])||{},g=Yl(Yl(Yl({},n),f),v);return vi(e,"getOperatorConfig",a,g),g}return n},mi=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!t)return null;var a=hi(e,t),u=pi(t);o||(o=No(e,t,n,l));var s=u?"".concat(u,"__").concat(n,"__").concat(o,"__").concat(l):null,c=fi(e,"getFieldWidgetConfig",s);if(c)return c;var d=e.widgets[o]||{},p=(null==a||null===(r=a.widgets)||void 0===r?void 0:r[o])||{},f=p.widgetProps||{},v="value"!==l&&l?{}:null==a?void 0:a.fieldSettings,g=Yl(Yl(Yl(Yl({},d),p),f),v);return vi(e,"getFieldWidgetConfig",s,g),i.forExport&&(g=B(g,"factory")),g},bi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.settings.fieldSeparator,n=ci(t,e),o=t?ni(e,t):e,l=null,i=[];do{var a,u=o===e?e.fields:null===(a=o)||void 0===a?void 0:a.subfields;if(!u||!Object.keys(u).length){o=l=null;break}l=Object.keys(u)[0],i.push(l),o=u[l]}while("!struct"==o.type||"!group"==o.type);return(n||[]).concat(i).join(r)};function Oi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ai(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oi(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Si=function(e,t){var r={usedFields:[]},n=Fi(e,t,r);if(n)return Ai(Ai({},n),r)},Fi=function(e,t,r){if(e){var n=e.get("type"),o=e.get("children1");return("group"===n||"rule_group"===n)&&o&&o.size?wi(e,t,r):"rule"===n?ji(e,t,r):void 0}},wi=function(e,t,r){var n=e.get("properties")||new I.T5,o=e.get("children1"),l=e.get("id"),i=o.map((function(e){return Fi(e,t,r)})).filter((function(e){return void 0!==e}));if(i.size){var a=n.get("conjunction");a||(a=Mr(t));var u=n.get("not");return{id:l,rules:i.toList(),condition:a.toUpperCase(),not:u}}},ji=function(e,t,r){var n,o=e.get("properties")||new I.T5,l=e.get("id"),i=o.get("operator"),a=o.get("operatorOptions"),u=o.get("field"),s=o.get("value"),c=o.get("valueSrc"),d=o.get("valueType"),p=s.filter((function(e){return void 0===e})).size>0;if(null!=u&&null!=i&&!p){var f=hi(t,u)||{},v=yi(t,i,u)||{},g=f.type||"undefined",h=G(v),y=t.types[f.type]||{},m=Ro(u,t,r);if(!(s.size<h)){-1==r.usedFields.indexOf(u)&&r.usedFields.push(u),s=s.toArray(),c=c.toArray(),d=(null===(n=d)||void 0===n?void 0:n.toArray())||[];for(var b=[],O=0;O<s.length;O++){var A={type:d[O],value:s[O]};if(b.push(A),"field"==c[O]){var S=s[O];-1==r.usedFields.indexOf(S)&&r.usedFields.push(S)}}var F=a?a.toJS():null;F&&!Object.keys(F).length&&(F=null);var w={id:l,fieldName:m,type:g,input:y.mainWidget,operator:i};return F&&(w.operatorOptions=F),w.values=b,w}}};function Ei(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ci(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ei(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ei(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Li(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ki(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ki(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function ki(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _i=function(e,t){var r,n={usedFields:[],errors:[]},o=zl(t,void 0,!1),l=Ti(e,o,n,!1,!0),i=n.errors,a=n.usedFields,u=(o.settings.fieldSeparator,{}),s=Li(a);try{for(s.s();!(r=s.n()).done;)for(var c=r.value,d=ci(c,t),p=(hi(o,c),u),f=0;f<d.length;f++){var v=d[f],g=hi(o,d.slice(0,f+1))||{};f!=d.length-1?"!group"==g.type&&"struct"!=g.mode?(p[v]||(p[v]=[{}]),p=p[v][0]):(p[v]||(p[v]={}),p=p[v]):p[v]||(p[v]=null)}}catch(e){s.e(e)}finally{s.f()}return{errors:i,logic:l,data:u}},Ti=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(e){var i,a=e.get("type"),u=(e.get("properties")||new I.T5).get("isLocked"),s=t.settings.jsonLogic.lockedOp;return"group"===a||"rule_group"===a?i=Pi(e,t,r,n,o,l):"rule"===a?i=Vi(e,t,r,n,l):"switch_group"==a?i=Ii(e,t,r,n):"case_group"==a&&(i=xi(e,t,r,n,l)),u&&i&&s&&(i=(0,_.A)({},s,i)),i}},Pi=function(e,t,r){var n,o,l,i,a,u,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,p=e.get("type"),f=e.get("properties")||new I.T5,v=f.get("mode"),g=e.get("children1")||new I.B8,h=f.get("field"),y=hi(t,h),m=f.get("conjunction");m||(m=Mr(t));var b=t.conjunctions[m].jsonLogicConj||m.toLowerCase(),O=!!f.get("not"),A="rule_group"===p&&!c,S=A&&"struct"!=v,F=S?h:d,w=f.get("operator"),j=w&&yi(t,w,h)||null,E=Di(t,f,r,w,d),C=A&&(!w||0==(null===(n=j)||void 0===n?void 0:n.cardinality)),L=A&&(null==g?void 0:g.size)>0,k=(A&&null!=g&&g.size,O),T=!1;L?(T=O,k=s):s&&(k=!k);var P=!1,V=null===(o=j)||void 0===o?void 0:o.reversedOp,x=yi(t,V,h),D=!(null!==(l=j)&&void 0!==l&&l.jsonLogic||null===(i=x)||void 0===i||!i.jsonLogic),N=!(null===(a=x)||void 0===a||!a.jsonLogic),R=null===(u=Ko(e))||void 0===u?void 0:u.get("type");if(!!t.settings.reverseOperatorsForNot&&(!A&&k&&"rule"===R||T&&1===(null==g?void 0:g.size))&&(L?T=!T:k=!k,P=!0),k&&A&&N&&(t.settings.reverseOperatorsForNot||D)){k=!k;var M=[V,w];w=M[0],V=M[1];var q=[x,j];j=q[0],x=q[1]}var W=g.map((function(e){return Ti(e,t,r,P,!1,F)})).filter((function(e){return void 0!==e})),B=!!t.settings.exportPreserveGroups;if(S&&!C){if(null==E)return}else if(!W.size&&!B)return;var G=c||B||1!=W.size;G||!O||P||(G=g.some((function(e){var r,n,o,l,i=null===(r=e.get("properties"))||void 0===r?void 0:r.get("operator"),a=null===(n=t.operators)||void 0===n||null===(n=n[i])||void 0===n?void 0:n.reversedOp;return null!==(o=null===(l=t.operators)||void 0===l||null===(l=l[a])||void 0===l?void 0:l._jsonLogicIsExclamationOp)&&void 0!==o&&o})));var z={};if(G?z[b]=W.toList().toJS():z=W.first(),T&&(z={"!":z}),S){var U=Mi(r,t,h,d);if(C){var $=w||"some";z=(0,_.A)({},$,[U,z])}else{var J=W.size?{filter:[U,z]}:U;z=qi(t,f,{reduce:[J,{"+":[1,{var:"accumulator"}]},0]},E,w,null,y)}}return k&&(z={"!":z}),z},Vi=function(e,t,r){var n,o,l,i,a,u,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,d=e.get("properties")||new I.T5,p=d.get("field"),f=d.get("fieldSrc"),v=d.get("operator"),g=d.get("operatorOptions");if((g=g?g.toJS():null)&&!Object.keys(g).length&&(g=null),null!=p&&null!=v){var h=hi(t,p),y=yi(t,v,p),m=null===(n=y)||void 0===n?void 0:n.reversedOp,b=yi(t,m,p);if(null!==(o=y)&&void 0!==o&&o.jsonLogic||null!==(l=b)&&void 0!==l&&l.jsonLogic){var O=s,A=!(null!==(i=y)&&void 0!==i&&i.jsonLogic||null===(a=b)||void 0===a||!a.jsonLogic),S=!(null===(u=b)||void 0===u||!u.jsonLogic)&&(!!t.settings.reverseOperatorsForNot||A);if(O&&S||A){O=!O;var F=[m,v];v=F[0],m=F[1];var w=[b,y];y=w[0],b=w[1]}var j=Di(t,d,r,v,c);if(void 0!==j){var E="func"===f?Ri(r,t,p,c):Mi(r,t,p,c);if(void 0!==E)return qi(t,d,E,j,v,g,h,O)}}else r.errors.push("Operator ".concat(v," is not supported"))}},Ii=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.get("children1");if(o){for(var l=o.map((function(e){return xi(e,t,r,n,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray(),i=[],a=0;a<l.length;a++)a===l.length-1||l[a][0]?(i.push(l[a]),a===l.length-1&&l[a][0]&&i.push([void 0,null])):r.errors.push("No condition for case ".concat(a));if(i.length){if(1===i.length){var u=(0,T.A)(i[0],2),s=(u[0],u[1]);return null==s&&(s=null),s}for(var c={if:[]},d=c.if,p=(0,T.A)(i[i.length-1],2),f=(p[0],p[1]),v=0;v<i.length-1;v++){var g=v===i.length-2,h=(0,T.A)(i[v],2),y=h[0],m=h[1];null==m&&(m=null),null==y&&(y=!0),d.push(y),d.push(m),g?d.push(f):(d.push({if:[]}),d=d[d.length-1].if)}return c}}},xi=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=e.get("type");if("case_group"==l){var i=e.get("properties")||new I.T5;return[Pi(e,t,r,n,o),Di(t,i,r,null,o,"!case_value")]}r.errors.push("Unexpected child of type ".concat(l," inside switch"))},Di=function(e,t,r,n,o){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=t.get("field"),a=t.get("valueSrc"),u=t.get("valueType");("!case_value"==l||u&&"case_value"==u.get(0))&&(i="!case_value");var s=hi(e,i),c=yi(e,n,i),d=G(c),p=t.get("value"),f=t.get("asyncListValues");if(null!=p){var v=[],g=[],h=r.usedFields,y=p.map((function(t,l){var d=a?a.get(l):null,p=u?u.get(l):null,h=Ho(t,d,e),y=No(e,i,n,d),m=mi(e,i,n,y,d,{forExport:!0}),b=Ni(r,e,h,d,p,m,s,n,c,o,f);return void 0!==b&&(v.push(d),g.push(p)),b})),m=y.filter((function(e){return void 0===e})).size>0;if(!(y.size<d||m))return d>1?y.toArray():1==d?y.first():null;r.usedFields=h}},Ni=function(e,t,r,n,o,l,i,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var d;if("field"==n)d=Mi(e,t,r,s);else if("func"==n)d=Ri(e,t,r,s);else if("function"==typeof(null==l?void 0:l.jsonLogic)){var p=l.jsonLogic,f=[r,Ci(Ci({},i?pe()(i,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),B(l,R)];a&&(f.push(a),f.push(u)),d=p.call.apply(p,[t.ctx].concat(f))}else d=r;return d}},Ri=function(e,t,r){var n,o,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),u=ii(t,i),s=ci(i,t),c=s[s.length-1];if(u)if(null!=u&&u.jsonLogic){var d={},p=[],f=[];for(var v in u.args){var g,h=u.args[v],y=hi(t,h),m=h.defaultValue,b=h.isOptional,O=null!=m&&m.func?"func":"value",A=a?a.get(v):void 0,S=A?A.get("value"):void 0,F=A?A.get("valueSrc"):void 0;"func"!==F&&null!==(g=S)&&void 0!==g&&g.toJS&&(S=S.toJS());var w=null,j=No(t,h,w,F),E=mi(t,h,w,j,F,{forExport:!0}),C=Ni(e,t,S,F,h.type,E,y,null,null,l);if(null!=S&&void 0===C)return void("func"!=F&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(i)));var L=void 0;if(void 0===C&&!b&&null!=m){var k=No(t,h,w,O),T=mi(t,h,w,k,O,{forExport:!0});if(void 0===(L=Ni(e,t,m,O,h.type,T,y,null,null,l)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(i)))}var P=null!=C?C:L;if(void 0!==P){if(p.length){var V,I=Li(p);try{for(I.s();!(V=I.n()).done;)d[V.value]=void 0}catch(e){I.e(e)}finally{I.f()}p=[]}d[v]=P}else b||f.push(v),p.push(v)}if(!f.length){var x,D=Object.values(d);if("function"==typeof u.jsonLogic){var N=u.jsonLogic,R=[d];x=N.call.apply(N,[t.ctx].concat(R))}else{var M=u.jsonLogic||c;if(u.jsonLogicIsMethod){var q=D[0],W=D.slice(1);x=W.length?{method:[q,M,W]}:{method:[q,M]}}else x=(0,_.A)({},M,D)}return x}}else e.errors.push("Func ".concat(i," is not supported"));else e.errors.push("Func ".concat(i," is not defined in config"))},Mi=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=t.settings,i=l.fieldSeparator,a=l.jsonLogic;if(r){Array.isArray(r)&&(r=r.join(i));var u=hi(t,r)||{},s=Ro(r,t,e,o),c=u.jsonLogicVar||("!group"==u.type?a.groupVarKey:"var");n=(0,_.A)({},c,s),-1==e.usedFields.indexOf(r)&&e.usedFields.push(r)}return n},qi=function(e,t,r,n,o){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=t.get("field"),s=yi(e,o,u)||{},c="function"==typeof s.jsonLogic?s.jsonLogic:function(e,t,r,n){var o=e,l=G(t);"string"==typeof t.jsonLogic&&(o=t.jsonLogic);var i=["<","<=",">",">="],a=["==","!="];return function(e,t,u,s,c){return 0==l&&a.includes(o)?(0,_.A)({},o,[r,null]):0==l?(0,_.A)({},o,r):1==l?(0,_.A)({},o,[r,n]):2==l&&i.includes(o)?(0,_.A)({},o,[n[0],r,n[1]]):(0,_.A)({},o,[r].concat((0,P.A)(n)))}}(o,s,r,n),d=[r,o,n,B(s,M),l,i],p=c.call.apply(c,[e.ctx].concat(d));return a&&(p={"!":p}),p};function Wi(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Bi(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function Bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function zi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Gi(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ui=function(e){return"object"==(0,V.A)(e)&&null!==e&&!Array.isArray(e)},$i=function(e,t){return Ji(e,t,!1)},Ji=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=zl(t,void 0,!1),l=Hi([],e,o,n);return r?[l,n.errors]:(n.errors.length&&console.warn("Errors while exporting to MongoDb:",n.errors),l)},Hi=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;if(t){var u=t.get("type");return"group"===u||"rule_group"===u?Ki(e,t,r,n,o,l,i,a):"rule"===u?Yi(e,t,r,n,o,l,i,a):void 0}},Ki=function(e,t,r,n){var o,l,i,a,u,s,c,d,p=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=t.get("type"),v=t.get("properties")||new I.T5,g=!!v.get("not"),h=t.get("children1")||new I.B8,y=r.settings,m=y.canShortMongoQuery,b=y.fieldSeparator,O=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,A=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),S=O&&A,F="rule_group"===f,w=F?v.get("field"):null,j=F?v.get("operator"):null,E=j&&yi(r,j,w)||null,C=j?null!==(o=null===(l=E)||void 0===l?void 0:l.cardinality)&&void 0!==o?o:1:void 0,L=Ro(w,r,n,S),k=(hi(r,w)||{}).mode,T=w&&"array"===k&&C>=1,V=F&&(null==h?void 0:h.size)>0,x=(F&&null!=h&&h.size,!1),D=g,N=!1;V?(N=g,D=p):p&&(D=!D);var R=null===(i=E)||void 0===i?void 0:i.reversedOp,M=yi(r,R,w),q=!(null!==(a=E)&&void 0!==a&&a.mongoFormatOp||null===(u=M)||void 0===u||!u.mongoFormatOp),W=!(null===(s=M)||void 0===s||!s.mongoFormatOp),B=null===(c=Ko(t))||void 0===c?void 0:c.get("type");if(!!r.settings.reverseOperatorsForNot&&(!F&&D&&"rule"===B||N&&1===(null==h?void 0:h.size))&&(V?N=!N:D=!D,x=!0),D&&F&&W&&(r.settings.reverseOperatorsForNot||q)){D=!D;var G=[R,j];j=G[0],R=G[1];var z=[M,E];E=z[0],M=z[1]}var U=v.get("conjunction");U||(U=Mr(r));var $=r.conjunctions[U];if($){var J=$.reversedConj;D&&"or"===(null===(d=U)||void 0===d?void 0:d.toLowerCase())&&J&&!F&&r.settings.canShortMongoQuery&&r.settings.reverseOperatorsForNot&&(U=J,$=r.conjunctions[U],D=!D,x=!0);var H=$.mongoConj,K=h.map((function(o){return Hi([].concat((0,P.A)(e),[t]),o,r,n,x,"array"!=k,"array"==k?function(e){return"$$el".concat(b).concat(e)}:void 0)})).filter((function(e){return void 0!==e}));if(T||K.size){var Y;if(1==K.size)Y=K.first();else if(K.size>1){var Q=K.toList().toJS();m&&"$and"==H&&(Y=Q.reduce((function(e,t){if(e){for(var r in t){if("$"==r[0]){e=void 0;break}if(null==e[r])e[r]=t[r];else{var n=e[r],o=t[r];if(Ui(n)||(n={$eq:n}),Ui(o)||(o={$eq:o}),Object.keys(n)[0]==Object.keys(o)[0]){e=void 0;break}e[r]=Object.assign({},n,o)}}return e}}),{})),Y||(Y=(0,_.A)({},H,Q))}if(w)if("array"==k){var X={$size:{$ifNull:["$"+L,[]]}},Z=Y?{$size:{$ifNull:[{$filter:{input:"$"+L,as:"el",cond:Y}},[]]}}:X;Y={$expr:Y=Hi(e,t.set("type","rule"),r,n,N,!1,(function(e){return Z}),X)}}else Y=(0,_.A)({},L,{$elemMatch:Y});return D&&(Y={$not:Y}),Y}}},Yi=function(e,t,r,n){var o,l,i,a,u,s,c,d=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,v=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,g=t.get("properties")||new I.T5,h=e.filter((function(e){return"rule_group"==e.get("type")})).length>0,y=e.filter((function(e){return"rule_group"==e.get("type")})).map((function(e){return e.get("properties").get("field")})).slice(-1).pop(),m=h&&y,b=g.get("operator"),O=g.get("operatorOptions"),A=g.get("field"),S=g.get("fieldSrc"),F=g.get("value"),w=g.get("valueSrc"),j=g.get("valueType"),E=g.get("asyncListValues");if(null!=A&&null!=b&&void 0!==F){var C=hi(r,A),L=yi(r,b,A),k=null===(o=L)||void 0===o?void 0:o.reversedOp,_=yi(r,k,A),P=G(L);if(null!==(l=L)&&void 0!==l&&l.mongoFormatOp||null!==(i=_)&&void 0!==i&&i.mongoFormatOp){var V,x=d,D=!(null!==(a=L)&&void 0!==a&&a.mongoFormatOp||null===(u=_)||void 0===u||!u.mongoFormatOp);if(null!==(s=_)&&void 0!==s&&s.mongoFormatOp&&(r.settings.reverseOperatorsForNot||D)&&x||D){var N=[k,b];b=N[0],k=N[1];var R=[_,L];L=R[0],_=R[1],x=!x}var q=!1;if("func"==S){var W=Zi(n,r,A,m),z=(0,T.A)(W,2);V=z[0],q=z[1]}else V=Ro(A,r,n,m),f&&(q=!0,V=f(V));if(null!=V){var U,$=[],J=[];if(null!=F){var H=F.map((function(e,t){var o=w?w.get(t):null,l=j?j.get(t):null,i=Ho(e,o,r),a=No(r,A,b,o),u=mi(r,A,b,a,o,{forExport:!0}),s=Qi(n,r,i,o,l,u,C,m,b,L,E),c=(0,T.A)(s,2),d=c[0],p=c[1];return void 0!==d&&(q=q||p,$.push(o),J.push(l)),d})),K=H.filter((function(e){return void 0===e})).size>0;if(H.size<P||K)return;U=P>1?H.toArray():1==P?H.first():null}var Y=q&&p,Q=null===(c=L)||void 0===c?void 0:c.mongoFormatOp,X=[V,b,void 0!==v&&null==U?v:U,q,$.length>1?$:$[0],J.length>1?J:J[0],B(L,M),O,C],Z=Q.call.apply(Q,[r.ctx].concat(X));return Y&&(Z={$expr:Z}),x&&(Z={$not:Z}),Z}}else n.errors.push("Operator ".concat(b," is not supported"))}},Qi=function(e,t,r,n,o,l,i,a,u,s,c){if(void 0===r)return[void 0,!1];var d,p=!1;if("field"==n){var f=Xi(e,t,r,a),v=(0,T.A)(f,2);d=v[0],p=v[1]}else if("func"==n){var g=Zi(e,t,r,a),h=(0,T.A)(g,2);d=h[0],p=h[1]}else if("function"==typeof(null==l?void 0:l.mongoFormatValue)){var y=l.mongoFormatValue,m=[r,zi(zi({},i?pe()(i,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),B(l,R)];u&&(m.push(u),m.push(s)),d=y.call.apply(y,[t.ctx].concat(m))}else d=r;return[d,p]},Xi=function(e,t,r,n){var o,l=t.settings.fieldSeparator;if(r){var i=hi(t,r)||{},a=ci(r,t),u=_o(r,t),s=u?u.join(l):null;o="$"+(0,t.settings.formatField)(Ro(r,t,e,n),a,s,i,t,!1)}return[o,!0]},Zi=function(e,t,r,n){var o,l,i,a=null===(o=r.get)||void 0===o?void 0:o.call(r,"func"),u=null===(l=r.get)||void 0===l?void 0:l.call(r,"args"),s=ii(t,a);if(!s)return e.errors.push("Func ".concat(a," is not defined in config")),[void 0,!1];var c=ci(a,t),d=c[c.length-1],p=s.mongoFunc||d,f=s.mongoArgsAsObject,v={},g=0,h=void 0,y=[],m=[];for(var b in s.args){var O;g++;var A=s.args[b],S=hi(t,A),F=A.defaultValue,w=A.isOptional,j=null!=F&&F.func?"func":"value",E=u?u.get(b):void 0,C=E?E.get("value"):void 0,L=E?E.get("valueSrc"):void 0;"func"!==L&&null!==(O=C)&&void 0!==O&&O.toJS&&(C=C.toJS());var k=E?E.get("asyncListValues"):void 0,P=null,V=No(t,A,P,L),I=mi(t,A,P,V,L,{forExport:!0}),x=Qi(e,t,C,L,A.type,I,S,n,null,null,k),D=(0,T.A)(x,2),N=D[0];if(D[1],null!=C&&void 0===N)return"func"!=L&&e.errors.push("Can't format value of arg ".concat(b," for func ").concat(a)),[void 0,!1];var R=void 0;if(void 0===N&&!w&&null!=F){var M=No(t,A,P,j),q=mi(t,A,P,M,j,{forExport:!0}),W=Qi(e,t,F,j,A.type,q,S,n,null,null,k),B=(0,T.A)(W,2);if(R=B[0],B[1],void 0===R)return"func"!=j&&e.errors.push("Can't format default value of arg ".concat(b," for func ").concat(a)),[void 0,!1]}var G=null!=N?N:R;if(void 0!==G){if(y.length){var z,U=Wi(y);try{for(U.s();!(z=U.n()).done;)v[z.value]=void 0}catch(e){U.e(e)}finally{U.f()}y=[]}v[b]=G,h=G}else w||m.push(b),y.push(b)}if(m.length)return[void 0,!1];if("function"==typeof s.mongoFormatFunc){var $=s.mongoFormatFunc,J=[v];i=$.call.apply($,[t.ctx].concat(J))}else{if(null===s.mongoFormatFunc)return e.errors.push("Functon ".concat(p," is not supported")),[void 0,!1];i=f?(0,_.A)({},p,v):1==g&&void 0!==h?(0,_.A)({},p,h):(0,_.A)({},p,Object.values(v))}return[i,!0]};function ea(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ta(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ta(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function ta(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ra(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function na(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ra(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ra(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oa=function(e,t){return la(e,t,!1)},la=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=zl(t,void 0,!1),l=ia(e,o,n);return r?[l,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SQL:",n.errors),l)},ia=function(e,t,r){if(e){var n=e.get("type");return e.get("children1"),"group"===n||"rule_group"===n?aa(e,t,r):"rule"===n?ua(e,t,r):void 0}},aa=function(e,t,r){var n=e.get("type"),o=e.get("properties")||new I.T5,l=e.get("children1")||new I.B8,i="rule_group"===n?o.get("field"):null;"array"==(hi(t,i)||{}).mode&&r.errors.push("Aggregation is not supported for ".concat(i));var a=o.get("not"),u=l.map((function(e){return ia(e,t,r)})).filter((function(e){return void 0!==e}));if(u.size){var s=o.get("conjunction");return s||(s=Mr(t)),t.conjunctions[s].sqlFormatConj.call(t.ctx,u,s,a)}},ua=function(e,t,r){var n=e.get("properties")||new I.T5,o=n.get("field"),l=n.get("fieldSrc"),i=n.get("operator"),a=n.get("operatorOptions"),u=n.get("valueSrc"),s=n.get("valueType"),c=n.get("value"),d=n.get("asyncListValues");if(null!=o&&null!=i){var p=hi(t,o)||{},f=yi(t,i,o)||{},v=f.reversedOp,g=yi(t,v,o)||{},h=G(f),y=!1,m=f.sqlOp||f.sqlFormatOp,b=g.sqlOp||g.sqlFormatOp;if(m||b){if(!m&&b){y=!0;var O=[v,i];i=O[0],v=O[1];var A=[g,f];f=A[0],g=A[1]}var S,F=[],w=[];if(null!=c){var j=c.map((function(e,n){var l=u?u.get(n):null,a=s?s.get(n):null,c=Ho(e,l,t),v=No(t,o,i,l),g=mi(t,o,i,v,l,{forExport:!0}),h=sa(r,t,c,l,a,g,p,i,f,d);return void 0!==h&&(F.push(l),w.push(a)),h}));if(j.filter((function(e){return void 0===e})).size>0||j.size<h)return;S=1==h?j.first():j}var E=f.sqlFormatOp||function(e,t){var r,n=t.sqlOp||e,o=G(t);return 0==o?r=function(e,t,r,o,l,i,a,u){return"".concat(e," ").concat(n)}:1==o?r=function(e,t,r,o,l,i,a,u){return"".concat(e," ").concat(n," ").concat(r)}:2==o&&(r=function(e,t,r,o,l,i,a,u){var s,c,d=null==r||null===(s=r.first)||void 0===s?void 0:s.call(r),p=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(n," ").concat(d," AND ").concat(p)}),r}(i,f);if(E){var C="func"==l?da(r,t,o):ca(r,t,o);if(null!=C){var L,k=[C,i,S,F.length>1?F:F[0],w.length>1?w:w[0],B(f,M),a,p];if(L=E.call.apply(E,[t.ctx].concat(k)),y&&(L=t.settings.sqlFormatReverse.call(t.ctx,L)),void 0!==L)return L;r.errors.push("Operator ".concat(i," is not supported for value source ").concat(F.join(", ")))}}else r.errors.push("Operator ".concat(i," is not supported"))}else r.errors.push("Operator ".concat(i," is not supported"))}},sa=function(e,t,r,n,o,l,i,a,u,s){if(void 0!==r){var c;if("field"==n)c=ca(e,t,r);else if("func"==n)c=da(e,t,r);else if("function"==typeof(null==l?void 0:l.sqlFormatValue)){var d=l.sqlFormatValue,p=[r,na(na({},pe()(i,["fieldSettings","listValues"])),{},{asyncListValues:s}),B(l,R)];if(a&&(p.push(a),p.push(u)),"field"==n){var f=hi(t,r)||{};p.push(f)}c=d.call.apply(d,[t.ctx].concat(p))}else c=Array.isArray(r)?r.map((function(e){return Ct.escape(e)})):Ct.escape(r);return c}},ca=function(e,t,r){if(r){var n=t.settings.fieldSeparator,o=hi(t,r)||{},l=ci(r,t),i=_o(r,t),a=i?i.join(n):null;return(0,t.settings.formatField)(Ro(r,t,e,null,{useTableName:!0}),l,a,o,t)}},da=function(e,t,r){var n,o,l=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),i=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),a=ii(t,l);if(a){var u=ci(l,t),s=u[u.length-1],c=a.sqlFunc||s,d={},p=[],f=[];for(var v in a.args){var g,h=a.args[v],y=hi(t,h),m=h.defaultValue,b=h.isOptional,O=null!=m&&m.func?"func":"value",A=i?i.get(v):void 0,S=A?A.get("value"):void 0,F=A?A.get("valueSrc"):void 0;"func"!==F&&null!==(g=S)&&void 0!==g&&g.toJS&&(S=S.toJS());var w=A?A.get("asyncListValues"):void 0,j=sa(e,t,S,F,h.type,y,h,null,null,w);if(null!=S&&void 0===j)return void("func"!=F&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(l)));var E=void 0;if(void 0===j&&!b&&null!=m&&void 0===(E=sa(e,t,m,O,h.type,y,h,null,null,w)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(l)));var C=null!=j?j:E;if(void 0!==C){if(p.length){var L,k=ea(v);try{for(k.s();!(L=k.n()).done;)d[L.value]=void 0}catch(e){k.e(e)}finally{k.f()}p=[]}d[v]=C}else b||f.push(v),p.push(v)}if(!f.length){var _;if("function"==typeof a.sqlFormatFunc){var P=a.sqlFormatFunc,V=[d];_=P.call.apply(P,[t.ctx].concat(V))}else{var I=Object.entries(d).map((function(e){var t=(0,T.A)(e,2);return t[0],t[1]})).join(", ");_="".concat(c,"(").concat(I,")")}return _}}else e.errors.push("Func ".concat(l," is not defined in config"))};function pa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function va(e,t,r,n,o,l){if(e&&r&&null!=t){var i=r,a=n.operators[i];if(a){var u=a.elasticSearchQueryType,s=!1;!u&&a.reversedOp&&(s=!0,i=a.reversedOp,u=(a=n.operators[i]).elasticSearchQueryType);var c=No(n,e,i,o),d=n.widgets[c];if(d){var p,f,v=d.elasticSearchFormatValue;if(p="function"==typeof u?u(c):u)return f="function"==typeof v?v(p,t,i,e,n):function(e,t,r,n,o,l){var i=function(e,t){return e}(n);switch(e){case"filter":return{script:o.operators[r].elasticSearchScript(n,t)};case"exists":return{field:n};case"match":return(0,_.A)({},i,t[0]);case"term":return l===ga?(0,_.A)({},n,{value:t[0]}):(0,_.A)({},n,t[0]);case"geo_bounding_box":return(0,_.A)({},n,function(e){if(null==e)return null;var t=e.split(",").map(Number);return{top_left:{lat:t[0],lon:t[1]},bottom_right:{lat:t[2],lon:t[3]}}}(t[0]));case"range":return(0,_.A)({},n,function(e,t){if(e.length>1)return{gte:"".concat(e[0]),lte:"".concat(e[1])};var r=e[0];switch(t){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}(t,r));case"wildcard":return(0,_.A)({},n,function(e){return{value:"*"+e+"*"}}(t[0]));case"regexp":return(0,_.A)({},n,function(e){return{value:e}}(t[0]));default:return}}(p,t,i,e,n,l),s?{bool:{must_not:(0,_.A)({},p,fa({},f))}}:(0,_.A)({},p,fa({},f))}}}}var ga="ES_7_SYNTAX",ha="ES_6_SYNTAX";function ya(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ha,n=zl(t,void 0,!1);if(e){var o=e.get("type"),l=e.get("properties")||new Map;if("rule"===o&&l.get("field")){var i,a,u,s=l.get("operator"),c=l.get("field"),d=l.get("fieldSrc"),p=null===(i=l.get("value"))||void 0===i?void 0:i.toJS(),f=(null===(a=l.get("valueType"))||void 0===a||a.get(0),null===(u=l.get("valueSrc"))||void 0===u?void 0:u.get(0));if("func"===f||"func"==d)return;return p&&Array.isArray(p[0])?p[0].map((function(e){return va(c,[e],s,n,f,r)})):va(c,p,s,n,f,r)}if("group"===o||"rule_group"===o){var v=l.get("not"),g=l.get("conjunction");return g||(g=Mr(n)),function(e,t,r,n,o,l){if(e&&e.size){var i=e.valueSeq().toArray(),a=function(e,t){switch(e){case"AND":return t?"must_not":"must";case"OR":return t?"should_not":"should";case"NOT":return t?"must":"must_not";default:return}}(t,r),u=i.map((function(e){return n(e,o,l)})).filter((function(e){return void 0!==e}));if(u.length){var s=u.flat(1/0);return{bool:(0,_.A)({},a,s)}}}}(e.get("children1"),g,v,ya,n,r)}}}var ma=r(68127),ba=r(63477),Oa=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function Aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Sa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sa(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var wa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return function(){var n=(0,ba.A)(ce().mark((function n(o,l,i){var a,u,s,c,d,p;return ce().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=null!=(null==i?void 0:i.pageSize)?i.pageSize:t,u=Fe(e).filter((function(e){var t=e.title,r=e.value;return null==o||-1!=t.toUpperCase().indexOf(o.toUpperCase())||-1!="".concat(r).toUpperCase().indexOf(o.toUpperCase())})),a&&Math.ceil(u.length/a),s=l||0,a&&Math.ceil(s/a),c=a?u.slice(s,s+a):u,d=a?s+c.length:null,p=!!a&&d<u.length,!r){n.next=11;break}return n.next=11,re(r);case 11:return n.abrupt("return",{values:c,hasMore:p});case 12:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}()},ja=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)return e;var o=e||[],l=t.filter((function(e){return null==o.find((function(t){return""+t.value==""+e.value}))})).map((function(e){return n?Fa(Fa({},e),{},{isHidden:!0}):e}));return r?[].concat((0,P.A)(l),(0,P.A)(o)):[].concat((0,P.A)(o),(0,P.A)(l))},Ea=function(e,t,r){var n,o=null==e||""==e?void 0:null!==(n=null==e?void 0:e.value)&&void 0!==n?n:e,l=ke(o,t),i=r&&!l?Se(o):void 0,a=l||i;return[o,a?[a]:void 0]},Ca=function(e,t,r){var n=e.map((function(e,n){var o,l=null==e||""==e?void 0:null!==(o=null==e?void 0:e.value)&&void 0!==o?o:e,i=ke(l,t),a=r&&!i?Se(l):void 0;return i||a})).filter((function(e){return null!=e})),o=n.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e}));return o.length||(o=void 0),[o,n]},La=function(e){if(null==e)return null;var t=e.title,r=e.value,n=e.disabled,o=e.groupTitle,l=e.grouplabel,i=e.renderTitle,a=e.children,u=e.label,s=e.isCustom,c=e.isHidden,d=(0,ma.A)(e,Oa),p={value:r,title:t||u||a};return n&&(p.disabled=n),s&&(p.isCustom=s),c&&(p.isHidden=c),(o||l)&&(p.groupTitle=o||l),i&&(p.renderTitle=i),Fa(Fa({},p),d)},ka=function(e){var t,r=[],n=[],o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Aa(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Aa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}(e);try{var l=function(){var e=t.value,o=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,P.A)(e).reverse().findIndex(t);return-1==r?-1:e.length-1-r}(r,(function(t){var r,n;return(null!==(r=t.groupTitle)&&void 0!==r?r:"")==(null!==(n=e.groupTitle)&&void 0!==n?n:"")}));null==e.groupTitle||n.includes(e.groupTitle)||(n.push(e.groupTitle),1===n.length&&(r=r.map((function(e){return Fa(Fa({},e),{},{groupTitle:""})})))),null==e.groupTitle&&n.length&&(e=Fa(Fa({},e),{},{groupTitle:""})),-1!=o?r.splice(o+1,0,e):r.push(e)};for(o.s();!(t=o.n()).done;)l()}catch(e){o.e(e)}finally{o.f()}return r},_a={label:"Now",returnType:"datetime",jsonLogic:"now",jsonLogicCustomOps:{now:{}},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},mongoFormatFunc:function(){return new Date},formatFunc:function(){return"NOW"}},Ta={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim,l=r+(o.charAt(0).toUpperCase()+o.slice(1)+"s");return"".concat(t,".").concat(l,"(").concat(n,")")},spelImport:function(e){var t,r,n,o,l=null===(t=e.methodName)||void 0===t?void 0:t.match(/^(minus|plus)(\w+)s$/);if(l&&(o=l[2].toLowerCase(),r=l[1],["minus","plus"].includes(r)&&["day","week","month","year"].includes(o)))return r={type:"string",val:r},o={type:"string",val:o},n=e.args[0],{date:e.obj,op:r,val:n,dim:o}},jsonLogic:function(e){var t=e.date,r=e.op;return{date_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]);return[t,e.date_add[1]>=0?"plus":"minus",r,e.date_add[2]]},jsonLogicCustomOps:{date_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(n)*("minus"==r?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},mongoFormatFunc:null,formatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return n?"".concat(t," ").concat("minus"==r?"-":"+"," ").concat(n," ").concat(o):t},args:{date:{label:"Date",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["func","field","value"],spelEscapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},spelEscapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],spelEscapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{day:"day",week:"week",month:"month",year:"year"}},spelEscapeForFormat:!1}}},Pa={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Va={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Ia={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,n=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(n,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelImport:function(e){var t,r;if("op-plus"===e.type){var n=(0,T.A)(e.children,2);if(r=n[0],t=n[1],"op-multiply"===r.type){var o=(0,T.A)(r.children,2);return{coef:o[0],val:o[1],bias:t}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias;return{$sum:[{$multiply:[t,e.val]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias;return{"+":[{"*":[t,e.val]},r]}},jsonLogicImport:function(e){return[e["+"][0]["*"][0],e["+"][0]["*"][1],e["+"][1]]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}};const xa={utils:{SqlString:Ct,moment:Qe(),mongoFormatOp1:function(e,t,r,n,o,l,i,a,u,s,c,d){var p="string"!=typeof n||n.startsWith("$")?n:"$"+n,f=t(l,d);if(void 0!==f)return r?i||e&&"$eq"!=e?i?{$not:(0,_.A)({},e,[p,f])}:(0,_.A)({},n,{$not:(0,_.A)({},e,f)}):(0,_.A)({},n,{$ne:f}):i||e&&"$eq"!=e?i?(0,_.A)({},e,[p,f]):(0,_.A)({},n,(0,_.A)({},e,f)):(0,_.A)({},n,f)},mongoFormatOp2:function(e,t,r,n,o,l,i,a,u,s,c){var d="string"!=typeof r||r.startsWith("$")?r:"$"+r;return t?l?{$not:{$and:[(0,_.A)({},e[0],[d,o[0]]),(0,_.A)({},e[1],[d,o[1]])]}}:(0,_.A)({},r,{$not:(0,_.A)((0,_.A)({},e[0],o[0]),e[1],o[1])}):l?{$and:[(0,_.A)({},e[0],[d,o[0]]),(0,_.A)({},e[1],[d,o[1]])]}:(0,_.A)({},r,(0,_.A)((0,_.A)({},e[0],o[0]),e[1],o[1]))},mongoEmptyValue:kt,escapeRegExp:Y,sqlEmptyValue:Lt,stringifyForDisplay:It,getTitleInListValues:je,spelEscape:Tt,spelFixList:_t,wrapWithBrackets:xt}};function Da(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Na(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ra(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Na(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Na(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ma={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,n,o,l,i,a,u){var s=a?"=":l.label;return"boolean"==o&&a?"No"==r?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(s," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},jsonLogic:"==",elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,n,o,l,i,a,u){return"boolean"==o&&a?"No"==r?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(l.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},jsonLogic:"!="},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(e){return e},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(e){return e},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return e},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(e){return e},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:function(e,t,r){return{in:[r,e]}},jsonLogic2:"#in",valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!0].concat(n))},jsonLogic:function(e,t,r){return{"!":{in:[r,e]}}},jsonLogic2:"#!in",_jsonLogicIsExclamationOp:!0,valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?"^"+t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e)+"$":void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,l,i,a){var u=r.first(),s=r.get(1);return a?"".concat(e," BETWEEN ").concat(u," AND ").concat(s):"".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s)},spelFormatOp:function(e,t,r,n,o,l,i,a){var u=r[0],s=r[1];return"".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return"time"===e?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,l,i,a){var u=r.first(),s=r.get(1);return a?"".concat(e," NOT BETWEEN ").concat(u," AND ").concat(s):"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},spelFormatOp:function(e,t,r,n,o,l,i,a){var u=r[0],s=r[1];return"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",jsonLogic:function(e,t,r){return{"!":{"<=":[Array.isArray(r)?r[0]:r,e,Array.isArray(r)?r[1]:r]}}},jsonLogic2:"!<=",_jsonLogicIsExclamationOp:!0,validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,n,o,l,i,a){return a?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,n,o,l,i,a){var u=this.utils.sqlEmptyValue(a);return"COALESCE(".concat(e,", ").concat(u,") = ").concat(u)},spelFormatOp:function(e,t,r,n,o,l,i,a){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,n,o,l,i,a){return a?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,n,o,l,i,a){var u=this.utils.sqlEmptyValue(a);return"COALESCE(".concat(e,", ").concat(u,") <> ").concat(u)},spelFormatOp:function(e,t,r,n,o,l,i,a){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,n,o,l,i,a){return a?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,n,o,l,i,a){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,n,o,l,i,a){return a?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,n,o,l,i,a){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,l,i,a){var u=a?"=":"==";return"".concat(e," ").concat(u," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,l,i,a){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,n,o,l,i,a){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,l,i,a){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):void 0},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,n,o,l,i,a){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,l,i,a){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e){return e},!1].concat(r))},reversedOp:"select_any_in",jsonLogic:function(e,t,r){return{"!":{in:[e,r]}}},jsonLogic2:"!in",_jsonLogicIsExclamationOp:!0},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",formatOp:function(e,t,r,n,o,l,i,a){return"value"==n?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",formatOp:function(e,t,r,n,o,l,i,a){return"value"==n?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains",jsonLogic2:"!some-in",jsonLogic:function(e,t,r){return{"!":{some:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,l,i,a){var u=a?"=":"==";return"value"==n?"".concat(e," ").concat(u," [").concat(r.join(", "),"]"):"".concat(e," ").concat(u," ").concat(r)},sqlFormatOp:function(e,t,r,n,o,l,i,a){var u=this;return"value"==n?"".concat(e," = '").concat(r.map((function(e){return u.utils.SqlString.trim(e)})).join(","),"'"):void 0},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",formatOp:function(e,t,r,n,o,l,i,a){return"value"==n?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,n,o,l,i,a){var u=this;return"value"==n?"".concat(e," != '").concat(r.map((function(e){return u.utils.SqlString.trim(e)})).join(","),"'"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"multiselect_equals",jsonLogic2:"!all-in",jsonLogic:function(e,t,r){return{"!":{all:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,n,o,l,i,a){var u=r.first(),s=r.get(1),c=null==i?void 0:i.get("proximity");return"".concat(e," ").concat(u," NEAR/").concat(c," ").concat(s)},sqlFormatOp:function(e,t,r,n,o,l,i,a){var u=r.first(),s=r.get(1),c=this.utils.SqlString.trim(u),d=this.utils.SqlString.trim(s),p=null==i?void 0:i.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(c,", ").concat(d,"), ").concat(p,")')")},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return 0},!1].concat(r))}}},qa={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var n=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,n)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return n?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,l=e.map((function(e){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e)}));return n?l.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o){var l=this;return e.map((function(e){return l.utils.SqlString.escape(e)}))},spelFormatValue:function(e,t,r,n,o){var l=o&&o.spelOp&&o.spelOp.startsWith("${1}"),i=this.utils.spelEscape(e);return l&&(i=this.utils.spelFixList(i)),i},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var l=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(l.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,n,o){var l=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD");return"T(java.time.LocalDate).parse('".concat(l,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o,l,i;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&null!==(n=r.fmt)&&void 0!==n&&null!==(n=n.value)&&void 0!==n&&null!==(o=n.includes)&&void 0!==o&&o.call(n," ")||null!==(l=r.fmt)&&void 0!==l&&null!==(l=l.value)&&void 0!==l&&null!==(i=l.toLowerCase)&&void 0!==i&&i.call(l).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var a=this.utils.moment(e.value,this.utils.moment.ISO_8601);return a.isValid()?[a.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var l=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(l.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,n,o){var l=this.utils.moment(e,r.valueFormat).format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(l,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var n,o,l;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&r.fmt&&(null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.toLowerCase)||void 0===o||!o.call(n).includes("hh:mm")||null!==(l=r.fmt)&&void 0!==l&&null!==(l=l.value)&&void 0!==l&&l.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,"HH:mm:ss");return i.isValid()?[i.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?60*r.get("hour")*60+60*r.get("minute")+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},elasticSearchFormatValue:function(e,t,r,n){return{script:{script:{source:"doc[".concat(n,"][0].getHour() >== params.min && doc[").concat(n,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){var l=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(l.toDate())},spelFormatValue:function(e,t,r,n,o){var l=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD HH:mm:ss");return"T(java.time.LocalDateTime).parse('".concat(l,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd HH:mm:ss","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o;if(!t)return[void 0,"No widget def to get value format"];if(null==r||null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.includes)||void 0===o||!o.call(n," "))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,this.utils.moment.ISO_8601);return l.isValid()?[l.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return n.isValid()?n.toDate():void 0}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,n){return n?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,n,o,l,i){return n&&i.label||e},sqlFormatValue:function(e,t,r,n,o,l){return e},spelFormatValue:function(e,t,r,n,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(""===e?null:e)},spelImportValue:function(e){return[e.value,[]]},jsonLogic:function(e){return""===e?null:e}}},Wa=Ra(Ra({},_l),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,n,o,l){var i=this,a=n.map((function(e,t){var r=e.key,n=e.parent,o=e.fieldSeparator;return 0==t?"[map]"==n?"#this[".concat(i.utils.spelEscape(r),"]"):r:"map"==n||"[map]"==n?"[".concat(i.utils.spelEscape(r),"]"):"".concat(o).concat(r)})).join("");return o.fieldName&&(a=e),o.isSpelVariable&&(a="#"+a),a},sqlFormatReverse:function(e){if(null!=e)return"NOT"+this.utils.wrapWithBrackets(e)},spelFormatReverse:function(e){if(null!=e)return"!"+this.utils.wrapWithBrackets(e)},formatReverse:function(e,t,r,n,o,l){if(null!=e)return l?"NOT "+this.utils.wrapWithBrackets(e):"!"+this.utils.wrapWithBrackets(e)},formatAggr:function(e,t,r,n,o,l,i,a,u,s){var c=i.labelForFormat,d=i.cardinality;if(0==d){var p=e?" HAVE ".concat(e):"";return"".concat(c," OF ").concat(t).concat(p)}if(null==d||1==d){var f=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(f," ").concat(c," ").concat(n)}if(2==d){var v=e?" WHERE ".concat(e):"",g=n.first(),h=n.get(1);return"COUNT OF ".concat(t).concat(v," ").concat(c," ").concat(g," AND ").concat(h)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,n){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),Ba=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={rangeslider:Ua,treeselect:$a,treemultiselect:Ja,rangeable__date:za("date","date")},l=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Da(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Da(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}(t);try{for(l.s();!(r=l.n()).done;){var i=r.value,a=o[i];if(!a)throw new Error("Can't ".concat(n?"add":"remove"," mixin ").concat(i));e=a(e,n)}}catch(e){l.e(e)}finally{l.f()}return e},Ga=function(e,t){return Ba(e,t,!0)},za=function(e,t){return function(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=r.types;return o=Ra(Ra({},o),{},(0,_.A)({},e,Ra(Ra({},o[e]),{},{widgets:Ra({},o[e].widgets)}))),n?o[e].widgets[t]=Ra({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],Ra(Ra({},r),{},{types:o})}},Ua=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Ra({},r),t?r.rangeslider=Ra({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},singleWidget:"slider",toJS:function(e,t){return e}},r.rangeslider):delete r.rangeslider,n=Ra(Ra({},n),{},{number:Ra(Ra({},n.number),{},{widgets:Ra({},n.number.widgets)})}),t?n.number.widgets.rangeslider=Ra({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},n.number.widgets.rangeslider):delete n.number.widgets.rangeslider,Ra(Ra({},e),{},{widgets:r,types:n})},$a=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Ra({},r),t?r.treeselect=Ra({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,l=this.utils.getTitleInListValues(o,e);return n?this.utils.stringifyForDisplay(l):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treeselect):delete r.treeselect,n=Ra({},n),t?n.treeselect=Ra({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},n.treeselect):delete n.treeselect,Ra(Ra({},e),{},{widgets:r,types:n})},Ja=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Ra({},r),t?r.treemultiselect=Ra({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,l=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,i=e.map((function(e){return o.utils.getTitleInListValues(l,e)}));return n?i.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o){var l=this;return e.map((function(e){return l.utils.SqlString.escape(e)}))},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treemultiselect):delete r.treemultiselect,n=Ra({},n),t?n.treemultiselect=Ra({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},n.treemultiselect):delete n.treemultiselect,Ra(Ra({},e),{},{widgets:r,types:n})},Ha={addMixins:Ga,removeMixins:function(e,t){return Ba(e,t,!1)}},Ka={conjunctions:{AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,n){var o=e.size>1?e.join(" "+(n?"AND":"&&")+" "):e.first();return(e.size>1||r)&&(o=this.utils.wrapWithBrackets(o)),r&&(o="NOT "+o),o},sqlFormatConj:function(e,t,r){var n=e.size>1?e.join(" AND "):e.first();return(e.size>1||r)&&(n=this.utils.wrapWithBrackets(n)),r&&(n="NOT "+n),n},spelFormatConj:function(e,t,r,n){r&&(n=!1);var o=e.size>1?e.join(" && "):e.first();return(e.size>1||r)&&!n&&(o=this.utils.wrapWithBrackets(o)),r&&(o="!"+o),o}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){return e.size>1?(r?"NOT ":"")+"("+e.join(" OR ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" || ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},operators:Ma,widgets:qa,types:{text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{widgetProps:{}}}}},settings:Wa,ctx:xa};const Ya=Ka=Ga(Ka,["rangeslider","treeselect","treemultiselect"]);var Qa="ADD_GROUP",Xa="ADD_CASE_GROUP",Za="REMOVE_GROUP",eu="SET_CONJUNCTION",tu="SET_NOT",ru="ADD_RULE",nu="REMOVE_RULE",ou="SET_FIELD",lu="SET_FIELD_SRC",iu="SET_OPERATOR",au="SET_VALUE",uu="SET_VALUE_SRC",su="SET_FUNC_VALUE",cu="SET_OPERATOR_OPTION",du="SET_LOCK",pu="SET_TREE",fu="MOVE_ITEM",vu="after",gu="before",hu="append",yu="prepend",mu="SET_DRAG_PROGRESS",bu="SET_DRAG_START",Ou="SET_DRAG_END",Au=r(97932),Su=r.n(Au);function Fu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fu(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ju(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Eu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Eu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}function Eu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Cu=function(e,t,r,n,o,l){var i,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(_e(t)))return e;var s=(null==o||null===(i=o.get)||void 0===i?void 0:i.call(o,"id"))||n,c=l.settings.shouldCreateEmptyGroup,d=t.push(s),p=!c,f=!(null==u||!u.isDefaultCase),v=e;return(e=Lu(e,t,r,s,qr(l).merge((0,I.ss)(o)||{}),l,a))!==v&&(a||f||(e=e.setIn(_e(d,"children1"),new I.Ay.OrderedMap),p&&(e=Lu(e,d,"rule",D(),Nr(l),l))),e=Ie(e)),e},Lu=function(e,t,r,n,o,l){var i,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("switch_group"===r)throw new Error("Can't add switch_group programmatically");var u=e.getIn(_e(t));if(!u)return e;var s,c,d=(null==o||null===(i=o.get)||void 0===i?void 0:i.call(o,"id"))||n,p=l.settings,f=p.maxNumberOfCases,v=p.maxNumberOfRules,g=p.maxNesting,h="switch_group"===e.get("type"),y=h?e.getIn(_e(t.take(2))):null,m=_e(t,"children1"),b=e.getIn(m),O=!!b&&b.size,A=O?b.size:null;"case_group"===r?(s=A,c=f):"group"===r?(s=t.size,c=g):"rule_group"===(null==u?void 0:u.get("type"))||(s=Re(h?y:e),c=v);var S=!c||!s||s<c,F={type:r,id:d,properties:o};Vu(l,F,a);var w="case_group"===r&&O&&null==b.last().get("children1");if(S){var j=new I.Ay.OrderedMap((0,_.A)({},d,new I.Ay.Map(F)));if(O)if(w){var E=b.last(),C=new I.Ay.OrderedMap((0,_.A)((0,_.A)({},d,new I.Ay.Map(F)),E.get("id"),E));e=(e=e.deleteIn(_e(m,"children1",E.get("id")))).mergeIn(m,C)}else e=e.mergeIn(m,j);else e=e.setIn(m,j);e=Ie(e)}return e},ku=function(e,t){return e=e.deleteIn(_e(t)),Ie(e)},_u=function(e,t,r,n,o){var l,i,a,u,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},c=e.getIn(_e(t));if(!c)return{state:e};var d=s.isEndValue,p=s.canDropArgs;if(!r)return{state:e=ku(e,t)};var f=n.settings,v=f.fieldSeparator,g=f.setOpOnChangeField,h=f.showErrorMessage;Array.isArray(r)&&(r=r.join(v));var y=c.get("type"),m=c.get("properties"),b="rule_group"==y,O=null==m?void 0:m.get("fieldSrc"),A=hi(n,r);if(!A)return console.warn("No config for LHS ".concat(r)),{state:e};var S=A.type;"!group"!==S&&"!struct"!==S||(S=null);var F=null==m?void 0:m.get("operator"),w=null==m?void 0:m.get("operatorOptions"),j=null==m?void 0:m.get("field"),E="!group"==A.type,C=E&&"array"==A.mode,L=b!=E,k=A&&-1!==(null===(l=A.operators)||void 0===l?void 0:l.indexOf(F))?F:null,_="func"===O&&(null==j||null===(i=j.get)||void 0===i?void 0:i.call(j,"func"))===(null===(a=r)||void 0===a||null===(u=a.get)||void 0===u?void 0:u.call(a,"func"))&&!!k,T=null,P="func"===O?jo(n,S):Eo(n,r);if(P&&1==P.length)T=P[0];else if(_)T=k;else if(P&&P.length>1){var V,x=ju(g);try{for(x.s();!(V=x.n()).done;){var N=V.value;if("keep"!=N||L?"default"==N?T=xr(n,r,!1):"first"==N&&(T=Co(n,r)):T=k,T)break}}catch(e){x.e(e)}finally{x.f()}}if(!E&&!A.operators)return console.warn("Type ".concat(A.type," is not supported")),{state:e};b&&!E&&(e=(e=(e=e.setIn(_e(t,"type"),"rule")).deleteIn(_e(t,"children1"))).setIn(_e(t,"properties"),new I.Ay.OrderedMap)),m||(e=e.setIn(_e(t,"properties"),new I.Ay.OrderedMap));var R=!h;if(E){e=e.setIn(_e(t,"type"),"rule_group");var M=vo(n,n,m,r,T,"field",R,d,p),q=(M.canReuseValue,M.newValue),W=M.newValueSrc,B=M.newValueType,G=M.operatorCardinality,z=qr(n,A).merge({field:r,fieldSrc:"field",mode:A.mode});C&&(z=z.merge({operator:T,value:q,valueSrc:W,valueType:B})),e=(e=e.setIn(_e(t,"children1"),new I.Ay.OrderedMap)).setIn(_e(t,"properties"),z),A.initialEmptyWhere&&1==G||(e=Lu(e,t,"rule",D(),Nr(n,r),n)),e=Ie(e)}else e=e.updateIn(_e(t,"properties"),(function(e){return e.withMutations((function(e){var t=vo(n,n,e,r,T,"field",R,d,p),o=t.canReuseValue,l=t.newValue,i=t.newValueSrc,a=t.newValueType,u=t.newValueError,s=t.newFieldError,c=t.fixedField,f=r;c!==r&&(f=c),h&&(e=(e=e.set("fieldError",s)).set("valueError",u));var v=o?w:Dr(n,T,f);return e=e.set("field",f).delete("fieldType").set("fieldSrc",O).set("operator",T).set("operatorOptions",v).set("value",l).set("valueSrc",i).set("valueType",a),o||(e=e.delete("asyncListValues")),e}))}));return{state:e}},Tu=function(e,t,r,n,o,l,i){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(_e(t)))return{state:e};var u=a.canDropArgs,s=a.isEndValue,c=l.settings,d=c.fieldSeparator,p=c.showErrorMessage,f=e.getIn(_e(t,"properties","valueSrc",r+""))||null;"field"===f&&Array.isArray(n)&&(n=n.join(d));var v=e.getIn(_e(t,"properties","field"))||null,g=e.getIn(_e(t,"properties","operator"))||null,h=yi(l,g,v),y=g?G(h):null,m=o||Lo(n,f,l),b=uo(l,v,v,g,n,m,f,i,!p,s,u),O=(0,T.A)(b,2),A=O[0],S=O[1],F=null==S?void 0:S.find((function(e){return!e.fixed&&!e.ignore})),w=F?$n(F):null,j=A!==n;j&&(n=A),e=Pu(e,t,l,y);var E=Array.from({length:y},(function(o,l){return l==r?n:e.getIn(_e(t,"properties","value",l+""))||null})),C=Array.from({length:y},(function(r,n){return e.getIn(_e(t,"properties","valueSrc",n+""))||null})),L=fo(l,v,g,E,C),k=L?$n(L):null;return(!!p||!w&&!k||j)&&(e=e.deleteIn(_e(t,"properties","asyncListValues")),void 0===n?e=(e=e.setIn(_e(t,"properties","value",r),void 0)).setIn(_e(t,"properties","valueType",r),null):(i&&(e=e.setIn(_e(t,"properties","asyncListValues"),i)),e=(e=e.setIn(_e(t,"properties","value",r),n)).setIn(_e(t,"properties","valueType",r),m))),p&&(e.getIn(_e(t,"properties","valueError"))||(e=e.setIn(_e(t,"properties","valueError"),new I.Ay.List(new Array(y)))),e=e.setIn(_e(t,"properties","valueError",r),w),y>=2&&(e=e.setIn(_e(t,"properties","valueError",y),k))),{state:e}},Pu=function(e,t,r,n){if(!n){var o=e.getIn(_e(t,"properties","field"))||null,l=e.getIn(_e(t,"properties","operator"))||null,i=yi(r,l,o);n=l?G(i):null}for(var a=0,u=["value","valueType","valueError","valueSrc"];a<u.length;a++){var s=u[a];e.getIn(_e(t,"properties",s))||(e=e.setIn(_e(t,"properties",s),new I.Ay.List(n?Array.from({length:n}):[])))}return e},Vu=function e(t,r,n){n&&Array.isArray(n)&&(r.children1=new I.Ay.OrderedMap(n.reduce((function(r,n){var o,l=null!==(o=n.id)&&void 0!==o?o:D(),i=wu(wu({},n),{},{properties:Wr(t,n).merge((0,I.ss)(n.properties)||{}),id:l});return e(t,i,i.children1),wu(wu({},r),{},(0,_.A)({},l,new I.Ay.Map(i)))}),{})))},Iu={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},xu=function(e,t){return{type:pu,tree:t,config:e}},Du=function(e,t,r){var n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return{type:ru,ruleType:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rule",children:arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,path:H(t),id:D(),properties:Nr(e,n).merge((0,I.ss)(r)||{}),config:e}},Nu=function(e,t){return{type:nu,path:H(t),config:e}},Ru=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:Xa,path:H(t),children:n,id:D(),properties:qr(e).merge((0,I.ss)(r)||{}),config:e,meta:{isDefaultCase:!0}}},Mu=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:Xa,path:H(t),children:n,id:D(),properties:qr(e).merge((0,I.ss)(r)||{}),config:e}},qu=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:Qa,path:H(t),children:n,id:D(),properties:qr(e).merge((0,I.ss)(r)||{}),config:e}},Wu=function(e,t){return{type:Za,path:H(t),config:e}},Bu=function(e,t,r,n){return{type:fu,fromPath:H(t),toPath:H(r),placement:n,config:e}},Gu=function(e,t,r){return{type:eu,path:H(t),conjunction:r}},zu=function(e,t,r){return{type:tu,path:H(t),not:r}},Uu=function(e,t,r){return{type:du,path:H(t),lock:r}},$u=function(e,t,r,n,o){return{type:ou,path:H(t),field:r,config:e,asyncListValues:n,_meta:o}},Ju=function(e,t,r){return{type:lu,path:H(t),srcKey:r,config:e}},Hu=function(e,t,r){return{type:iu,path:H(t),operator:r,config:e}},Ku=function(e,t,r,n,o,l,i){return{type:au,path:H(t),delta:r,value:n,valueType:o,asyncListValues:l,config:e,_meta:i}},Yu=function(e,t,r,n,o){return{type:uu,path:H(t),delta:r,srcKey:n,config:e,_meta:o}},Qu=function(e,t,r,n,o,l,i,a,u){return{type:su,path:H(t),delta:r,parentFuncs:n,argKey:o,value:l,valueType:i,asyncListValues:a,config:e,_meta:u}},Xu=function(e,t,r,n){return{type:cu,path:H(t),name:r,value:n,config:e}};function Zu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function es(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zu(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ts=es(es(es({},g),{},{Export:f,Import:a,ConfigMixins:Ha},f),a),rs=r(5821),ns=r.n(rs);const os=function(e,t,r,n,o){var l=wu({tree:t},Iu);return function(){var t,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,u=arguments.length>1?arguments[1]:void 0,s=null!==(t=null!==(i=null==o?void 0:o())&&void 0!==i?i:null==u?void 0:u.config)&&void 0!==t?t:e,c={},d=function(e,t){if(!e||!e.type)return null;var r,n=[pu,bu,mu,Ou],o=Su()(he()(e,["config","asyncListValues"]),K),l=e.path&&function(e,t){return e.getIn(_e(t,"properties","field"))||null}(t.tree,e.path)||e.field;return l&&(null!==(r=l)&&void 0!==r&&r.toJS&&(l=l.toJS()),o.affectedField=l),(n.includes(e.type)||0==e.type.indexOf("@@redux"))&&(o=null),o}(u,a);switch(null==u?void 0:u.type){case pu:var p=r(s,u.tree);c.tree=p;break;case Xa:c.tree=Cu(a.tree,u.path,"case_group",u.id,u.properties,s,u.children,u.meta);break;case Qa:c.tree=Cu(a.tree,u.path,"group",u.id,u.properties,s,u.children,u.meta);break;case Za:c.tree=function(e,t,r){if(!e.getIn(_e(t)))return e;e=ku(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1);return Be(e,o)||n||(e=xe(e),!We(e)||n)||(e=Lu(e,new I.Ay.List,"rule",D(),Nr(r,void 0,void 0,!1,!1),r)),Ie(e)}(a.tree,u.path,s);break;case ru:c.tree=Lu(a.tree,u.path,u.ruleType,u.id,u.properties,s,u.children);break;case nu:c.tree=function(e,t,r){if(!e.getIn(_e(t)))return e;e=ku(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.pop(),l=e.getIn(_e(o)),i=l.getIn(["properties","field"]),a=l.getIn(["properties","operator"]),u=i?hi(r,i):null,s=a?yi(r,a,i):null,c=i&&a&&0!=s.cardinality,d="rule_group"==l.get("type"),p=!Be(e,o),f=d?c&&u.initialEmptyWhere:n;return p&&!f&&(d&&(e=e.deleteIn(_e(o))),e=xe(e),We(e)&&!n)&&(e=Lu(e,new I.Ay.List,"rule",D(),Nr(r,void 0,void 0,!1,!1),r)),Ie(e)}(a.tree,u.path,s);break;case eu:c.tree=function(e,t,r){return e.getIn(_e(t))?e=e.setIn(_e(t,"properties","conjunction"),r):e}(a.tree,u.path,u.conjunction);break;case tu:c.tree=function(e,t,r){return e.getIn(_e(t))?e=e.setIn(_e(t,"properties","not"),r):e}(a.tree,u.path,u.not);break;case ou:var f=_u(a.tree,u.path,u.field,s,u.asyncListValues,u._meta).state;c.tree=f;break;case lu:c.tree=function(e,t,r,n){var o=e.getIn(_e(t));if(!o)return e;var l=n.settings.keepInputOnChangeFieldSrc,i=o.get("properties"),a=null==i?void 0:i.get("field"),u=null==i?void 0:i.get("fieldType"),s=hi(n,a),c=(null==s?void 0:s.type)||u;c&&"!group"!==c&&"!struct"!==c||(c=null);var d=!wo.includes(c);return(e=l&&!Mo(o,n)&&d?(e=(e=e.setIn(_e(t,"properties","field"),null)).deleteIn(_e(t,"properties","fieldError"))).setIn(_e(t,"properties","fieldType"),c):e.setIn(_e(t,"properties"),Nr(n,null,null,!1))).setIn(_e(t,"properties","fieldSrc"),r)}(a.tree,u.path,u.srcKey,s);break;case du:c.tree=function(e,t,r){return e.getIn(_e(t))?e=Ve(e.setIn(_e(t,"properties","isLocked"),r)):e}(a.tree,u.path,u.lock);break;case iu:c.tree=function(e,t,r,n){var o=e.getIn(_e(t));if(!o)return e;var l=n.settings.showErrorMessage,i=o.get("properties"),a=o.get("children1"),u=i.get("field"),s=(i.get("fieldSrc"),hi(n,u)),c="!group"==(null==s?void 0:s.type),d=yi(n,r,u),p=d?G(d):null;return e=e.updateIn(_e(t,"properties"),(function(e){return e.withMutations((function(e){var t=e.get("field"),o=e.get("operatorOptions"),i=(e.get("value",new I.Ay.List),e.get("valueSrc",new I.Ay.List),e.get("operator"),vo(n,n,e,t,r,"operator",!0)),a=i.canReuseValue,u=i.newValue,s=i.newValueSrc,c=i.newValueType,d=i.newValueError;l&&(e=e.set("valueError",d));var p=a?o:Dr(n,r,t);return a||(e=e.delete("asyncListValues")),e.set("operator",r).set("operatorOptions",p).set("value",u).set("valueSrc",s).set("valueType",c)}))})),c&&0==p&&0==a.size&&(e=Lu(e,t,"rule",D(),Nr(n,u),n)),e}(a.tree,u.path,u.operator,s);break;case au:var v=Tu(a.tree,u.path,u.delta,u.value,u.valueType,s,u.asyncListValues,u._meta).state;c.tree=v;break;case su:var g=function(e,t,r,n,o,l,i,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:{},c=t.getIn(_e(r));if(!c)return t;var d,p=-1===n,f=c.get("properties"),v=f.get("field"),g=f.get("value"),h=[],y=p?v:g.getIn([n]),m=ju(o||[]);try{for(m.s();!(d=m.n()).done;){var b=(0,T.A)(d.value,2),O=b[0],A=b[1];if(h.push([O,A,y]),O!==y.get("func")){var S=h.map((function(e){var t=(0,T.A)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")||"root";throw new Error("In ".concat(p?"LHS":"RHS"," for path ").concat(S," expected func key ").concat(O," but got ").concat(parent.get("func")))}y=y.getIn(["args",A,"value"])}}catch(e){m.e(e)}finally{m.f()}if(l){var F=y.get("func"),w=ii(e,F).args[l];y="!valueSrc"===a?So(y,l,i,w,e):Ao(y,l,i,w,e)}else y=yo(y,i,e,!0),s.canDropArgs=!0;for(var j=y;h.length;){var E=h.pop(),C=(0,T.A)(E,3),L=C[0],k=C[1],_=C[2],P=ii(e,L).args[k];j=Ao(_,k,j,P,e)}return p?_u(t,r,j,e,u,s):Tu(t,r,n,j,void 0,e,u,s)}(s,a.tree,u.path,u.delta,u.parentFuncs,u.argKey,u.value,u.valueType,u.asyncListValues,u._meta),h=g.state;c.tree=h;break;case uu:c.tree=function(e,t,r,n,o){if(!e.getIn(_e(t)))return e;var l=o.settings.showErrorMessage,i=e.getIn(_e(t,"properties","field"))||null,a=e.getIn(_e(t,"properties","operator"))||null,u=yi(o,a,i),s=a?G(u):null;if(e=(e=(e=(e=Pu(e,t,o,s)).setIn(_e(t,"properties","value",r+""),void 0)).setIn(_e(t,"properties","valueType",r+""),null)).deleteIn(_e(t,"properties","asyncListValues")),l&&(e=e.setIn(_e(t,"properties","valueError",r),null),u.validateValues&&(e=e.setIn(_e(t,"properties","valueError",s),null))),e=void 0===n?e.setIn(_e(t,"properties","valueSrc",r+""),null):e.setIn(_e(t,"properties","valueSrc",r+""),n),n){var c=e.getIn(_e(t,"properties")),d=vo(o,o,c,i,a,"valueSrc",!0),p=d.canReuseValue,f=d.newValue,v=d.newValueSrc,g=d.newValueType;d.newValueError,p||v.get(r)!=n||(e=(e=e.setIn(_e(t,"properties","value",r+""),f.get(r))).setIn(_e(t,"properties","valueType",r+""),g.get(r)))}return e}(a.tree,u.path,u.delta,u.srcKey,s,u._meta);break;case cu:c.tree=function(e,t,r,n){return e.getIn(_e(t))?e.setIn(_e(t,"properties","operatorOptions",r),n):e}(a.tree,u.path,u.name,u.value);break;case fu:c.tree=function(e,t,r,n,o){var l=Pe(e,t),i=t.pop(),a=t.size>1?Pe(e,i):null,u=a?a.get("children1"):null,s=Pe(e,r),c=n==hu||n==yu?r:r.pop(),d=n==hu||n==yu?s:r.size>1?Pe(e,c):null,p=d?d.get("children1"):null;if(!a||!d||!l)return e;var f=a.get("id")==d.get("id"),v=c.size<i.size&&z(c.toArray(),i.toArray().slice(0,c.size)),g=c.size>i.size&&z(i.toArray(),c.toArray().slice(0,i.size)),h=null,y=null;v?h=I.Ay.List(i.toArray().slice(c.size)):g&&(y=I.Ay.List(c.toArray().slice(i.size)));var m=p,b=u;return g||(b=b.delete(l.get("id"))),f?m=b:v&&(m=m.updateIn(Te(h,"children1"),(function(e){return b}))),n==gu||n==vu?m=I.Ay.OrderedMap().withMutations((function(e){var t,r=ju(m.entries());try{for(r.s();!(t=r.n()).done;){var o=(0,T.A)(t.value,2),i=o[0],a=o[1];i==(null==s?void 0:s.get("id"))&&n==gu&&e.set(l.get("id"),l),e.set(i,a),i==(null==s?void 0:s.get("id"))&&n==vu&&e.set(l.get("id"),l)}}catch(e){r.e(e)}finally{r.f()}})):n==hu?m=m.merge(I.Ay.OrderedMap((0,_.A)({},l.get("id"),l))):n==yu&&(m=I.Ay.OrderedMap((0,_.A)({},l.get("id"),l)).merge(m)),g&&(b=(b=b.updateIn(Te(y,"children1"),(function(e){return m}))).delete(l.get("id"))),f||v||(e=e.updateIn(_e(i,"children1"),(function(e){return b}))),g||(e=e.updateIn(_e(c,"children1"),(function(e){return m}))),Ie(e)}(a.tree,u.fromPath,u.toPath,u.placement);break;case bu:c.dragStart=u.dragStart,c.dragging=u.dragging,c.mousePos=u.mousePos;break;case mu:c.mousePos=u.mousePos,c.dragging=u.dragging;break;case Ou:c.tree=function(e,t){return t.settings.canLeaveEmptyGroup||(e=xe(e)),e}(a.tree,s),c=wu(wu({},c),Iu)}return d&&(c.__lastAction=d),n&&c.tree&&a.tree&&n(a.tree),wu(wu(wu({},a),{__lastAction:void 0}),c)}},ls=k.createContext();var is=r(80652),as=r(91761),us="after",ss="before",cs="append",ds="prepend",ps=function(e,t){return{type:"SET_DRAG_PROGRESS",mousePos:e,dragging:t}},fs=function(e,t,r){return{type:"SET_DRAG_START",dragStart:e,dragging:t,mousePos:r}},vs=function(){return{type:"SET_DRAG_END"}},gs=y,hs=m,ys=b,ms=(r(7736),function(e,t,r){if(!t||!e||e.length<=t)return e;var n=e.substr(0,t-1);return(r?n.substr(0,n.lastIndexOf(" ")):n)+"..."}),bs=function(e,t){return e===t||(null==e?void 0:e.equals(t))},Os=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?Os(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):e&&"function"==typeof e.equals?e.equals(t):"object"===(0,V.A)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),l=n.length;if(o.length!==l)return!1;for(var i=0;i<l;i++){var a=n[i];if(!(r?Os(e[a],t[a],r):e[a]===t[a]))return!1}return!0}(e,t,r):e===t)},As=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null!=e&&e?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}}(),Ss=ts.Validation.validateAndFixTree,Fs=function e(t){if(t){var r,n=(r=t)._reactRootContainer?"root":Object.getOwnPropertyNames(r).filter((function(e){return e.startsWith("__reactContainer")})).length>0?"container":void 0;return void 0!==n?n:e(t.parentNode)}},ws=function(e){return"root"===Fs(e)},js=function(e,t){return function(r,n){var o=e.props,l=e.state,i=r!=o||n!=l;if(i&&l==n&&o!=r){var a=[];for(var u in r){var s=r[u]!=o[u];s&&("ignore"==t[u]?s=!1:"shallow_deep"==t[u]?s=!Os(r[u],o[u],!0):"shallow"==t[u]?s=!Os(r[u],o[u]):"function"==typeof t[u]&&(s=t[u](r[u],o[u],r,o))),s&&a.push(u)}a.length||(i=!1)}return i}},Es=function(e){return function(t,r){return!Os(e.props,t)||!Os(e.state,r)}},Cs=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=Es(e)),16==(r=k.version.split(".").map(parseInt.bind(null,10)))[0]&&r[1]<3||r[0]<16)e.componentWillReceiveProps=function(t){e.onPropsChanged(t)};else{var t=e.shouldComponentUpdate;e.shouldComponentUpdate=function(r,n){return!Os(e.props,r)&&e.onPropsChanged(r),t.call(e,r,n)}.bind(e)}var r},Ls=function(e,t,r){return Su()(e,(function(e){return function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r(e.apply(void 0,[t].concat(o)))}}))};function ks(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ks(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ks(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ts(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Ps()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Ps(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ps=function(){return!!e})()}var Vs=function(e){function t(e){var r;(0,w.A)(this,t),(r=Ts(this,t,[e])).shouldComponentUpdate=js(r,{tree:function(e){return e!==r.oldValidatedTree||r.oldValidatedTree!==r.validatedTree}}),Cs(r),r._updateActions(e),r.validatedTree=e.getMemoizedTree(e.config,e.tree,void 0,e.sanitizeTree),r.oldValidatedTree=r.validatedTree;var n=e.getBasicConfig(e.config);return e.onInit&&e.onInit(r.validatedTree,n,void 0,r.actions),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"_updateActions",value:function(e){var t=e.config,r=e.dispatch;this.actions=Ls(_s(_s(_s({},gs),hs),ys),t,r)}},{key:"onPropsChanged",value:function(e){var t=e.onChange,r=this.props.config,n=e.tree,o=(this.props.tree,e.config);if(this.oldValidatedTree=this.validatedTree,this.validatedTree=n,r!==o&&(this._updateActions(e),this.validatedTree=e.getMemoizedTree(o,n,r)),!bs(this.validatedTree,this.oldValidatedTree)){var l=e.getBasicConfig(o);t&&t(this.validatedTree,l,e.__lastAction,this.actions)}}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.renderBuilder,n=e.dispatch;return r({tree:this.validatedTree,actions:this.actions,config:t,dispatch:n})}}])}(k.Component);Vs.propTypes={config:ns().object.isRequired,onChange:ns().func,onInit:ns().func,renderBuilder:ns().func,tree:ns().any};var Is=(0,as.Ng)((function(e){return{tree:e.tree,__lastAction:e.__lastAction}}),null,null,{context:ls})(Vs);Is.displayName="ConnectedQuery";const xs=Is;function Ds(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Ns()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Ns(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ns=function(){return!!e})()}var Rs=ts.DefaultUtils.defaultRoot,Ms=ts.ConfigUtils.createConfigMemo,qs=function(e){function t(e,r){var n,o,l;(0,w.A)(this,t),(l=Ds(this,t,[e,r])).setLastTree=function(e){l.prevTree&&(l.prevprevTree=l.prevTree),l.prevTree=e},l.getConfig=function(){return l.config},l.shouldComponentUpdate=js(l,{value:function(e,t){return!1}}),Cs(l);var i=Ms({reactIndex:null!==(n=null===(o=l._reactInternals)||void 0===o?void 0:o.index)&&void 0!==n?n:-1,maxSize:2,canCompile:!0}),a=i.getExtendedConfig,u=i.getBasicConfig,s=i.clearConfigMemo;l.getMemoizedConfig=a,l.getBasicConfig=u,l.clearConfigMemo=s,l.getMemoizedTree=function(){var e,t,r;return function(n,o){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return o?n.__configId===r&&(bs(o,e)||bs(o,t))?t:(r=n.__configId,e=o,t=!1===i?Ss(o,null,n,l||n,!1,!1,!1):Ss(o,null,n,l||n)):null}}();var c=l.getMemoizedConfig(e),d=c.settings.shouldCreateEmptyGroup,p=Rs(c,!d),f=!!e.value,v=e.value||p,g=l.getMemoizedTree(c,v,void 0,f),h=os(c,g,l.getMemoizedTree,l.setLastTree,l.getConfig),y=(0,is.y$)(h);return l.config=c,l.state={store:y},l.QueryWrapper=function(e){return c.settings.renderProvider(e,c.ctx)},l}return(0,L.A)(t,e),(0,j.A)(t,[{key:"componentWillUnmount",value:function(){this.clearConfigMemo()}},{key:"onPropsChanged",value:function(e){var t=this.props,r=this.config,n=this.getMemoizedConfig(e),o=r!==n,l=this.state.store.getState().tree,i=!bs(e.value,this.props.value)&&!bs(e.value,l),a=i?e.value||Rs(e):l,u=i&&!bs(e.value,this.prevTree)&&!bs(e.value,this.prevprevTree);if(this.sanitizeTree=u||o,o&&(t.settings.renderProvider!==e.settings.renderProvider&&(this.QueryWrapper=function(e){return n.settings.renderProvider(e,n.ctx)}),this.config=n),i||o){var s=this.getMemoizedTree(n,a,r,this.sanitizeTree);this.state.store.dispatch(gs.setTree(n,s))}}},{key:"render",value:function(){var e=this.props,t=e.renderBuilder,r=e.get_children,n=e.onChange,o=e.onInit,l=this.state.store,i=this.config,a=this.QueryWrapper;return k.createElement(a,{config:i},k.createElement(as.Kq,{store:l,context:ls},k.createElement(xs,{config:i,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:n,onInit:o,renderBuilder:t||r})))}}])}(k.Component);qs.propTypes={conjunctions:ns().object.isRequired,fields:ns().object.isRequired,types:ns().object.isRequired,operators:ns().object.isRequired,widgets:ns().object.isRequired,settings:ns().object.isRequired,ctx:ns().object.isRequired,onChange:ns().func,onInit:ns().func,renderBuilder:ns().func,value:ns().any};var Ws=r(79570),Bs=r(30395),Gs=r.n(Bs);function zs(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Us()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Us(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Us=function(){return!!e})()}var $s=ts.ConfigUtils.getFieldConfig;function Js(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Hs()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Hs(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Hs=function(){return!!e})()}var Ks=ts.clone,Ys=ts.TreeUtils.getFlatTree,Qs=!1,Xs=["isDraggingTempo","isDraggingMe","dragging"];function Zs(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,ec()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function ec(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ec=function(){return!!e})()}const tc=function(e){return function(t){var r;return r=function(r){function n(e){var t;return(0,w.A)(this,n),(t=Zs(this,n,[e])).handleDraggerMouseDown=function(e){var r=t.props.id,n=t.wrapper.current;t.props.onDragStart&&t.props.onDragStart(r,n,e)},t.wrapper=k.createRef(),t}return(0,L.A)(n,r),(0,j.A)(n,[{key:"render",value:function(){var r=this.props,n=r.isDraggingTempo,o=r.isDraggingMe,l=r.dragging,i=(0,ma.A)(r,Xs),a=i.isTrueLocked,u={};o&&n&&(Qs||(u={top:l.y,left:l.x,width:l.w}));var s=Gs()(e,"group-or-rule",o&&n?"qb-draggable":null,o&&!n?"qb-placeholder":null,a?"locked":null);return k.createElement("div",{className:s,style:u,ref:this.wrapper,"data-id":this.props.id},k.createElement(t,(0,Ws.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:o,isDraggingTempo:n},i)))}}])}(k.PureComponent),r.propTypes={isDraggingTempo:ns().bool,isDraggingMe:ns().bool,onDragStart:ns().func,dragging:ns().object,isLocked:ns().bool,isTrueLocked:ns().bool},r}};var rc=r(3511),nc=r.n(rc),oc=r(2691),lc=r.n(oc);function ic(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ac(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,uc()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function uc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uc=function(){return!!e})()}var sc=ts.ConfigUtils,cc=sc.getFieldConfig,dc=sc.getOperatorConfig,pc=function(e){function t(e){var r;return(0,w.A)(this,t),(r=ac(this,t,[e])).shouldComponentUpdate=js(r,{selectedField:function(e,t){return!1}}),Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.selectedField,o=e.selectedFieldType,l=e.selectedOperator,i=cc(r,n),a=(0,P.A)((null==i?void 0:i.operators)||(null===(t=r.types[o])||void 0===t?void 0:t.operators)||[]);n||a.includes(l)||a.push(l);var u=Su()(lc()(r.operators,(function(e,t){return-1!==(null==a?void 0:a.indexOf(t))})),(function(e,t){return dc(r,t,n)})),s=this.buildOptions(r,u,a),c=u[l]||{},d=l?[l]:null;return{placeholder:this.props.config.settings.operatorPlaceholder,items:s,selectedKey:l,selectedKeys:d,selectedPath:d,selectedLabel:c.label,selectedAltLabel:c.label2||c.tooltip,selectedOpts:c,fieldConfig:i}}},{key:"buildOptions",value:function(e,t,r){return t&&r?nc()(t).sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})).map((function(e){var r=t[e];return{key:e,path:e,label:r.label,altLabel:r.label2,tooltip:r.tooltip}})):null}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setOperator,o=e.readonly,l=e.id,i=e.groupId,a=t.settings.renderOperator,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ic(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ic(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:l,groupId:i,config:t,customProps:r,readonly:o,setField:n},this.meta);return u.items?a(u,t.ctx):null}}])}(k.Component);pc.propTypes={id:ns().string,groupId:ns().string,config:ns().object.isRequired,selectedField:ns().any,selectedFieldId:ns().string,selectedFieldType:ns().string,selectedFieldSrc:ns().string,selectedOperator:ns().string,readonly:ns().bool,customProps:ns().object,setOperator:ns().func.isRequired};var fc=["children"],vc=function(e){var t=e.children,r=(0,ma.A)(e,fc);return k.createElement("div",r,t)},gc=function(){},hc=function(){return k.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},k.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),k.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},yc=function(e){return function(t){var r=t.config.settings.useConfirm,n=r?r.call(t.config.ctx,t.config.ctx):null;return k.createElement(e,(0,Ws.A)({},t,{confirmFn:n}))}},mc=function(e){var t=e.id,r=e.isLHS,n=e.delta;return[t,r?"L":"R",r?-1:n||0,(e.parentFuncs||[]).map((function(e){var t=(0,T.A)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")].join(":")},bc=function(e,t){var r;return"function"==typeof t?(r=function(r){return null==t?void 0:t(r,e.ctx)}).displayName=t.name:r=t,r};function Oc(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Ac()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Ac(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ac=function(){return!!e})()}var Sc=function(e){function t(){return(0,w.A)(this,t),Oc(this,t,arguments)}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,l=e.selectedOperator,i=e.setOperator,a=e.selectedFieldId,u=e.showOperator,s=e.showOperatorLabel,c=e.selectedFieldWidgetConfig,d=e.readonly,p=e.id,f=e.groupId;return[u&&k.createElement(vc,{key:"operators-for-"+a,className:"rule--operator"},t.settings.showLabels&&k.createElement("label",{className:"rule--label"},t.settings.operatorLabel),k.createElement(pc,{key:"operator",config:t,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,selectedFieldId:a,selectedOperator:l,setOperator:i,customProps:t.settings.customOperatorSelectProps,readonly:d,id:p,groupId:f})),s&&k.createElement(vc,{key:"operators-for-"+a,className:"rule--operator"},k.createElement("div",{className:"rule--operator-wrapper"},t.settings.showLabels?k.createElement("label",{className:"rule--label"}," "):null,k.createElement("div",{className:"rule--operator-text-wrapper"},k.createElement("span",{className:"rule--operator-text"},c.operatorInlineLabel))))]}}])}(k.PureComponent);function Fc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wc(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,jc()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function jc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jc=function(){return!!e})()}var Ec=ts.RuleUtils.getFieldPathLabels,Cc=ts.ConfigUtils,Lc=Cc.getFieldConfig,kc=Cc.getFieldParts,_c=Cc.getFieldPathParts,Tc=function(e){function t(e){var r;return(0,w.A)(this,t),(r=wc(this,t,[e])).setField=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.props.id;if(!n.widgetId){var l=[o,"L",-1].join(":");n.widgetId=l}r.props.setField(e,t,n)},Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.config,o=e.parentField,l=t,i=n.settings,a=i.maxLabelsLength,u=i.fieldSeparatorDisplay,s=i.fieldPlaceholder,c=(i.fieldSeparator,!!t),d=c?null:ms(s,a),p=c?Lc(n,l):null,f=p||{},v=_c(l,n),g=_c(l,n,!0),h=this.getFieldLabel(p,l,n),y=Ec(l,n),m=y?y.join(u):null;(m==h||o)&&(m=null);var b=f.label2||f.tooltip,O=kc(o,n),A=o?Lc(n,o):null,S=o?A&&A.subfields:n.fields,F=!c&&r,w=this.buildOptions(O,n,S,F,O),j=F?"Please select field":null;return l&&"object"===(0,V.A)(l)&&(l=void 0),{placeholder:d,items:w,parentField:o,selectedKey:l,selectedKeys:v,selectedPath:g,selectedLabel:h,selectedOpts:f,selectedAltLabel:b,selectedFullLabel:m,errorText:j}}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=kc(t,r),l=(null==e?void 0:e.label)||ve()(o);return ms(l,n)}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!r)return null;var a=t.settings,u=a.fieldSeparator,s=a.fieldSeparatorDisplay,c=null!=l&&l.length?l.join(u)+u:"",d=function e(t){return Object.keys(t||{}).reduce((function(r,n){var l=t[n];return"!struct"===l.type?r+e(l.subfields):r+(l.type===o?1:0)}),0)};return nc()(r).map((function(a){var u=[].concat((0,P.A)(null!=l?l:[]),[a]),p=r[a],f=n.getFieldLabel(p,u,t),v=Ec(u,t).join(s);(v==f||null!=e&&e.length)&&(v=null);var g=p.label2,h=p.tooltip,y=p.disabled;if(!p.hideForSelect){if("!struct"==p.type){var m=n.buildOptions(e,t,p.subfields,o,u,{label:f,tooltip:h}),b=d(p.subfields)>0;return{disabled:y,key:a,path:c+a,label:f,fullLabel:v,altLabel:g,tooltip:h,items:m,matchesType:b}}var O=void 0!==o?p.type===o:void 0;return{disabled:y,key:a,path:c+a,label:f,fullLabel:v,altLabel:g,tooltip:h,grouplabel:null==i?void 0:i.label,group:i,matchesType:O}}})).filter((function(e){return!!e}))}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setFieldSrc,o=e.readonly,l=e.id,i=e.groupId,a=t.settings.renderField,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fc(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:l,groupId:i,config:t,customProps:r,readonly:o,setField:this.setField,setFieldSrc:n},this.meta);return a(u,t.ctx)}}])}(k.Component);function Pc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Vc(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Ic()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Ic(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ic=function(){return!!e})()}Tc.propTypes={id:ns().string,groupId:ns().string,config:ns().object.isRequired,selectedField:ns().any,selectedFieldSrc:ns().string,selectedFieldType:ns().string,parentField:ns().string,customProps:ns().object,readonly:ns().bool,setField:ns().func.isRequired,setFieldSrc:ns().func};var xc=ts.clone,Dc=ts.ConfigUtils,Nc=Dc.getFieldConfig,Rc=Dc.getFuncConfig,Mc=Dc.getFieldParts,qc=Dc.getFieldPathParts,Wc=ts.RuleUtils,Bc=Wc.getFuncPathLabels,Gc=Wc.getWidgetForFieldOp,zc=ts.OtherUtils.shallowEqual,Uc=function(e){function t(e){var r;return(0,w.A)(this,t),r=Vc(this,t,[e]),Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"].map((function(r){return"parentFuncs"===r?!zc(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0;(!this.meta||["config","field","fieldType","fieldSrc","value","isLHS"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r&&(this.items=this.getItems(e,this.meta))}},{key:"getItems",value:function(e,t){var r=e.config,n=e.field,o=e.fieldType,l=e.isLHS,i=e.operator,a=e.parentFuncs,u=e.fieldDefinition,s=e.isFuncArg,c=t.lookingForFieldType,d=r.settings.canUseFuncForField,p=this.filterFuncs(r,r.funcs,n,o,l,i,d,a,s,u);return this.buildOptions(r,p,c)}},{key:"getMeta",value:function(e){var t=e.config,r=(e._field,e.fieldType),n=e.value,o=e.isLHS,l=e.isFuncArg,i=t.settings,a=i.funcPlaceholder,u=i.fieldSeparatorDisplay,s=n,c=!!n,d=c?null:a,p=c?Rc(t,s):null,f=p||{},v=qc(s,t),g=qc(s,t,!0),h=this.getFuncLabel(p,s,t),y=Bc(s,t),m=y?y.join(u):null;m==h&&(m=null);var b=o&&!l&&!c&&r;return{placeholder:d,selectedKey:s,selectedKeys:v,selectedPath:g,selectedLabel:h,selectedOpts:f,selectedFullLabel:m,errorText:b?"Please select function":null,lookingForFieldType:b}}},{key:"filterFuncs",value:function(e,t,r,n,o,l,i,a,u,s){t=xc(t);var c,d=e.settings.fieldSeparator,p=Nc(e,r),f=p,v=Gc(e,r,l,"value");return v&&e.widgets[v],u?(f=s,c=null==s?void 0:s.type):p?c=p.type:o||(c=n),function t(n,o){for(var u in n){var s=n[u].subfields,v=(o||[]).concat(u),g=v.join(d),h=Rc(e,g);if("!struct"==h.type)0==t(s,v)&&delete n[u];else{var y,m=!c||h.returnType==c;null!==(y=f)&&void 0!==y&&y.funcs&&(m=m&&f.funcs.includes(g)),i&&(m=m&&i(r,p,g,h,l)),!h.allowSelfNesting&&a&&a.map((function(e){var t=(0,T.A)(e,2),r=t[0];return t[1],r})).includes(g)&&(m=!1),m||delete n[u]}}return nc()(n).length}(t,[]),t}},{key:"buildOptions",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!t)return null;var i=e.settings,a=i.fieldSeparator,u=i.fieldSeparatorDisplay,s=null!=o&&o.length?o.join(a)+a:"",c=function e(t){return Object.keys(t||{}).reduce((function(r,o){var l=t[o];return"!struct"===l.type?r+e(l.subfields):r+(l.type===n?1:0)}),0)};return nc()(t).map((function(i){var a=[].concat((0,P.A)(null!=o?o:[]),[i]),d=t[i],p=r.getFuncLabel(d,a,e),f=Bc(a,e).join(u);f==p&&(f=null);var v=d.tooltip;if("!struct"==d.type){var g=r.buildOptions(e,d.subfields,n,a,{label:p,tooltip:v}),h=c(d.subfields)>0;return{key:i,path:s+i,label:p,fullLabel:f,tooltip:v,items:g,matchesType:h}}var y=void 0!==n?d.returnType===n:void 0;return{key:i,path:s+i,label:p,fullLabel:f,tooltip:v,grouplabel:null==l?void 0:l.label,group:l,matchesType:y}}))}},{key:"getFuncLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Mc(t,r),l=(null==e?void 0:e.label)||ve()(o);return ms(l,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,l=e.id,i=e.groupId,a=t.settings.renderFunc,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pc(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({config:t,customProps:r,readonly:o,setField:n,items:this.items,id:l,groupId:i},this.meta);return a(u,t.ctx)}}])}(k.Component);Uc.propTypes={id:ns().string,groupId:ns().string,config:ns().object.isRequired,field:ns().any,fieldType:ns().string,fieldSrc:ns().string,operator:ns().string,customProps:ns().object,value:ns().string,setValue:ns().func.isRequired,readonly:ns().bool,parentFuncs:ns().array,fieldDefinition:ns().object,isFuncArg:ns().bool,isLHS:ns().bool};var $c=r(34978),Jc=r.n($c),Hc=["widgetFactory"],Kc=["factory"];function Yc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yc(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Xc=ts.ListUtils.getTitleInListValues,Zc=ts.ConfigUtils._widgetDefKeysToOmit,ed=ts.TreeUtils,td=ed._fixImmutableValue,rd=ed.isImmutable,nd=(0,k.memo)((function(e){var t=e.widgetFactory,r=(0,ma.A)(e,Hc),n=r.config,o=r.isFuncArg,l=r.fieldDefinition||{},i=l.fieldSettings,a=l.defaultValue,u=l.valueSources,s=o&&1==(null==u?void 0:u.length)&&"const"===(null==u?void 0:u[0]),c=(null==i?void 0:i.treeValues)||(null==i?void 0:i.listValues);return s&&a?"boolean"==typeof a?a?r.labelYes||"YES":r.labelNo||"NO":c?Array.isArray(a)?a.map((function(e){return Xc(c,e)||e})).join(", "):Xc(c,a)||a:""+a:t?t(r,n.ctx):"?"}));nd.displayName="WidgetFactoryMemo";var od=function(e){var t=e.delta,r=e.isFuncArg,n=e.valueSrc,o=e.value,l=e.valueError,i=e.fieldError,a=e.asyncListValues,u=e.isSpecialRange,s=e.fieldDefinition,c=e.widget,d=e.widgetDefinition,p=e.widgetValueLabel,f=e.valueLabels,v=e.textSeparators,g=e.setValue,h=e.setFuncValue,y=e.config,m=e.field,b=e.fieldSrc,O=e.fieldPath,A=e.fieldType,S=e.isLHS,F=e.operator,w=e.readonly,j=e.parentField,E=e.parentFuncs,C=e.id,L=e.groupId,_=e.widgetId,T=d.factory,V=(0,ma.A)(d,Kc),I=o?o.map((function(e){return td(e)})):void 0,x=(0,k.useMemo)((function(){if(u){var e=[null==I?void 0:I.get(0),null==I?void 0:I.get(1)];return void 0===e[0]&&void 0===e[1]&&(e=void 0),e}return null==I?void 0:I.get(t)}),[u,o]),D=(0,k.useMemo)((function(){return l?u?[l.get(0),l.get(1),l.get(2)]:null==l?void 0:l.get(t):null}),[u,o]),N=S?i:D,R=(s||{}).fieldSettings,M=p.label,q=p.placeholder,W=f?f.placeholder:null,B=rd(m)?null:m,G=he()(Qc(Qc(Qc({},V),R),{},{config:y,field:B,fieldPath:O,fieldSrc:b,fieldType:A,isLHS:S,parentField:j,parentFuncs:E,fieldDefinition:s,operator:F,delta:t,isSpecialRange:u,isFuncArg:r,value:x,valueSrc:n,valueError:D,fieldError:i,errorMessage:N,label:M,placeholder:q,placeholders:W,textSeparators:v,setValue:g,setFuncValue:h,readonly:w,asyncListValues:a,id:C,groupId:L,widgetId:_,widgetFactory:T,widget:c}),[].concat((0,P.A)(Zc),["toJS"]));return k.createElement(nd,(0,Ws.A)({widgetFactory:T},G))};od.displayName="WidgetFactory";const ld=od;function id(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,ad()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function ad(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ad=function(){return!!e})()}var ud=ts.ConfigUtils,sd=ud.getFieldConfig,cd=ud.getOperatorConfig,dd=ud.getFieldWidgetConfig,pd=ts.RuleUtils,fd=pd.getValueSourcesForFieldOp,vd=pd.getWidgetForFieldOp,gd=pd.getValueLabel,hd=ts.DefaultUtils.createListWithOneElement,yd=ts.OtherUtils.shallowEqual,md=(ts.TreeUtils.isImmutable,{cardinality:1}),bd=function(e){function t(e){var r;return(0,w.A)(this,t),(r=id(this,t,[e]))._setValue=function(e,t,n,o,l,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(a.widgetId||(a.widgetId=o),e&&Array.isArray(l)){var u=[r.props.value.get(0),r.props.value.get(1)];u[0]!=l[0]&&r.props.setValue(0,l[0],n,i,a),u[1]!=l[1]&&r.props.setValue(1,l[1],n,i,a)}else r.props.setValue(t,l,n,i,a)},r._setValueSrc=function(e,t,n){var o={widgetId:t};r.props.setValueSrc(e,n,o)},r.renderWidget=function(e,t,r){var n=r.config,o=r.isFuncArg,l=r.leftField,i=r.operator,a=r.value,u=r.valueError,s=r.fieldError,c=r.readonly,d=r.parentField,p=r.parentFuncs,f=r.id,v=r.groupId,g=r.fieldSrc,h=r.fieldType,y=r.isLHS,m=r.setFuncValue,b=n.settings,O=t.widgets,A=t.iValues,S=t.aField,F=t.valueSources,w=o?A:a,j=o?l:S,E=O[e],C=E.valueSrc,L=E.valueLabel,_=E.widgetId,T=F.length>1&&!c,P=b.showLabels?k.createElement("label",{key:"label-"+_,className:"rule--label"},L.label):null;return k.createElement("div",{key:"wrapper-"+_,className:Gs()("func"===C?"widget--func":"widget--widget",T?"widget--has-valuerscs":"widget--has-no-valuerscs")},"func"===C?null:P,k.createElement(ld,(0,Ws.A)({key:_,id:f,groupId:v,widgetId:_,valueSrc:C,delta:e,value:w,valueError:u,fieldError:s,isFuncArg:o,isLHS:y},pe()(t,["isSpecialRange","fieldDefinition","asyncListValues"]),pe()(O[e],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValue"]),{setFuncValue:m,config:n,field:j,fieldSrc:g,fieldType:h,parentField:d,parentFuncs:p,operator:i,readonly:c})))},r.renderValueSources=function(e,t,n){var o=n.config,l=n.isFuncArg,i=n.leftField,a=n.operator,u=n.readonly,s=o.settings,c=t.valueSources,d=t.widgets,p=t.aField,f=t.valueSourcesOptions,v=l?i:p,g=d[e],h=g.valueSrc,y=g.setValueSrc,m=r.ValueSources,b=s.showLabels?k.createElement("label",{className:"rule--label"}," "):null;return c.length>1&&!u&&k.createElement("div",{key:"wrapper-valuesrc-"+e,className:"widget--valuesrc"},b,k.createElement(m,{key:"valuesrc-"+e,delta:e,valueSources:f,valueSrc:h,config:o,field:v,operator:a,setValueSrc:y,readonly:u,title:s.valueSourcesPopupTitle}))},r.renderSep=function(e,t,r){var n=r.config,o=t.widgets,l=n.settings,i=o[e].sepText,a=l.showLabels?k.createElement("label",{className:"rule--label"}," "):null;return i&&k.createElement("div",{key:"widget-separators-"+e,className:Gs()("widget--sep",0==e&&"widget--sep-first")},a,k.createElement("span",null,i))},r.renderWidgetDelta=function(e){return[r.renderSep(e,r.meta,r.props),r.renderValueSources(e,r.meta,r.props),r.renderWidget(e,r.meta,r.props)]},Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config),n=["config","id","parentFuncs","field","fieldId","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue","value"].filter((function(r){return"parentFuncs"===r?!yd(e[r],t[r],!0):"field"===r?e.fieldId!==t.fieldId:e[r]!==t[r]}));if((!this.meta||n.length>0)&&(this.meta=this.getMeta(e,n)),r){var o=e.config,l=o.settings.renderValueSources;this.ValueSources=bc(o,l)}}},{key:"getMeta",value:function(e){var t,r,n,o,l=this,i=e.config,a=e.field,u=(e.fieldSrc,e.fieldType),s=e.fieldFunc,c=e.fieldArg,d=e.operator,p=e.valueSrc,f=e.value,v=e.isForRuleGroup,g=e.isCaseValue,h=e.isFuncArg,y=(e.leftField,e.asyncListValues),m=e.parentFuncs,b=e.isLHS,O=e.id,A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],S=i.settings.valueSourcesInfo,F=h?{func:s,arg:c}:a,w=!a&&u,j=p,E=f;(h||v||g)&&(j=hd(p),E=hd(f));var C=sd(i,F);!C&&w&&(C=i.types[u]);var L,k=vd(i,F,d);!k&&w&&(k=null===(L=i.types[u])||void 0===L?void 0:L.mainWidget);var _=h?md:cd(i,d,F);if((null==C||null==_)&&!g)return null;var T,P,V=null==_?void 0:_.isSpecialRange,I=V&&("field"===(null===(t=j)||void 0===t?void 0:t.get(0))||"field"===(null===(r=j)||void 0===r?void 0:r.get(1))),x=V&&!I,D=x?1:null!==(P=null==(T=_)?void 0:T.cardinality)&&void 0!==P?P:1;if(0===D)return null;var N=null===(n=this.meta)||void 0===n?void 0:n.valueSources,R=null===(o=this.meta)||void 0===o?void 0:o.valueSourcesOptions;N&&!["field","operator","config","fieldDefinition","isForRuleGroup"].filter((function(e){return A.includes(e)})).length||(N=fd(i,F,d,C),v&&(N=["value"]),F||(N=Object.keys(S)),R=N.map((function(e){return[e,{label:S[e].label}]})));var M=Jc()(0,D).map((function(e){var t,r,n,o,a=null===(t=l.meta)||void 0===t||null===(t=t.widgets)||void 0===t?void 0:t[e],u=(null===(r=j)||void 0===r?void 0:r.get(e))||null,s=vd(i,F,d,u),c=dd(i,F,d,s,u);I&&(s=c.singleWidget,c=dd(i,F,d,s,u)),!c&&w&&(s=["func","field"].includes(u)?u:k,c=i.widgets[s]);var p=null===(n=c)||void 0===n?void 0:n.type,f=gd(i,F,d,e,u,x),v=gd(i,F,d,e,null,x),g=null!=_&&_.textSeparators?null==_?void 0:_.textSeparators[e]:null,h=null,y=null;V&&(h={placeholder:[(h=[gd(i,F,d,0),gd(i,F,d,1)])[0].placeholder,h[1].placeholder],label:[h[0].label,h[1].label]},y=null==_?void 0:_.textSeparators);var A=mc({id:O,isLHS:b,delta:e,parentFuncs:m}),S=A+":VS",E=null==a?void 0:a.setValueSrc;E&&(null==a?void 0:a.widgetId)===A||(E=l._setValueSrc.bind(l,e,S));var C=null==a?void 0:a.setValue;return C&&(null==a?void 0:a.widgetId)===A&&(null==a?void 0:a.widgetType)===p&&(null===(o=l.meta)||void 0===o?void 0:o.isSpecialRange)===V||(C=l._setValue.bind(l,V,e,p,A)),{valueSrc:u,valueLabel:f,widget:s,sepText:g,widgetDefinition:c,widgetValueLabel:v,valueLabels:h,textSeparators:y,setValueSrc:E,setValue:C,widgetId:A,widgetType:p}}));return{defaultWidget:k,fieldDefinition:C,operatorDefinition:_,isSpecialRange:x,cardinality:D,valueSources:N,valueSourcesOptions:R,widgets:M,iValues:E,aField:F,asyncListValues:y}}},{key:"render",value:function(){if(!this.meta)return null;var e=this.meta,t=e.defaultWidget,r=e.cardinality;if(!t)return null;var n=t;return k.createElement(vc,{className:"rule--widget rule--widget--".concat(n.toUpperCase()),key:"widget-col-"+n},Jc()(0,r).map(this.renderWidgetDelta))}}])}(k.Component);function Od(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Ad()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Ad(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ad=function(){return!!e})()}bd.propTypes={config:ns().object.isRequired,value:ns().any,valueSrc:ns().any,valueError:ns().any,fieldError:ns().string,field:ns().any,fieldSrc:ns().string,fieldType:ns().string,fieldId:ns().string,operator:ns().string,readonly:ns().bool,asyncListValues:ns().array,id:ns().string,groupId:ns().string,setValue:ns().func,setValueSrc:ns().func,setFuncValue:ns().func,isFuncArg:ns().bool,fieldFunc:ns().string,fieldArg:ns().string,leftField:ns().any,isForRuleGroup:ns().bool,parentField:ns().string,parentFuncs:ns().array,isLHS:ns().bool,isCaseValue:ns().bool};var Sd=ts.ConfigUtils.getFuncConfig,Fd=ts.OtherUtils.shallowEqual,wd=function(e){function t(e){var r;return(0,w.A)(this,t),(r=Od(this,t,[e])).setFunc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.props,o=n.isLHS,l=n.delta,i=n.parentFuncs,a=n.id;if(!t.widgetId){var u=mc({id:a,isLHS:o,delta:l,parentFuncs:i});t.widgetId=u}r.props.setFuncValue(o?-1:l||0,i,null,e,"!func",void 0,t)},r.setArgValue=function(e,t,n,o,l){var i=r.props,a=(i.config,i.delta),u=i.isLHS,s=i.parentFuncs;r.props.setFuncValue(u?-1:a||0,s,e,t,n,o,l)},r.setArgValueSrc=function(e,t,n){var o=r.props,l=(o.config,o.delta),i=o.isLHS,a=o.parentFuncs;r.props.setFuncValue(i?-1:l||0,a,e,t,"!valueSrc",void 0,n)},r.renderFuncSelect=function(){var e,t,n=r.props,o=n.config,l=n.field,i=n.fieldType,a=n.fieldSrc,u=n.isLHS,s=n.operator,c=n.customProps,d=n.value,p=n.readonly,f=n.parentFuncs,v=n.id,g=n.groupId,h=n.isFuncArg,y=n.fieldDefinition,m={value:null!==(e=null==d||null===(t=d.get)||void 0===t?void 0:t.call(d,"func"))&&void 0!==e?e:null,setValue:r.setFunc,config:o,field:l,fieldType:i,fieldSrc:a,isLHS:u,operator:s,customProps:c,readonly:p,parentFuncs:f,isFuncArg:h,fieldDefinition:y,id:v,groupId:g},b=o.settings,O=b.showLabels,A=b.funcLabel,S=O?k.createElement("label",{className:"rule--label"},A):null;return k.createElement(vc,{key:"func",className:"rule--func"},S,k.createElement(Uc,m))},r.renderArgLabel=function(e,t){var n=t.valueSources,o=t.type,l=t.showPrefix,i=t.label,a=r.props.config,u=n&&1==n.length&&"const"==n[0];return a.settings.showLabels||"boolean"!=o&&!u||!l?null:k.createElement(vc,{className:"rule--func--arg-label"},i||e)},r.renderArgLabelSep=function(e,t){var n=t.valueSources,o=t.type,l=t.showPrefix,i=r.props.config,a=n&&1==n.length&&"const"==n[0];return i.settings.showLabels||"boolean"!=o&&!a||!l?null:k.createElement(vc,{className:"rule--func--arg-label-sep"},":")},r.renderArgVal=function(e,t,n){var o=r.props,l=o.config,i=o.field,a=o.fieldType,u=o.fieldSrc,s=o.isLHS,c=(o.operator,o.value),d=o.readonly,p=o.parentFuncs,f=o.id,v=o.groupId,g=o.fieldError,h=o.valueError,y=o.setFuncValue,m=c?c.getIn(["args",t]):null,b=m?m.get("value"):void 0,O=1==n.valueSources.length?n.valueSources[0]:void 0,A={config:l,fieldFunc:e,fieldArg:t,leftField:i,fieldType:a,fieldSrc:u,fieldError:g,valueError:h,isLHS:s,operator:null,value:b,valueSrc:m?m.get("valueSrc")||O||"value":O,setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:y,funcKey:e,argKey:t,argDefinition:n,readonly:d,parentFuncs:p,id:f,groupId:v};return k.createElement(vc,{className:"rule--func--arg-value"},k.createElement(jd,A))},r.renderArgSep=function(e,t,r,n){var o=n.renderSeps;return r?k.createElement(vc,{className:"rule--func--arg-sep"},o?o[r-1]:", "):null},r.renderBracketBefore=function(e){var t=e.renderBrackets;return k.createElement(vc,{key:"before_args",className:"rule--func--bracket-before"},t?t[0]:"(")},r.renderBracketAfter=function(e){var t=e.renderBrackets;return k.createElement(vc,{key:"after_args",className:"rule--func--bracket-after"},t?t[1]:")")},r.renderFuncArgs=function(){var e=r.meta,t=e.funcDefinition,n=e.funcKey;if(!n)return null;var o=(t||{}).args;return o?k.createElement(k.Fragment,null,r.renderBracketBefore(t),k.createElement(vc,{key:"args-".concat(n),className:"rule--func--args rule--func--".concat(n,"--args")},Object.keys(o).map((function(e,l){return k.createElement(vc,{key:"arg-".concat(e,"-").concat(l),className:"rule--func--arg rule--func--".concat(n,"--arg--").concat(e)},r.renderArgSep(e,o[e],l,t),r.renderArgLabel(e,o[e]),r.renderArgLabelSep(e,o[e]),r.renderArgVal(n,e,o[e]))}))),r.renderBracketAfter(t)):null},Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","field","operator","value","fieldSrc","fieldType","isLHS"].map((function(r){return"parentFuncs"===r?!Fd(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r,n=e.config,o=(e.field,e.operator,e.value),l=null!==(t=null==o||null===(r=o.get)||void 0===r?void 0:r.call(o,"func"))&&void 0!==t?t:null;return{funcDefinition:l?Sd(n,l):null,funcKey:l}}},{key:"render",value:function(){var e=this.props.parentFuncs,t=e?e.map((function(e){var t=(0,T.A)(e,2),r=t[0],n=t[1];return"".concat(r,"_").concat(n)})).join("-"):"root",r=(null==e?void 0:e.length)||0;return k.createElement(vc,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(t," rule--func--wrapper--lev-").concat(r)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(k.Component);wd.propTypes={id:ns().string,groupId:ns().string,config:ns().object.isRequired,field:ns().any,fieldSrc:ns().string,fieldType:ns().string,fieldError:ns().string,operator:ns().string,customProps:ns().object,value:ns().object,setValue:ns().func.isRequired,setFuncValue:ns().func,readonly:ns().bool,parentFuncs:ns().array,fieldDefinition:ns().object,isFuncArg:ns().bool,isLHS:ns().bool,valueError:ns().string};var jd=function(e){function t(e){var r;return(0,w.A)(this,t),(r=Od(this,t,[e])).setValue=function(e,t,n,o,l){var i=r.props;(0,i.setValue)(i.argKey,t,n,o,l)},r.setValueSrc=function(e,t,n){var o=r.props;(0,o.setValueSrc)(o.argKey,t,n)},Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["parentFuncs","funcKey","argKey"].map((function(r){return"parentFuncs"===r?!Fd(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.parentFuncs,r=e.funcKey,n=e.argKey;return{parentFuncs:[].concat((0,P.A)(t||[]),[[r,n]])}}},{key:"render",value:function(){var e=this.meta.parentFuncs;return k.createElement(bd,(0,Ws.A)({},this.props,{setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:e}))}}])}(k.Component);function Ed(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Cd()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Cd(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Cd=function(){return!!e})()}jd.propTypes={funcKey:ns().string.isRequired,argKey:ns().string.isRequired,setValue:ns().func.isRequired,setValueSrc:ns().func.isRequired,readonly:ns().bool,isLHS:ns().bool,parentFuncs:ns().array,id:ns().string,groupId:ns().string};var Ld=function(e){function t(e){var r;return(0,w.A)(this,t),(r=Ed(this,t,[e])).renderField=function(){var e=r.props,t=e.config,n=e.classname,o=e.selectedField,l=e.selectedFieldSrc,i=e.selectedFieldType,a=e.setField,u=e.setFuncValue,s=e.parentField,c=e.readonly,d=e.id,p=e.groupId,f=e.fieldError,v=e.valueError;if(!["func","field"].includes(l))return"?";var g="func"===l?k.createElement(wd,{isLHS:!0,config:t,value:o,fieldSrc:l,fieldType:i,fieldError:f,valueError:v,parentField:s,setValue:a,setFuncValue:u,readonly:c,id:d,groupId:p,key:"field-func-"+d}):k.createElement(Tc,{config:t,selectedField:o,selectedFieldSrc:l,selectedFieldType:i,parentField:s,setField:a,customProps:t.settings.customFieldSelectProps,readonly:c,id:d,groupId:p,key:"field-"+d}),h="func"===l?t.settings.funcLabel:t.settings.fieldLabel,y=t.settings.showLabels&&"func"!==l&&k.createElement("label",{className:"rule--label"},h);return k.createElement("div",{key:l,className:n},y,g)},r.renderFieldSources=function(){if(!r.meta)return null;var e=r.props,t=e.config,n=e.readonly,o=e.selectedFieldSrc,l=e.setFieldSrc,i=e.id,a=r.meta.fieldSourcesOptions,u=t.settings,s=r.ValueSources,c=u.showLabels?k.createElement("label",{className:"rule--label"}," "):null;return a.length>1&&!n&&k.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},c,k.createElement(s,{key:"fieldsrc-"+i,valueSources:a,valueSrc:o,config:t,setValueSrc:l,readonly:n,title:u.fieldSourcesPopupTitle}))},Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config);if((!this.meta||["config"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r){var n=e.config,o=n.settings.renderValueSources;this.ValueSources=function(e){return o(e,n.ctx)}}}},{key:"getMeta",value:function(e){var t=e.config.settings,r=t.valueSourcesInfo;return{fieldSourcesOptions:t.fieldSources.map((function(e){return[e,{label:r[e].label}]}))}}},{key:"render",value:function(){var e=this.props,t=(e.classname,e.canSelectFieldSource),r=t&&this.renderFieldSources(),n=this.renderField();return t?k.createElement(vc,{className:"rule--field-wrapper"},r,n):n}}])}(k.Component),kd=["factory"];function _d(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Td()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Td(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Td=function(){return!!e})()}var Pd=ts.ConfigUtils.getOperatorConfig,Vd=function(e){function t(){return(0,w.A)(this,t),_d(this,t,arguments)}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var e=Pd(this.props.config,this.props.selectedOperator,this.props.selectedField);if(void 0===e.options)return null;var t=e.options,r=t.factory,n=(0,ma.A)(t,kd),o=r(Object.assign({},n,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),this.props.config.ctx),l=this.props.selectedOperator;return k.createElement("div",{className:"rule--operator rule--operator--".concat(l.toUpperCase())},o)}}])}(k.PureComponent);function Id(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Id(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Id(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Dd(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Nd()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Nd(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Nd=function(){return!!e})()}Vd.propTypes={config:ns().object.isRequired,operatorOptions:ns().any.isRequired,selectedField:ns().any,selectedFieldSrc:ns().string,selectedOperator:ns().string.isRequired,readonly:ns().bool,setOperatorOption:ns().func.isRequired};var Rd=ts.ConfigUtils,Md=Rd.getFieldConfig,qd=Rd.getOperatorConfig,Wd=Rd.getFieldWidgetConfig,Bd=Rd.getFieldId,Gd=ts.RuleUtils.isEmptyRuleProperties,zd=function(e){function t(e){var r;return(0,w.A)(this,t),r=Dd(this,t,[e]),Cs(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props,n=!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if((!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked"].map((function(t){return e[t]!==r[t]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),n){var o=e.config,l=o.settings,i=l.renderIcon,a=l.renderButton,u=l.renderButtonGroup,s=l.renderSwitch,c=l.renderBeforeWidget,d=l.renderAfterWidget,p=l.renderRuleError;this.Icon=bc(o,i),this.Btn=bc(o,a),this.BtnGrp=bc(o,u),this.Switch=bc(o,s),this.BeforeWidget=bc(o,c),this.AfterWidget=bc(o,d),this.RuleError=bc(o,p)}this.doRemove=function(){t.props.removeSelf()}}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.selectedOperator,o=e.config,l=e.reordableNodesCnt,i=e.isLocked,a=o.settings.keepInputOnChangeFieldSrc,u=Bd(t,o),s=Md(o,t),c=s&&"!struct"===s.type,d=!!t||a&&r,p=d&&n,f=qd(o,n,t),v=f&&null!=f.options,g=Wd(o,t,n,null,null)||{},h=g.hideOperator;return{selectedFieldId:u,selectedFieldWidgetConfig:g,showDragIcon:o.settings.canReorder&&l>1&&!i,showOperator:d&&!h,showOperatorLabel:d&&h&&g.operatorInlineLabel,showWidget:p&&!c,showOperatorOptions:p&&v}}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,l=n.removeRuleConfirmOptions;l&&!this.isEmptyCurrentRule()?o.call(r.ctx,xd(xd({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"_buildWidgetProps",value:function(e,t){var r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,l=e.selectedOperator,i=e.operatorOptions,a=e.value,u=e.valueType,s=e.valueSrc,c=e.asyncListValues,d=e.valueError,p=e.fieldError,f=e.parentField;return{field:r,fieldSrc:n,fieldType:o,fieldId:t.selectedFieldId,operator:l,operatorOptions:i,value:a,valueType:u,valueSrc:s,asyncListValues:c,valueError:d,fieldError:p,parentField:f}}},{key:"isEmptyCurrentRule",value:function(){var e=this.props.config,t=this._buildWidgetProps(this.props,this.meta);return Gd(t,e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.parentField,o=e.groupId,l=e.id,i=e.selectedFieldSrc,a=e.selectedField,u=e.selectedFieldType,s=e.setField,c=e.setFuncValue,d=e.setFieldSrc,p=e.fieldError,f=t.settings.immutableFieldsMode,v=this.meta.selectedFieldId;return k.createElement(Ld,{key:"field",classname:Gs()("func"==i?"rule--field--func":"rule--field"),config:t,canSelectFieldSource:!n,selectedField:a,selectedFieldSrc:i,selectedFieldType:u,selectedFieldId:v,fieldError:p,setField:f?gc:s,setFuncValue:f?gc:c,setFieldSrc:f?gc:d,parentField:n,readonly:f||r,id:l,groupId:o})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta,o=n.selectedFieldId,l=n.selectedFieldWidgetConfig,i=n.showOperator,a=n.showOperatorLabel,u=t.settings.immutableOpsMode;return k.createElement(Sc,{key:"operator",config:t,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedFieldId:o,selectedOperator:this.props.selectedOperator,setOperator:u?gc:this.props.setOperator,showOperator:i,showOperatorLabel:a,selectedFieldWidgetConfig:l,readonly:u||r,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta.showWidget,o=t.settings.immutableValuesMode;if(!n)return null;var l=k.createElement(bd,(0,Ws.A)({key:"values"},this._buildWidgetProps(this.props,this.meta),{config:t,setValue:o?gc:this.props.setValue,setValueSrc:o?gc:this.props.setValueSrc,setFuncValue:o?gc:this.props.setFuncValue,readonly:o||r,id:this.props.id,groupId:this.props.groupId}));return k.createElement(vc,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"renderOperatorOptions",value:function(){var e=this.props.config,t=this.meta.showOperatorOptions,r=e.settings,n=r.immutableOpsMode,o=r.immutableValuesMode;if(!t)return null;var l=k.createElement(Vd,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:n?gc:this.props.setOperatorOption,config:e,readonly:o});return k.createElement(vc,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},l)}},{key:"renderBeforeWidget",value:function(){var e=this.BeforeWidget;return e?k.createElement(vc,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},k.createElement(e,this.props)):null}},{key:"renderAfterWidget",value:function(){var e=this.AfterWidget;return e?k.createElement(vc,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},k.createElement(e,this.props)):null}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=e.fieldError,o=t.settings.showErrorMessage,l=this.RuleError,i=[n].concat((0,P.A)((null==r?void 0:r.toArray())||[])).filter((function(e){return!!e})).shift()||null;return o&&i&&k.createElement("div",{className:"rule--error"},l?k.createElement(l,{error:i}):i)}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.meta.showDragIcon,r=this.Icon,n=k.createElement(r,{type:"drag"});return t&&k.createElement("div",{key:"rule-drag-icon",onMouseDown:e,className:"qb-drag-handler rule--drag-handler"},n)}},{key:"renderDel",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=t.settings,o=n.deleteLabel,l=n.immutableGroupsMode,i=n.canDeleteLocked,a=this.Icon,u=this.Btn;return!l&&(!r||r&&i)&&k.createElement(u,{key:"rule-del",type:"delRule",onClick:this.removeSelf,label:o,config:t,renderIcon:a})}},{key:"renderLock",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.isTrueLocked,o=e.id,l=t.settings,i=l.lockLabel,a=l.lockedLabel,u=l.showLock,s=this.Switch;return u&&!(r&&!n)&&k.createElement(s,{key:"rule-lock",type:"lock",id:o,value:r,setValue:this.setLock,label:i,checkedLabel:a,hideLabel:!0,config:t})}},{key:"render",value:function(){var e=this.meta,t=e.showOperatorOptions,r=e.selectedFieldWidgetConfig,n=this.props,o=n.valueSrc,l=n.value,i=n.config,a="value"==(null==o?void 0:o.first())&&!t&&1==l.size&&r.fullWidth,u=this.BtnGrp,s=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],c=k.createElement("div",{key:"rule-body",className:Gs()("rule--body",a&&"can--shrink--value")},s),d=this.renderError(),p=this.renderDrag(),f=this.renderLock(),v=this.renderDel();return k.createElement(k.Fragment,null,p,k.createElement("div",{key:"rule-body-wrapper",className:"rule--body--wrapper"},c,d),k.createElement("div",{key:"rule-header-wrapper",className:"rule--header"},k.createElement(u,{key:"rule-header-group",config:i},f,v)))}}])}(k.Component);zd.propTypes={id:ns().string.isRequired,groupId:ns().string,selectedField:ns().any,selectedFieldSrc:ns().string,selectedFieldType:ns().string,selectedOperator:ns().string,operatorOptions:ns().object,config:ns().object.isRequired,value:ns().any,valueSrc:ns().any,valueType:ns().any,asyncListValues:ns().array,isDraggingMe:ns().bool,isDraggingTempo:ns().bool,parentField:ns().string,valueError:ns().any,fieldError:ns().string,isLocked:ns().bool,isTrueLocked:ns().bool,handleDraggerMouseDown:ns().func,setField:ns().func,setFieldSrc:ns().func,setOperator:ns().func,setOperatorOption:ns().func,setLock:ns().func,removeSelf:ns().func,setValue:ns().func,setValueSrc:ns().func,setFuncValue:ns().func,reordableNodesCnt:ns().number,totalRulesCnt:ns().number,parentReordableNodesCnt:ns().number};const Ud=function(e){var t=(0,as.Ng)((function(e){return{dragging:e.dragging}}),null,null,{context:ls})(function(e){var t;return t=function(t){function r(e){var t;return(0,w.A)(this,r),(t=zs(this,r,[e])).dummyFn=function(){},t.removeSelf=function(){t.props.actions.removeRule(t.props.path)},t.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setLock(t.props.path,e)},t.setField=function(e,r,n){t.props.actions.setField(t.props.path,e,r,n)},t.setFieldSrc=function(e){t.props.actions.setFieldSrc(t.props.path,e)},t.setOperator=function(e){t.props.actions.setOperator(t.props.path,e)},t.setOperatorOption=function(e,r){t.props.actions.setOperatorOption(t.props.path,e,r)},t.setValue=function(e,r,n,o,l){t.props.actions.setValue(t.props.path,e,r,n,o,l)},t.setValueSrc=function(e,r,n){t.props.actions.setValueSrc(t.props.path,e,r,n)},t.setFuncValue=function(e,r,n,o,l,i,a){t.props.actions.setFuncValue(t.props.path,e,r,n,o,l,i,a)},t.pureShouldComponentUpdate=Es(t),t.dummyFn.isDummyFn=!0,t}return(0,L.A)(r,t),(0,j.A)(r,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var l=(e.dragging.id||r.dragging.id)==e.id,i=[];for(var a in e){var u=e[a]!=r[a];"dragging"!=a||l||(u=!1),u&&i.push(a)}i.length||(o=!1)}return o}},{key:"render",value:function(){var t=this.props.dragging.id==this.props.id,r=$s(this.props.config,this.props.field),n=this.props.fieldType||(null==r?void 0:r.type)||null,o=this.props.config.settings.showErrorMessage,l=(r&&r.type,!t&&this.props.isDraggingTempo),i=this.props,a=i.valueError,u=null!=([i.fieldError].concat((0,P.A)((null==a?void 0:a.toArray())||[])).filter((function(e){return!!e})).shift()||null)&&o;return k.createElement("div",{className:Gs()("group-or-rule-container","rule-container",u?"rule-with-error":null),"data-id":this.props.id},[t?k.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,k.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:t,isDraggingTempo:l,onDragStart:this.props.onDragStart,setLock:l?this.dummyFn:this.setLock,removeSelf:l?this.dummyFn:this.removeSelf,setField:l?this.dummyFn:this.setField,setFieldSrc:l?this.dummyFn:this.setFieldSrc,setFuncValue:l?this.dummyFn:this.setFuncValue,setOperator:l?this.dummyFn:this.setOperator,setOperatorOption:l?this.dummyFn:this.setOperatorOption,setValue:l?this.dummyFn:this.setValue,setValueSrc:l?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(k.Component),t.propTypes={id:ns().string.isRequired,groupId:ns().string,config:ns().object.isRequired,path:ns().any.isRequired,operator:ns().string,field:ns().any,fieldSrc:ns().string,fieldType:ns().string,actions:ns().object.isRequired,onDragStart:ns().func,value:ns().any,valueSrc:ns().any,asyncListValues:ns().array,valueError:ns().any,fieldError:ns().string,operatorOptions:ns().object,reordableNodesCnt:ns().number,parentField:ns().string,isLocked:ns().bool,isTrueLocked:ns().bool,dragging:ns().object,isDraggingTempo:ns().bool},t}(e));return t.displayName="ConnectedRuleContainer",t}(tc("rule")(yc(zd)));var $d=r(28198),Jd=r.n($d);function Hd(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Kd()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Kd(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Kd=function(){return!!e})()}var Yd=ts.DefaultUtils.defaultGroupConjunction;const Qd=function(e,t){var r=(0,as.Ng)((function(e){return{dragging:e.dragging}}),null,null,{context:ls})(function(e,t){var r;return r=function(r){function n(e){var r;return(0,w.A)(this,n),(r=Hd(this,n,[e]))._selectedConjunction=function(e){return(e=e||r.props).conjunction||Yd(e.config,e.field)},r.setConjunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setConjunction(r.props.path,e)},r.setNot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setNot(r.props.path,e)},r.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setLock(r.props.path,e)},r.dummyFn=function(){},r.removeSelf=function(){r.props.actions.removeGroup(r.props.path)},r.addGroup=function(){r.props.actions.addGroup(r.props.path)},r.addCaseGroup=function(){r.props.actions.addCaseGroup(r.props.path)},r.addDefaultCaseGroup=function(){r.props.actions.addDefaultCaseGroup(r.props.path)},r.addRule=function(){var e="rule_group"==t?r.props.field:null;r.props.actions.addRule(r.props.path,void 0,void 0,void 0,e)},r.setField=function(e,t,n){r.props.actions.setField(r.props.path,e,t,n)},r.setOperator=function(e){r.props.actions.setOperator(r.props.path,e)},r.setValue=function(e,t,n,o,l){r.props.actions.setValue(r.props.path,e,t,n,o,l)},r.setValueSrc=function(e,t,n){r.props.actions.setValueSrc(r.props.path,e,t,n)},r.setFuncValue=function(e,t,n,o,l,i,a){r.props.actions.setFuncValue(r.props.path,e,t,n,o,l,i,a)},r.pureShouldComponentUpdate=Es(r),Cs(r),r.selectedConjunction=r._selectedConjunction(e),r.conjunctionOptions=r._getConjunctionOptions(e),r.dummyFn.isDummyFn=!0,r}return(0,L.A)(n,r),(0,j.A)(n,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var l=(e.dragging.id||r.dragging.id)==e.id,i=[];for(var a in e){var u=e[a]!=r[a];"dragging"!=a||l||(u=!1),u&&i.push(a)}i.length||(o=!1)}return o}},{key:"onPropsChanged",value:function(e){var t=e.config,r=(e.id,e.conjunction),n=this.props.config,o=this.props.conjunction;n==t&&o==r||(this.selectedConjunction=this._selectedConjunction(e),this.conjunctionOptions=this._getConjunctionOptions(e))}},{key:"_getConjunctionOptions",value:function(e){var t=this;return Su()(e.config.conjunctions,(function(r,n){return{id:"conjunction-".concat(e.id,"-").concat(n),name:"conjunction[".concat(e.id,"]"),key:n,label:r.label,checked:n===t._selectedConjunction(e)}}))}},{key:"render",value:function(){var t=this.props.config.settings.showErrorMessage,r=this.props.dragging.id==this.props.id,n=this.props.path.size,o=this.props.config.settings.maxNesting,l=!r&&this.props.isDraggingTempo,i=this.props.fieldType||null,a=this.props.valueError,u=null!=((0,P.A)((null==a?void 0:a.toArray())||[]).filter((function(e){return!!e})).shift()||null)&&t,s=void 0===o||n<o,c=1==n;return k.createElement("div",{className:Gs()("group-or-rule-container","group-container",u?"group-with-error":null),"data-id":this.props.id},[r?k.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:c,allowFurtherNesting:s,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:i,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,k.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:r,isDraggingTempo:l,onDragStart:this.props.onDragStart,isRoot:c,allowFurtherNesting:s,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:l?this.dummyFn:this.setConjunction,setNot:l?this.dummyFn:this.setNot,setLock:l?this.dummyFn:this.setLock,removeSelf:l?this.dummyFn:this.removeSelf,addGroup:l?this.dummyFn:this.addGroup,addCaseGroup:l?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:l?this.dummyFn:this.addDefaultCaseGroup,addRule:l?this.dummyFn:this.addRule,setField:l?this.dummyFn:this.setField,setFuncValue:l?this.dummyFn:this.setFuncValue,setOperator:l?this.dummyFn:this.setOperator,setValue:l?this.dummyFn:this.setValue,setValueSrc:l?this.dummyFn:this.setValueSrc,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:i,parentField:this.props.parentField||null,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(k.Component),r.propTypes={config:ns().object.isRequired,actions:ns().object.isRequired,path:ns().any.isRequired,id:ns().string.isRequired,groupId:ns().string,not:ns().bool,conjunction:ns().string,children1:ns().any,onDragStart:ns().func,reordableNodesCnt:ns().number,field:ns().any,fieldSrc:ns().string,fieldType:ns().string,parentField:ns().string,value:ns().any,valueSrc:ns().any,valueError:ns().any,isLocked:ns().bool,isTrueLocked:ns().bool,dragging:ns().object,isDraggingTempo:ns().bool},r}(e,t));return r.displayName="ConnectedGroupContainer",r};function Xd(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Zd()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Zd(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Zd=function(){return!!e})()}var ep={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},tp=function(e){function t(){return(0,w.A)(this,t),Xd(this,t,arguments)}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.removeSelf,l=e.setLock,i=e.isLocked,a=e.isTrueLocked,u=e.id,s=e.canAddGroup,c=e.canAddRule,d=e.canDeleteGroup,p=t.settings,f=p.immutableGroupsMode,v=p.addRuleLabel,g=p.addGroupLabel,h=p.delGroupLabel,y=p.groupActionsPosition,m=p.renderButton,b=p.renderIcon,O=p.renderSwitch,A=p.renderButtonGroup,S=p.lockLabel,F=p.lockedLabel,w=p.showLock,j=p.canDeleteLocked,E=function(e){return b(e,t.ctx)},C=function(e){return m(e,t.ctx)},L=function(e){return O(e,t.ctx)},_=function(e){return A(e,t.ctx)},T=ep[y||"topRight"],P=w&&!(i&&!a)&&k.createElement(L,{type:"lock",id:u,value:i,setValue:l,label:S,checkedLabel:F,config:t}),V=!f&&c&&!i&&k.createElement(C,{type:"addRule",onClick:r,label:v,readonly:i,config:t,renderIcon:E}),I=!f&&s&&!i&&k.createElement(C,{type:"addGroup",onClick:n,label:g,readonly:i,config:t,renderIcon:E}),x=!f&&d&&(!i||i&&j)&&k.createElement(C,{type:"delGroup",onClick:o,label:h,config:t,renderIcon:E});return k.createElement("div",{className:"group--actions ".concat(T)},k.createElement(_,{config:t},P,V,I,x))}}])}(k.PureComponent);function rp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function np(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rp(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function op(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,lp()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function lp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(lp=function(){return!!e})()}var ip=ts.RuleUtils.isEmptyGroupChildren,ap=function(e){function t(e){var r;return(0,w.A)(this,t),(r=op(this,t,[e])).childrenClassName=function(){return""},r.renderBeforeActions=function(){var e=r.BeforeActions;return null==e?null:k.createElement(e,(0,Ws.A)({key:"group-actions-before"},r.props))},r.renderAfterActions=function(){var e=r.AfterActions;return null==e?null:k.createElement(e,(0,Ws.A)({key:"group-actions-after"},r.props))},Cs(r),r.onPropsChanged(e),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props;if(!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config)){var n=e.config,o=n.settings,l=o.renderIcon,i=o.renderConjs,a=o.renderBeforeActions,u=o.renderAfterActions;this.Icon=bc(n,l),this.Conjs=bc(n,i),this.BeforeActions=bc(n,a),this.AfterActions=bc(n,u)}this.doRemove=function(){t.props.removeSelf()}}},{key:"isGroupTopPosition",value:function(){return Jd()(this.props.config.settings.groupActionsPosition||"topRight","top")}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,l=n.removeGroupConfirmOptions;l&&!this.isEmptyCurrentGroup()?o.call(r.ctx,np(np({},l),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config;return ip(t,r)}},{key:"showNot",value:function(){return this.props.config.settings.showNot}},{key:"showConjs",value:function(){var e=this.props,t=e.conjunctionOptions;return e.children1,e.config,Object.keys(t).length>1||this.showNot()}},{key:"isNoChildren",value:function(){var e=this.props.children1;return!e||0==e.size}},{key:"isOneChild",value:function(){var e=this.props.children1;return!e||e.size<2}},{key:"renderChildrenWrapper",value:function(){return this.props.children1&&k.createElement("div",{key:"group-children",className:Gs()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var e=this.isGroupTopPosition();return k.createElement("div",{key:"group-header",className:Gs()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),e&&this.renderBeforeActions(),e&&this.renderActions(),e&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){return!this.isGroupTopPosition()&&k.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,l=e.isTrueLocked,i=e.id;return k.createElement(tp,{key:"group-actions",config:t,addRule:r,addGroup:n,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:l,id:i})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props.config.settings.maxNumberOfRules,t=this.props.totalRulesCnt;return!e||t<e}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var e=this.props.children1;return e?e.valueSeq().toArray().map(this.renderItem):null}},{key:"renderItem",value:function(e){if(e){var t=this.props,r=t.config,n=t.actions,o=t.onDragStart,l=t.isLocked,i="group"==e.get("type")&&null!=e.getIn(["properties","field"])?"rule_group":e.get("type");return k.createElement(of,(0,Ws.A)({},this.extraPropsForItem(e),{key:e.get("id"),id:e.get("id"),groupId:t.id,path:e.get("path"),type:i,properties:e.get("properties"),config:r,actions:n,children1:e.get("children1"),reordableNodesCnt:this.reordableNodesCntForItem(e),totalRulesCnt:this.totalRulesCntForItem(e),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:o,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:l}))}}},{key:"extraPropsForItem",value:function(e){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var e=this.props,t=e.config,r=e.isRoot,n=e.isLocked,o=this.reordableNodesCnt();return t.settings.canReorder&&!r&&o>1&&!n}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.Icon,r=k.createElement(t,{type:"drag"});return this.showDragIcon()&&k.createElement("div",{key:"group-drag-icon",onMouseDown:e,className:"qb-drag-handler group--drag-handler"},r)}},{key:"conjunctionOptions",value:function(){return this.props.conjunctionOptions}},{key:"renderConjs",value:function(){var e=this.props,t=e.config,r=e.children1,n=e.id,o=e.selectedConjunction,l=e.setConjunction,i=e.not,a=e.setNot,u=e.isLocked,s=t.settings,c=s.immutableGroupsMode,d=(s.renderConjs,s.showNot,s.notLabel),p=this.conjunctionOptions();if(!this.showConjs())return null;if(!r||!r.size)return null;var f={disabled:this.isOneChild(),readonly:c||u,selectedConjunction:o,setConjunction:c?gc:l,conjunctionOptions:p,config:t,not:i||!1,id:n,setNot:c?gc:a,notLabel:d,showNot:this.showNot(),isLocked:u},v=this.Conjs;return k.createElement(v,(0,Ws.A)({key:"group-conjs"},f))}},{key:"renderHeader",value:function(){return k.createElement("div",{key:"group-conjunctions",className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"render",value:function(){return k.createElement(k.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}}])}(k.Component);ap.propTypes={reordableNodesCnt:ns().number,conjunctionOptions:ns().object.isRequired,allowFurtherNesting:ns().bool.isRequired,isRoot:ns().bool.isRequired,not:ns().bool,selectedConjunction:ns().string,config:ns().object.isRequired,id:ns().string.isRequired,groupId:ns().string,path:ns().any,children1:ns().any,isDraggingMe:ns().bool,isDraggingTempo:ns().bool,isLocked:ns().bool,isTrueLocked:ns().bool,handleDraggerMouseDown:ns().func,onDragStart:ns().func,addRule:ns().func.isRequired,addGroup:ns().func.isRequired,removeSelf:ns().func.isRequired,setConjunction:ns().func.isRequired,setNot:ns().func.isRequired,setLock:ns().func.isRequired,actions:ns().object.isRequired};const up=Qd(tc("group")(yc(ap)),"group");var sp=r(81381);function cp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,dp()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function dp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dp=function(){return!!e})()}var pp=function(e){function t(){return(0,w.A)(this,t),cp(this,t,arguments)}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,l=e.removeSelf,i=e.setLock,a=e.isLocked,u=e.isTrueLocked,s=e.id,c=t.settings,d=c.immutableGroupsMode,p=c.addRuleLabel,f=c.delGroupLabel,v=c.renderButton,g=c.renderIcon,h=c.renderSwitch,y=c.renderButtonGroup,m=c.lockLabel,b=c.lockedLabel,O=c.showLock,A=c.canDeleteLocked,S=function(e){return g(e,t.ctx)},F=function(e){return v(e,t.ctx)},w=function(e){return h(e,t.ctx)},j=function(e){return y(e,t.ctx)},E=O&&!(a&&!u)&&k.createElement(w,{type:"lock",id:s,value:a,setValue:i,label:m,checkedLabel:b,hideLabel:!0,config:t}),C=!d&&n&&!a&&k.createElement(F,{type:"addRuleGroup",onClick:r,label:p,readonly:a,config:t,renderIcon:S}),L=!d&&o&&(!a||a&&A)&&k.createElement(F,{type:"delRuleGroup",onClick:l,label:f,config:t,renderIcon:S});return k.createElement("div",{className:"group--actions"},k.createElement(j,{config:t},E,C,L))}}])}(k.PureComponent);function fp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fp(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,hp()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function hp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(hp=function(){return!!e})()}var yp=function(e){function t(e){var r;return(0,w.A)(this,t),(r=gp(this,t,[e])).childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){(0,sp.A)((0,C.A)(t.prototype),"onPropsChanged",this).call(this,e)}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.children1;return(null==t?void 0:t.size)||0}},{key:"renderChildrenWrapper",value:function(){return k.createElement(k.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),(0,sp.A)((0,C.A)(t.prototype),"renderChildrenWrapper",this).call(this))}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,l=e.setField,i=e.setFuncValue,a=e.setFieldSrc,u=e.parentField,s=e.id,c=e.groupId,d=e.isLocked,p=t.settings.immutableFieldsMode;return k.createElement(Ld,{key:"field",classname:"group--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:l,setFuncValue:i,setFieldSrc:a,parentField:u,readonly:p||d,id:s,groupId:c})}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,l=e.id;return k.createElement(pp,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:l})}},{key:"extraPropsForItem",value:function(e){return{parentField:this.props.selectedField}}}])}(ap);yp.propTypes=vp(vp({},ap.propTypes),{},{selectedField:ns().any,selectedFieldSrc:ns().string,parentField:ns().string,setField:ns().func,setFieldSrc:ns().func});const mp=Qd(tc("group rule_group")(yc(yp)),"rule_group");function bp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Op()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Op(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Op=function(){return!!e})()}var Ap=function(e){function t(){return(0,w.A)(this,t),bp(this,t,arguments)}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,l=e.removeSelf,i=e.setLock,a=e.isLocked,u=e.isTrueLocked,s=e.id,c=t.settings,d=c.immutableGroupsMode,p=c.addSubRuleLabel,f=c.delGroupLabel,v=c.renderButton,g=c.renderIcon,h=c.renderSwitch,y=c.renderButtonGroup,m=c.lockLabel,b=c.lockedLabel,O=c.showLock,A=c.canDeleteLocked,S=function(e){return g(e,t.ctx)},F=function(e){return v(e,t.ctx)},w=function(e){return h(e,t.ctx)},j=function(e){return y(e,t.ctx)},E=O&&!(a&&!u)&&k.createElement(w,{type:"lock",id:s,value:a,setValue:i,label:m,checkedLabel:b,config:t}),C=!d&&n&&!a&&k.createElement(F,{type:"addRuleGroupExt",onClick:r,label:p,readonly:a,config:t,renderIcon:S}),L=!d&&o&&(!a||a&&A)&&k.createElement(F,{type:"delRuleGroup",onClick:l,label:f,config:t,renderIcon:S});return k.createElement("div",{className:"group--actions group--actions--tr"},k.createElement(j,{config:t},E,C,L))}}])}(k.PureComponent);function Sp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fp(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sp(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sp(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function wp(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Ep()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Ep(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ep=function(){return!!e})()}var Cp=ts.ConfigUtils,Lp=Cp.getFieldConfig,kp=Cp.getFieldWidgetConfig,_p=ts.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,Tp=function(e){function t(e){var r;return(0,w.A)(this,t),(r=jp(this,t,[e])).childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!0},r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){(0,sp.A)((0,C.A)(t.prototype),"onPropsChanged",this).call(this,e)}},{key:"renderHeaderWrapper",value:function(){return k.createElement("div",{key:"group-header",className:Gs()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return k.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return k.createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings,o=n.renderRuleError,l=n.showErrorMessage,i=(0,P.A)((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return l&&i&&k.createElement("div",{className:"rule_group--error"},o?o({error:i},t.ctx):i)}},{key:"showNot",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=(e.selectedOperator,Lp(t,r)||{});return null!=n.showNot?n.showNot:t.settings.showNot}},{key:"conjunctionOptions",value:function(){var e=this.props,r=e.config,n=e.selectedField,o=(e.selectedOperator,Lp(r,n)||{}),l=(0,sp.A)((0,C.A)(t.prototype),"conjunctionOptions",this).call(this);if(o.conjunctions){var i,a={},u=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return wp(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wp(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw l}}}}(o.conjunctions);try{for(u.s();!(i=u.n()).done;){var s=i.value,c=l[s];c&&(a[s]=c)}}catch(e){u.e(e)}finally{u.f()}l=a}return l}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,l=e.setField,i=e.setFieldSrc,a=e.setFuncValue,u=e.parentField,s=e.id,c=e.groupId,d=e.isLocked,p=t.settings.immutableFieldsMode;return k.createElement(Ld,{key:"field",classname:"rule--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:l,setFuncValue:a,setFieldSrc:i,parentField:u,readonly:p||d,id:s,groupId:c})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedOperator,l=(e.setField,e.setOperator),i=e.isLocked,a=t.settings.immutableFieldsMode,u=kp(t,r,o)||{},s=u.hideOperator,c=r&&s&&u.operatorInlineLabel,d=r&&!s;return k.createElement(Sc,{key:"operator",classname:"group--operator",config:t,selectedField:r,selectedFieldSrc:n,selectedOperator:o,setOperator:l,showOperator:d,showOperatorLabel:c,selectedFieldWidgetConfig:u,readonly:a||i,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config,n=this._buildWidgetProps(this.props);return _p(n,t,r)}},{key:"_buildWidgetProps",value:function(e){var t=e.selectedField,r=e.selectedFieldSrc,n=e.selectedFieldType,o=e.selectedOperator,l=e.operatorOptions,i=e.value,a=e.valueType,u=(e.valueSrc,e.asyncListValues,e.valueError);return e.fieldError,{field:t,fieldSrc:r,fieldType:n,operator:o,operatorOptions:l,value:i,valueType:a,valueSrc:["value"],valueError:u,fieldError:null,parentField:e.parentField}}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.isLocked,l=t.settings.immutableValuesMode;if(!r||!n)return null;var i=k.createElement(bd,(0,Ws.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:t,setValue:l?gc:this.props.setValue,setValueSrc:gc,readonly:l||o,id:this.props.id,groupId:this.props.groupId}));return k.createElement(vc,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},i)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,l=e.id;return k.createElement(Ap,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:l})}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.children1;return(null==t?void 0:t.size)||0}},{key:"extraPropsForItem",value:function(e){return{parentField:this.props.selectedField}}}])}(ap);Tp.propTypes=Fp(Fp({},ap.propTypes),{},{selectedField:ns().any,selectedFieldSrc:ns().string,selectedOperator:ns().string,value:ns().any,parentField:ns().string,setField:ns().func,setFieldSrc:ns().func,setOperator:ns().func,setValue:ns().func,valueError:ns().any});const Pp=Qd(tc("group rule_group_ext")(yc(Tp)),"rule_group");function Vp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Ip()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Ip(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ip=function(){return!!e})()}var xp={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},Dp=function(e){function t(){return(0,w.A)(this,t),Vp(this,t,arguments)}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.setLock,l=e.isLocked,i=e.isTrueLocked,a=e.id,u=e.canAddGroup,s=e.canAddDefault,c=t.settings,d=c.immutableGroupsMode,p=c.addCaseLabel,f=c.addDefaultCaseLabel,v=c.groupActionsPosition,g=c.renderButton,h=c.renderIcon,y=c.renderSwitch,m=c.renderButtonGroup,b=c.lockLabel,O=c.lockedLabel,A=c.showLock,S=function(e){return h(e,t.ctx)},F=function(e){return g(e,t.ctx)},w=function(e){return y(e,t.ctx)},j=function(e){return m(e,t.ctx)},E=xp[v||"topRight"],C=A&&!(l&&!i)&&k.createElement(w,{type:"lock",id:a,value:l,setValue:o,label:b,checkedLabel:O,config:t}),L=!d&&u&&!l&&k.createElement(F,{type:"addCaseGroup",onClick:r,label:p,readonly:l,config:t,renderIcon:S}),_=!d&&s&&!l&&k.createElement(F,{type:"addDefaultCaseGroup",onClick:n,label:f,readonly:l,config:t,renderIcon:S});return k.createElement("div",{className:"group--actions ".concat(E)},k.createElement(j,{config:t},C,L,_))}}])}(k.PureComponent);function Np(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Mp()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Mp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mp=function(){return!!e})()}var qp=ts.TreeUtils,Wp=qp.getTotalReordableNodesCountInTree,Bp=qp.getTotalRulesCountInTree,Gp=function(e){function t(e){var r;return(0,w.A)(this,t),(r=Rp(this,t,[e])).childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var e;return(null===(e=r.props.children1)||void 0===e?void 0:e.size)&&r.props.children1.filter((function(e){return null==e.get("children1")})).size>0},r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){(0,sp.A)((0,C.A)(t.prototype),"onPropsChanged",this).call(this,e)}},{key:"canAddGroup",value:function(){var e,t=this.props.config.settings.maxNumberOfCases,r=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return!t||r<t}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var e,t=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return this.hasDefaultCase()&&t--,t}},{key:"totalRulesCntForItem",value:function(e){return Bp(e)}},{key:"reordableNodesCntForItem",value:function(e){var t;if(this.props.isLocked)return 0;var r=this.props.config.settings,n=r.canLeaveEmptyCase,o=r.canRegroupCases,l=(null===(t=this.props.children1)||void 0===t?void 0:t.size)||0;this.hasDefaultCase()&&l--;var i=Wp(e);return 1==i&&o&&n&&l>1&&(i=111),i}},{key:"renderHeaderWrapper",value:function(){return k.createElement("div",{key:"group-header",className:Gs()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return k.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){return this.props.config.settings.renderSwitchPrefix||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.isLocked,l=e.isTrueLocked,i=e.id;return k.createElement(Dp,{config:t,addCaseGroup:r,addDefaultCaseGroup:n,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:o,isTrueLocked:l,id:i})}}])}(ap);Gp.propTypes=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Np(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Np(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},ap.propTypes);const zp=Qd(tc("group switch_group")(yc(Gp)),"switch_group");function Up(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Up(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Up(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Jp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Hp()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Hp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Hp=function(){return!!e})()}var Kp=function(e){function t(e){var r;return(0,w.A)(this,t),(r=Jp(this,t,[e])).childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var r=this.props,n=!this.renderBeforeCaseValue||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if((0,sp.A)((0,C.A)(t.prototype),"onPropsChanged",this).call(this,e),n){var o=e.config,l=o.settings,i=l.renderBeforeCaseValue,a=l.renderAfterCaseValue,u=l.renderRuleError;this.BeforeCaseValue=bc(o,i),this.AfterCaseValue=bc(o,a),this.RuleError=bc(o,u)}}},{key:"isDefaultCase",value:function(){return null==this.props.children1}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return!this.isDefaultCase()&&(0,sp.A)((0,C.A)(t.prototype),"showDragIcon",this).call(this)}},{key:"renderHeaderWrapper",value:function(){return k.createElement("div",{key:"group-header",className:Gs()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:k.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderBeforeValue(),this.renderValue(),this.renderAfterValue())}},{key:"renderHeaderLeft",value:function(){return this.isDefaultCase()?this.props.config.settings.defaultCaseLabel||"":k.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag(),this.renderError())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:(0,sp.A)((0,C.A)(t.prototype),"renderChildrenWrapper",this).call(this)}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?k.createElement("div",null,this.renderValue(),this.renderError()):null}},{key:"canAddGroup",value:function(){return!this.isDefaultCase()&&(0,sp.A)((0,C.A)(t.prototype),"canAddGroup",this).call(this)}},{key:"canAddRule",value:function(){return!this.isDefaultCase()&&(0,sp.A)((0,C.A)(t.prototype),"canAddRule",this).call(this)}},{key:"renderBeforeValue",value:function(){var e=this.BeforeCaseValue;return null==e?null:k.createElement(e,(0,Ws.A)({key:"values-before"},this.props))}},{key:"renderAfterValue",value:function(){var e=this.AfterCaseValue;return null==e?null:k.createElement(e,(0,Ws.A)({key:"values-after"},this.props))}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings.showErrorMessage,o=this.RuleError,l=(0,P.A)((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return n&&l&&k.createElement("div",{className:"rule--error"},o?k.createElement(o,{error:l}):l)}},{key:"renderValue",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.value,o=e.valueSrc,l=e.valueError,i=e.setValue,a=e.setValueSrc,u=e.setFuncValue,s=e.id,c=t.settings.immutableValuesMode,d=k.createElement(bd,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:n,valueSrc:null!=o?o:"value",valueError:l,fieldError:null,config:t,setValue:c?gc:i,setValueSrc:c?gc:a,setFuncValue:c?gc:u,readonly:c||r,id:s,groupId:null});return k.createElement(vc,{className:"case_group--value"},d)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addGroup,n=e.addRule,o=e.isLocked,l=e.isTrueLocked,i=e.id;return k.createElement(tp,{config:t,addGroup:r,addRule:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:l,id:i})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props.value,r=e&&e.size?e.get(0):null,n=null!=r&&(!Array.isArray(r)||r.length>0);return(0,sp.A)((0,C.A)(t.prototype),"isEmptyCurrentGroup",this).call(this)&&!n}}])}(ap);Kp.propTypes=$p($p({},ap.propTypes),{},{parentReordableNodesCnt:ns().number,value:ns().any,setValue:ns().func});const Yp=Qd(tc("group case_group")(yc(Kp)),"case_group");var Qp=["type"];function Xp(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Zp()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Zp(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Zp=function(){return!!e})()}function ef(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ef(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ef(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var rf=function(e){var t,r=(null===(t=e.properties)||void 0===t?void 0:t.toObject())||{},n=tf({},r);return e.isParentLocked&&(n.isLocked=!0),r.isLocked&&(n.isTrueLocked=!0),n},nf={rule:function(e){return k.createElement(Ud,(0,Ws.A)({},rf(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},group:function(e){return k.createElement(up,(0,Ws.A)({},rf(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group:function(e){return k.createElement(mp,(0,Ws.A)({},rf(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},rule_group_ext:function(e){return k.createElement(Pp,(0,Ws.A)({},rf(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentReordableNodesCnt:e.parentReordableNodesCnt}))},switch_group:function(e){return k.createElement(zp,(0,Ws.A)({},rf(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return k.createElement(Yp,(0,Ws.A)({},rf(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},of=function(e){function t(){return(0,w.A)(this,t),Xp(this,t,arguments)}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){var e,t=this.props,r=t.type,n=(0,ma.A)(t,Qp),o="array"==(null===(e=n.properties)||void 0===e?void 0:e.get("mode"))?"_ext":"",l=n.config.settings.renderItem,i=nf[r+o];return l?l(tf(tf({},n),{},{type:r,itemComponent:i}),n.config.ctx):i?i(n):null}}])}(k.PureComponent);function lf(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,af()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function af(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(af=function(){return!!e})()}of.propTypes={config:ns().object.isRequired,id:ns().string.isRequired,groupId:ns().string,type:ns().oneOf(["rule","group","rule_group","switch_group","case_group"]).isRequired,path:ns().any.isRequired,properties:ns().any,children1:ns().any,actions:ns().object.isRequired,reordableNodesCnt:ns().number,onDragStart:ns().func,parentField:ns().string,isDraggingTempo:ns().bool,isParentLocked:ns().bool};var uf=ts.TreeUtils,sf=uf.getTotalReordableNodesCountInTree,cf=uf.getTotalRulesCountInTree,df=ts.DefaultUtils,pf=df.createListWithOneElement,ff=df.emptyProperties,vf=function(e){function t(e){var r;return(0,w.A)(this,t),(r=lf(this,t,[e])).pureShouldComponentUpdate=Es(r),r._updPath(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.pureShouldComponentUpdate(e,t)}},{key:"_updPath",value:function(e){var t=e.tree.get("id");this.path=pf(t)}},{key:"render",value:function(){var e=this.props,t=e.tree,r=e.config,n=e.actions,o=e.onDragStart,l=t.get("type"),i="switch_group"==l,a=i?null:sf(t),u=i?null:cf(t),s=t.get("id");return k.createElement(of,{key:s,id:s,path:this.path,type:l,properties:t.get("properties")||ff(),config:r,actions:n,children1:t.get("children1")||ff(),reordableNodesCnt:a,totalRulesCnt:u,parentReordableNodesCnt:0,onDragStart:o})}}])}(k.Component);vf.propTypes={tree:ns().any.isRequired,config:ns().object.isRequired,actions:ns().object.isRequired,onDragStart:ns().func};const gf=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(0,as.Ng)((function(e){return{dragging:e.dragging,dragStart:e.dragStart,mousePos:e.mousePos}}),{setDragStart:fs,setDragProgress:ps,setDragEnd:vs},null,{context:ls})(function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=function(t){function n(e){var t;return(0,w.A)(this,n),(t=Js(this,n,[e]))._getEventTarget=function(e,t){return e&&e.__mocked_window||document.body||window},t.onDragStart=function(e,r,n){var o=r.closest(".query-builder");void 0===t._isUsingLegacyReactDomRender&&(t._isUsingLegacyReactDomRender=ws(o)),document.body.classList.add("qb-dragging"),o.classList.add("qb-dragging");var l,i=o.closest(".query-builder-container")||o,a=(i=t._getScrollParent(i)||document.body).scrollTop,u=(t._getDraggableNodeEl(o),t._getPlaceholderNodeEl(o),o.querySelectorAll(".group--children")),s=u.length?u[0]:null;s&&(l=window.getComputedStyle(s,null).getPropertyValue("padding-left"),l=parseInt(l));var c={id:e,x:r.offsetLeft,y:r.offsetTop,w:r.offsetWidth,h:r.offsetHeight,itemInfo:t.tree.items[e],paddingLeft:l},d={id:e,x:r.offsetLeft,y:r.offsetTop,scrollTop:a,clientX:n.clientX,clientY:n.clientY,itemInfo:Ks(t.tree.items[e]),treeEl:o,treeElContainer:i},p={clientX:n.clientX,clientY:n.clientY},f=t._getEventTarget(n,d);t.eventTarget=f,f.addEventListener("mousemove",t.onDrag),f.addEventListener("mouseup",t.onDragEnd),t.props.setDragStart(d,c,p)},t.onDrag=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object.assign({},t.props.dragging),l=t.props.dragStart,i=o.paddingLeft,a=l.treeElContainer.scrollTop;if(o.itemInfo=t.tree.items[o.id],o.itemInfo){var u={clientX:e.clientX,clientY:e.clientY},s={clientX:l.clientX,clientY:l.clientY};if(e.__mock_dom){var c=l.treeEl,d=t._getDraggableNodeEl(c),p=t._getPlaceholderNodeEl(c);e.__mock_dom({treeEl:c,dragEl:d,plhEl:p})}if(!l.plX){var f=l.treeEl,v=t._getPlaceholderNodeEl(f);v&&(l.plX=v.getBoundingClientRect().left+window.scrollX,l.plY=v.getBoundingClientRect().top+window.scrollY)}var g=l.x,h=l.y,y=l.clientX,m=l.clientY,b=l.scrollTop,O={x:g+(e.clientX-y),y:h+(e.clientY-m)+(a-b)};o.x=O.x,o.y=O.y,o.paddingLeft=i,o.mousePos=u,o.startMousePos=s,t.props.setDragProgress(u,o),n&&t.handleDrag(o,e,r)||e.preventDefault&&e.preventDefault()}},t.onDragEnd=function(){var e=t.props.dragStart.treeEl;t.props.setDragEnd(),e.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),t._cacheEls={};var r=t.eventTarget||t._getEventTarget();r.removeEventListener("mousemove",t.onDrag),r.removeEventListener("mouseup",t.onDragEnd)},t.pureShouldComponentUpdate=Es(t),Cs(t),t.onPropsChanged(e),t}return(0,L.A)(n,t),(0,j.A)(n,[{key:"onPropsChanged",value:function(e){this.tree=Ys(e.tree)}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var l=[];for(var i in e)e[i]!=r[i]&&"dragging"!=i&&"mousePos"!=i&&l.push(i);l.length||(o=!1)}return o}},{key:"componentDidUpdate",value:function(e,t){var r=this.props.dragging,n=this.props.dragStart;if(Qs=!1,n&&n.id&&(r.itemInfo=this.tree.items[r.id],r.itemInfo&&(r.itemInfo.index!=n.itemInfo.index||r.itemInfo.parent!=n.itemInfo.parent))){var o=n.treeEl,l=n.treeElContainer,i=this._getPlaceholderNodeEl(o,!0);if(i){var a=i.getBoundingClientRect().left+window.scrollX,u=i.getBoundingClientRect().top+window.scrollY,s=n.plX,c=n.plY,d=l.scrollTop;n.plX=a,n.plY=u,n.itemInfo=Ks(r.itemInfo),n.y=i.offsetTop,n.x=i.offsetLeft,n.clientY+=u-c,n.clientX+=a-s,l!=document.body&&(n.scrollTop=d),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t)return null;this._cacheEls||(this._cacheEls={});var n=this._cacheEls[t];return n&&document.contains(n)&&!r||(n=e.querySelector('.group-or-rule-container[data-id="'+t+'"]'),this._cacheEls[t]=n),n}},{key:"_getDraggableNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.draggable;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-draggable");return r=n.length?n[0]:null,this._cacheEls.draggable=r,r}},{key:"_getPlaceholderNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.placeholder;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-placeholder");return r=n.length?n[0]:null,this._cacheEls.placeholder=r,r}},{key:"_isScrollable",value:function(e){var t=window.getComputedStyle(e)["overflow-y"];return("scroll"===t||"auto"===t)&&e.scrollHeight>e.offsetHeight}},{key:"_getScrollParent",value:function(e){return null==e?null:e===document.body||this._isScrollable(e)?e:this._getScrollParent(e.parentNode)}},{key:"handleDrag",value:function(e,t,r){var n,o,l,i,a=this,u=e.itemInfo,s=e.paddingLeft,c=null,d=this.props.dragStart.treeEl,p=e.id,f=this._getDraggableNodeEl(d),v=this._getPlaceholderNodeEl(d);if(f&&v){if(n=f.getBoundingClientRect(),!(o=v.getBoundingClientRect()).width)return;var g={hrz:0,vrt:0};n.top<o.top?g.vrt=-1:n.bottom>o.bottom&&(g.vrt=1),n.left>o.left?g.hrz=1:n.left<o.left&&(g.hrz=-1);var h,y={x:(i=d.getBoundingClientRect()).left+(i.right-i.left)/2,y:g.vrt>=0?n.bottom:n.top};if(t.__mocked_hov_container)h=t.__mocked_hov_container;else{var m=document.elementFromPoint(y.x,y.y-1);if(!(h=m?m.closest(".group-or-rule-container"):null)&&m&&m.classList.contains("query-builder-container")){var b,O=null==m||null===(b=m.firstChild)||void 0===b?void 0:b.firstChild;O&&O.classList.contains("group-or-rule-container")&&(h=O)}}if(h){var A=h.classList.contains("group-container"),S=h.getAttribute("data-id"),F=h,w=!1,j=!1;if(F){var E=(l=F.getBoundingClientRect()).bottom-l.top,C=this.tree.items[S];if(!C)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var L=null,k=null,_=null,T=null;if(0==g.vrt)_=u,(k=v)&&(L=k.getBoundingClientRect());else if(A){if(g.vrt>0){var V=h.getElementsByClassName("group--header"),I=V.length?V[0]:null;if(I){var x=I.getBoundingClientRect(),D=x.bottom-x.top;n.bottom-x.top>3*D/4&&C.top>e.itemInfo.top&&(_=C,L=x,k=I,j=!0)}}else g.vrt<0&&C.lev>=u.lev&&l.bottom-n.top>=2&&C.top<e.itemInfo.top&&(_=C,L=l,k=F,w=!0);(g.vrt<0?l.bottom-n.top>E-5:n.bottom-l.top>E-5)&&(j||w||(_=C,L=l,k=F),T=C)}else(g.vrt<0?l.bottom-n.top>E/2:n.bottom-l.top>E/2)&&(_=C,L=l,k=F);var N=_&&_.id==p;if(L){var R=n.left-i.left,M=(L.left,i.left,Math.max(0,Math.round(R/s))),q=[],W=[];if(N);else{if(A&&(w?q.push([cs,_,_.lev+1]):j&&q.push([ds,_,_.lev+1]),T)){var B=0==T.lev,G="case_group"==T.type&&"case_group"!=u.type,z=T.prev&&this.tree.items[T.prev].caseId,U=T.next&&this.tree.items[T.next].caseId;u.caseId==z&&(z=null),u.caseId==U&&(U=null);var $=z&&this.tree.items[z],J=U&&this.tree.items[U];g.vrt>0?B?W.push([cs,T,T.lev+1]):G&&J?W.push([ds,J,J.lev+1]):W.push([us,T,T.lev]):g.vrt<0&&(B?W.push([ds,T,T.lev+1]):G&&$?W.push([cs,$,$.lev+1]):W.push([ss,T,T.lev]))}w||j||(g.vrt<0?q.push([ss,_,_.lev]):g.vrt>0&&q.push([us,_,_.lev]))}var H=function(e){var t=e[1],r=u.caseId?a.tree.items[u.caseId]:null,n=t.caseId?a.tree.items[t.caseId]:null;return[].concat((0,P.A)(e),[r,n])};q=q.map(H),W=W.map(H);var K=null,Y=(q=q.filter((function(e){var t=e[0],r=e[1];if((t==ss||t==us)&&null==r.parent)return!1;if(r.collapsed&&(t==cs||t==ds))return!1;var n=r.id==u.id;if(!n)for(var o=r;o.parent;)if((o=a.tree.items[o.parent]).id==u.id){n=!0;break}return!n})).map((function(e){var t=e[0],r=e[1],n=(e[2],e[3],e[4],null);return(n=t==cs||t==ds?r:a.tree.items[r.parent])&&null==n.parent&&(n=null),e[5]=n,e}))).filter((function(e){return a.canMove(u,e[1],e[0],e[3],e[4],e[5],r)}));0==Y.length&&W.length>0&&(Y=W.filter((function(e){return a.canMove(u,e[1],e[0],e[3],e[4],e[5],r)})));var Q=Y.map((function(e){return e[2]})),X=u.lev,Z=Q.concat(X),ee=null;-1!=Z.indexOf(M)?ee=M:M>Math.max.apply(Math,(0,P.A)(Z))?ee=Math.max.apply(Math,(0,P.A)(Z)):M<Math.min.apply(Math,(0,P.A)(Z))&&(ee=Math.min.apply(Math,(0,P.A)(Z))),K=Y.find((function(e){return e[2]==ee})),N||K||!Y.length||(K=Y[0]),c=K}}}else As.log("out of tree bounds!")}return!!c&&(this.move(u,c[1],c[0],c[3]),!0)}},{key:"canMove",value:function(e,t,r,n,o,l,i){if(!e||!t)return!1;if(e.id===t.id)return!1;var a=this.props.config.settings,u=a.canRegroup,s=a.canRegroupCases,c=a.maxNesting,d=a.maxNumberOfRules,p=a.canLeaveEmptyCase,f=(l?l.lev+1:t.lev)+(e.depth||0),v=r==ss||r==us,g=r==ds||r==cs,h=v&&1==t.lev||g&&0==t.lev,y=e.parent!=t.parent,m=g||y,b="case_group"==e.type&&!h||"rule_group"==e.parentType||"rule_group"==t.type||"rule_group"==t.parentType||"case_group"!=e.type&&"case_group"==t.type&&v||"case_group"!=e.type&&"switch_group"==t.type||!s&&e.caseId!=t.caseId,O=t.isLocked||e.isLocked||l&&l.isLocked;if(c&&f>c)return!1;if(m&&(!u||b||O))return!1;if("case_group"!=e.type&&e.caseId!=t.caseId){var A=!!n&&2==n._height,S=o?o.atomicRulesCountInCase+1:0;if(d&&S>d)return!1;if(A&&!p)return!1}if("case_group"==e.type&&(e.isDefaultCase||t.isDefaultCase||"switch_group"==t.type&&r==cs))return!1;var F=!0;return i&&(F=i(e.node.toJS(),t.node.toJS(),r,l?l.node.toJS():null)),F}},{key:"move",value:function(e,t,r,n){this._isUsingLegacyReactDomRender||(Qs=!0),this.props.actions.moveItem(e.path,t.path,r)}},{key:"render",value:function(){return k.createElement(e,(0,Ws.A)({},this.props,{onDragStart:this.onDragStart}))}}])}(k.Component),t.propTypes={tree:ns().any.isRequired,actions:ns().object.isRequired},t}(e,t));return r.displayName="ConnectedSortableContainer",r}(vf);function hf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yf(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,mf()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function mf(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(mf=function(){return!!e})()}var bf=ts.clone,Of=ts.ConfigUtils,Af=Of.getFieldConfig,Sf=Of.getFieldParts,Ff=Of.getFieldPathParts,wf=ts.RuleUtils,jf=wf.getFieldPathLabels,Ef=wf.getWidgetForFieldOp,Cf=function(e){function t(e){var r;return(0,w.A)(this,t),r=yf(this,t,[e]),Cs(r),r.onPropsChanged(e),r}return(0,L.A)(t,e),(0,j.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0,n=!this.meta||["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0;r&&(this.items=this.getItems(e)),n&&(this.meta=this.getMeta(e))}},{key:"getItems",value:function(e){var t=e.config,r=e.field,n=e.fieldType,o=e.operator,l=e.parentField,i=e.isFuncArg,a=e.fieldDefinition,u=t.settings.canCompareFieldWithField,s=Sf(l,t),c=l?Af(t,l):null,d=l?null==c?void 0:c.subfields:t.fields,p=this.filterFields(t,d,r,l,s,o,u,i,a,n);return this.buildOptions(s,t,p,s)}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.field,o=(e.fieldType,e.operator,e.value),l=e.placeholder,i=e.isFuncArg,a=e.parentField,u=r.settings,s=u.fieldPlaceholder,c=u.fieldSeparatorDisplay,d=o,p=!!o,f=n?Af(r,n):{},v=null==f||null===(t=f.widgets)||void 0===t?void 0:t.field,g=(null==v?void 0:v.widgetProps)||{},h=p?null:i&&l||g.valuePlaceholder||s,y=p?Af(r,d):null,m=y||{},b=Ff(d,r),O=Ff(d,r,!0),A=this.getFieldLabel(y,d,r),S=jf(d,r),F=S?S.join(c):null;return(F==A||a)&&(F=null),{placeholder:h,selectedKey:d,selectedKeys:b,selectedPath:O,selectedLabel:A,selectedOpts:m,selectedAltLabel:m.label2||m.tooltip,selectedFullLabel:F}}},{key:"filterFields",value:function(e,t,r,n,o,l,i,a,u,s){t=bf(t);var c,d=e.settings.fieldSeparator,p=Af(e,r),f=Ef(e,r,l,"value");return e.widgets[f],c=a?null==u?void 0:u.type:p?p.type:s,function t(n,o){for(var u in n){var s=n[u].subfields,f=(o||[]).concat(u),v=f.join(d),g=Af(e,v);if(g)if("!struct"==g.type||"!group"==g.type)0==t(s,f)&&delete n[u];else{var h=!(c&&g.type!=c||!a&&v==r),y=i||e.settings.canCompareFieldWithField;y&&(h=h&&y(r,p,v,g,l)),h||delete n[u]}else delete n[u]}return nc()(n).length}(t,o||[]),t}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!r)return null;var i=t.settings,a=i.fieldSeparator,u=i.fieldSeparatorDisplay,s=null!=o&&o.length?o.join(a)+a:"";return nc()(r).map((function(i){var a=[].concat((0,P.A)(null!=o?o:[]),[i]),c=r[i],d=n.getFieldLabel(c,a,t),p=jf(a,t).join(u);(p==d||e)&&(p=null);var f=c.label2,v=c.tooltip;if(!c.hideForCompare)return"!struct"==c.type||"!group"==c.type?{key:i,path:s+i,label:d,fullLabel:p,altLabel:f,tooltip:v,items:n.buildOptions(e,t,c.subfields,a,{label:d,tooltip:v})}:{key:i,path:s+i,label:d,fullLabel:p,altLabel:f,tooltip:v,grouplabel:null==l?void 0:l.label,group:l}})).filter((function(e){return!!e}))}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Sf(t,r),l=(null==e?void 0:e.label)||ve()(o);return ms(l,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,l=e.id,i=e.groupId,a=t.settings.renderField,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hf(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isValueField:!0,config:t,customProps:r,setField:n,readonly:o,items:this.items,id:l,groupId:i},this.meta);return a(u,t.ctx)}}])}(k.Component);Cf.propTypes={id:ns().string,groupId:ns().string,setValue:ns().func.isRequired,config:ns().object.isRequired,field:ns().any,fieldSrc:ns().string,fieldType:ns().string,value:ns().string,operator:ns().string,customProps:ns().object,readonly:ns().bool,parentField:ns().string,fieldDefinition:ns().object,isFuncArg:ns().bool};const Lf=function(e){var t=e.value,r=e.setValue,n=(e.config,e.labelYes),o=e.labelNo,l=e.readonly,i=(e.widgetId,e.customProps),a=void 0===i?{}:i,u=a.radioYes||{},s=a.radioNo||{},c=function(e){return r("true"==e.target.value)};return k.createElement(k.Fragment,null,k.createElement("input",(0,Ws.A)({type:"radio",value:!0,checked:!!t,disabled:l,onChange:c},u))," ",n,k.createElement("input",(0,Ws.A)({type:"radio",value:!1,checked:!t,disabled:l,onChange:c},s))," ",o)},kf=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,l=e.maxLength,i=e.customProps,a=t||"";return k.createElement("input",(0,Ws.A)({type:"text",value:a,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:l},i))},_f=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,l=e.maxLength,i=(e.maxRows,e.fullWidth),a=e.customProps,u=t||"";return k.createElement("textarea",(0,Ws.A)({value:u,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:l,style:{width:i?"100%":void 0}},a))};ts.moment;const Tf=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.readonly),o=e.customProps;return k.createElement("input",(0,Ws.A)({type:"date",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))},Pf=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.use12Hours,e.readonly),o=e.customProps;return k.createElement("input",(0,Ws.A)({type:"time",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))};var Vf=ts.moment;const If=function(e){var t,r=e.value,n=e.setValue,o=(e.config,e.valueFormat),l=(e.use12Hours,e.readonly),i=e.customProps;return t=r?Vf(r).format("YYYY-MM-DDTHH:mm"):"",k.createElement("input",(0,Ws.A)({type:"datetime-local",value:t,disabled:l,onChange:function(e){var t=e.target.value;t=""==t?void 0:Vf(new Date(t)).format(o),n(t)}},i))};var xf=ts.ListUtils.mapListValues;const Df=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),l=e.customProps;return k.createElement("select",(0,Ws.A)({multiple:!0,onChange:function(e){return n(function(e){for(var t=[],r=e.options,n=0;n<r.length;n++){var o=r[n];o.selected&&t.push(o.value)}return t.length||(t=void 0),t}(e.target))},value:r,disabled:o},he()(l,["showSearch","input","showCheckboxes"])),xf(t,(function(e){var t=e.title,r=e.value;return k.createElement("option",{key:r,value:r},t)})))};var Nf=ts.ListUtils.mapListValues;const Rf=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),l=e.customProps,i=null!=r;return k.createElement("select",(0,Ws.A)({onChange:function(e){return n(e.target.value)},value:i?r:"",disabled:o},he()(l,["showSearch","input"])),!i&&k.createElement("option",{disabled:!0,value:""}),Nf(t,(function(e){var t=e.title,r=e.value;return k.createElement("option",{key:r,value:r},t)})))},Mf=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,l=e.max,i=e.step,a=e.placeholder,u=e.customProps,s=null==t?"":t;return k.createElement("input",(0,Ws.A)({type:"number",value:s,placeholder:a,disabled:n,min:o,max:l,step:i,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},u))},qf=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,l=e.max,i=e.step,a=e.placeholder,u=e.customProps,s=void 0===u?{}:u,c=s.input||{},d=s.slider||s,p=function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},f=null==t?"":t;return k.createElement("div",{style:{display:"inline-flex"}},k.createElement("input",(0,Ws.A)({key:"number",type:"number",value:f,placeholder:a,disabled:n,min:o,max:l,step:i,onChange:p},c)),k.createElement("input",(0,Ws.A)({key:"range",type:"range",value:f,disabled:n,min:o,max:l,step:i,onChange:p},d)))},Wf=function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,l=e.errorText,i=null!=n;return k.createElement("select",{onChange:function(e){return r(e.target.value)},value:i?n:"",disabled:o,style:{color:l?"red":null}},!i&&k.createElement("option",{disabled:!0,value:""}),function e(t){return t.map((function(t){var r=t.items,n=t.path,o=t.label,l=t.disabled,i=t.matchesType;if(r)return k.createElement("optgroup",{disabled:l,key:n,label:o},e(r));var a=i?{fontWeight:"bold"}:{};return k.createElement("option",{disabled:l,key:n,value:n,style:a},o)}))}(t))},Bf=function(e){var t,r=e.id,n=e.not,o=e.setNot,l=e.conjunctionOptions,i=e.setConjunction,a=e.disabled,u=e.readonly,s=e.config,c=e.showNot,d=e.notLabel,p=Object.keys(l).length,f=a,v=s.settings.forceShowConj||p>1&&!f,g=function(e){return i(e.target.value)};return[c&&(t="not",[k.createElement("input",{key:r+t,type:"checkbox",id:r+t,checked:n,disabled:u,onChange:function(e){return o(e.target.checked)}}),k.createElement("label",{key:r+t+"label",htmlFor:r+t},d||"NOT")]),v&&Object.keys(l).map((function(e){var t=l[e],r=t.id,n=t.name,o=t.label,s=t.checked,c=i.isDummyFn?"__dummy":"";return!u&&!a||s?[k.createElement("input",{key:r+c,type:"radio",id:r+c,name:n+c,checked:s,disabled:u||a,value:e,onChange:g}),k.createElement("label",{key:r+c+"label",htmlFor:r+c},o)]:null}))]};var Gf={addRuleGroup:"+",addRuleGroupExt:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const zf=function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,l=r||Gf[t];return k.createElement("button",{onClick:n,type:"button",disabled:o},l)},Uf=function(e){var t=e.type,r={}[t]||null;return r||"drag"!==t||(r=k.createElement(hc,null)),r},$f=function(e){var t=e.children;return e.config,k.createElement(k.Fragment,null,t)},Jf=function(e){e.config;var t=e.valueSources,r=e.valueSrc,n=(e.title,e.setValueSrc),o=e.readonly;return k.createElement("select",{onChange:function(e){return n(e.target.value)},value:r||"",disabled:o},function(e){return e.map((function(e){var t=(0,T.A)(e,2),r=t[0],n=t[1];return k.createElement("option",{key:r,value:r},n.label)}))}(t))},Hf=function(e){var t=e.value,r=e.setValue,n=e.label,o=e.id,l=(e.config,e.type);return[k.createElement("input",{key:o+l,type:"checkbox",id:o+l,checked:!!t,onChange:function(e){return r(e.target.checked)}}),k.createElement("label",{key:o+l+"label",htmlFor:o+l},n)]},Kf=function(e){var t=e.onOk,r=(e.okText,e.cancelText,e.title);confirm(r)&&t()};var Yf=function(e){return e.config,e.children};function Qf(e,t,r){return t=(0,C.A)(t),(0,E.A)(e,Xf()?Reflect.construct(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function Xf(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Xf=function(){return!!e})()}var Zf=function(e){function t(){var e;(0,w.A)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=Qf(this,t,[].concat(n))).handleChange=function(t){e.props.setOption("proximity",parseInt(t))},e}return(0,L.A)(t,e),(0,j.A)(t,[{key:"render",value:function(){var e=this.props,t=e.defaults,r=e.options,n=e.config,o=e.optionLabel,l=e.optionPlaceholder,i=e.customProps,a=e.minProximity,u=e.maxProximity,s=e.optionTextBefore,c=e.readonly,d=n.settings,p=n.widgets,f=n.ctx,v=t?t.proximity:void 0,g=d.showLabels,h=r.get("proximity",v),y=Jc()(a,u+1).map((function(e){return{title:e,value:e}})),m=p.select.factory,b=function(e){return m(e,f)};return k.createElement("div",{className:"operator--PROXIMITY"},k.createElement("div",{className:"operator--options"},g&&k.createElement("label",{className:"rule--label"},o),!g&&s&&k.createElement("div",{className:"operator--options--sep"},k.createElement("span",null,s)),k.createElement(b,(0,Ws.A)({config:n,value:h,listValues:y,setValue:this.handleChange,readonly:c,placeholder:l},i))),k.createElement("div",{className:"operator--widgets"},this.props.children))}}])}(k.PureComponent);function ev(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ev(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ev(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Zf.propTypes={config:ns().object.isRequired,setOption:ns().func.isRequired,options:ns().any.isRequired,minProximity:ns().number,maxProximity:ns().number,optionPlaceholder:ns().string,optionTextBefore:ns().string,optionLabel:ns().string,customProps:ns().object,readonly:ns().bool},Zf.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};var rv={conjunctions:tv({},Ya.conjunctions),operators:tv(tv({},Ya.operators),{},{proximity:tv(tv({},Ya.operators.proximity),{},{options:tv(tv({},Ya.operators.proximity.options),{},{factory:function(e,t){return(0,t.RCE)(t.O.ProximityOperator,e)}})})}),widgets:{text:tv(tv({},Ya.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}}),textarea:tv(tv({},Ya.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextAreaWidget,e)}}),number:tv(tv({},Ya.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaNumberWidget,e)}}),slider:tv(tv({},Ya.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSliderWidget,e)}}),select:tv(tv({},Ya.widgets.select),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSelectWidget,e)}}),multiselect:tv(tv({},Ya.widgets.multiselect),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaMultiSelectWidget,e)}}),date:tv(tv({},Ya.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateWidget,e)}}),time:tv(tv({},Ya.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTimeWidget,e)}}),datetime:tv(tv({},Ya.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateTimeWidget,e)}}),boolean:tv(tv({},Ya.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaBooleanWidget,e)}}),field:tv(tv({},Ya.widgets.field),{},{factory:function(e,t){return(0,t.RCE)(t.W.ValueFieldWidget,e)},customProps:{showSearch:!0}}),func:tv(tv({},Ya.widgets.func),{},{factory:function(e,t){return(0,t.RCE)(t.W.FuncWidget,e)},customProps:{}}),case_value:tv(tv({},Ya.widgets.case_value),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}})},types:tv(tv({},Ya.types),{},{select:tv(tv({},Ya.types.select),{},{widgets:tv(tv({},Ya.types.select.widgets),{},{select:tv(tv({},Ya.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),settings:tv(tv({},Ya.settings),{},{renderField:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderOperator:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.VanillaConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.VanillaSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.VanillaButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.VanillaIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.VanillaButtonGroup,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.VanillaProvider,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderFieldSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderConfirm:function(e,t){return(0,t.W.vanillaConfirm)(e)},renderSwitchPrefix:"IF",renderBeforeCaseValue:function(e,t){return(0,t.RCE)("span",{children:[" then "]})},customFieldSelectProps:{showSearch:!0},customOperatorSelectProps:{},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),ctx:tv(tv({},Ya.ctx),{},{W:tv({},A),O:tv({},S),RCE:function(e,t){return k.createElement(e,t)}})};const nv=rv=ts.ConfigMixins.removeMixins(rv,["rangeslider","treeselect","treemultiselect"]);var ov=r(89012),lv=r.n(ov);function iv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function av(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?iv(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var uv=ts.Autocomplete,sv=uv.mergeListValues,cv=uv.listValueToOption,dv=uv.optionToListValue,pv=uv.optionsToListValues,fv=uv.fixListValuesGroupOrder,vv=ts.ListUtils,gv=vv.mapListValues,hv=vv.listValuesToArray,yv=vv.getListValue,mv=vv.makeCustomListValue,bv=vv.searchListValue;function Ov(e){return new Promise((function(t){setTimeout(t,e)}))}vv.getItemInListValues;const Av=function(e,t){var r=e.asyncFetch,n=e.useLoadMore,o=e.useAsyncSearch,l=e.forceAsyncSearch,i=e.asyncListValues,a=e.listValues,u=e.allowCustomValues,s=e.value,c=e.setValue,d=e.placeholder,p=e.config,f=t.debounceTimeout,v=t.multiple,g=t.uif,h=t.isFieldAutocomplete,y=["LOAD_MORE","LOADING_MORE"],m="Load more...",b="Loading more...",O=l?"Type to search":d,A=k.useState(!1),S=(0,T.A)(A,2),F=S[0],w=S[1],j=k.useState(void 0),E=(0,T.A)(j,2),C=E[0],L=E[1],_=k.useState(0),V=(0,T.A)(_,2),I=V[0],x=V[1],D=k.useState(!1),N=(0,T.A)(D,2),R=N[0],M=N[1],q=k.useState(""),W=(0,T.A)(q,2),B=W[0],G=W[1],z=k.useState(void 0),U=(0,T.A)(z,2),$=U[0],J=U[1],H=k.useRef(0),K=k.useRef(0),Y=k.useRef(!1),Q=k.useMemo((function(){return hv(i)}),[i]),X=k.useMemo((function(){return r?i?sv($,Q,!0):$:hv(a)}),[r,i,$,a]),Z=r?$:hv(a);u&&B&&!bv(B,$)&&(Z=sv(Z,[mv(B)],!0)),!r||$||!i||B||F||"antd"!==g||(Z=X),r&&!u&&i&&"mui"===g&&(Z=sv(Z,Q,!0,!0));var ee=I>0,te=F&&r&&void 0===$&&(!l||B),re=te&&ee,ne=!re&&X&&X.length>0&&C&&C.hasMore&&(C.filter||"")===B,oe=!ee&&ne,le=gv(Z,cv),ie=null!=s,ae=!v&&ie?yv(s,X):null,ue=function(){var e=(0,ba.A)(ce().mark((function e(){var t,o,l,i,a,u,s,c,d,f,v,g,h,y,m=arguments;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:null,!(o=m.length>1&&void 0!==m[1]&&m[1])&&C&&L(void 0),l=o&&$?$.length:0,i=o&&C||!n&&{pageSize:0},a=++H.current,e.next=8,r.call(null==p?void 0:p.ctx,t,l,i);case 8:if(u=e.sent,H.current==a&&K.current){e.next=12;break}return e.abrupt("return",null);case 12:return s=null!=u&&u.values?u:{values:u},c=s.values,d=s.hasMore,f=s.meta,v=hv(c),o?(h=sv($,v,!1),g=h.length>$.length):(h=v,n&&(g=h.length>0)),(y=null!=d||null!=f||null!=g?av(av(av(av({},null!=g?{hasMore:g}:{}),null!=d?{hasMore:d}:{}),null!=f?f:{}),{},{filter:t}):void 0)&&L(y),e.abrupt("return",h);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=(0,ba.A)(ce().mark((function e(){var t,r,n,o=arguments;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:null,r=o.length>1&&void 0!==o[1]&&o[1],x((function(e){return e+1})),M(r),e.next=6,ue(t,r);case 6:if(n=e.sent,K.current){e.next=9;break}return e.abrupt("return");case 9:null!=n&&J(n),x((function(e){return e-1})),M(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=k.useCallback(lv()(se,f),[]);k.useEffect((function(){return K.current++,te&&0==I&&0==H.current&&(0,ba.A)(ce().mark((function e(){return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se();case 2:case"end":return e.stop()}}),e)})))(),function(){K.current--}}),[te]);var pe=function(){w(!0)},fe=function(){var e=(0,ba.A)(ce().mark((function e(t){var r;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Y.current)?(Y.current=!1,v&&w(!1)):w(!1),"mui"!==g||r){e.next=6;break}return e.next=6,ge(null,"","my-reset");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=(0,ba.A)(ce().mark((function e(t,n,o){var l,i,a,d,p,f,y,m,b,O,A,S,j,E,C,L;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=v&&"mui"===g&&"clear"===o,a=!v&&"mui"===g&&"clear"===o&&"change"===(null==t?void 0:t.type),d=!v&&"mui"===g&&"clear"===o&&"change"!==(null==t?void 0:t.type),"mui"===g&&(o=n,n=v?o.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e})):null!==(p=null===(f=o)||void 0===f?void 0:f.value)&&void 0!==p?p:o),y=v&&Array.isArray(o)&&o.map((function(e){return null==e?void 0:e.specialValue})).find((function(e){return!!e}))||(null===(l=o)||void 0===l?void 0:l.specialValue),v&&n&&!Array.isArray(n)&&(n=[].concat((0,P.A)(s||[]),[n]),o=null),!(i&&0===n.length&&B&&F||a)){e.next=9;break}return e.abrupt("return");case 9:if(m=v&&n.length&&n.length>(s||[]).length&&n[n.length-1]==B&&!yv(B,$),"LOAD_MORE"!=y){e.next=17;break}return G(B),Y.current=!0,e.next=15,se(B,!0);case 15:e.next=37;break;case 17:if("LOADING_MORE"!=y){e.next=21;break}Y.current=!0,e.next=37;break;case 21:if(!v){e.next=31;break}if(b=pv(n,X,u),O=(0,T.A)(b,2),A=O[0],S=O[1],c(A,r?S:void 0),!m){e.next=29;break}return e.next=27,Ov(0);case 27:return e.next=29,ge(null,"","my-reset");case 29:e.next=37;break;case 31:if(j=dv(n,X,u),E=(0,T.A)(j,2),C=E[0],L=E[1],c(C,r?L:void 0),!d||!h){e.next=37;break}return e.next=36,Ov(0);case 36:w(!1);case 37:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),ge=function(){var e=(0,ba.A)(ce().mark((function e(t,r,n){var i,a;return ce().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i="mui"===g&&"reset"===n,(a=r)!==m&&a!==b&&!i){e.next=4;break}return e.abrupt("return");case 4:if(r==B){e.next=13;break}if(G(a),!o||l&&!a){e.next=12;break}return e.next=10,de(a);case 10:e.next=13;break;case 12:o&&l&&J([]);case 13:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();return{options:"mui"===g?fv(le):le,listValues:X,hasValue:ie,selectedListValue:ae,open:F,onOpen:pe,onClose:fe,onDropdownVisibleChange:function(e){e?pe():fe()},onChange:ve,inputValue:B,onInputChange:ge,canShowLoadMore:oe,isInitialLoading:re,isLoading:ee,isLoadingMore:R,isSpecialValue:function(e){var t=(null==e?void 0:e.specialValue)||(null==e?void 0:e.value);return y.includes(t)},extendOptions:function(e){var t=(0,P.A)(e);return n&&(oe?t.push({specialValue:"LOAD_MORE",title:m}):R&&t.push({specialValue:"LOADING_MORE",title:b,disabled:!0})),t},getOptionSelected:function(e,t){if(null==t)return null;var r=null!=t.value?t.value:t;return e.value===r},getOptionDisabled:function(e){return e&&e.disabled},getOptionIsCustom:function(e){var t;if(null!=e&&e.isCustom)return!0;var r=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e,n=yv(r,X);return(null==n?void 0:n.isCustom)||!1},getOptionLabel:function(e){if(null==e)return null;var t=null!=e.value?e:cv(yv(e,X));return!t&&e.specialValue?e.title:!t&&u?e.toString():t?t.title||t.label||t.value.toString():e.toString()},aPlaceholder:O}};function Sv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sv(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const wv=Fv(Fv({},ts),{},{ReactUtils:O,DragIcon:hc})},61507:(e,t,r)=>{var n={"./es-us":1748,"./es-us.js":1748,"./ru":60582,"./ru.js":60582};function o(e){var t=l(e);return r(t)}function l(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=l,e.exports=o,o.id=61507},20039:()=>{},7736:()=>{}}]);
//# sourceMappingURL=171.bundle.js.map
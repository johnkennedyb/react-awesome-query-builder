(self.webpackChunk_react_awesome_query_builder_examples=self.webpackChunk_react_awesome_query_builder_examples||[]).push([[773],{1783:(e,t,r)=>{"use strict";r.d(t,{WQ:()=>ft});var n,o,i,l,a,u,s=r(6467),c=r(67308),d=r(76569),p=r(42664),f=r(18608),v=r(38513),g=r(188),h=r(22665),m=d.Aq.moment,y=parseInt(null!==(n=null==h||null===(o=h.version)||void 0===o||null===(o=o.split("."))||void 0===o?void 0:o[0])&&void 0!==n?n:"0"),b=r(93826),O=d.Aq.moment,A=parseInt(null!==(i=null==h||null===(l=h.version)||void 0===l||null===(l=l.split("."))||void 0===l?void 0:l[0])&&void 0!==i?i:"0"),S=r(32145),F=d.Aq.moment,j=parseInt(null!==(a=null==h||null===(u=h.version)||void 0===u||null===(u=u.split("."))||void 0===u?void 0:u[0])&&void 0!==a?a:"0"),w=r(5545),E=r(41926),C=r(64234),_=r.n(C),L=d.Aq.ListUtils.mapListValues,k=r(58809),T=d.Aq.NumberFormat,P=T.NumericFormat,V=T.getNumberFormatProps,x=r(2716),I=r(9885),D=r(23786),R=["width"],N=r(73188),q=r(12024),M=["width"],W=r(65651),G=r(21153),z=r(19909),B=r(25828),U=r(80079),$=d.Aq.ListUtils.mapListValues,H=r(14214),J=r(82040),Y=r(94079),K=r(36936),Q=r(22516),X=r(79271),Z=r(84295),ee=r(44309),te=["width"];function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){(0,s.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oe=d.Rj.W,ie=[];const le=function(e){var t=e.allowCustomValues,r=e.multiple,n=e.disableClearable,o=e.value,i=e.customProps,l=e.readonly,a=e.config,u=e.filterOptionsConfig,s=e.errorText,d=e.tooltipText,g=e.isFieldAutocomplete,h=e.dontFixOptionsOrder,m={stringify:(0,c.useCallback)((function(e){return a.settings.listKeysForSearch.map((function(t){return"string"==typeof e[t]?e[t]:""})).join("\0")}),[a])},y=(0,H.Z)(u||m),b=oe(e,{debounceTimeout:100,multiple:r,uif:"mui",isFieldAutocomplete:g,dontFixOptionsOrder:h}),O=b.open,A=b.onOpen,S=b.onClose,F=b.onChange,j=b.onInputChange,w=b.inputValue,C=b.options,L=b.isInitialLoading,k=b.isLoading,T=b.aPlaceholder,P=b.extendOptions,V=(b.getOptionSelected,b.getOptionDisabled),x=b.getOptionIsCustom,D=b.getOptionLabel,R=b.selectedListValue,N=a.settings,q=N.defaultSelectWidth,M=(N.defaultSearchWidth,N.renderSize),W=i||{},G=W.width,z=(0,I.A)(W,te),B=z.input||{};B.width,B=_()(B,["width"]);var $=_()(z,["showSearch","showCheckboxes"]),re=!1,le=G||q,ae={width:r?void 0:le,minWidth:le},ue=l?"":T,se=ue||a.settings.fieldPlaceholder,ce=null!=o?o:r?ie:null,de=(0,ee.A)(),pe=function(e){var t=e.group,r=t.label;return r&&t.tooltip&&(r=c.createElement(Z.A,{title:t.tooltip,placement:"left-start"},c.createElement("span",null,r))),c.createElement("div",{style:{position:"sticky",top:"-8px",padding:"4px 10px",color:de.palette.primary.main,backgroundColor:de.palette.background.default}},r)},fe=function(e){var t=e.children;return c.createElement(c.Fragment,null,t)},ve=c.createElement(J.A,(0,p.A)({disableClearable:n,disableCloseOnSelect:r,fullWidth:re,multiple:r,style:ae,freeSolo:t,loading:L,open:O,onOpen:A,onClose:S,inputValue:w,onInputChange:j,label:ue,onChange:F,value:ce,disabled:l,readOnly:l,options:C,groupBy:function(e){return null!=e&&e.group?JSON.stringify(e.group):null==e?void 0:e.groupTitle},getOptionLabel:D,getOptionDisabled:V,renderInput:function(e){var t,n,o,i=!r&&!O,a=null!==(t=null!==(n=null==R?void 0:R.title)&&void 0!==n?n:null==ce?void 0:ce.toString())&&void 0!==t?t:"",u=i?a:r&&!O?"":null!==(o=null!=w?w:null==ce?void 0:ce.toString())&&void 0!==o?o:"";return c.createElement(f.A,(0,p.A)({variant:"standard"},e,{inputProps:ne(ne({"aria-label":se},e.inputProps),{},{value:u}),InputProps:ne(ne({},e.InputProps),{},{readOnly:l,endAdornment:c.createElement(c.Fragment,null,k?c.createElement(Y.A,{color:"inherit",size:20}):null,e.InputProps.endAdornment)}),size:M,disabled:l,placeholder:ue,error:!!s},B))},renderGroup:function(e){var t,r,n=e.group;if("string"==typeof n&&"{"===n[0])try{r=JSON.parse(n)}catch(e){}else n&&(r={label:n});var o=r?null!==(t=r.parentGroups)&&void 0!==t?t:[r]:[];return c.createElement("div",{key:e.key},o.map((function(e){return c.createElement(pe,{key:null==e?void 0:e.path,group:e})})),c.createElement(fe,null,e.children))},renderTags:function(e,t){return e.map((function(e,r){return c.createElement(K.A,(0,p.A)({key:e.value,label:D(e),size:"small",variant:x(e)?"outlined":"filled"},t({index:r})))}))},renderOption:function(e,t){var n=t.title,i=t.renderTitle,l=t.value,a=t.isHidden,u=t.tooltip,s=t.group,d=t.groupTitle||s,f=r?(o||[]).includes(l):o==l,v=x(t)?"customSelectOption":void 0,h=i||(!g&&d?"  ":"")+n,m=c.createElement("span",{className:v},h);if(u&&(m=c.createElement(Z.A,{title:u,placement:"left-start"},m)),a)return null;if(t.specialValue)return c.createElement("div",e,h);if(r){var y=f?c.createElement(c.Fragment,null,c.createElement(X.A,null,c.createElement(Q.A,null)),m):c.createElement(U.A,{inset:!0},m);return c.createElement(E.A,(0,p.A)({},e,{size:"small",selected:f}),y)}return c.createElement("div",e,m)},filterOptions:function(e,t){var r=y(e,t);return P(r)},isOptionEqualToValue:function(e,t){return(null==e?void 0:e.value)==t},size:M},$));return d&&(ve=c.createElement(Z.A,{title:O?null:d,placement:"top-start"},ve)),c.createElement(v.A,{fullWidth:re},ve)};var ae=r(11384),ue=["items","selectedKey","setField","isValueField","selectedLabel","selectedOpts","selectedAltLabel","selectedFullLabel"];function se(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ce(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ce(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){(0,s.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe={key:"_value2",path:"value",label:"title",altLabel:"_altLabel",tooltip:"tooltip",grouplabel:"groupTitle"},ve=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=e.map((function(e){var t=e.items,o=e.path,i=e.key,l=e.label,a=e.altLabel,u=e.disabled,s=e.grouplabel,d=e.group,p=e.matchesType,f=e.tooltip,v=function(e){return"  ".repeat(e)},g=v(r);return t?ve(t,r+1,[].concat((0,N.A)(n),[e])):{title:l,renderTitle:p?c.createElement("b",null,g+l):g+l,value:o,disabled:u,groupTitle:r>0?g+s:null,group:r>0?pe(pe({},d),{},{label:g+d.label,parentGroups:n.map((function(e,t){var r=e.tooltip,n=e.label;return{path:e.path,tooltip:r,label:v(t)+n}}))}):null,tooltip:f,_value2:i,_altLabel:a}})).flat(1/0),i=[],l=se(o);try{for(l.s();!(t=l.n()).done;){var a=t.value;if(a.group){a.group.parentGroups=a.group.parentGroups.filter((function(e){var t=e.path;return!i.includes(t)}));var u,s=se(a.group.parentGroups);try{for(s.s();!(u=s.n()).done;){var d=u.value;i.push(d.path)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){l.e(e)}finally{l.f()}return o},ge=r(15654),he=r(89533),me=r(99523),ye=r(2918),be=d.Aq.DragIcon,Oe={delGroup:c.createElement(he.A,null),delRuleGroup:c.createElement(he.A,null),delRule:c.createElement(he.A,null),addSubRuleSimple:c.createElement(me.A,null),addSubRule:c.createElement(me.A,null),addSubGroup:c.createElement(me.A,null),addRule:c.createElement(me.A,null),addGroup:c.createElement(me.A,null),drag:c.createElement(ge.A,null)},Ae={drag:"primary"},Se=r(21898),Fe=r(66291),je={addSubRuleSimple:!0,delGroup:!0,delRuleGroup:!0,delRule:!0},we={addRule:"primary",addGroup:"primary",delGroup:"secondary",delRuleGroup:"secondary",delRule:"secondary"};const Ee=(0,c.memo)((function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,i=e.renderIcon,l=e.config,a=l.settings.renderSize,u=null==i?void 0:i({type:t,readonly:o,renderSize:a,config:l});return!r||je[t]?c.createElement(Fe.A,{size:a,disabled:o,onClick:n,color:we[t],"aria-label":r},u):c.createElement(Se.A,{size:a,disabled:o,onClick:n,color:we[t],startIcon:u},r)}));var Ce=r(85284),_e=c.memo((function(e){var t=e.conjKey,r=e.id,n=(e.name,e.label),o=e.checked,i=e.setConjunction,l=e.readonly,a=e.disabled,u=(0,c.useCallback)((function(){i(t)}),[t,i]),s=i.isDummyFn?"__dummy":"";return!l&&!a||o?c.createElement(Se.A,{key:r+s,id:r+s,color:"primary",disableElevation:!0,variant:o?"contained":"outlined",sx:{backgroundColor:o?"primary.main":"background.paper"},value:t,onClick:u,disabled:l||a},n):null})),Le=c.memo((function(e){var t=e.id,r=e.not,n=e.setNot,o=e.conjunctionOptions,i=e.setConjunction,l=e.disabled,a=e.readonly,u=e.config,s=e.showNot,d=e.notLabel,f=Object.keys(o).length,g=l,h=u.settings,m=h.forceShowConj,y=h.renderSize,b=m||f>1&&!g,O=(0,c.useCallback)((function(){n(!r)}),[r,n]);return c.createElement(v.A,null,c.createElement(Ce.A,{disableElevation:!0,size:y,disabled:a,sx:{marginLeft:"1px"}},s&&(a&&!r?null:c.createElement(Se.A,{size:y,key:t,id:t+"__not",color:"error",disableElevation:!0,variant:r?"contained":"outlined",sx:{backgroundColor:r?"error.main":"background.paper"},onClick:O,disabled:a},d||"NOT")),b&&Object.keys(o).map((function(e){var t=o[e],r=t.id,n=t.name,u=t.label,s=t.checked,d={conjKey:e,id:r,name:n,label:u,checked:s,setConjunction:i,readonly:a,disabled:l};return l&&!s?null:c.createElement(_e,(0,p.A)({key:r},d))}))))}));const ke=Le;var Te=r(84362),Pe=r(86133),Ve=r(77493),xe=r(951),Ie=r(56449),De=r(13280),Re=c.memo((function(e){var t=e.valueSrc,r=e.srcKey,n=e.handleChange,o=e.info,i=t==r||!t&&"value"==r,l=(0,c.useCallback)((function(e){return n(e,r)}),[n,r]);return c.createElement(E.A,{value:r,selected:i,onClick:l},!i&&c.createElement(U.A,{inset:!0},o.label),i&&c.createElement(c.Fragment,null,c.createElement(X.A,null,c.createElement(Q.A,null)),o.label))}));const Ne=c.memo((function(e){var t=e.valueSources,r=e.valueSrc,n=e.title,o=e.setValueSrc,i=(e.readonly,e.config.settings.renderSize),l=c.useState(null),a=(0,q.A)(l,2),u=a[0],s=a[1],d=(0,c.useCallback)((function(e){s(e.currentTarget)}),[s]),p=(0,c.useCallback)((function(){s(null)}),[s]),f=(0,c.useCallback)((function(e){u?p():d(e)}),[p,d,u]),g=(0,c.useCallback)((function(e,t){o(t),p()}),[p,o]),h=Boolean(u);return c.createElement("div",null,c.createElement(Fe.A,{size:i,onClick:f},c.createElement(xe.A,null)),c.createElement(De.A,{size:i,anchorEl:u,open:h,onClose:p},c.createElement(v.A,{component:"fieldset",sx:{p:0}},c.createElement(Ie.A,{component:"legend",sx:{p:2,pt:0,pb:1}},n),function(e){return e.map((function(e){var t=(0,q.A)(e,2),n=t[0],o=t[1];return c.createElement(Re,{key:n,valueSrc:r,srcKey:n,handleChange:g,info:o})}))}(t))))}));var qe=r(49119),Me=["confirmFn"],We=r(15596),Ge=r(29723),ze=r(39173),Be=r(47844),Ue=r(39847),$e=r.n(Ue);function He(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?He(Object(r),!0).forEach((function(t){(0,s.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ye,Ke,Qe=d.Aq.ColorUtils,Xe=(Qe.setColorOpacity,Qe.generateCssVarsForLevels),Ze=Qe.chroma,et=d.Aq.OtherUtils.logger,tt=function(e,t){var r,n,o,i;et.log("generateCssVars - MUI theme",e);var l=e.palette,a=e.typography,u=e.shadows,s=e.shape,c="dark"===l.mode,d=null!==(r=null===(n=t.settings.designSettings)||void 0===n?void 0:n.useThickLeftBorderOnHoverItem)&&void 0!==r&&r,p=null!==(o=null===(i=t.settings.designSettings)||void 0===i?void 0:i.useShadowOnHoverItem)&&void 0!==o&&o,f=Je(Je(Je(Je(Je(Je({"--main-background":l.background.paper,"--rule-background":l.background.paper},Xe(c,"--group-background",l.background.paper)),Xe(c,"--rulegroup-background",l.background.paper)),Xe(c,"--rulegroupext-background",l.background.paper)),Xe(c,"--switch-background",l.background.paper)),Xe(c,"--case-background",l.background.paper)),{},{"--rule-border-color":c?l.divider:Ze(l.divider).brighten(3).hex(),"--group-border-color":l.divider,"--rulegroup-border-color":l.divider,"--rulegroupext-border-color":l.divider,"--switch-border-color":l.divider,"--case-border-color":l.divider,"--treeline-color":l.primary.main,"--treeline-switch-color":l.secondary.main,"--main-text-color":l.text.primary,"--main-font-family":a.fontFamily,"--main-font-size":a.fontSize+"px","--item-radius":s.borderRadius+"px"});return d&&(f=Je(Je({},f),{},{"--rule-border-left-width-hover":"2px","--group-border-left-width-hover":"2px","--rulegroup-border-left-width-hover":"2px","--rulegroupext-border-left-width-hover":"2px"})),p&&(f=Je(Je({},f),{},{"--rule-shadow-hover":u[1],"--group-shadow-hover":u[1],"--rulegroup-shadow-hover":u[1],"--rulegroupext-shadow-hover":u[1]})),f},rt=function(e){var t,r,n=e.children,o=e.config,i=c.createRef(),l=null!==(t=o.settings.themeMode)&&void 0!==t?t:"light",a=o.settings.compactMode,u=o.settings.liteMode,s=!(null===(r=o.settings.designSettings)||void 0===r||!r.generateCssVarsFromThemeLibrary),d=(0,ee.A)();return c.useEffect((function(){var e=i.current,t={};if(s){var r,n,l=null!==(r=null===(n=o.settings.designSettings)||void 0===n||null===(n=n.generateCssVars)||void 0===n?void 0:n.mui)&&void 0!==r?r:tt;for(var a in t=l.call(o.ctx,d,o))null!=t[a]&&(null==e||e.style.setProperty(a,t[a]))}return function(){for(var r in t)null==e||e.style.removeProperty(r)}}),[l,d,o,s]),c.createElement("div",{ref:i,className:"qb-mui qb-".concat(l," ").concat(a?"qb-compact":""," ").concat(u?"qb-lite":"")},n)},nt=parseInt(null!==(Ye=null===(Ke=h.version)||void 0===Ke||null===(Ke=Ke.split("."))||void 0===Ke?void 0:Ke[0])&&void 0!==Ye?Ye:"0"),ot={MuiTextWidget:function(e){var t=e.value,r=e.setValue,n=e.config,o=e.readonly,i=e.placeholder,l=e.customProps,a=e.maxLength,u=(e.errorMessage,n.settings.renderSize),s=(0,c.useCallback)((function(e){var t=e.target.value;""===t&&(t=void 0),r(t)}),[r]),d=t||"";return c.createElement(v.A,null,c.createElement(f.A,(0,p.A)({variant:"standard",value:d,placeholder:o?"":i,InputProps:{readOnly:o},inputProps:{maxLength:a},disabled:o,onChange:s,size:u},l)))},MuiTextAreaWidget:function(e){var t=e.value,r=e.setValue,n=e.config,o=e.readonly,i=e.placeholder,l=e.customProps,a=e.maxLength,u=e.maxRows,s=e.fullWidth,d=n.settings,g=d.defaultMaxRows,h=d.renderSize,m=t||"";return c.createElement(v.A,{fullWidth:s},c.createElement(f.A,(0,p.A)({variant:"standard",fullWidth:s,maxRows:u||g,multiline:!0,value:m,placeholder:o?"":i,InputProps:{readOnly:o},inputProps:{maxLength:a},disabled:o,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},size:h},l)))},MuiDateWidget:function(e){var t=e.value,r=e.setValue,n=e.readonly,o=e.customProps,i=e.dateFormat,l=e.valueFormat,a=e.placeholder,u=e.config.settings.renderSize,s=y>=6?{format:i,slotProps:{textField:{size:u,variant:"standard"},toolbar:{toolbarPlaceholder:n?"":a}}}:{inputFormat:i,renderInput:function(e){return c.createElement(f.A,(0,p.A)({size:u,variant:"standard"},e))},toolbarPlaceholder:n?"":a},d=t?y>=6?m(t,l):t:null;return c.createElement(v.A,null,c.createElement(g.l,(0,p.A)({desktopModeMediaQuery:"@media (pointer: fine), (pointer: none)",readOnly:n,disabled:n,value:d,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(l):void 0}(e))},size:u},s,o)))},MuiDateTimeWidget:function(e){var t=e.value,r=e.setValue,n=e.use12Hours,o=e.readonly,i=e.placeholder,l=e.dateFormat,a=e.timeFormat,u=e.valueFormat,s=e.customProps,d=e.config.settings.renderSize,g=l+" "+a,h=A>=6?{format:g,slotProps:{textField:{size:d,variant:"standard"},toolbar:{toolbarPlaceholder:o?"":i}}}:{inputFormat:g,renderInput:function(e){return c.createElement(f.A,(0,p.A)({size:d,variant:"standard"},e))},toolbarPlaceholder:o?"":i},m=t?A>=6?O(t,u):t:null;return c.createElement(v.A,null,c.createElement(b.K,(0,p.A)({desktopModeMediaQuery:"@media (pointer: fine), (pointer: none)",readOnly:o,disabled:o,ampm:!!n,value:m,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(u):void 0}(e))},size:d},h,s)))},MuiTimeWidget:function(e){var t=e.value,r=e.setValue,n=e.use12Hours,o=e.readonly,i=e.placeholder,l=e.timeFormat,a=e.valueFormat,u=e.customProps,s=e.config.settings.renderSize,d=-1!=l.indexOf(":ss"),g=t?F(t,l):null,h=j>=6?{format:l,slotProps:{textField:{size:s,variant:"standard"},toolbar:{toolbarPlaceholder:o?"":i}}}:{inputFormat:l,renderInput:function(e){return c.createElement(f.A,(0,p.A)({size:s,variant:"standard"},e))},toolbarPlaceholder:o?"":i};return c.createElement(v.A,null,c.createElement(S.A,(0,p.A)({desktopModeMediaQuery:"@media (pointer: fine), (pointer: none)",readOnly:o,disabled:o,ampm:!!n,value:g,onChange:function(e){r(function(e){return e&&e.isValid()?e.format(a):void 0}(e))},views:d?["hours","minutes","seconds"]:["hours","minutes"],size:s},h,u)))},MuiSelectWidget:function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.placeholder,l=e.customProps,a=e.config.settings.renderSize,u=null!=r;return c.createElement(v.A,null,c.createElement(w.A,(0,p.A)({variant:"standard",autoWidth:!0,displayEmpty:!0,placeholder:o?"":i,onChange:function(e){void 0!==e.target.value&&n(e.target.value)},value:u?r:"",disabled:o,readOnly:o,renderValue:function(e){return o||null!=e?function(e){return L(t,(function(t){var r=t.title;return t.value===e?r:null})).filter((function(e){return null!==e})).shift()}(e):i},size:a},_()(l,["showSearch","input"])),L(t,(function(e){var t=e.title,r=e.value;return c.createElement(E.A,{key:r,value:r},t)}))))},MuiNumberWidget:function(e){var t=e.value,r=e.setValue,n=e.config,o=e.readonly,i=e.min,l=e.max,a=e.step,u=e.placeholder,s=e.customProps,d=n.settings.renderSize,g=null==t?"":t,h=(0,c.useMemo)((function(){return{readOnly:o}}),[o]),m=(0,c.useMemo)((function(){return{min:i,max:l,step:a}}),[i,l,a]);return c.createElement(v.A,null,c.createElement(f.A,(0,p.A)({variant:"standard",type:"number",value:g,placeholder:o?"":u,InputProps:h,inputProps:m,disabled:o,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},size:d},s)))},MuiPriceWidget:function(e){var t=e.value,r=e.setValue,n=e.readonly,o=(e.min,e.max,e.step,e.placeholder),i=e.customProps,l=e.prefix,a=e.suffix,u=V(e,["prefix","suffix"]),s=null==t?"":t,d=(0,c.useMemo)((function(){return{readOnly:n,startAdornment:null!=l?c.createElement(k.A,{position:"start"},l):void 0,endAdornment:null!=a?c.createElement(k.A,{position:"end"},a):void 0}}),[n]);return c.createElement(v.A,null,c.createElement(P,(0,p.A)({size:"small",customInput:f.A,value:s,placeholder:n?"":o,InputProps:d,disabled:n,onValueChange:function(e){var t=e.floatValue;r(void 0===t?null:t)},variant:"standard"},i,u)))},MuiSliderWidget:function(e){var t=e.config,r=e.placeholder,n=e.customProps,o=e.value,i=e.setValue,l=e.min,a=e.max,u=e.step,s=e.marks,d=e.readonly,g=t.settings,h=g.defaultSliderWidth,m=g.renderSize,y=(0,c.useCallback)((function(e,t){i(t)}),[i]),b=(0,c.useCallback)((function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),i(t)}),[i]),O=(0,c.useCallback)((function(e){var t=e.target.value;(t=""===t||null===t?void 0:Number(t))<l?i(l):t>a&&i(a)}),[i,l,a]),A=n||{},S=A.width,F=(0,I.A)(A,R),j=F.input||{},w=F.slider||F,E="number"==typeof o?o:"",C="number"==typeof o?o:null,_=(0,c.useMemo)((function(){return!!s&&Object.keys(s).map((function(e){return{value:Number(e),label:"object"===(0,x.A)(s[e])||void 0===s[e]?s[e]:c.createElement("p",null,s[e])}}))}),[s]),L=(0,c.useMemo)((function(){return{readOnly:d}}),[d]),k=(0,c.useMemo)((function(){return{min:l,max:a,step:u}}),[l,a,u]),T=c.createElement(f.A,(0,p.A)({variant:"standard",type:"number",value:E,placeholder:r,InputProps:L,inputProps:k,disabled:d,onChange:b,onBlur:O,size:m},j)),P=c.createElement(D.Ay,(0,p.A)({value:C,onChange:y,disabled:d,min:l,max:a,step:u,marks:_,valueLabelDisplay:"auto",size:m},w)),V={marginLeft:"5px",paddingLeft:"12px",marginBottom:_&&"-24px",width:S||h};return c.createElement(v.A,null,c.createElement("div",{style:{display:"inline-flex",alignItems:"center",flexWrap:"wrap"}},c.createElement("div",{style:{marginLeft:"5px"}},T),c.createElement("div",{style:V},P)))},MuiRangeWidget:function(e){var t=e.config,r=e.placeholders,n=e.customProps,o=e.value,i=e.setValue,l=e.min,a=e.max,u=e.step,s=e.marks,d=e.readonly,g=e.textSeparators,h=t.settings,m=h.defaultSliderWidth,y=h.renderSize;(0,c.useEffect)((function(){var t=e.value||[void 0,void 0],r=(0,q.A)(t,2);r[0],r[1],e.value}),[]);var b=function(){o&&(o[0]<l?i([l,o[1]]):o[1]>a&&i([o[0],a]))},O=n||{},A=O.width,S=(0,I.A)(O,M),F=S.input||{},j=S.slider||S,w=!!s&&Object.keys(s).map((function(e){return{value:Number(e),label:"object"===(0,x.A)(s[e])||void 0===s[e]?s[e]:c.createElement("p",null,s[e])}})),E=o?(0,N.A)(o):[void 0,void 0],C=(0,q.A)(E,2),_=C[0],L=C[1];null==_&&(_="",E[0]=0),null==L&&(L="",E[1]=0);var k=c.createElement(f.A,(0,p.A)({variant:"standard",type:"number",value:_,placeholder:r[0],InputProps:{readOnly:d},inputProps:{min:l,max:a,step:u},disabled:d,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,N.A)(e.value):[void 0,void 0];n[0]=r,i(n)},onBlur:b,size:y},F)),T=c.createElement(f.A,(0,p.A)({variant:"standard",type:"number",value:L,placeholder:r[1],InputProps:{readOnly:d},inputProps:{min:l,max:a,step:u},disabled:d,onChange:function(t){var r=t.target.value;r=""===r||null==r?void 0:Number(r);var n=e.value?(0,N.A)(e.value):[void 0,void 0];n[1]=r,i(n)},onBlur:b,size:y},F)),P=c.createElement(D.Ay,(0,p.A)({value:E,onChange:function(e,t){i(t)},disabled:d,min:l,max:a,step:u,marks:w,valueLabelDisplay:"auto",size:y},j)),V={marginLeft:"5px"},R={marginLeft:"5px",paddingLeft:"12px",marginBottom:w&&"-16px",width:A||m};return c.createElement(v.A,null,c.createElement("div",{style:{display:"inline-flex",flexWrap:"wrap"}},c.createElement("div",{style:V},k),c.createElement("div",{className:"widget--sep"},c.createElement("span",null,g[1])),c.createElement("div",{style:V},T),c.createElement("div",{style:R},P)))},MuiBooleanWidget:function(e){var t=e.customProps,r=e.value,n=e.setValue,o=e.labelYes,i=e.labelNo,l=e.readonly,a=e.config.settings.renderSize;return c.createElement(v.A,{size:a},c.createElement(z.A,{component:"div"},c.createElement(G.Ay,{component:"label",container:!0,alignItems:"center",spacing:0},c.createElement(G.Ay,{item:!0,component:"span"},i),c.createElement(G.Ay,{item:!0,component:"span"},c.createElement(W.A,(0,p.A)({checked:!!r,onChange:function(){n(!r)},disabled:l,size:a},t))),c.createElement(G.Ay,{item:!0,component:"span"},o))))},MuiMultiSelectWidget:function(e){var t,r=e.listValues,n=e.value,o=e.setValue,i=(e.allowCustomValues,e.readonly),l=e.placeholder,a=e.customProps,u=e.config.settings.renderSize,s=null!=n&&n.length>0;return c.createElement(v.A,null,c.createElement(w.A,(0,p.A)({multiple:!0,variant:"standard",autoWidth:!0,displayEmpty:!0,label:i?"":l,onChange:function(e){void 0!==e.target.value&&o(e.target.value)},value:s?n:[],disabled:i,readOnly:i,renderValue:function(e){if(!i&&!e.length)return l;var t=$(r,(function(t){var r=t.title,n=t.value;return e.indexOf(n)>-1?r:null})).filter((function(e){return null!==e}));return t.join(", ")},size:u},_()(a,["showSearch","input","showCheckboxes"])),(t=s?n:[],$(r,(function(e){var r=e.title,n=e.value;return c.createElement(E.A,{key:n,value:n},c.createElement(B.A,{checked:t.indexOf(n)>-1}),c.createElement(U.A,{primary:r}))})))))},MuiAutocompleteWidget:le,MuiFieldSelect:function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,i=e.placeholder,l=e.errorText,a=e.selectedLabel,u=(e.selectedOpts,e.selectedAltLabel),s=e.selectedFullLabel,d=e.config.settings.renderSize,p=(0,c.useState)(!1),f=(0,q.A)(p,2),g=f[0],h=f[1],m=(0,c.useCallback)((function(){h(!0)}),[h]),y=(0,c.useCallback)((function(){h(!1)}),[h]),b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object.keys(e).map((function(r){var n=e[r],o=n.items,i=n.path,l=n.label,a=n.disabled,u=n.matchesType,s=n.tooltip,d="  ".repeat(t),p=c.createElement("span",null,d&&c.createElement("span",null,d),u?c.createElement("b",null,l):l);return s&&(p=c.createElement(Z.A,{title:s,placement:"left-start"},p)),o?[c.createElement(ae.A,{disabled:a,key:i,disableSticky:!0},p),b(o,t+1)]:c.createElement(E.A,{disabled:a,key:i,value:i},p)}))},O=(0,c.useCallback)((function(e){void 0!==e.target.value&&r(e.target.value)}),[r]),A=(0,c.useCallback)((function(e){if(!o&&!e)return i;var r=function(t){return t.map((function(t){return t.items?r(t.items):t.path===e?t.label:null}))};return r(t).filter((function(e){return Array.isArray(e)?e.some((function(e){return null!==e})):null!==e})).pop()}),[o,i,t]),S=null!=n,F=u||s;F==a&&(F=null);var j=c.createElement(w.A,{error:!!l,variant:"standard",autoWidth:!0,displayEmpty:!0,placeholder:i,onChange:O,value:S?n:"",disabled:o,renderValue:A,size:d,open:g,onOpen:m,onClose:y},b(t));return F&&(j=c.createElement(Z.A,{title:g?null:F},j)),c.createElement(v.A,null,j)},MuiFieldAutocomplete:function(e){return c.createElement(le,function(e,t){var r=e.items,n=e.selectedKey,o=e.setField,i=e.isValueField,l=e.selectedLabel,a=(e.selectedOpts,e.selectedAltLabel),u=e.selectedFullLabel,s=(0,I.A)(e,ue),d=a||u;d==l&&(d=null);var p=ve(r),f=n,v={stringify:(0,c.useCallback)((function(e){return t.settings.fieldItemKeysForSearch.map((function(e){return fe[e]})).map((function(t){return"string"==typeof e[t]?e[t]:""})).join("\0")}),[t])};return pe(pe({},s),{},{tooltipText:d,listValues:p,setValue:function(e,t){if(e||i)return o(e)},filterOptionsConfig:v,allowCustomValues:!1,multiple:!1,disableClearable:!i,value:f,isFieldAutocomplete:!0,dontFixOptionsOrder:!0})}(e,e.config))},MuiIcon:function(e){var t=e.type,r=e.readonly,n=e.renderSize,o=Oe[t]||null;return o||"drag"!==t?"drag"===t?c.createElement(ye.A,{size:null!=n?n:"small",disabled:r,color:Ae[t]},o):o:c.createElement(be,null)},MuiButton:Ee,MuiButtonGroup:function(e){var t=e.children;return e.config,c.createElement(c.Fragment,null,t)},MuiConjs:ke,MuiSwitch:function(e){var t=e.value,r=e.setValue,n=e.label,o=e.checkedLabel,i=e.hideLabel,l=e.id,a=e.config,u=e.type,s=a.settings.renderSize,d=function(){return r(!t)},p=u,f=t&&o||n,v=t?c.createElement(Ve.A,null):c.createElement(Pe.A,null);return"lock"==u?i?c.createElement(Fe.A,{key:l+p,onClick:d,size:s},v):c.createElement(Se.A,{key:l+p,onClick:d,size:s,startIcon:v},f):c.createElement(Te.A,{control:c.createElement(W.A,{checked:!!t,size:s,onChange:function(e){return r(e.target.checked)}}),label:f})},MuiValueSources:Ne,MuiConfirm:function(e){(0,e.confirmFn)((0,I.A)(e,Me))},MuiUseConfirm:function(){var e=(0,qe.S)();return function(t){var r=t.okText,n=t.cancelText,o=t.title,i=t.onOk;e({description:o||"Are you sure?",title:null,confirmationText:r||"Ok",cancellationText:n||"Cancel"}).then(i).catch((function(){}))}},MuiProvider:function(e){var t,r,n=e.config,o=e.children,i=null===(t=n.settings.locale)||void 0===t?void 0:t.moment,l=(0,ee.A)(),a=null!==(r=n.settings.designSettings)&&void 0!==r&&r.canInheritThemeFromOuterProvider?l:void 0,u=c.useMemo((function(){return function(e,t){var r,n,o=e.settings.themeMode,i=null===(r=e.settings.theme)||void 0===r?void 0:r.mui,l=null===(n=e.settings.locale)||void 0===n?void 0:n.mui,a=null==t?void 0:t.palette.mode;if(!(i||o||l))return null;var u,s,c,d,p=void 0;if(null!=(c=i)&&c.shadows&&null!=c&&null!==(d=c.palette)&&void 0!==d&&d.mode)p=i;else{var f=o&&t&&o!=a?(u=t,s=_()(u.palette,["background","text","divider","action"]),Je(Je({},u),{},{palette:s})):t;p=$e()({},null!=f?f:{},null!=i?i:{},o&&{palette:{mode:o}})}return(0,Be.A)(p,null!=l?l:{})}(n,a)}),[n,a]),s=i?nt>=6?{locale:i}:{adapterLocale:i}:{},d=c.createElement(Ge.$,(0,p.A)({dateAdapter:ze.Y},s),c.createElement(qe.a,null,c.createElement(rt,{config:n},o)));return u?c.createElement(We.A,{theme:u},d):d}};const it=ot;function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function at(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(r),!0).forEach((function(t){(0,s.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ut=at(at({},d.d$.settings),{},{renderField:function(e,t){var r,n=t.RCE,o=t.W,i=o.MuiFieldAutocomplete,l=o.MuiFieldSelect;return null!=e&&null!==(r=e.customProps)&&void 0!==r&&r.showSearch?n(i,e):n(l,e)},renderOperator:function(e,t){var r,n=t.RCE,o=t.W,i=o.MuiFieldAutocomplete,l=o.MuiFieldSelect;return null!=e&&null!==(r=e.customProps)&&void 0!==r&&r.showSearch?n(i,e):n(l,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.MuiFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.MuiConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.MuiSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.MuiButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.MuiIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.MuiButtonGroup,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.MuiValueSources,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.MuiProvider,e)},renderConfirm:function(e,t){return(0,t.W.MuiConfirm)(e)},useConfirm:function(e){return(0,e.W.MuiUseConfirm)()}}),st=at(at({},d.d$.widgets),{},{text:at(at({},d.d$.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiTextWidget,e)}}),textarea:at(at({},d.d$.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiTextAreaWidget,e)}}),number:at(at({},d.d$.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiNumberWidget,e)}}),price:at(at({},d.d$.widgets.price),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiPriceWidget,e)}}),multiselect:at(at({},d.d$.widgets.multiselect),{},{factory:function(e,t){var r=t.RCE,n=t.W,o=n.MuiAutocompleteWidget,i=n.MuiMultiSelectWidget;return e.asyncFetch||e.showSearch||e.allowCustomValues?r(o,at(at({},e),{},{multiple:!0})):r(i,e)}}),select:at(at({},d.d$.widgets.select),{},{factory:function(e,t){var r=t.RCE,n=t.W,o=n.MuiAutocompleteWidget,i=n.MuiSelectWidget;return e.asyncFetch||e.showSearch||e.allowCustomValues?r(o,e):r(i,e)}}),slider:at(at({},d.d$.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiSliderWidget,e)}}),boolean:at(at({},d.d$.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiBooleanWidget,e)}}),date:at(at({},d.d$.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiDateWidget,e)}}),time:at(at({},d.d$.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiTimeWidget,e)}}),datetime:at(at({},d.d$.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiDateTimeWidget,e)}}),rangeslider:at(at({},d.d$.widgets.rangeslider),{},{factory:function(e,t){return(0,t.RCE)(t.W.MuiRangeWidget,e)}})}),ct=at({},d.d$.types),dt=at(at({},d.d$.ctx),{},{W:at(at({},d.d$.ctx.W),it),generateCssVars:tt}),pt=at(at({},d.d$),{},{ctx:dt,types:ct,widgets:st,settings:ut});const ft=pt=d.Aq.ConfigMixins.addMixins(pt,["rangeslider"])},7262:(e,t,r)=>{"use strict";r.d(t,{uu:()=>a,q0:()=>es,aI:()=>F,kG:()=>Ms,Aq:()=>uc});var n={};r.r(n),r.d(n,{applyToJS:()=>oe,cleanJSX:()=>ae,clone:()=>P(),deepEqual:()=>Z,deepFreeze:()=>fe,escapeRegExp:()=>ie,getFirstDefined:()=>he,getLogger:()=>ge,getOpCardinality:()=>X,hasSafeOwnProperty:()=>J,isDirtyJSX:()=>ue,isImmutable:()=>te,isImmutableList:()=>re,isJSX:()=>se,isJsonCompatible:()=>ve,isJsonLogic:()=>ce,isObject:()=>W,isObjectOrArray:()=>G,isSafeKeyForObject:()=>H,isTruthy:()=>U,isTypeOf:()=>B,logger:()=>me,mergeArraysSmart:()=>pe,mergeCustomizerNoArrays:()=>le,mergeIn:()=>K,moment:()=>x(),omit:()=>Q,opDefKeysToOmit:()=>M,setIn:()=>Y,shallowCopy:()=>$,shallowEqual:()=>ee,sleep:()=>de,toImmutableList:()=>ne,typeOf:()=>z,uuid:()=>k,widgetDefKeysToOmit:()=>q});var o={};r.r(o),r.d(o,{_fixImmutableValue:()=>yt,expandTreePath:()=>ot,expandTreeSubpath:()=>it,fixEmptyGroupsInTree:()=>ct,fixPathsInTree:()=>st,getAncestorRuleGroups:()=>at,getFlatTree:()=>dt,getItemByPath:()=>lt,getLightTree:()=>vt,getSwitchValues:()=>gt,getTotalReordableNodesCountInTree:()=>pt,getTotalRulesCountInTree:()=>ft,hasChildren:()=>mt,immutableToJs:()=>oe,isEmptyTree:()=>ht,isImmutable:()=>te,jsToImmutable:()=>bt,removeIsLockedInTree:()=>ut,toImmutableList:()=>ne});var i={};r.r(i),r.d(i,{calculateValueType:()=>Vt,completeFuncValue:()=>Jt,completeValue:()=>Ht,formatFieldName:()=>Rt,getDefaultArgValue:()=>Kt,getFieldPathLabels:()=>It,getFuncPathLabels:()=>xt,getOneChildOrDescendant:()=>Yt,getValueLabel:()=>Dt,isEmptyGroupChildren:()=>Gt,isEmptyItem:()=>Nt,isEmptyRuleGroupExtPropertiesAndChildren:()=>Mt,isEmptyRuleProperties:()=>Bt,setArgValue:()=>Qt,setFuncDefaultArg:()=>Zt,setFuncDefaultArgs:()=>Xt,whatRulePropertiesAreCompleted:()=>Ut});var l={};r.r(l),r.d(l,{addJsonLogicOperation:()=>hr,addRequiredJsonLogicOperations:()=>yr,applyJsonLogic:()=>gr,customJsonLogicOperations:()=>mr,jsonLogicFormatConcat:()=>br,jsonLogicImportConcat:()=>Or});var a={};r.r(a),r.d(a,{LINEAR_REGRESSION:()=>Vr,LOWER:()=>Tr,NOW:()=>wr,RELATIVE_DATE:()=>kr,RELATIVE_DATETIME:()=>Lr,START_OF_TODAY:()=>Cr,TODAY:()=>Er,TRUNCATE_DATETIME:()=>_r,UPPER:()=>Pr});var u={};r.r(u),r.d(u,{mongoEmptyValue:()=>qn,mongoFieldEscape:()=>Gn,mongoFieldUnescape:()=>zn,mongoFormatOp1:()=>Mn,mongoFormatOp2:()=>Wn});var s={};r.r(s),r.d(s,{spelEscape:()=>no,spelFixList:()=>lo,spelFormatConcat:()=>oo,spelImportConcat:()=>io});var c={};r.r(c),r.d(c,{SqlString:()=>ao,mongoEmptyValue:()=>qn,spelEscape:()=>no,spelFixList:()=>lo,spelFormatConcat:()=>oo,spelImportConcat:()=>io,sqlEmptyValue:()=>uo,stringifyForDisplay:()=>so,wrapWithBrackets:()=>co});var d={};r.r(d),r.d(d,{_mongodbFormat:()=>Yn,_spelFormat:()=>To,_sqlFormat:()=>mo,elasticSearchFormat:()=>li,jsonLogicFormat:()=>_n,mongodbFormat:()=>Jn,queryBuilderFormat:()=>rr,queryString:()=>Jo,spelFormat:()=>ko,sqlFormat:()=>ho});var p={};r.r(p),r.d(p,{_getFromConfigCache:()=>Ge,_getWidgetsAndSrcsForFieldOp:()=>Ye,_saveToConfigCache:()=>ze,_widgetDefKeysToOmit:()=>Ee,applyJsonLogic:()=>gr,areConfigsSame:()=>sn,cleanJSX:()=>ae,compileConfig:()=>Kr,compressConfig:()=>Jr,configKeys:()=>Ce,createConfigMemo:()=>pn,decompressConfig:()=>Yr,extendConfig:()=>bn,filterValueSourcesForField:()=>Ke,findExtendedConfigInAllMemos:()=>dn,getCommonMemo:()=>cn,getFieldConfig:()=>Ue,getFieldId:()=>We,getFieldParts:()=>qe,getFieldPartsConfigs:()=>nt,getFieldPath:()=>Ne,getFieldPathParts:()=>Me,getFieldRawConfig:()=>Pe,getFieldSrc:()=>Be,getFieldWidgetConfig:()=>He,getFirstField:()=>Je,getFirstOperator:()=>rt,getFuncArgConfig:()=>De,getFuncConfig:()=>Ie,getFuncSignature:()=>xe,getOperatorConfig:()=>$e,getOperatorsForField:()=>tt,getOperatorsForType:()=>et,getValueSourcesForFieldOp:()=>Xe,getWidgetForFieldOp:()=>Qe,getWidgetsForFieldOp:()=>Ze,isDirtyJSX:()=>ue,isFieldDescendantOfField:()=>Re,isJSX:()=>se,iterateFields:()=>ke,iterateFuncs:()=>Le,normalizeField:()=>Ve,selectTypes:()=>_e});var f={};r.r(f),r.d(f,{getItemInListValues:()=>$l,getListValue:()=>Ql,getTitleInListValues:()=>Hl,getValueInListValues:()=>Jl,listValuesToArray:()=>Ul,makeCustomListValue:()=>Bl,mapListValues:()=>Yl,searchListValue:()=>Kl,toListValue:()=>zl});var v={};r.r(v),r.d(v,{_validateTree:()=>la,checkTree:()=>ra,getTreeBadFields:()=>ta,isValidTree:()=>ea,sanitizeTree:()=>oa,translateValidation:()=>Il,validateAndFixTree:()=>ia,validateRange:()=>ga,validateTree:()=>na,validateValue:()=>da});var g={};r.r(g),r.d(g,{getCompatibleArgsOnFuncChange:()=>ba,getDefaultArgValue:()=>Kt,setArgValue:()=>Qt,setArgValueAsyncListValues:()=>ya,setArgValueSrc:()=>ma,setFunc:()=>ha,setFuncDefaultArg:()=>Zt,setFuncDefaultArgs:()=>Xt});var h={};r.r(h),r.d(h,{createListFromArray:()=>Lt,createListWithOneElement:()=>_t,defaultConjunction:()=>Ot,defaultGroupConjunction:()=>St,defaultGroupProperties:()=>Ft,defaultItemProperties:()=>Fa,defaultOperatorOptions:()=>At,defaultRoot:()=>wa,defaultRule:()=>ja,defaultRuleProperties:()=>Sa,emptyProperties:()=>kt,getDefaultField:()=>jt,getDefaultFieldSrc:()=>Et,getDefaultOperator:()=>Ct,getDefaultSubField:()=>wt});var m={};r.r(m),r.d(m,{fixListValuesGroupOrder:()=>Ra,getListValue:()=>Ql,listValueToOption:()=>Da,mergeListValues:()=>Va,optionToListValue:()=>xa,optionsToListValues:()=>Ia,simulateAsyncFetch:()=>Pa});var y={};r.r(y),r.d(y,{Autocomplete:()=>m,ConfigUtils:()=>p,DefaultUtils:()=>h,ExportUtils:()=>c,FuncUtils:()=>g,JsonLogicUtils:()=>l,ListUtils:()=>f,MongoUtils:()=>u,OtherUtils:()=>n,RuleUtils:()=>i,SpelUtils:()=>s,TreeUtils:()=>o,Validation:()=>v,checkTree:()=>ra,clone:()=>P(),compressConfig:()=>Jr,decompressConfig:()=>Yr,getSwitchValues:()=>gt,i18n:()=>Dl,isValidTree:()=>ea,moment:()=>x(),sanitizeTree:()=>oa,uuid:()=>k,validateAndFixTree:()=>ia,validateTree:()=>na});var b={};r.r(b),r.d(b,{_loadFromJsonLogic:()=>Ci,_loadFromSpel:()=>Nu,getTree:()=>ai,isImmutableTree:()=>si,isJsonLogic:()=>ce,isTree:()=>ci,jsToImmutable:()=>bt,loadFromJsonLogic:()=>Ei,loadFromSpel:()=>Ru,loadTree:()=>ui});var O={};r.r(O),r.d(O,{addCaseGroup:()=>Us,addDefaultCaseGroup:()=>Bs,addGroup:()=>$s,addRule:()=>Gs,moveItem:()=>Ys,removeGroup:()=>Hs,removeGroupChildren:()=>Js,removeRule:()=>zs,setTree:()=>Ws});var A={};r.r(A),r.d(A,{setConjunction:()=>Ks,setLock:()=>Xs,setNot:()=>Qs});var S={};r.r(S),r.d(S,{setField:()=>Zs,setFieldSrc:()=>ec,setFuncValue:()=>oc,setOperator:()=>tc,setOperatorOption:()=>ic,setValue:()=>rc,setValueSrc:()=>nc});var F={};r.r(F),r.d(F,{Os:()=>A,Hu:()=>S,B2:()=>O});var j=r(6467),w=r(12024),E=r(73188),C=r(2716),_=r(80280),L=0;const k=function(){var e=((new Date).getTime().toString(16)+"FF").substr(0,11);return"ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,(function(e){var t="s"===e?Math.floor(16*Math.random()):15&L++;return("x"===e?t:3&t|8).toString(16)}))+e};var T=r(99804),P=r.n(T),V=r(5866),x=r.n(V),I=r(20039);function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var q=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],M=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],W=function(e){return"object"===(0,C.A)(e)&&null!==e&&"[object Object]"===Object.prototype.toString.call(e)},G=function(e){return"object"===(0,C.A)(e)&&null!==e},z=function(e){var t=(0,C.A)(e);return t&&null!==e&&Array.isArray(e)?"array":t},B=function(e,t){return z(e)===t||"number"===t&&!isNaN(e)},U=function(e){return!!e},$=function(e){if("object"===(0,C.A)(e)&&null!==e){if(Array.isArray(e))return(0,E.A)(e);if(W(e))return N({},e)}return e},H=function(e){return!["__proto__","constructor","prototype"].includes(e)},J=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&H(t)},Y=function(e,t,r,n){var o=n=N(N({},{canCreate:!1,canIgnore:!1,canChangeType:!1}),null!=n?n:{}),i=o.canCreate,l=o.canIgnore,a=o.canChangeType;if(!Array.isArray(t))throw new Error("path is not an array");if(!t.length)throw new Error("path is empty");var u="number"==typeof t[0]?"array":"object";if(!B(e,u))throw new Error("obj is not of type ".concat(u));var s,c=$(e),d=c,p=(0,E.A)(t),f=p.pop(),v=[],g=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return D(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(p);try{for(g.s();!(s=g.n()).done;){var h=s.value;if(!H(h))throw new Error("path contains unsafe ".concat(h));var m="number"==typeof t[v.length]?"array":"object";if(!B(d[h],m)){if(!(d[h]?a:i)){if(l){d=void 0,c=e;break}throw new Error("Value by path ".concat(v.join(".")," should have type ").concat(m," but got ").concat(z(d[h])))}d[h]="array"===m?[]:{}}v.push(h),d[h]=$(d[h]),d=d[h]}}catch(e){g.e(e)}finally{g.f()}if(d)if(void 0===r)delete d[f];else{var y=d[f];d[f]="function"==typeof r?r(y):r}return c},K=function(e,t,r){var n=r=N(N({},{canCreate:!0,canChangeType:!0,deepCopyObj:!1,deepCopyMixin:!1,arrayMergeMode:"merge",circularRefs:!1,specialSymbols:!0}),null!=r?r:{}),o=n.deepCopyObj,i=n.deepCopyMixin,l=n.circularRefs,a=n.specialSymbols;if(!B(e,"object"))throw new Error("obj is not an object");if(!B(t,"object"))throw new Error("mixin is not an object");var u=Symbol.for("_v"),s=Symbol.for("_type"),c=Symbol.for("_canCreate"),d=Symbol.for("_canChangeType"),p=Symbol.for("_arrayMergeMode"),f=o?P()(e,l):$(e),v=!1,g=function(e,t,n){var f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},h=f.isMixingArray,m=f.isMixingRealArray,y=0,b=function(){if(!H(O))throw new Error("mixin contains unsafe key ".concat(O));if(!J(t,O))return 0;var f,b,A,S,F,j,w,C=h?Number(O)+y:O,_=a&&G(t[O]),L=r.canCreate,k=r.canChangeType,T=r.arrayMergeMode,V=t[O],x=!1,I=z(V);if(_&&(u in t[O]&&(x=!0,V=t[O][u]),I=(null===(f=t[O])||void 0===f?void 0:f[s])||z(V),L=null!==(b=null===(A=t[O])||void 0===A?void 0:A[c])&&void 0!==b?b:L,k=null!==(S=null===(F=t[O])||void 0===F?void 0:F[d])&&void 0!==S?S:k,T=null!==(j=null===(w=t[O])||void 0===w?void 0:w[p])&&void 0!==j?j:T,"array"===I&&"overwrite"===T&&(x=!0)),"array"!==I&&(T=void 0),!B(n[C],I)){if(!(n[C]?k:L))return 0;"array"!==I&&"object"!==I||(n[C]="array"===I?[]:{},v=!0)}if("array"===I||"object"===I)if(x)v=!0,n[C]=i?P()(V,l):$(V);else if(T&&["join","joinMissing","joinRespectOrder"].includes(T)){v=!0;var D=o?n[C]:P()(n[C],l),R=i?P()(V,l):V;"joinRespectOrder"===T?n[C]=pe(D,R):("joinMissing"===T&&(R=R.filter((function(e){return!D.includes(e)}))),n[C]=[].concat((0,E.A)(D),(0,E.A)(R)))}else{var N;o||(n[C]=$(n[C])),g([].concat((0,E.A)(e),[O]),V,n[C],{isMixingArray:"array"===I,isMixingRealArray:"array"===I&&!(null!==(N=t[O])&&void 0!==N&&N[s])})}else void 0!==V||m||x?(v=!0,n[C]=V):C in n&&(v=!0,Array.isArray(n)?(n.splice(C,1),y--):delete n[C])};for(var O in t)b()};return g([],t,f),v?f:e},Q=function(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){var r=(0,w.A)(e,1)[0];return!t.includes(r)})))},X=function(e){var t;return null!==(t=null==e?void 0:e.cardinality)&&void 0!==t?t:1},Z=function(e,t){return e===t||(_.T5.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t))},ee=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?ee(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):_.T5.isMap(e)?e.equals(t):"object"==(0,C.A)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var l=0;l<i;l++){var a=n[l];if(!(r?ee(e[a],t[a],r):e[a]===t[a]))return!1}return!0}(e,t,r):e===t)};var te=function(e){return"object"===(0,C.A)(e)&&null!==e&&"function"==typeof e.toJS},re=function(e){return te(e)&&_.Ay.isList(e)};function ne(e){return re(e)?e:new _.Ay.List(e)}function oe(e){return te(e)?e.toJS():e}var ie=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},le=function(e,t,r,n,o,i){if(Array.isArray(e))return t},ae=function(e){var t;if(e instanceof Array)return e.map((function(e,t){return ae(e)}));if("object"===(0,C.A)(e)&&null!==e&&ue(e)){var r,n=Q(e,["$$typeof","_owner","_store","ref","key"]);return n.type&&(n.type="string"==typeof(t=n.type)?t:"function"==typeof t?t.name:t),null!=n&&null!==(r=n.props)&&void 0!==r&&r.children&&(n.props.children=ae(n.props.children)),n}return e},ue=function(e){return"object"===(0,C.A)(e)&&null!==e&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},se=function(e){return"object"===(0,C.A)(e)&&null!==e&&!Array.isArray(e)&&"string"==typeof e.type&&Object.keys(e).includes("props")},ce=function(e){return"object"===(0,C.A)(e)&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length};function de(e){return new Promise((function(t){setTimeout(t,e)}))}function pe(e,t){return e||(e=[]),t||(t=[]),t.map((function(t){return[t,e.indexOf(t)]})).map((function(e,t,r){var n=(0,w.A)(e,2),o=n[0];if(-1==n[1]){var i=r.slice(t+1),l=r.slice(0,t),a=(0,E.A)(l).reverse().find((function(e){var t=(0,w.A)(e,2);return t[0],-1!=t[1]})),u=l[l.length-1],s=i.find((function(e){var t=(0,w.A)(e,2);return t[0],-1!=t[1]})),c=a&&a===l[l.length-1],d=s&&i===i[0];return c?[o,"after",a[0]]:d?[o,"before",s[0]]:a?u?[o,"after",u[0]]:[o,"after",a[0]]:s?[o,"before",s[0]]:[o,"append",null]}return null})).filter((function(e){return null!==e})).reduce((function(e,t){var r=(0,w.A)(t,3),n=r[0],o=r[1],i=r[2],l=e.indexOf(i);if(-1===e.indexOf(n))if(l>-1){var a="after"===o?1:0;e.splice(l+a,0,n)}else e.splice("append"===o?1/0:0,0,n);return e}),e.slice())}var fe=function(e){"object"!==(0,C.A)(e)||null===e||ue(e)||(Object.keys(e).forEach((function(t){"__cache"!==t&&fe(e[t])})),Object.freeze(e))},ve=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(W(e)){if(e.var)return r[e.var]=t,!0;if(!W(t))return!1;for(var o in e){var i=e[o],l=t[o];if(!ve(i,l,r,[].concat((0,E.A)(n),[o])))return!1}return!0}if(Array.isArray(e)){if(!Array.isArray(t))return!1;for(var a=0;a<e.length;a++){var u=e[a],s=t[a];if(!ve(u,s,r,[].concat((0,E.A)(n),[a])))return!1}return!0}return e===t},ge=function(e){return void 0!==I&&"true"==(null==I||null===(I={NODE_ENV:"production"})||void 0===I?void 0:I.NODE_ENV_TEST)?N(N({},console),{},{log:function(){},debug:function(){},info:function(){}}):(null!=e?e:void 0!==I&&"development"==(null==I||null===(I={NODE_ENV:"production"})||void 0===I?void 0:I.NODE_ENV))?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}}},he=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0;r<t.length;r++){var n=t[r];if(void 0!==n){e=n;break}}return e},me=ge(),ye=r(80920),be=r.n(ye),Oe=r(40222),Ae=r.n(Oe);function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var je=be().mark(Le),we=be().mark(ke),Ee=q,Ce=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],_e=["select","multiselect","treeselect","treemultiselect"];function Le(e){return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Te(e,e.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}}),je)}function ke(e){return be().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Te(e,e.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}}),we)}function Te(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";return be().mark((function o(i){var l,a,u;return be().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:l=(null==e||null===(i=e.settings)||void 0===i?void 0:i.fieldSeparator)||".",o.t0=be().keys(t);case 2:if((o.t1=o.t0()).done){o.next=13;break}if(a=o.t1.value,!(u=t[a])[n]){o.next=9;break}return o.delegateYield(Te(e,u[n],[].concat((0,E.A)(r),[a]),n),"t2",7);case 7:o.next=11;break;case 9:return o.next=11,[[].concat((0,E.A)(r),[a]).join(l),u,a];case 11:o.next=2;break;case 13:case"end":return o.stop()}}),o)}))()}var Pe=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fields",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";if(!t)return null;if("!case_value"===t)return null==e||null===(n=e.settings)||void 0===n?void 0:n.caseValueField;var l=(null==e||null===(r=e.settings)||void 0===r?void 0:r.fieldSeparator)||".",a=qe(t,e),u=e[o];if(!u)return null;for(var s=u,c=null,d=[],p=0;p<a.length;p++){var f=a[p];d.push(f),c=s[d.join(l)],p<a.length-1&&(c&&c[i]?(s=c[i],d=[]):c=null)}return c},Ve=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.settings.fieldSeparator,l=[o].concat((0,E.A)(t.split(i))).filter((function(e){return null!=e})),a=t;return((null===(r=e.__fieldNames[a])||void 0===r||null===(n=r.find)||void 0===n||null===(n=n.call(r,(function(e){var t=e.inGroup;return!t||(null==o?void 0:o.startsWith(t))})))||void 0===n?void 0:n.fullPath)||l).join(i)},xe=function(e,t){if(!t)return null;var r=Pe(e,t,"funcs","subfields");if(!r)return null;var n=r.returnType,o=r.args;return{returnType:n,args:Object.fromEntries(Object.entries(o||{}).map((function(e){var t=(0,w.A)(e,2),r=t[0],n=t[1];return[r,Ae()(n,["type","valueSources","defaultValue","fieldSettings","isOptional","_funcKey","_argKey","_isFuncArg"])]})))}},Ie=function(e,t){return t&&Pe(e,t,"funcs","subfields")||null},De=function(e,t,r){var n=Ie(e,t);return n&&(n.args&&n.args[r]||null)||null},Re=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;var o=(null==n||null===(r=n.settings)||void 0===r?void 0:r.fieldSeparator)||".",i=Ne(e,n),l=Ne(t,n);return i.startsWith(l+o)},Ne=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e)return e;var n=(null==r||null===(t=r.settings)||void 0===t?void 0:t.fieldSeparator)||".";return qe(e,r).join(n)},qe=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var i,l=(null==o||null===(t=o.settings)||void 0===t?void 0:t.fieldSeparator)||".";return null!=e&&e.func?Array.isArray(e.func)?e.func:e.func.split(l):null!=e&&null!==(r=e.get)&&void 0!==r&&r.call(e,"func")?null==e||null===(i=e.get)||void 0===i?void 0:i.call(e,"func").split(l):(null==e||null===(n=e.split)||void 0===n?void 0:n.call(e,l))||[]},Me=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;var n=t.settings.fieldSeparator,o=qe(e,t);return r?o:o.map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return e.join(n)}))},We=function(e){var t;if("string"==typeof e||Array.isArray(e))return"field:".concat(Ne(e));if("object"===(0,C.A)(e)&&e){if(e._funcKey&&e._argKey)return"arg:".concat(Ne(e._funcKey),"__").concat(e._argKey);if(e._funcKey)return"func:".concat(Ne(e._funcKey));if(e.func&&e.arg)return"arg:".concat(Ne(e.func),"__").concat(e.arg);if(e.func)return"func:".concat(Ne(e.func));if(e.type)return null}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?"arg:".concat(Ne(e.get("func")),"__").concat(e.get("arg")):"func:".concat(Ne(e.get("func"))):null},Ge=function(e,t,r){var n;return null===(n=e.__cache)||void 0===n||null===(n=n[t])||void 0===n?void 0:n[r]},ze=function(e,t,r,n){e.__cache&&r&&(e.__cache[t]||(e.__cache[t]={}),e.__cache[t][r]=n)},Be=function(e){var t;if(!e)return null;if("object"===(0,C.A)(e)){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?null:"func":"field"},Ue=function(e,t){var r;if(!t)return null;if("object"==(0,C.A)(t)){if(!t.func&&t.type&&t.widgets)return t;if(t._isFuncArg)return De(e,t._funcKey,t._argKey);if(t._isFunc)return Ie(e,t._funcKey);if(t.func)return t.func&&t.arg?De(e,t.func,t.arg):Ie(e,t.func)}return null!=t&&null!==(r=t.get)&&void 0!==r&&r.call(t,"func")?null!=t&&t.get("arg")?De(e,t.get("func"),t.get("arg")):Ie(e,t.get("func")):Pe(e,t)||null},$e=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return null;var n=e.operators[t];if(r){var o,i,l=We(r),a=l?"".concat(l,"__").concat(t):null,u=Ge(e,"getOperatorConfig",a);if(u)return u;var s=Ue(e,r),c=Qe(e,r,t,null),d=e.widgets[c]||{},p=(s&&s.widgets?s.widgets[c]:{})||{},f=(null===(o=d.opProps)||void 0===o?void 0:o[t])||{},v=(null===(i=p.opProps)||void 0===i?void 0:i[t])||{},g=Fe(Fe(Fe({},n),f),v);return ze(e,"getOperatorConfig",a,g),g}return n},He=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!t)return null;var a=Ue(e,t),u=We(t);o||(o=Qe(e,t,n,i));var s=u?"".concat(u,"__").concat(n,"__").concat(o,"__").concat(i):null,c=Ge(e,"getFieldWidgetConfig",s);if(c)return c;var d=e.widgets[o]||{},p=(null==a||null===(r=a.widgets)||void 0===r?void 0:r[o])||{},f=p.widgetProps||{},v="value"!==i&&i?{}:null==a?void 0:a.fieldSettings,g=Fe(Fe(Fe(Fe({},d),p),f),v);return ze(e,"getFieldWidgetConfig",s,g),l.forExport&&(g=Q(g,"factory")),g},Je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.settings.fieldSeparator,n=qe(t,e),o=t?Pe(e,t):e,i=null,l=[];do{var a,u=o===e?e.fields:null===(a=o)||void 0===a?void 0:a.subfields;if(!u||!Object.keys(u).length){o=i=null;break}i=Object.keys(u)[0],l.push(i),o=u[i]}while("!struct"==o.type||"!group"==o.type);return(n||[]).concat(l).join(r)};function Ye(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],i=[];if(!t)return{widgets:o,valueSrcs:i};var l=We(t),a=l?"".concat(l,"__").concat(r,"__").concat(n):null,u=Ge(e,"_getWidgetsAndSrcsForFieldOp",a);if(u)return u;var s="object"===(0,C.A)(t)&&(!!t.func&&!!t.arg||t._isFuncArg),c=Ue(e,t),d=r?e.operators[r]:null;if(null!=c&&c.widgets){var p=function(){var l=c.widgets[f];if(!e.widgets[f])return 1;var a=e.widgets[f].valueSrc||"value",u=!0;if("field"===f&&(u=u&&Ke(e,["field"],c,r).length>0),"func"===f&&(u=u&&Ke(e,["func"],c,r).length>0),"value"!==n||l.operators||s||"!case_value"===t||(u=!1),l.operators&&r&&(u=u&&-1!=l.operators.indexOf(r)),n&&n!=a&&"const"!==n&&(u=!1),d&&0==d.cardinality&&"value"!==a&&(u=!1),u){var p,v;o.push(f);var g=-1!=(null===(p=c.valueSources)||void 0===p?void 0:p.indexOf(a));-1==(null==d||null===(v=d.valueSources)||void 0===v?void 0:v.indexOf(a))&&(g=!1),g&&!i.find((function(e){return e==a}))&&i.push(a)}};for(var f in c.widgets)p()}var v=function(e){var t=0;return c.preferWidgets?c.preferWidgets.includes(e)&&(t+=10-c.preferWidgets.indexOf(e)):e==c.mainWidget&&(t+=100),"field"===e&&(t-=1),"func"===e&&(t-=2),t};o.sort((function(e,t){return v(t)-v(e)}));var g={widgets:o,valueSrcs:i};return ze(e,"_getWidgetsAndSrcsForFieldOp",a,g),g}var Ke=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!r)return t;var i=null!==(n=r.type)&&void 0!==n?n:r.returnType;"!group"===i&&(i="number");var l=!1;if(o){var a=e.operators[o];null!=a&&a.valueTypes&&(i=a.valueTypes[0],l=!0)}return t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter((function(t){var n=!0;if("field"===t&&e.__fieldsCntByType){var o=r._isFuncArg||l?0:1;n=n&&e.__fieldsCntByType[i]>o}return"func"===t&&(r.funcs&&(n=n&&r.funcs.length>0),e.__funcsCntByType&&(n=n&&e.__funcsCntByType[i]>0)),n}))},Qe=function(e,t,r){var n=Ye(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets,o=null;return n.length&&(o=n[0]),o},Xe=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=Ye(e,t,r,null).valueSrcs;return Ke(e,o,n,r)},Ze=function(e,t,r){return Ye(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets},et=function(e,t){var r;return(null===(r=e.types[t])||void 0===r?void 0:r.operators)||null},tt=function(e,t){var r=Ue(e,t);return r?r.operators:[]},rt=function(e,t){var r,n=tt(e,t);return null!==(r=null==n?void 0:n[0])&&void 0!==r?r:null},nt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;var n=r&&Pe(t,r)||null,o=t.settings.fieldSeparator,i=qe(e,t),l=Re(e,r,t)?qe(r,t):[];return i.slice(l.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return{part:[].concat((0,E.A)(l),(0,E.A)(e)).join(o),key:e[e.length-1]}})).map((function(e){var r=e.part;return{key:e.key,cnf:Pe(t,r)}})).map((function(e,t,r){return[e.key,e.cnf,t>0?r[t-1].cnf:n]}))},ot=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.skip(1),e.push.apply(e,r),e}))},it=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.push.apply(e,r),e}))},lt=function(e,t){var r=new _.Ay.OrderedMap((0,j.A)({},e.get("id"),e)),n=e;return t.forEach((function(e){var t,o;n=null===(t=r)||void 0===t?void 0:t.get(e),r=null===(o=n)||void 0===o?void 0:o.get("children1")})),n},at=function(e,t){var r=t.map((function(e,r){return t.take(r+1)})).reverse().toJS().map((function(t){return{item:lt(e,t),path:t}})).filter((function(e){var t=e.item;return"rule_group"===(null==t?void 0:t.get("type"))}));return r.length?r.map((function(e){var t=e.item;return{path:e.path,field:t.get("properties").get("field")}})):[]},ut=function(e){var t=e;return function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n.push(r.get("id")),l=r.getIn(["properties","isLocked"]);o&&l&&(t=t.deleteIn(ot(i,"properties","isLocked")));var a=r.get("children1");a&&a.map((function(t,r){e(t,i,l||o)}))}(e,new _.Ay.List),t},st=function(e){var t=e;return function e(r,n,o,i){if(r){var l=r.get("path"),a=r.get("id"),u=a||i||k(),s=n.push(u);l&&l.equals(s)||(t=t.setIn(ot(s,"path"),s)),a||(t=t.setIn(ot(s,"id"),u));var c=r.get("children1");c&&("Map"===c.constructor.name&&(t=t.setIn(ot(s,"children1"),new _.Ay.OrderedMap(c))),c.map((function(t,r){e(t,s,o+1,r)})))}}(e,new _.Ay.List,0),t},ct=function(e){var t=e;return function e(r,n,o,i){if(!r)return!1;var l=r.get("id")||i,a=n.push(l),u=r.get("children1");if(u){var s=u.map((function(t,r){return e(t,a,o+1,r)})).reduce((function(e,t){return e&&t}),!0);if((0==u.size||s)&&o>0)return t=t.deleteIn(ot(a)),!0}return!1}(e,new _.Ay.List,0),t},dt=function(e,t){var r=[],n={},o=[],i=0,l=0,a=0,u={};!function s(c,d,p,f,v,g,h,m,y){var b,O,A,S=c===e,F=c.get("type"),j=c.get("collapsed"),w=c.get("id"),C=c.get("children1"),_=c.getIn(["properties","isLocked"]),L=C?C.map((function(e,t){return t})).valueSeq().toArray():null,k="rule_group"===F,T="rule"===F,P="group"===F,V="case_group"===F,x=!v&&(!C||k),I=(null==L?void 0:L.length)>0,D=d.length?d[d.length-1]:null,R=(0,E.A)(d).reverse().find((function(e){return"rule_group"==n[e].type})),N=c.getIn(["properties","field"]),q=N&&t&&Ue(t,N),M=q?!1!==(null==q?void 0:q.canRegroup):void 0,W=null==q?void 0:q.maxNesting,G=null==n||null===(b=n[R])||void 0===b?void 0:b.canRegroup,z=null==n||null===(O=n[R])||void 0===O?void 0:O.maxNesting,B=null==n||null===(A=n[R])||void 0===A?void 0:A.lev,U=V?w:m;V&&(o.push(w),l=0,a=0,u={});var $,H=U?o.indexOf(U):null,J=r.length,Y=i;S||(($={}).caseNo=H,$.globalNoByType=V?H:u[F]||0,$.indexPath=[].concat((0,E.A)(d.slice(1).map((function(e){return n[e].childNo}))),[y]),T?$.globalLeafNo=l:P&&($.globalGroupNo=a));var K=v||k?h:h+1;r.push(w),n[w]={node:c,index:J,id:w,type:F,parent:D,children:L,childNo:y,caseId:U,caseNo:H,closestRuleGroupId:R,closestRuleGroupLev:B,closestRuleGroupMaxNesting:z,closestRuleGroupCanRegroup:G,maxNesting:W,canRegroup:M,path:d.concat(w),lev:g,atomicLev:h,nextAtomicLev:K,isLeaf:!C,isAtomicRule:x,isLocked:_||f,top:p?null:Y,isDefaultCase:V?!C:void 0,atomicRulesCountInCase:V?0:void 0,position:$,collapsed:j,_top:J,parentType:D?n[D].type:null,leaf:!C};var Q=0,X=0;p||(i+=1,Q+=1,!I||j||k||(X+=1),S||V||(P&&a++,T&&l++,u[F]=(u[F]||0)+1)),m&&x&&n[m].atomicRulesCountInCase++;var Z=0,ee=0;if(I){var te=0;C.map((function(e,t){if(e){s(e,d.concat(w),p||j,f||_,v||k,g+1,K,U,te);var r=n[t];Z=Math.max(Z,r.depth||0),ee+=r.height,te++}}))}Q+=ee,X+=Z;var re=r.length-J,ne=p?null:Y+Q;Object.assign(n[w],{depth:C?X:void 0,_height:re,height:Q,bottom:ne})}(e,[],!1,!1,!1,0,0,null,null);for(var s=0;s<r.length;s++){var c=s>0?r[s-1]:null,d=s<r.length-1?r[s+1]:null,p=n[r[s]];p.prev=c,p.next=d}return{flat:r,items:n,cases:o}},pt=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,l,a;"function"==typeof r.get?(i=r.get("id"),l=r.get("children1"),a=r.get("type")):(i=r.id,l=r.children1,a=r.type),t++,"rule_group"==a&&o>0||l&&l.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t-1},ft=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,l,a;"function"==typeof r.get?(i=r.get("id"),l=r.get("children1"),a=r.get("type")):(i=r.id,l=r.children1,a=r.type),"rule"==a||"rule_group"==a&&o>0?t++:l&&l.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t},vt=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return function e(n,o){t&&n.path&&delete n.path,t&&!r&&o&&delete n.id;var i=n.properties;i&&null==i.operatorOptions&&delete i.operatorOptions;var l=n.children1;if(l){for(var a in l)l[a]&&e(l[a],a);r&&(n.children1=Object.values(l))}}(e,null),n},gt=function(e){var t=[],r=e.get("children1");return r&&r.map((function(e){var r,n=e.getIn(["properties","value"]);n&&1==n.size?(r=n.get(0),Array.isArray(r)&&0==r.length&&(r=null)):r=null,t=[].concat((0,E.A)(t),[r])})),t},ht=function(e){return!e.get("children1")||0==e.get("children1").size},mt=function(e,t){return e.getIn(ot(t,"children1")).size>0},yt=function(e){if(null!=e&&e.toJS){var t,r=null==e||null===(t=e.toJS)||void 0===t?void 0:t.call(e);return null!=r&&r.func?e.toOrderedMap():r}return e};function bt(e){return(0,_.ss)(e,(function(e,t,r){var n,o=r&&r.length>3&&"value"===r[r.length-1]&&"args"===r[r.length-3],i=r&&r.length>3&&"value"===r[r.length-1]&&"properties"===r[r.length-2];if("properties"==e){n=t.toOrderedMap();for(var l=0;l<2;l++){var a,u;null===(null===(a=n.get("value"))||void 0===a||null===(u=a.get)||void 0===u?void 0:u.call(a,l))&&(n=n.setIn(["value",l],void 0))}}else n=o?yt(t):(r?i:"value"==e)&&_.Ay.Iterable.isIndexed(t)?t.map(yt).toList():"asyncListValues"==e?t.toJS():"children1"==e&&_.Ay.Iterable.isIndexed(t)?new _.Ay.OrderedMap(t.map((function(e){return[(null==e?void 0:e.get("id"))||k(),e]}))):_.Ay.Iterable.isIndexed(t)?t.toList():t.toOrderedMap();return n}))}var Ot=function(e){return St(e)},At=function(e,t,r){var n=t?$e(e,t,r):null;return n&&n.options?new _.Ay.Map(n.options&&n.options.defaults||{}):null},St=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=(null===(t=n=Ue(e,n))||void 0===t?void 0:t.conjunctions)||Object.keys(e.conjunctions);return 1==o.length?o[0]:(null===(r=n)||void 0===r?void 0:r.defaultConjunction)||e.settings.defaultConjunction||e.settings.defaultGroupConjunction||o[0]},Ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new _.Ay.Map({conjunction:St(e,t),not:!1})},jt=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.settings.defaultField,o=(r?wt(e,r):n)||t&&Je(e,r)||null;return null==o||"string"==typeof o||te(o)||(o=bt(o)),o},wt=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r)return null;var n=(null==e||null===(t=e.settings)||void 0===t?void 0:t.fieldSeparator)||".",o=Ue(e,r),i=null==o?void 0:o.defaultField;return i&&(i=[].concat((0,E.A)(qe(r)),[i]).join(n)),i},Et=function(e){var t;return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=e.settings.fieldSources)||void 0===t?void 0:t[0])||"field"},Ct=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Ue(e,t),o=(null==n?void 0:n.operators)||[],i=e.settings.defaultOperator;i&&!o.includes(i)&&(i=null);var l=null==n?void 0:n.defaultOperator,a=null==n?void 0:n.ownDefaultOperator,u=r?rt(e,t):null;return a||i||l||u},_t=function(e){return re(e)?e:Lt([e])},Lt=function(e){return re(e)?e:new _.Ay.List(e)},kt=function(){return new _.Ay.Map},Tt=r(75179),Pt=r.n(Tt),Vt=function(e,t,r){var n=null;if(e)if("field"===t){var o=Ue(r,e);o&&(n=o.type)}else if("func"===t){var i=e.get("func");if(i){var l=Ie(r,i);l&&(n=l.returnType||l.type)}}return n},xt=function(e,t){return It(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,"funcs","subfields")},It=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fields",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"subfields";if(!e)return null;var i=t.settings.fieldSeparator,l=qe(e,t),a=qe(r,t);return l.slice(a.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return[].concat((0,E.A)(a),(0,E.A)(e)).join(i)})).map((function(e){var r=Pe(t,e,n,o);return r&&r.label||Pt()(e.split(i))})).filter((function(e){return null!=e}))},Dt=function(e,t,r,n){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=He(e,t,r,null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:null)||{},l=$e(e,r,t)||{},a=null;if((o?1:l.cardinality)>1){var u=i.valueLabels||l.valueLabels;u&&(a=u[n]),a&&"object"!==(0,C.A)(a)&&(a={label:a,placeholder:a}),a||(a={label:e.settings.valueLabel+" "+(n+1),placeholder:e.settings.valuePlaceholder+" "+(n+1)})}else{var s=i.valueLabel,c=i.valuePlaceholder;a={label:s||e.settings.valueLabel,placeholder:c||e.settings.valuePlaceholder}}return a},Rt=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(e){var i=Ue(t,e)||{},l=t.settings.fieldSeparator,a=qe(e,t),u=Array.isArray(e)?e.join(l):e;if(null!=o&&o.useTableName&&i.tableName){var s=(0,E.A)(a);s[0]=i.tableName,u=s.join(l)}if(i.fieldName&&(u=i.fieldName),n){Ue(t,n);var c=n;0==u.indexOf(c+l)?u=u.slice((c+l).length):i.fieldName||r.errors.push("Can't cut group ".concat(c," from field ").concat(u))}return u}},Nt=function(e,t){var r=e.get("type"),n=e.getIn(["properties","mode"]);return"rule_group"==r&&"array"==n?qt(e,t):"group"==r||"rule_group"==r?Wt(e,t):zt(e,t)},qt=function(e,t){var r=e.get("children1"),n=e.get("properties");return Mt(n.toObject(),r,t)},Mt=function(e,t,r){var n,o,i=e.operator,l=0==(null!==(n=null===(o=r.operators[i])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1),a=!Bt(e,r),u=!Gt(t,r);return!(a&&(!l||u))},Wt=function(e,t){var r=e.get("children1");return Gt(r,t)},Gt=function(e,t){return!((null==e?void 0:e.size)>0&&e.filter((function(e){return!Nt(e,t)})).size>0)},zt=function(e,t){var r=e.get("properties");return Bt((null==r?void 0:r.toObject())||{},t)},Bt=function(e,t){return!(Ut(e,t,!0).score>=3)},Ut=function(e,t){var r,n,o,i=e.field,l=e.fieldSrc,a=(e.fieldType,e.operator),u=e.value,s=e.valueSrc,c=(e.valueType,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),d=null!==(r=null===(n=t.operators[a])||void 0===n?void 0:n.cardinality)&&void 0!==r?r:1,p=null!=s&&s.get?s.toJS():s,f={parts:{},score:0};if(f.parts.field=c?null!=i:$t(i,l,t),f.parts.operator=!!a,f.parts.value=(null==u||null===(o=u.filter((function(e,r){return $t(e,null==p?void 0:p[r],t,c)})))||void 0===o?void 0:o.size)>=(c?Math.min(d,1):d),f.score=Object.keys(f.parts).filter((function(e){return!!f.parts[e]})).length,c&&f.score<3){var v=!0;!f.parts.value&&"func"===l&&$t(i,l,t,!1,v)&&f.score++,f.parts.field||null==u||u.map((function(e,r){"func"===(null==p?void 0:p[r])&&$t(e,null==p?void 0:p[r],t,!1,v)&&f.score++}))}return f},$t=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(!n&&"func"==t&&e){var i,l=null===(i=e.get)||void 0===i?void 0:i.call(e,"func"),a=Ie(r,l);if(a){var u=e.get("args");for(var s in a.args){var c=a.args[s],d=u?u.get(s):void 0,p=d?d.get("value"):void 0,f=d?d.get("valueSrc"):void 0;if(null==p&&void 0===(null==c?void 0:c.defaultValue)&&(null==c||!c.isOptional))return!1;if(null!=p&&!$t(p,f,r,!o||n))return!1}return!0}}return null!=e},Ht=function(e,t,r){return"func"==t?Jt(e,r):e},Jt=function(e,t){if(e){var r=e.get("func"),n=r&&Ie(t,r);if(n){var o=e,i=!1;for(var l in n.args){var a=n.args[l],u=a.valueSources,s=a.isOptional,c=a.defaultValue,d=Ke(t,u,a),p=o.get("args"),f=1==d.length?d[0]:void 0,v=p?p.get(l):void 0,g=v?v.get("value"):void 0,h=(v?v.get("valueSrc"):void 0)||f;if(void 0!==g){var m=Ht(g,h,t);if(void 0===m)return;if(m!==g&&(o=o.setIn(["args",l,"value"],m)),i)return}else if(void 0===c||W(c)){if(!s)return;i=!0}else o=(o=o.setIn(["args",l,"value"],Kt(a))).setIn(["args",l,"valueSrc"],"value")}return o}}},Yt=function(e){var t=e.get("children1");if(1==(null==t?void 0:t.size)){var r=t.first();return"group"===r.get("type")?Yt(r):r}return null},Kt=function(e){var t=e.defaultValue;return W(t)&&!_.Ay.Map.isMap(t)&&t.func?_.Ay.fromJS(t,(function(e,t){return _.Ay.Iterable.isIndexed(t)?t.toList():t.toOrderedMap()})):t},Qt=function(e,t,r,n,o){if(e&&e.get("func")){var i=(e=e.setIn(["args",t,"value"],r)).getIn(["args",t,"valueSrc"]),l=n.valueSources,a=Ke(o,l,n),u=1==a.length?a[0]:void 0;!u&&a.includes("value")&&(u="value"),!i&&u&&(e=e.setIn(["args",t,"valueSrc"],u))}return e},Xt=function(e,t,r){if(r)for(var n in r.args)t=Zt(e,t,r,n);return t},Zt=function(e,t,r,n){var o=r.args[n],i=o.valueSources,l=o.defaultValue,a=Ke(e,i,o),u=a.length?a[0]:void 0,s=(l?W(l)&&l.func?"func":"value":void 0)||u;return t.getIn(["args",n])||(void 0!==l&&(t=t.setIn(["args",n,"value"],Kt(o))),s&&(t=t.setIn(["args",n,"valueSrc"],s))),t};function er(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):er(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var rr=function(e,t){var r={usedFields:[]},n=nr(e,t,r);if(n)return tr(tr({},n),r)},nr=function(e,t,r){if(e){var n=e.get("type"),o=e.get("children1");return("group"===n||"rule_group"===n)&&o&&o.size?or(e,t,r):"rule"===n?ir(e,t,r):void 0}},or=function(e,t,r){var n=e.get("properties")||new _.T5,o=e.get("children1"),i=e.get("id"),l=o.map((function(e){return nr(e,t,r)})).filter((function(e){return void 0!==e}));if(l.size){var a=n.get("conjunction");a||(a=Ot(t));var u=n.get("not");return{id:i,rules:l.toList(),condition:a.toUpperCase(),not:u}}},ir=function(e,t,r){var n,o=e.get("properties")||new _.T5,i=e.get("id"),l=o.get("operator"),a=o.get("operatorOptions"),u=o.get("field"),s=o.get("value"),c=o.get("valueSrc"),d=o.get("valueType"),p=s.filter((function(e){return void 0===e})).size>0;if(null!=u&&null!=l&&!p){var f=Ue(t,u)||{},v=$e(t,l,u)||{},g=f.type||"undefined",h=X(v),m=t.types[f.type]||{},y=Rt(u,t,r);if(!(s.size<h)){-1==r.usedFields.indexOf(u)&&r.usedFields.push(u),s=s.toArray(),c=c.toArray(),d=(null===(n=d)||void 0===n?void 0:n.toArray())||[];for(var b=[],O=0;O<s.length;O++){var A={type:d[O],value:s[O]};if(b.push(A),"field"==c[O]){var S=s[O];-1==r.usedFields.indexOf(S)&&r.usedFields.push(S)}}var F=a?a.toJS():null;F&&!Object.keys(F).length&&(F=null);var j={id:i,fieldName:y,type:g,input:m.mainWidget,operator:l};return F&&(j.operatorOptions=F),j.values=b,j}}},lr=r(39847),ar=r.n(lr),ur={reverseOperatorsForNot:!1,canShortMongoQuery:!0,fixJsonLogicDateCompareOp:!1,formatField:function(e,t,r,n,o,i){return i?r:e},caseValueField:{type:"case_value"},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,exportPreserveGroups:!1,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultConjunction:"AND",defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",addSubGroupLabel:"Add sub group",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null,loadMoreLabel:"Load more...",loadingMoreLabel:"Loading more...",typeToSearchLabel:"Type to search",loadingLabel:"Loading...",notFoundLabel:"Not found"},sr=r(12495),cr=r.n(sr),dr=r(26462),pr=r.n(dr);function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gr(e,t){return pr().apply(e,t)}function hr(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:pr()).add_operation(e,t)}var mr={CALL:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return e.call.apply(e,[t].concat(n))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return vr(vr({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()},strlen:function(e){return(null==e?void 0:e.length)||0},regexTest:function(e,t,r){return null!=(null==e?void 0:e.match(new RegExp(t,r)))},"date==":function(e,t){if(null==e||null==t)return!1;var r=x()(e).startOf("day"),n=x()(t).startOf("day");return r.isSame(n)},"date!=":function(e,t){return!mr["date=="](e,t)},"datetime==":function(e,t){if(null==e||null==t)return!1;var r=x()(e),n=x()(t);return r.isSame(n)},"datetime!=":function(e,t){return!mr["datetime=="](e,t)},now:function(){return new Date},today:function(){var e=x()().startOf("day"),t=e.year(),r=e.month(),n=e.date();return x().utc([t,r,n]).toDate()},start_of_today:function(){return x()().startOf("day").toDate()},date_add:function(e,t,r){return x()(e).add(t,r).toDate()},datetime_add:function(e,t,r){return x()(e).add(t,r).toDate()},datetime_truncate:function(e,t){return x()(e).startOf(t).toDate()}};function yr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pr();for(var t in mr)hr(t,mr[t],e)}var br=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e})).filter((function(e){return null!=e})):void 0},Or=function(e){if(null!=e){var t=[],r=(Array.isArray(e)?e:[e]).filter((function(e){return null!=e})).map((function(t){return{type:"property",value:e}}));if(t.length)throw new Error(t.join("\n"));return r}};function Ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Fr={day:"day",week:"week",month:"month",year:"year"},jr=Sr({hour:"hour",minute:"minute",second:"second"},Fr),wr={label:"Now",returnType:"datetime",jsonLogicCustomOps:{now:{}},jsonLogic:function(){return{now:[]}},jsonLogicImport:function(e){if(e.now)return[]},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},sqlFunc:"NOW",mongoFormatFunc:function(){return{$toDate:"$$NOW"}},formatFunc:function(){return"NOW"}},Er={label:"Today",returnType:"date",jsonLogicCustomOps:{today:{}},jsonLogic:function(){return{today:[]}},jsonLogicImport:function(e){if(e.today)return[]},spelFunc:"T(java.time.LocalDate).now()",sqlFormatFunc:function(){return"CURDATE()"},sqlFunc:"CURDATE",mongoFormatFunc:function(){return{$dateTrunc:{date:{$toDate:"$$NOW"},unit:"day"}}},formatFunc:function(){return"TODAY"}},Cr={label:"Start of today",returnType:"datetime",jsonLogicCustomOps:{start_of_today:{}},jsonLogic:function(){return{start_of_today:[]}},jsonLogicImport:function(e){if(e.start_of_today)return[]},spelFunc:"T(java.time.LocalDateTime).now().truncatedTo(T(java.time.temporal.ChronoUnit).DAYS)",spelImport:function(e){var t,r,n,o,i=e.obj,l=e.args,a="!func"===(null==e?void 0:e.type)&&"truncatedTo"===(null==e?void 0:e.methodName),u="now"===(null==i?void 0:i.methodName)&&"java.time.LocalDateTime"===(null==i||null===(t=i.obj)||void 0===t||null===(t=t.cls)||void 0===t?void 0:t.join(".")),s=(null==l?void 0:l.length)||0,c=null==l?void 0:l[0],d=null==c||null===(r=c.children)||void 0===r?void 0:r[0],p=null==c||null===(n=c.children)||void 0===n?void 0:n[1],f="!type"===(null==d?void 0:d.type)&&(null==d||null===(o=d.cls)||void 0===o?void 0:o.join(".")),v="property"===(null==p?void 0:p.type)&&(null==p?void 0:p.val),g=1===s&&"compound"===c.type&&"java.time.temporal.ChronoUnit"===f&&"DAYS"===v;if(u&&a&&g)return{}},sqlFormatFunc:function(){return"DATE_FORMAT(NOW(), '%Y-%m-%d 00:00:00')"},sqlImport:function(e,t,r){var n;if("DATE_FORMAT"===(null==e?void 0:e.func)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var o=(0,w.A)(e.children,2),i=o[0],l=o[1];if("%Y-%m-%d 00:00:00"==(null==l?void 0:l.value)&&"NOW"==(null==i?void 0:i.func))return{args:{}}}},mongoFormatFunc:function(){return{$dateTrunc:{date:{$toDate:"$$NOW"},unit:"day"}}},formatFunc:function(){return"START_OF_TODAY"}},_r={label:"Truncate",returnType:"datetime",renderBrackets:["",""],renderSeps:["to"],jsonLogicCustomOps:{datetime_truncate:{}},jsonLogic:function(e){return{datetime_truncate:[e.date,e.dim]}},jsonLogicImport:function(e){if(e.datetime_truncate)return[e.datetime_truncate[0],e.datetime_truncate[1]]},spelFormatFunc:function(e){var t=e.date,r=e.dim,n=(r.charAt(0).toUpperCase()+r.slice(1)+"s").toUpperCase();return"".concat(t,".truncatedTo(T(java.time.temporal.ChronoUnit).").concat(n,")")},spelImport:function(e){var t,r,n,o=e.args,i="!func"===(null==e?void 0:e.type)&&"truncatedTo"===(null==e?void 0:e.methodName),l=(null==o?void 0:o.length)||0,a=null==o?void 0:o[0],u=null==a||null===(t=a.children)||void 0===t?void 0:t[0],s=null==a||null===(r=a.children)||void 0===r?void 0:r[1],c="!type"===(null==u?void 0:u.type)&&(null==u||null===(n=u.cls)||void 0===n?void 0:n.join(".")),d="property"===(null==s?void 0:s.type)&&(null==s?void 0:s.val),p=1===l&&"compound"===a.type&&"java.time.temporal.ChronoUnit"===c&&d,f=d.toLowerCase().substring(0,d.length-1);if(i&&p)return{date:e.obj,dim:{type:"string",val:f}}},sqlFormatFunc:function(e,t){var r=e.date,n=e.dim;if(t&&"MySQL"!==t){if("PostgreSQL"===t)return"date_trunc(".concat(n,", ").concat(r,")")}else switch(n=n.replace(/^'|'$/g,"")){case"second":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d %H:%i:%s')");case"minute":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d %H:%i:00')");case"hour":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d %H:00:00')");case"day":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d 00:00:00')");case"week":return"DATE_SUB(DATE_FORMAT(".concat(r,", '%Y-%m-%d 00:00:00'), INTERVAL WEEKDAY(").concat(r,") DAY)");case"month":return"DATE_FORMAT(".concat(r,", '%Y-%m-01 00:00:00')");case"year":return"DATE_FORMAT(".concat(r,", '%Y-01-01 00:00:00')")}},sqlImport:function(e,t,r){var n,o,i;if(r&&"MySQL"!==r){if("PostgreSQL"===r&&"date_trunc"===(null==e?void 0:e.func)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var l=(0,w.A)(e.children,2),a=l[0];return{args:{date:l[1],dim:a.value}}}}else if("DATE_FORMAT"===(null==e?void 0:e.func)&&2===(null===(o=e.children)||void 0===o?void 0:o.length)){var u,s=(0,w.A)(e.children,2),c=s[0],d=s[1];switch(null==d?void 0:d.value){case"%Y-%m-%d %H:%i:%s":u="second";break;case"%Y-%m-%d %H:%i:00":u="minute";break;case"%Y-%m-%d %H:00:00":u="hour";break;case"%Y-%m-%d 00:00:00":u="day";break;case"%Y-%m-01 00:00:00":u="month";break;case"%Y-01-01 00:00:00":u="year"}if(u)return{args:{date:c,dim:u}}}else if("DATE_SUB"===(null==e?void 0:e.func)&&2===(null===(i=e.children)||void 0===i?void 0:i.length)){var p,f=(0,w.A)(e.children,2),v=f[0],g=f[1],h="DATE_FORMAT"===(null==v?void 0:v.func)&&2===(null===(p=v.children)||void 0===p?void 0:p.length),m="interval"==g._type&&"day"===g.unit;if(h&&m){var y=(0,w.A)(v.children,2),b=y[0],O=y[1];if("%Y-%m-%d 00:00:00"===(null==O?void 0:O.value))return{args:{date:b,dim:"week"}}}}},mongoFormatFunc:function(e){return{$dateTrunc:{date:e.date,unit:e.dim}}},formatFunc:function(e){var t=e.date,r=e.dim;return"TRUNCATE ".concat(t," TO ").concat(r)},args:{date:{label:"Datetime",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["value","field","func"],escapeForFormat:!0},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:jr},escapeForFormat:!1}}},Lr={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim,i=r+(o.charAt(0).toUpperCase()+o.slice(1)+"s");return"".concat(t,".").concat(i,"(").concat(n,")")},spelImport:function(e){var t,r,n,o,i=null===(t=e.methodName)||void 0===t?void 0:t.match(/^(minus|plus)(\w+)s$/);if(i&&(o=i[2].toLowerCase(),r=i[1],["minus","plus"].includes(r)&&Object.keys(jr).includes(o)))return r={type:"string",val:r},o={type:"string",val:o},n=e.args[0],{date:e.obj,op:r,val:n,dim:o}},jsonLogic:function(e){var t=e.date,r=e.op;return{datetime_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){if(e.datetime_add){var t=e.datetime_add[0],r=Math.abs(e.datetime_add[1]);return[t,e.datetime_add[1]>=0?"plus":"minus",r,e.datetime_add[2]]}},jsonLogicCustomOps:{datetime_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(n)*("minus"==r?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},sqlImport:function(e,t,r){var n;if(["DATE_ADD","DATE_SUB"].includes(null==e?void 0:e.func)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var o=(0,w.A)(e.children,2),i=o[0],l=o[1];if("interval"==l._type)return{args:{date:i,op:"DATE_ADD"===(null==e?void 0:e.func)?"plus":"minus",val:l.value,dim:l.unit}}}},mongoFormatFunc:function(e){var t=e.date,r=e.op,n=e.val;return{$dateAdd:{startDate:t,unit:e.dim,amount:n*("minus"==r?-1:1)}}},formatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return n?"".concat(t," ").concat("minus"==r?"-":"+"," ").concat(n," ").concat(o):t},args:{date:{label:"Datetime",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["value","field","func"],escapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},escapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],escapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:jr},escapeForFormat:!1}}},kr=Sr(Sr({},Lr),{},{label:"Relative",returnType:"date",jsonLogic:function(e){var t=e.date,r=e.op;return{date_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]);return[t,e.date_add[1]>=0?"plus":"minus",r,e.date_add[2]]},jsonLogicCustomOps:{date_add:{}},args:{date:Sr(Sr({},Lr.args.date),{},{label:"Date",type:"date",defaultValue:{func:"TODAY",args:[]}}),op:Sr({},Lr.args.op),val:Sr({},Lr.args.val),dim:Sr(Sr({},Lr.args.dim),{},{defaultValue:"day",fieldSettings:{listValues:Fr}})}}),Tr={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",sqlFunc:"LOWER",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Pr={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",sqlFunc:"UPPER",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},Vr={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,n=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(n,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelImport:function(e){var t,r;if("op-plus"===e.type){var n=(0,w.A)(e.children,2);if(r=n[0],t=n[1],"op-multiply"===r.type){var o=(0,w.A)(r.children,2);return{coef:o[0],val:o[1],bias:t}}}},sqlImport:function(e,t,r){var n;if(["+"].includes(null==e?void 0:e.operator)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var o,i=(0,w.A)(e.children,2),l=i[0],a=i[1];if(["*"].includes(null==l?void 0:l.operator)&&2===(null===(o=l.children)||void 0===o?void 0:o.length)){var u=(0,w.A)(l.children,2);return{args:{coef:u[0],val:u[1],bias:a}}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias;return{$sum:[{$multiply:[t,e.val]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias;return{"+":[{"*":[t,e.val]},r]}},jsonLogicImport:function(e){return[e["+"][0]["*"][0],e["+"][0]["*"][1],e["+"][1]]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}};function xr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ir(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ir(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Nr(e,t,r){var n;try{n=pr().apply(e,t)}catch(e){throw e.message="".concat(r.join(".")," :: ").concat(e.message),e}return n}function qr(e,t,r,n){var o;try{o=t.call.apply(t,[e].concat((0,E.A)(r)))}catch(e){throw e.message="".concat(n.join(".")," :: ").concat(e.message),e}return o}yr();var Mr={asyncFetch:{type:"f",args:["searchOrValues","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},Wr=Rr(Rr({},Mr),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef","sqlDialect"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},sqlImport:{type:"f",args:["sqlObj","wgtDef","sqlDialect"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},jsonLogicImport:{type:"f",args:["val","wgtDef"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Gr={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef","expectedType","settings"]},sqlImport:{type:"f",args:["sqlObj","_","sqlDialect"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},zr={widgetProps:Wr,opProps:Gr},Br=Rr(Rr({},Mr),{},{fieldSettings:Mr}),Ur=Rr(Rr({},Mr),{},{fieldSettings:Mr,widgets:{x:zr},mainWidgetProps:Wr}),$r={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"},material:{type:"f",args:[],invokeWith:[],ignore:"jl"},antd:{type:"f",args:[],invokeWith:[],ignore:"jl"}},designSettings:{generateCssVars:{antd:{type:"f",args:["theme","config"]},mui:{type:"f",args:["theme","config"]},material:{type:"f",args:["theme","config"]},fluent:{type:"f",args:["theme","config"]},bootstrap:{type:"f",args:["theme","config"]}}},caseValueField:Ur,canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderBeforeCaseValue:{type:"rf"},renderAfterCaseValue:{type:"rf"},renderRuleError:{type:"rf"}},Hr={fields:{x:Ur},widgets:{x:Wr},conjunctions:{x:{formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}}},operators:{x:Gr},types:{x:{widgets:{x:zr}}},funcs:{x:Rr(Rr(Rr({},Br),{renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},sqlImport:{type:"f",args:["sqlObj","_","sqlDialect"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs","sqlDialect"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}}),{},{args:{x:Rr({},Br)}})},settings:$r},Jr=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=Ae()(e,Ce);delete r.ctx;var n,o=function(e,t,r,n){if(W(e)){if(ue(e)&&(e=ae(e)),"funcs"===r[0]&&!t){var i=r[r.length-1];(t=Pe({funcs:n.BasicFuncs},i,"funcs","subfields")||void 0)&&(e.$$key=i)}if(void 0!==t&&W(t))for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(!Object.keys(e).includes(l)||void 0===e[l]&&void 0!==t[l]?e[l]="$$deleted":(e[l]=o(e[l],t[l],[].concat((0,E.A)(r),[l]),n),void 0===e[l]&&delete e[l]));for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var u;t&&Object.keys(t).includes(a)||(e[a]=o(e[a],null===(u=t)||void 0===u?void 0:u[a],[].concat((0,E.A)(r),[a]),n)),void 0===e[a]&&delete e[a]}0===Object.keys(e).length&&(e=void 0)}else Array.isArray(e)&&e.forEach((function(t,i){e[i]=o(e[i],void 0,[].concat((0,E.A)(r),[i]),n)}));if(void 0===t||!ee(e,t,!0)){if("function"==typeof e)throw new Error("compressConfig: function at ".concat(r.join(".")," should be converted to JsonLogic"));return e}},i=xr(Ce);try{for(i.s();!(n=i.n()).done;){var l=n.value;if("ctx"===l);else if("fields"===l)r[l]=P()(r[l]),o(r[l],{},[l]);else if("funcs"===l)for(var u in r[l]=P()(r[l]||{}),r[l])o(r[l][u],null,[l,u],{BasicFuncs:a});else r[l]=P()(r[l]),o(r[l],t[l],[l])}}catch(e){i.e(e)}finally{i.f()}return r},Yr=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");var n,o={},i=function(e,t,r){if(W(t))for(var n in W(e)||(e={}),t)J(t,n)&&("$$deleted"===t[n]?delete e[n]:e[n]=i(e[n],t[n],[].concat((0,E.A)(r),[n])));else e=Array.isArray(t)?P()(t):t;return e},l=function(e,t,r){var n=!1;if(W(e)&&Object.prototype.hasOwnProperty.call(e,"$$key")&&e.$$key){var o=Pe({funcs:r.BasicFuncs},e.$$key,"funcs","subfields");if(!o)throw new Error("decompressConfig: basic function not found by key ".concat(e.$$key," at ").concat(t.join(".")));delete e.$$key,e=i(P()(o),e,t),n=!0}if(!n)if(W(e))for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(e[a]=l(e[a],[].concat((0,E.A)(t),[a]),r));else if(Array.isArray(e)){var u,s=xr(e);try{for(s.s();!(u=s.n()).done;){var c=u.value;e[c]=l(e[c],[].concat((0,E.A)(t),[c]),r)}}catch(e){s.e(e)}finally{s.f()}}return e},u=xr(Ce);try{for(u.s();!(n=u.n()).done;){var s=n.value;"ctx"===s?o[s]=cr()({},t.ctx||{},r||{}):"funcs"===s?(o[s]=P()(e[s]||{}),l(o[s],[s],{BasicFuncs:a})):"fields"===s?o[s]=P()(e[s]||{}):(o[s]=P()(t[s]||{}),i(o[s],e[s]||{},[s]))}}catch(e){u.e(e)}finally{u.f()}return o},Kr=function(e){return e.__compliled||(Qr(e=P()(e),e,{ctx:e.ctx},Hr,[]),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0})),e};function Qr(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(t)for(var l in i.length,n){var a=n[l],u="x"===l?i:[].concat((0,E.A)(i),[l]);if("r"===a.type){var s=t,c=s[l];if(a.isArr)for(var d in c){var p=en(c[d],r,[].concat((0,E.A)(u),[d]));p!==c[d]&&(o.push("Compiled ".concat(u.join("."),"[").concat(d,"]")),c[d]=p)}else{var f=en(c,r,u,void 0);f!==c&&(o.push("Compiled R ".concat(u.join("."))),s[l]=f)}}else if("rf"===a.type){var v=t,g=v[l],h=Xr(g,r,u,a.ignore);h!==g&&(o.push("Compiled JL-RF ".concat(u.join("."))),v[l]=h)}else if("f"===a.type){var m,y=t,b=y[l],O=Zr(b,r,u,a.args,a.ignore);a.invokeWith&&O&&"function"==typeof O&&(O=(m=O).call.apply(m,[null].concat((0,E.A)(a.invokeWith)))),O!==b&&(o.push("Compiled JL-F ".concat(u.join("."))),y[l]=O)}else if("x"===l)for(var A in t){u=[].concat((0,E.A)(i),[A]);var S=t[A];Qr(e,S,r,a,o,u),S.subfields&&Qr(e,S.subfields,r,n,o,u)}else Qr(e,t[l],r,a,o,u)}}function Xr(e,t,r){return ce(e)?function(n,o){o=o||(null==t?void 0:t.ctx);var i=Nr(e,{props:n,ctx:o},r);return"string"==typeof i&&(i={type:i,props:n}),en(i,{ctx:o},r)}:"string"==typeof e?function(n,o){o=o||(null==t?void 0:t.ctx);var i=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),o);return i?qr(this,i,[n,o],r):en({type:e,props:n},{ctx:o},r)}:e}function Zr(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return ce(e)&&"jl"!==o?function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];var a=this||(null==t?void 0:t.ctx),u=(n||[]).reduce((function(e,t,r){return Rr(Rr({},e),{},(0,j.A)({},t,i[r]))}),{args:i,ctx:a});return Nr(e,u,r)}.bind(null==t?void 0:t.ctx):"string"==typeof e&&"string"!==o?function(){var n=this||(null==t?void 0:t.ctx),o=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),n);if(o){for(var i=arguments.length,l=new Array(i),a=0;a<i;a++)l[a]=arguments[a];return qr(this,o,l,r)}throw new Error("".concat(r.join(".")," :: Function ").concat(e," is not found in ctx"))}.bind(null==t?void 0:t.ctx):e}function en(e,t,r){var n,o,i,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(se(e)){var a,u=e.type,s=e.props;if("string"!=typeof u)throw new Error("renderReactElement for ".concat(r.join("."),": type should be string"));var c,d=(n=u,(null==(o=t.ctx)||null===(i=o.components)||void 0===i?void 0:i[n])||o.W[n]||o.O[n]||u.toLowerCase());return void 0!==l&&(s=Rr(Rr({},s),{},{key:l})),null!==(a=s)&&void 0!==a&&a.children&&(c=en(s.children,t,r),s=Rr(Rr({},s),{},{children:c})),t.ctx.RCE(d,s)}return e instanceof Array?e.map((function(e,n){return en(e,t,r,""+n)})):e}function tn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return rn(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function nn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var on,ln=0,an=0,un={},sn=function(e,t){return 0===Ce.map((function(r){return e[r]===t[r]})).filter((function(e){return!e})).length},cn=function(e){return on||(on=pn({reactIndex:void 0,maxSize:3,canCompile:void 0,extendConfig:e})),on},dn=function(e,t){var r;for(var n in un){var o=un[n].findExtendedConfig(e,t);if(o){r=o;break}}return r},pn=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{reactIndex:void 0,maxSize:2,canCompile:!0,extendConfig:void 0},r=new Map,n=t.maxSize||2,o=++ln,i=function(e,t){r.size+1>n&&r.delete(r.keys().next().value),r.set(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),t)},l=function(e,t){var n,o=tn(r.keys());try{var i,l=function(){var o=n.value;if(Ce.filter((function(t){return o[t]===e[t]})).length===Ce.length&&(!t||o.__compliled))return{v:r.get(o)}};for(o.s();!(n=o.n()).done;)if(i=l())return i.v}catch(e){o.e(e)}finally{o.f()}var a,u=tn(r.values());try{var s,c=function(){var r=a.value;if(Ce.filter((function(t){return r[t]===e[t]})).length===Ce.length&&(!t||r.__compliled))return{v:r}};for(u.s();!(a=u.n()).done;)if(s=c())return s.v}catch(e){u.e(e)}finally{u.f()}return null};return e={getExtendedConfig:function(e){return function(e){return l(e)||function(e){var r=t.extendConfig(e,++an,t.canCompile);return i(e,r),r}(e)}(function(e){return Ae()(e,Ce)}(e))},findExtendedConfig:l,getBasicConfig:function(e){var t,n=tn(r.keys());try{for(n.s();!(t=n.n()).done;){var o=t.value,i=r.get(o);if(sn(i,e))return o}}catch(e){n.e(e)}finally{n.f()}return e},clearConfigMemo:function(){r.clear(),delete un[o],on===e&&(on=void 0)},configId:an,storeConfigPair:i,getSize:function(){return r.size},configStore:r,memoId:o,meta:t},void 0===t.reactIndex&&(on=e),un[o]=e,e};function fn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return vn(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function gn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var mn=["customProps"],yn=["options"],bn=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(r=r&&e.settings.useConfigCompress,e.__configId)return e;var n=dn(e,r);if(n)return n;var o=e;(e=r?e.__compliled?P()(e):Kr(e):P()(e)).settings=ar()({},ur,e.settings,le),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},function(e,t){for(var r in e)On(0,e[r],t)}(e.types,e),An(e.fields,e),Sn(e.funcs,e);var i=e.settings.caseValueField;i&&Fn(i,e,[],!1,!0);var l=e.settings.locale.moment;return l&&x().locale(l),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||k()}),e.__cache={},fe(e),cn(bn).storeConfigPair(o,e),e};function On(e,t,r){var n=null,o=null;t.mainWidget=t.mainWidget||Object.keys(t.widgets).filter((function(e){return"field"!=e&&"func"!=e}))[0];var i=t.excludeOperators||[];for(var l in t.widgets){var a=t.widgets[l],u=a.defaultOperator;a.operators&&(n=pe(n,a.operators.filter((function(e){return!i.includes(e)})))),u&&!i.includes(u)&&(o&&l!==t.mainWidget||(o=u)),l==t.mainWidget&&(a.widgetProps=hn(hn({},t.mainWidgetProps||{}),a.widgetProps||{})),t.widgets[l]=a}t.valueSources||(t.valueSources=Object.keys(r.settings.valueSourcesInfo));var s,c=fn(t.valueSources);try{for(c.s();!(s=c.n()).done;){var d=s.value;"value"==d||t.widgets[d]||(t.widgets[d]={})}}catch(e){c.e(e)}finally{c.f()}!t.operators&&n&&(t.operators=Array.from(new Set(n))),!t.defaultOperator&&o&&(t.defaultOperator=o)}function An(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var n in e){var o=[].concat((0,E.A)(r),[n]);Fn(e[n],t,o),e[n].subfields&&An(e[n].subfields,t,o)}}function Sn(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){var o=(null==t||null===(r=t.settings)||void 0===r?void 0:r.fieldSeparator)||".";for(var i in e){var l=[].concat((0,E.A)(n),[i]),a=l.join(o),u=e[i];if(u.returnType&&(u.type=u.returnType,t.__funcsCntByType[u.returnType]||(t.__funcsCntByType[u.returnType]=0),t.__funcsCntByType[u.returnType]++),Fn(u,t,l,!1),u.args){for(var s in u.args)Fn(u.args[s],t,[].concat((0,E.A)(l),[s]),!0);var c,d=!0,p=fn(Object.keys(u.args).reverse());try{for(p.s();!(c=p.n()).done;){var f=c.value,v=u.args[f];!d&&v.isOptional&&(me.info("Arg ".concat(f," for func ").concat(a," can't be optional")),delete v.isOptional),v.isOptional||(d=!1)}}catch(e){p.e(e)}finally{p.f()}}u.subfields&&Sn(u.subfields,t,[].concat((0,E.A)(n),[i]))}}}function Fn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.settings,l=i.showLabels,a=i.fieldSeparator;a=null!=a?a:".";var u=r[r.length-1],s=n?r.slice(0,r.length-1).join(a):r.join(a),c=!!e.returnType,d=e.type||e.returnType,p=t.types[d],f=e.excludeOperators||[],v=(e.operators||(null==p?void 0:p.operators)||[]).filter((function(e){return!f.includes(e)})),g=e.defaultOperator||(null==p?void 0:p.defaultOperator);f.includes(g)&&(g=void 0);var h=!!g&&g==e.defaultOperator;if(h&&(e.ownDefaultOperator=e.defaultOperator),p){n||c||o||(t.__fieldsCntByType[d]||(t.__fieldsCntByType[d]=0),t.__fieldsCntByType[d]++),n&&(e._isFuncArg=!0,e._argKey=u,e._funcKey=s),c&&(e._isFunc=!0,e._funcKey=s),o&&(e._isCaseValue=!0),function(e,t,r){for(var n,o,i=0,l=["listValues","treeValues","allowCustomValues","validateValue"];i<l.length;i++){var a=l[i];e[a]&&(e.fieldSettings||(e.fieldSettings={}),e.fieldSettings[a]=e[a],delete e[a])}null!==(n=e.fieldSettings)&&void 0!==n&&n.listValues&&t.settings.normalizeListValues&&(e.fieldSettings.listValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.listValues,r,e.fieldSettings)),null!==(o=e.fieldSettings)&&void 0!==o&&o.treeValues&&t.settings.normalizeListValues&&(e.fieldSettings.treeValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.treeValues,r,e.fieldSettings))}(e,t,d);var m=["widgets","operators","defaultOperator"];Object.keys(p).filter((function(e){return!m.includes(e)})).map((function(t){e[t]||(e[t]=$(p[t]))}));var y=p.excludeOperators||[];e.operators&&(y=y.filter((function(t){return!e.operators.includes(t)}))),e.widgets||(e.widgets={});var b=function(){var r=hn({},e.widgets[O]||{}),o=p.widgets[O]||{};if(!n){var i=r.defaultOperator,a=[].concat((0,E.A)(f),(0,E.A)(y)),s=e.preferWidgets&&("field"===O||e.preferWidgets.includes(O))||a.length>0;if(r.operators){var c=r.operators.filter((function(e){return!a.includes(e)}));r.operators=c,v=pe(v,c)}else if(s&&o.operators){var d=o.operators.filter((function(e){return!a.includes(e)}));r.operators=d,v=pe(v,d)}i&&!a.includes(i)&&(g&&(h||O!==e.mainWidget)||(g=i))}r.widgetProps=hn(hn(hn({},o.widgetProps||{}),O===e.mainWidget&&e.mainWidgetProps||{}),r.widgetProps||{});for(var m=0,b=mn;m<b.length;m++){var A,S,F,j,w=b[m];r.widgetProps[w]&&(r.widgetProps[w]=hn(hn(hn(hn({},(null===(A=t.widgets[O])||void 0===A?void 0:A[w])||{}),(null===(S=o.widgetProps)||void 0===S?void 0:S[w])||{}),O===e.mainWidget&&(null===(F=e.mainWidgetProps)||void 0===F?void 0:F[w])||{}),(null===(j=r.widgetProps)||void 0===j?void 0:j[w])||{}))}var C=Array.from(new Set([].concat((0,E.A)(Object.keys(o.opProps||{})),(0,E.A)(Object.keys(r.opProps||{})))));if(C.length){var _,L={},k=fn(C);try{for(k.s();!(_=k.n()).done;){var T,P,V=_.value;L[V]=hn(hn({},(null===(T=o.opProps)||void 0===T?void 0:T[V])||{}),(null===(P=r.opProps)||void 0===P?void 0:P[V])||{});for(var x=0,I=yn;x<I.length;x++){var D,R,N,q=I[x];L[V][q]&&(L[V][q]=hn(hn(hn({},(null===(D=t.operators)||void 0===D||null===(D=D[V])||void 0===D?void 0:D[q])||{}),(null===(R=o.opProps)||void 0===R||null===(R=R[V])||void 0===R?void 0:R[q])||{}),(null===(N=r.opProps)||void 0===N||null===(N=N[V])||void 0===N?void 0:N[q])||{}))}}}catch(e){k.e(e)}finally{k.f()}r.opProps=L}var M=r,W=M.valueLabel,G=M.valuePlaceholder;n&&(W||(r.valueLabel=e.label||u),G||l||(r.valuePlaceholder=e.label||u)),r=hn(hn({},o),r),e.widgets[O]=r};for(var O in p.widgets)b();if(n||(e.operators||(e.operators=Array.from(new Set(v))),e.defaultOperator||(e.defaultOperator=g)),!n&&!c&&!o){var A=function(e,t){if(!t)return{};var r=e.settings.fieldSeparator,n=(0,E.A)(t).reduce((function(t,n,o,i){var l=t.computedPath,a=t.computed,u=t.inGroup,s=[].concat((0,E.A)(i.slice(0,o)),[n]),c=Pe(e,s);return"!group"===(null==c?void 0:c.type)&&o<i.length-1?(u=s.join(r),l=[]):null!=c&&c.fieldName?(a=!0,l=[c.fieldName]):l=[].concat((0,E.A)(l),[n]),{computedPath:l,computed:a,inGroup:u}}),{computedPath:[],computed:!1,inGroup:void 0}),o=n.computedPath,i=n.computed,l=n.inGroup;return i?{fieldName:o.join(r),inGroup:l}:{}}(t,r),S=A.fieldName,F=A.inGroup;S&&(e.fieldName=S,t.__fieldNames[S]||(t.__fieldNames[S]=[]),t.__fieldNames[S].push({fullPath:r,inGroup:F}))}}else"!struct"!==e.type&&(e.disabled=!0)}function jn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function En(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Cn(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var _n=function(e,t){var r,n={usedFields:[],errors:[]},o=bn(t,void 0,!1),i=Ln(e,o,n,!1,!0),l=n.errors,a=n.usedFields,u=(o.settings.fieldSeparator,{}),s=En(a);try{for(s.s();!(r=s.n()).done;)for(var c=r.value,d=qe(c,t),p=(Ue(o,c),u),f=0;f<d.length;f++){var v=d[f],g=Ue(o,d.slice(0,f+1))||{};f!=d.length-1?"!group"==g.type&&"struct"!=g.mode?(p[v]||(p[v]=[{}]),p=p[v][0]):(p[v]||(p[v]={}),p=p[v]):p[v]||(p[v]=null)}}catch(e){s.e(e)}finally{s.f()}return{errors:l,logic:i,data:u}},Ln=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(e){var l,a=e.get("type"),u=(e.get("properties")||new _.T5).get("isLocked"),s=t.settings.jsonLogic.lockedOp;return"group"===a||"rule_group"===a?l=kn(e,t,r,n,o,i):"rule"===a?l=Tn(e,t,r,n,i):"switch_group"==a?l=Pn(e,t,r,n):"case_group"==a&&(l=Vn(e,t,r,n,i)),u&&l&&s&&(l=(0,j.A)({},s,l)),l}},kn=function(e,t,r){var n,o,i,l,a,u,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,p=e.get("type"),f=e.get("properties")||new _.T5,v=f.get("mode"),g=e.get("children1")||new _.B8,h=f.get("field"),m=Ue(t,h),y=f.get("conjunction");y||(y=Ot(t));var b=t.conjunctions[y],O=(null==b?void 0:b.jsonLogicConj)||y.toLowerCase(),A=!!f.get("not"),S="rule_group"===p&&!c,F=S&&"struct"!=v,w=F?h:d,E=f.get("operator"),C=E&&$e(t,E,h)||null,L=xn(t,f,r,E,d),k=S&&(!E||0==(null===(n=C)||void 0===n?void 0:n.cardinality)),T=S&&(null==g?void 0:g.size)>0,P=(S&&null!=g&&g.size,A),V=!1;T?(V=A,P=s):s&&(P=!P);var x=!1,I=null===(o=C)||void 0===o?void 0:o.reversedOp,D=$e(t,I,h),R=!(null!==(i=C)&&void 0!==i&&i.jsonLogic||null===(l=D)||void 0===l||!l.jsonLogic),N=!(null===(a=D)||void 0===a||!a.jsonLogic),q=null===(u=Yt(e))||void 0===u?void 0:u.get("type");if(!!t.settings.reverseOperatorsForNot&&(!S&&P&&"rule"===q||V&&1===(null==g?void 0:g.size))&&(T?V=!V:P=!P,x=!0),P&&S&&N&&(t.settings.reverseOperatorsForNot||R)){P=!P;var M=[I,E];E=M[0],I=M[1];var W=[D,C];C=W[0],D=W[1]}var G=g.map((function(e){return Ln(e,t,r,x,!1,w)})).filter((function(e){return void 0!==e})),z=!!t.settings.exportPreserveGroups;if(F&&!k){if(null==L)return}else if(!G.size&&!z)return;var B=c||z||1!=G.size;B||!A||x||(B=g.some((function(e){var r,n,o,i,l=null===(r=e.get("properties"))||void 0===r?void 0:r.get("operator"),a=null===(n=t.operators)||void 0===n||null===(n=n[l])||void 0===n?void 0:n.reversedOp;return null!==(o=null===(i=t.operators)||void 0===i||null===(i=i[a])||void 0===i?void 0:i._jsonLogicIsExclamationOp)&&void 0!==o&&o})));var U={};B?U[O]=G.toList().toJS():U=G.first(),V&&(U={"!":U});var $=U;if(F){var H,J,Y=Rn(r,t,h,d);k||(J={reduce:[G.size?{filter:[Y,U]}:Y,{"+":[1,{var:"accumulator"}]},0]});var K=null!=J?J:Y,Q=new _.T5({having:U,reduce:J,groupField:h,groupFieldFormatted:Y});if("function"==typeof(null===(H=C)||void 0===H?void 0:H.jsonLogic))$=Nn(t,f,K,L,E,Q,m);else if(k){var X=E||"some";$=(0,j.A)({},X,[Y,U])}else $=Nn(t,f,K,L,E,null,m)}return P&&($={"!":$}),$},Tn=function(e,t,r){var n,o,i,l,a,u,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,d=e.get("properties")||new _.T5,p=d.get("field"),f=d.get("fieldSrc"),v=d.get("operator"),g=d.get("operatorOptions");if((g=g?g.toJS():null)&&!Object.keys(g).length&&(g=null),null!=p&&null!=v){var h=Ue(t,p),m=$e(t,v,p),y=null===(n=m)||void 0===n?void 0:n.reversedOp,b=$e(t,y,p);if(null!==(o=m)&&void 0!==o&&o.jsonLogic||null!==(i=b)&&void 0!==i&&i.jsonLogic){var O=s,A=!(null!==(l=m)&&void 0!==l&&l.jsonLogic||null===(a=b)||void 0===a||!a.jsonLogic),S=!(null===(u=b)||void 0===u||!u.jsonLogic)&&(!!t.settings.reverseOperatorsForNot||A);if(O&&S||A){O=!O;var F=[y,v];v=F[0],y=F[1];var j=[b,m];m=j[0],b=j[1]}var w=xn(t,d,r,v,c);if(void 0!==w){var E="func"===f?Dn(r,t,p,c):Rn(r,t,p,c);if(void 0!==E)return Nn(t,d,E,w,v,g,h,O)}}else r.errors.push("Operator ".concat(v," is not supported"))}},Pn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.get("children1");if(o){for(var i=o.map((function(e){return Vn(e,t,r,n,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray(),l=[],a=0;a<i.length;a++)a===i.length-1||i[a][0]?(l.push(i[a]),a===i.length-1&&i[a][0]&&l.push([void 0,null])):r.errors.push("No condition for case ".concat(a));if(l.length){if(1===l.length){var u=(0,w.A)(l[0],2),s=(u[0],u[1]);return null==s&&(s=null),s}for(var c={if:[]},d=c.if,p=(0,w.A)(l[l.length-1],2),f=(p[0],p[1]),v=0;v<l.length-1;v++){var g=v===l.length-2,h=(0,w.A)(l[v],2),m=h[0],y=h[1];null==y&&(y=null),null==m&&(m=!0),d.push(m),d.push(y),g?d.push(f):(d.push({if:[]}),d=d[d.length-1].if)}return c}}},Vn=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=e.get("type");if("case_group"==i){var l=e.get("properties")||new _.T5;return[kn(e,t,r,n,o),xn(t,l,r,null,o,"!case_value")]}r.errors.push("Unexpected child of type ".concat(i," inside switch"))},xn=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=t.get("field"),a=t.get("valueSrc"),u=t.get("valueType");("!case_value"==i||u&&"case_value"==u.get(0))&&(l="!case_value");var s=Ue(e,l),c=$e(e,n,l),d=X(c),p=t.get("value"),f=t.get("asyncListValues");if(null!=p){var v=[],g=[],h=r.usedFields,m=p.map((function(t,i){var d=a?a.get(i):null,p=u?u.get(i):null,h=Ht(t,d,e),m=Qe(e,l,n,d),y=He(e,l,n,m,d,{forExport:!0}),b=In(r,e,h,d,p,y,s,n,c,o,f);return void 0!==b&&(v.push(d),g.push(p)),b})),y=m.filter((function(e){return void 0===e})).size>0;if(!(m.size<d||y))return d>1?m.toArray():1==d?m.first():null;r.usedFields=h}},In=function(e,t,r,n,o,i,l,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var d;if("field"==n)d=Rn(e,t,r,s);else if("func"==n)d=Dn(e,t,r,s);else if("function"==typeof(null==i?void 0:i.jsonLogic)){var p=i.jsonLogic,f=[r,wn(wn({},l?Ae()(l,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),Q(i,q)];a&&(f.push(a),f.push(u)),d=p.call.apply(p,[t.ctx].concat(f))}else d=r;return d}},Dn=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),u=Ie(t,l),s=qe(l,t),c=s[s.length-1];if(u)if(null!=u&&u.jsonLogic){var d={},p=[],f=[];for(var v in u.args){var g,h=u.args[v],m=Ue(t,h),y=h.defaultValue,b=h.isOptional,O=null!=y&&y.func?"func":"value",A=a?a.get(v):void 0,S=A?A.get("value"):void 0,F=A?A.get("valueSrc"):void 0;"func"!==F&&null!==(g=S)&&void 0!==g&&g.toJS&&(S=S.toJS());var w=null,E=Qe(t,h,w,F),C=He(t,h,w,E,F,{forExport:!0}),_=In(e,t,S,F,h.type,C,m,null,null,i);if(null!=S&&void 0===_)return void("func"!=F&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(l)));var L=void 0;if(void 0===_&&!b&&null!=y){var k=Qe(t,h,w,O),T=He(t,h,w,k,O,{forExport:!0});if(void 0===(L=In(e,t,y,O,h.type,T,m,null,null,i)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(l)))}var P=null!=_?_:L;if(void 0!==P){if(p.length){var V,x=En(p);try{for(x.s();!(V=x.n()).done;)d[V.value]=void 0}catch(e){x.e(e)}finally{x.f()}p=[]}d[v]=P}else b||f.push(v),p.push(v)}if(!f.length){var I,D=Object.values(d);if("function"==typeof u.jsonLogic){var R=u.jsonLogic,N=[d];I=R.call.apply(R,[t.ctx].concat(N))}else{var q=u.jsonLogic||c;if(u.jsonLogicIsMethod){var M=D[0],W=D.slice(1);I=W.length?{method:[M,q,W]}:{method:[M,q]}}else I=(0,j.A)({},q,D)}return I}}else e.errors.push("Func ".concat(l," is not supported"));else e.errors.push("Func ".concat(l," is not defined in config"))},Rn=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.settings,l=i.fieldSeparator,a=i.jsonLogic;if(r){Array.isArray(r)&&(r=r.join(l));var u=Ue(t,r)||{},s=Rt(r,t,e,o),c=u.jsonLogicVar||("!group"==u.type?a.groupVarKey:"var");n=(0,j.A)({},c,s),-1==e.usedFields.indexOf(r)&&e.usedFields.push(r)}return n},Nn=function(e,t,r,n,o){var i,l,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=t.get("field"),d=null===(i=t.get("valueType"))||void 0===i?void 0:i.get(0),p=$e(e,o,c)||{},f=null!==(l=null==u?void 0:u.type)&&void 0!==l?l:d,v="function"==typeof p.jsonLogic?p.jsonLogic:function(e,t,r,n){var o=e,i=X(t);"string"==typeof t.jsonLogic&&(o=t.jsonLogic);var l=["<","<=",">",">="],a=["==","!="];return function(e,t,u,s,c){return 0==i&&a.includes(o)?(0,j.A)({},o,[r,null]):0==i?(0,j.A)({},o,r):1==i?(0,j.A)({},o,[r,n]):2==i&&l.includes(o)?(0,j.A)({},o,[n[0],r,n[1]]):(0,j.A)({},o,[r].concat((0,E.A)(n)))}}(o,p,r,n),g=[r,o,n,Q(p,M),a,u,f,e.settings],h=v.call.apply(v,[e.ctx].concat(g));return s&&(h={"!":h}),h},qn=function(e){var t="";return"number"==(null==e?void 0:e.type)&&(t=0),t},Mn=function(e,t,r,n,o,i,l,a,u,s,c,d,p){var f="string"!=typeof n||n.startsWith("$")?n:"$"+n,v=t(i,p);if(void 0!==v){var g=l^r;if(a&&"$nin"==e&&(g=!g,e="$in"),a&&"$regex"==e){var h={$regexFind:{input:f,regex:v}};return g&&(h={$not:h}),h}return g?a?{$not:(0,j.A)({},e,[f,v])}:(0,j.A)({},n,{$not:(0,j.A)({},e,v)}):a||e&&"$eq"!=e?a?(0,j.A)({},e,[f,v]):(0,j.A)({},n,(0,j.A)({},e,v)):(0,j.A)({},n,v)}},Wn=function(e,t,r,n,o,i,l,a,u,s,c,d){var p="string"!=typeof r||r.startsWith("$")?r:"$"+r;return i^t?l?{$not:{$and:[(0,j.A)({},e[0],[p,o[0]]),(0,j.A)({},e[1],[p,o[1]])]}}:(0,j.A)({},r,{$not:(0,j.A)((0,j.A)({},e[0],o[0]),e[1],o[1])}):l?{$and:[(0,j.A)({},e[0],[p,o[0]]),(0,j.A)({},e[1],[p,o[1]])]}:(0,j.A)({},r,(0,j.A)((0,j.A)({},e[0],o[0]),e[1],o[1]))},Gn=function(e){return e.replace(/\$/g,"＄")},zn=function(e){return e.replace(/\uFF04/g,"$")};function Bn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Un(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Un(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Un(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function $n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Hn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Jn=function(e,t){return Yn(e,t,!1)},Yn=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=bn(t,void 0,!1),i=Kn([],e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to MongoDb:",n.errors),i)},Kn=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;if(t){var u=t.get("type");return"group"===u||"rule_group"===u?Qn(e,t,r,n,o,i,l,a):"rule"===u?Xn(e,t,r,n,o,i,l,a):void 0}},Qn=function(e,t,r,n){var o,i,l,a,u,s,c,d,p,f=arguments.length>4&&void 0!==arguments[4]&&arguments[4],v=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,g=t.get("type"),h=t.get("properties")||new _.T5,m=!!h.get("not"),y=t.get("children1")||new _.B8,b=r.settings,O=b.canShortMongoQuery,A=b.fieldSeparator,S=b.exportPreserveGroups,F=b.reverseOperatorsForNot,w=A,C=null===(o=e.filter((function(e){return"rule_group"==e.get("type")})))||void 0===o||null===(o=o.slice(-1))||void 0===o?void 0:o.pop(),L=!!C,k=null==C?void 0:C.get("properties").get("field"),T=L&&"array"==C.get("properties").get("mode"),P="rule_group"===g,V=P?h.get("field"):null,x=P?h.get("operator"):null,I=x&&$e(r,x,V)||null,D=x?null!==(i=null===(l=I)||void 0===l?void 0:l.cardinality)&&void 0!==i?i:1:void 0,R=Rt(V,r,n,k),N=(Ue(r,V)||{}).mode,q=V&&"array"===N&&D>=1,M=P&&(null==y?void 0:y.size)>0,G=(P&&null!=y&&y.size,!1),z=m,B=!1;M?(B=m,z=f):f&&(z=!z);var U=null===(a=I)||void 0===a?void 0:a.reversedOp,$=$e(r,U,V),H=!(null!==(u=I)&&void 0!==u&&u.mongoFormatOp||null===(s=$)||void 0===s||!s.mongoFormatOp),J=!(null===(c=$)||void 0===c||!c.mongoFormatOp),Y=null===(d=Yt(t))||void 0===d?void 0:d.get("type"),K=!P&&"rule"===Y;if((z&&K||B&&1===(null==y?void 0:y.size))&&!S&&(K?z=!z:B=!B,G=!0),z&&P&&J&&(F&&!S||H)){z=!z;var Q=[U,x];x=Q[0],U=Q[1];var X=[$,I];I=X[0],$=X[1]}var Z=h.get("conjunction");Z||(Z=Ot(r));var ee=r.conjunctions[Z];if(ee){var te=ee.reversedConj;z&&"or"===(null===(p=Z)||void 0===p?void 0:p.toLowerCase())&&te&&!P&&F&&!S&&(Z=te,ee=r.conjunctions[Z],z=!z,G=!0);var re=ee.mongoConj,ne=!P&&!L,oe="array"==N?function(e){return"$$el".concat(w).concat(e)}:v,ie=y.map((function(o){return Kn([].concat((0,E.A)(e),[t]),o,r,n,G,ne,oe)})).filter((function(e){return void 0!==e}));if(q||ie.size){var le;if(1==ie.size)le=ie.first();else if(ie.size>1){var ae=ie.toList().toJS();O&&"$and"==re&&!S&&(le=ae.reduce((function(e,t){if(e){for(var r in t){if("$"==r[0]){e=void 0;break}if(null==e[r])e[r]=t[r];else{var n=e[r],o=t[r];if(W(n)||(n={$eq:n}),W(o)||(o={$eq:o}),Object.keys(n)[0]==Object.keys(o)[0]){e=void 0;break}e[r]=Object.assign({},n,o)}}return e}}),{})),le||(le=(0,j.A)({},re,ae))}if(V)if("array"==N){var ue={$size:{$ifNull:["$"+Gn(R),[]]}};B&&le&&(le={$not:le},B=!1);var se=le?{$size:{$ifNull:[{$filter:{input:"$"+Gn(R),as:"el",cond:le}},[]]}}:ue,ce=!S&&z;ce&&(z=!1),le={$expr:le=Kn(e,t.set("type","rule"),r,n,ce,!1,(function(e){return se}),ue)}}else le=(0,j.A)({},Gn(R),{$elemMatch:le});return z&&(le=T?{$not:le}:{$nor:[le]}),le}}},Xn=function(e,t,r,n){var o,i,l,a,u,s,c,d,p=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],v=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,g=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,h=t.get("properties")||new _.T5,m=null===(o=e.filter((function(e){return"rule_group"==e.get("type")})))||void 0===o||null===(o=o.slice(-1))||void 0===o?void 0:o.pop(),y=null==m?void 0:m.get("properties").get("field"),b=h.get("operator"),O=h.get("operatorOptions"),A=h.get("field"),S=h.get("fieldSrc"),F=h.get("value"),j=h.get("valueSrc"),E=h.get("valueType"),C=h.get("asyncListValues");if(null!=A&&null!=b&&void 0!==F){var L=Ue(r,A),k=$e(r,b,A),T=null===(i=k)||void 0===i?void 0:i.reversedOp,P=$e(r,T,A),V=X(k);if(null!==(l=k)&&void 0!==l&&l.mongoFormatOp||null!==(a=P)&&void 0!==a&&a.mongoFormatOp){var x,I=p,D=!(null!==(u=k)&&void 0!==u&&u.mongoFormatOp||null===(s=P)||void 0===s||!s.mongoFormatOp);if(null!==(c=P)&&void 0!==c&&c.mongoFormatOp&&(r.settings.reverseOperatorsForNot||D)&&I||D){var R=[T,b];b=R[0],T=R[1];var N=[P,k];k=N[0],P=N[1],I=!I}var q=!1;if("func"==S){var W=to(n,r,A,y),G=(0,w.A)(W,2);x=G[0],q=G[1]}else x=Rt(A,r,n,y),x=Gn(x),v&&(q=!0,x=v(x));if(null!=x){var z,B=[],U=[];if(null!=F){var $=F.map((function(e,t){var o=j?j.get(t):null,i=E?E.get(t):null,l=Ht(e,o,r),a=Qe(r,A,b,o),u=He(r,A,b,a,o,{forExport:!0}),s=Zn(n,r,l,o,i,u,L,y,b,k,C),c=(0,w.A)(s,2),d=c[0],p=c[1];return void 0!==d&&(q=q||p,B.push(o),U.push(i)),d})),H=$.filter((function(e){return void 0===e})).size>0;if($.size<V||H)return;z=V>1?$.toArray():1==V?$.first():null}var J=q&&f,Y=null===(d=k)||void 0===d?void 0:d.mongoFormatOp,K=[x,b,void 0!==g&&null==z?g:z,I,q,B.length>1?B:B[0],U.length>1?U:U[0],Q(k,M),O,L],Z=Y.call.apply(Y,[r.ctx].concat(K));return J&&(Z={$expr:Z}),Z}}else n.errors.push("Operator ".concat(b," is not supported"))}},Zn=function(e,t,r,n,o,i,l,a,u,s,c){if(void 0===r)return[void 0,!1];var d,p=!1;if("field"==n){var f=eo(e,t,r,a),v=(0,w.A)(f,2);d=v[0],p=v[1]}else if("func"==n){var g=to(e,t,r,a),h=(0,w.A)(g,2);d=h[0],p=h[1]}else{var m;if("function"==typeof(null==i?void 0:i.mongoFormatValue)){var y=i.mongoFormatValue,b=[r,Hn(Hn({},l?Ae()(l,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),Q(i,q)];u&&(b.push(u),b.push(s)),d=y.call.apply(y,[t.ctx].concat(b))}else d=r;null!==(m=d)&&void 0!==m&&m.$dateFromString&&(p=!0)}return[d,p]},eo=function(e,t,r,n){var o,i=t.settings.fieldSeparator;if(r){var l=Ue(t,r)||{},a=qe(r,t),u=It(r,t),s=u?u.join(i):null,c=(0,t.settings.formatField)(Rt(r,t,e,n),a,s,l,t,!1);o="$"+Gn(c)}return[o,!0]},to=function(e,t,r,n){var o,i,l,a=null===(o=r.get)||void 0===o?void 0:o.call(r,"func"),u=null===(i=r.get)||void 0===i?void 0:i.call(r,"args"),s=Ie(t,a);if(!s)return e.errors.push("Func ".concat(a," is not defined in config")),[void 0,!1];var c=qe(a,t),d=c[c.length-1],p=s.mongoFunc||d,f=s.mongoArgsAsObject,v={},g=0,h=void 0,m=[],y=[];for(var b in s.args){var O;g++;var A=s.args[b],S=Ue(t,A),F=A.defaultValue,E=A.isOptional,C=null!=F&&F.func?"func":"value",_=u?u.get(b):void 0,L=_?_.get("value"):void 0,k=_?_.get("valueSrc"):void 0;"func"!==k&&null!==(O=L)&&void 0!==O&&O.toJS&&(L=L.toJS());var T=_?_.get("asyncListValues"):void 0,P=null,V=Qe(t,A,P,k),x=He(t,A,P,V,k,{forExport:!0}),I=Zn(e,t,L,k,A.type,x,S,n,null,null,T),D=(0,w.A)(I,2),R=D[0];if(D[1],null!=L&&void 0===R)return"func"!=k&&e.errors.push("Can't format value of arg ".concat(b," for func ").concat(a)),[void 0,!1];var N=void 0;if(void 0===R&&!E&&null!=F){var q=Qe(t,A,P,C),M=He(t,A,P,q,C,{forExport:!0}),W=Zn(e,t,F,C,A.type,M,S,n,null,null,T),G=(0,w.A)(W,2);if(N=G[0],G[1],void 0===N)return"func"!=C&&e.errors.push("Can't format default value of arg ".concat(b," for func ").concat(a)),[void 0,!1]}var z=null!=R?R:N;if(void 0!==z){if(m.length){var B,U=Bn(m);try{for(U.s();!(B=U.n()).done;)v[B.value]=void 0}catch(e){U.e(e)}finally{U.f()}m=[]}v[b]=z,h=z}else E||y.push(b),m.push(b)}if(y.length)return[void 0,!1];if("function"==typeof s.mongoFormatFunc){var $=s.mongoFormatFunc,H=[v];l=$.call.apply($,[t.ctx].concat(H))}else{if(null===s.mongoFormatFunc)return e.errors.push("Functon ".concat(p," is not supported")),[void 0,!1];l=f?(0,j.A)({},p,v):1==g&&void 0!==h?(0,j.A)({},p,h):(0,j.A)({},p,Object.values(v))}return[l,!0]},ro=r(95122),no=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e)return"null";switch((0,C.A)(e)){case"boolean":return e?"true":"false";case"number":if(!Number.isFinite(e)||isNaN(e))return;return e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=["int","float"];return e.map((function(e){if(null!=e){if("string"==typeof e)r="String";else{if("number"!=typeof e)throw new Error("spelEscape: Can't use value ".concat(e," in array"));r=Number.isInteger(e)?"int":"float"}if(t){if(t!=r){if(!i.includes(t)||!i.includes(r))throw new Error("spelEscape: Can't use different types in array: found ".concat(t," and ").concat(r));t="float"}}else t=r}})),t||(t="String"),n="float"==t?e.map((function(e){return no(e,!0)})):e.map((function(e){return no(e)})),o?"new ".concat(t,"[]{").concat(n.join(", "),"}"):"{".concat(n.join(", "),"}")}(e,r);throw new Error("spelEscape: Object is not supported");default:return function(e){return"'"+e.replace(/'/g,"''")+"'"}(e)}},oo=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){return"const"==e.type?no(e.value):"property"==e.type?""+e.value:"variable"==e.type?"#"+e.value:void 0})).filter((function(e){return null!=e})).join(" + "):"null"},io=function(e){if(null==e)return[void 0,[]];var t=[],r="case_value"==e.valueType?e.value:e;return[(Array.isArray(r)?r:[r]).map((function(e){return"value"===e.valueSrc?null===e.value?void 0:{type:"const",value:e.value}:"field"===e.valueSrc?{type:e.isVariable?"variable":"property",value:e.value}:void t.push("Unsupported valueSrc ".concat(e.valueSrc," in concatenation"))})).filter((function(e){return null!=e})),t]},lo=function(e){return"".concat(e,".?[true]")},ao=r.n(ro)();ao.trim=function(e){return"'"==(null==e?void 0:e.charAt(0))?e.substring(1,e.length-1):e},ao.unescapeLike=function(e){if("string"!=typeof e)return e;var t=e;return"BigQuery"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0)?t.replace(/\\\\([%_])/g,"$1"):t.replace(/\\([%_])/g,"$1")},ao.escapeLike=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if("string"!=typeof e)return e;var o=ao.escape(e);return o=ao.trim(o),"'"+(o=(t?"%":"")+(o="BigQuery"===n?o.replace(/[%_\\]/g,"\\\\$&"):o.replace(/[%_]/g,"\\$&"))+(r?"%":""))+"'"};var uo=function(e){var t="''",r=null==e?void 0:e.type;return"date"==r?t="'0000-00-00'":"datetime"==r?t="'0000-00-00 00:00'":"time"==r?t="'00:00'":"number"==r&&(t="0"),t},so=function(e){return null==e?"NULL":e.toString()},co=function(e){return null==e||"("===(null==e?void 0:e[0])&&")"===(null==e?void 0:e[(null==e?void 0:e.length)-1])?e:"("+e+")"};function po(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return fo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function fo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function vo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function go(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vo(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ho=function(e,t){return mo(e,t,!1)},mo=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=bn(t,void 0,!1),i=yo(e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SQL:",n.errors),i)},yo=function(e,t,r){if(e){var n=e.get("type");return e.get("children1"),"group"===n||"rule_group"===n?bo(e,t,r):"rule"===n?Oo(e,t,r):void 0}},bo=function(e,t,r){var n=e.get("type"),o=e.get("properties")||new _.T5,i=e.get("children1")||new _.B8,l="rule_group"===n?o.get("field"):null;"array"==(Ue(t,l)||{}).mode&&r.errors.push("Aggregation is not supported for ".concat(l));var a=o.get("not"),u=i.map((function(e){return yo(e,t,r)})).filter((function(e){return void 0!==e}));if(u.size){var s=o.get("conjunction");return s||(s=Ot(t)),t.conjunctions[s].sqlFormatConj.call(t.ctx,u,s,a)}},Oo=function(e,t,r){var n=e.get("properties")||new _.T5,o=n.get("field"),i=n.get("fieldSrc"),l=n.get("operator"),a=n.get("operatorOptions"),u=n.get("valueSrc"),s=n.get("valueType"),c=n.get("value"),d=n.get("asyncListValues");if(null!=o&&null!=l){var p=Ue(t,o)||{},f=$e(t,l,o)||{},v=f.reversedOp,g=$e(t,v,o)||{},h=X(f),m=!1,y=f.sqlOp||f.sqlFormatOp,b=g.sqlOp||g.sqlFormatOp;if(y||b){if(!y&&b){m=!0;var O=[v,l];l=O[0],v=O[1];var A=[g,f];f=A[0],g=A[1]}var S,F=[],j=[];if(null!=c){var w=c.map((function(e,n){var i=u?u.get(n):null,a=s?s.get(n):null,c=Ht(e,i,t),v=Qe(t,o,l,i),g=He(t,o,l,v,i,{forExport:!0}),h=Ao(r,t,c,i,a,g,p,l,f,d);return void 0!==h&&(F.push(i),j.push(a)),h}));if(w.filter((function(e){return void 0===e})).size>0||w.size<h)return;S=1==h?w.first():w}var E=f.sqlFormatOp||function(e,t){var r,n=t.sqlOp||e,o=X(t);return 0==o?r=function(e,t,r,o,i,l,a,u){return"".concat(e," ").concat(n)}:1==o?r=function(e,t,r,o,i,l,a,u){return"".concat(e," ").concat(n," ").concat(r)}:2==o&&(r=function(e,t,r,o,i,l,a,u){var s,c,d=null==r||null===(s=r.first)||void 0===s?void 0:s.call(r),p=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(n," ").concat(d," AND ").concat(p)}),r}(l,f);if(E){var C="func"==i?Fo(r,t,o):So(r,t,o);if(null!=C){var L,k=[C,l,S,F.length>1?F:F[0],j.length>1?j:j[0],Q(f,M),a,p];if(L=E.call.apply(E,[t.ctx].concat(k)),m&&(L=t.settings.sqlFormatReverse.call(t.ctx,L)),void 0!==L)return L;r.errors.push("Operator ".concat(l," is not supported for value source ").concat(F.join(", ")))}}else r.errors.push("Operator ".concat(l," is not supported"))}else r.errors.push("Operator ".concat(l," is not supported"))}},Ao=function(e,t,r,n,o,i,l,a,u,s){if(void 0!==r){var c;if("field"==n)c=So(e,t,r);else if("func"==n)c=Fo(e,t,r);else if(null==r)c=void 0;else if("function"==typeof(null==i?void 0:i.sqlFormatValue)){var d=i.sqlFormatValue,p="field"==n&&Ue(t,r)||{},f=[r,go(go({},Ae()(l,["fieldSettings","listValues"])),{},{asyncListValues:s}),Q(i,q),a,u,p,t.settings.sqlDialect];c=d.call.apply(d,[t.ctx].concat(f))}else c=Array.isArray(r)?r.map((function(e){return ao.escape(e)})):ao.escape(r);return c}},So=function(e,t,r){if(r){var n=t.settings.fieldSeparator,o=Ue(t,r)||{},i=qe(r,t),l=It(r,t),a=l?l.join(n):null;return(0,t.settings.formatField)(Rt(r,t,e,null,{useTableName:!0}),i,a,o,t)}},Fo=function(e,t,r){var n,o,i=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),l=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),a=Ie(t,i);if(a){var u=qe(i,t),s=u[u.length-1],c=a.sqlFunc||s,d={},p=[],f=[];for(var v in a.args){var g,h=a.args[v],m=Ue(t,h),y=h.defaultValue,b=h.isOptional,O=null!=y&&y.func?"func":"value",A=l?l.get(v):void 0,S=A?A.get("value"):void 0,F=A?A.get("valueSrc"):void 0;"func"!==F&&null!==(g=S)&&void 0!==g&&g.toJS&&(S=S.toJS());var j=A?A.get("asyncListValues"):void 0,E=Ao(e,t,S,F,h.type,m,h,null,null,j);if(null!=S&&void 0===E)return void("func"!=F&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(i)));var C=void 0;if(void 0===E&&!b&&null!=y&&void 0===(C=Ao(e,t,y,O,h.type,m,h,null,null,j)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(i)));var _=null!=E?E:C;if(void 0!==_){if(p.length){var L,k=po(v);try{for(k.s();!(L=k.n()).done;)d[L.value]=void 0}catch(e){k.e(e)}finally{k.f()}p=[]}d[v]=_}else b||f.push(v),p.push(v)}if(!f.length){var T;if("function"==typeof a.sqlFormatFunc){var P=a.sqlFormatFunc,V=[d,t.settings.sqlDialect];T=P.call.apply(P,[t.ctx].concat(V))}else{var x=Object.entries(d).map((function(e){var t=(0,w.A)(e,2);return t[0],t[1]})).join(", ");T="".concat(c,"(").concat(x,")")}return T}}else e.errors.push("Func ".concat(i," is not defined in config"))};function jo(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return wo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function wo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Eo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Co(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Eo(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Eo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _o="${0}.compareTo(${1})",Lo={datetime:!0,time:!0,date:!0},ko=function(e,t){return To(e,t,!1)},To=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=bn(t,void 0,!1),i=Po(e,o,n,null);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SpEL:",n.errors),i)},Po=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return"group"===o||"rule_group"===o?Io(e,t,r,n):"rule"===o?No(e,t,r,n):"switch_group"==o?xo(e,t,r,n):"case_group"==o?Vo(e,t,r,n):void 0}},Vo=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type");if("case_group"==o){var i=e.get("properties")||new _.T5,l=Mo(t,i,r,null,n,"!case_value"),a=l.value;return l.valueSrc,l.valueType,[Io(e,t,r,n),a]}r.errors.push("Unexpected child of type ".concat(o," inside switch"))},xo=function(e,t,r){e.get("properties")||new _.T5;var n=e.get("children1");if(n){var o=n.map((function(e){return Vo(e,t,r,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray();if(o.length){if(1==o.length&&!o[0][0])return o[0][1];for(var i=[],l=0;l<o.length;l++)l==o.length-1||o[l][0]?(i.push(o[l]),l==o.length-1&&o[l][0]&&i.push([void 0,null])):r.errors.push("No condition for case ".concat(l));for(var a="",u="",s=0;s<i.length;s++){var c=(0,w.A)(i[s],2),d=c[0],p=c[1];null==p&&(p="null"),null==d&&(d="true"),s!=i.length-1?(a+="(".concat(d," ? ").concat(p," : "),u+=")"):a+="".concat(p)}return a+u}}},Io=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type"),i=e.get("properties")||new _.T5,l=i.get("mode"),a=e.get("children1")||new _.B8,u=i.get("field"),s=i.get("conjunction");s||(s=Ot(t));var c=t.conjunctions[s],d=i.get("not"),p="rule_group"===o&&u,f=p&&"struct"!=l,v=f?u:n,g=(Ue(t,v)||{}).isSpelArray,h=t.settings.fieldSeparator,m=i.get("operator");m||l&&"some"!=l||(m="some");var y=Ro(t,m,u),b=y!=m,O=m&&$e(t,y,u)||null,A=p&&(!y||0==O.cardinality),S=Mo(t,i,r,y,n,null),F=S.value,j=S.valueSrc,w=S.valueType,E=a.map((function(e){return Po(e,t,r,v)})).filter((function(e){return void 0!==e}));if(f&&!A){if(null==F)return}else if(!E.size)return;var C,L=p,k=E.size?c.spelFormatConj.call(t.ctx,E,s,d,L):null;if(f){var T=Go(r,t,u,n).value,P=(h||".")+(g?"length":"size()"),V="".concat(T).concat(P),x=k?"".concat(T,".?[").concat(k,"]").concat(P):V;C=Do(r,t,i,x,A?V:F,y,j,w,b)}else C=k;return C},Do=function(e,t,r,n,o,i,l,a){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],s=r.get("field"),c=$e(t,i,s)||{},d=Ue(t,s)||{},p=r.get("operatorOptions"),f=c.spelFormatOp||function(e,t,r){var n=t.spelOp;if(n){var o,i=n.includes("${0}"),l=Lo[r],a=n,u=X(t);return l?o=function(e,t,r,n,o,i,l,s){var c=_o.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:u>1?r[n-1]:r}));return"".concat(c," ").concat(a," 0")}:i?o=function(e,t,r,o,i,l,a,s){return n.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:u>1?r[n-1]:r}))}:0==u?o=function(e,t,r,n,o,i,l,u){return"".concat(e," ").concat(a)}:1==u&&(o=function(e,t,r,n,o,i,l,u){return"".concat(e," ").concat(a," ").concat(r)}),o}}(0,c,null!=a?a:d.type);if(f){var v,g=[n,i,o,l,a,Q(c,M),p,d];return v=f.call.apply(f,[t.ctx].concat(g)),u&&(v=t.settings.spelFormatReverse.call(t.ctx,v)),void 0===v&&e.errors.push("Operator ".concat(i," is not supported for value source ").concat(l)),v}e.errors.push("Operator ".concat(i," is not supported"))},Ro=function(e,t,r){if(t){var n=$e(e,t,r)||{},o=n.reversedOp,i=$e(e,o,r)||{},l=n.spelOp||n.spelFormatOp,a=i.spelOp||i.spelFormatOp;if(l||a){if(!l&&a){var u=[o,t];t=u[0],o=u[1];var s=[i,n];n=s[0],i=s[1]}return t}}},No=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.get("properties")||new _.T5,l=i.get("field"),a=i.get("fieldSrc"),u=i.get("operator");if(null!=l&&null!=u){var s=Ro(t,u,l);if(s){var c=s!=u,d=Mo(t,i,r,s,o,null),p=d.value,f=d.valueSrc,v=d.valueType;if(void 0!==p){var g=null!==(n=qo(r,t,l,a,o))&&void 0!==n?n:{},h=g.value,m=(g.valueSrc,g.valueType);if(void 0!==h)return Do(r,t,i,h,p,s,f,null!=v?v:m,c)}}else r.errors.push("Operator ".concat(u," is not supported"))}},qo=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"func"===n?zo(e,t,r,o):Go(e,t,r,o)},Mo=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=t.get("field"),a=t.get("valueSrc"),u=t.get("valueType");("!case_value"==i||u&&"case_value"==u.get(0))&&(l="!case_value");var s,c=Ue(e,l)||{},d=$e(e,n,l)||{},p=X(d),f=t.get("value"),v=t.get("asyncListValues"),g=[],h=[];if(null!=f){var m=f.map((function(t,i){var s=a?a.get(i):null,p=u?u.get(i):null,f=Ht(t,s,e),m=Qe(e,l,n,s),y=He(e,l,n,m,s,{forExport:!0}),b=Wo(r,e,f,s,p,y,c,n,d,o,v);return void 0!==b&&(g.push(s),h.push(p)),b})),y=m.filter((function(e){return void 0===e})).size>0;m.size<p||y||(s=p>1?m.toArray():1==p?m.first():null)}return{value:s,valueSrc:g.length>1?g:g[0],valueType:h.length>1?h:h[0]}},Wo=function(e,t,r,n,o,i,l,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var d,p;if("field"===n)d=null===(p=Go(e,t,r,s))||void 0===p?void 0:p.value;else if("func"===n){var f;d=null===(f=zo(e,t,r,s,o))||void 0===f?void 0:f.value}else if("function"==typeof(null==i?void 0:i.spelFormatValue)){var v=i.spelFormatValue,g=[r,Co(Co({},Ae()(l,["fieldSettings","listValues"])),{},{asyncListValues:c}),Q(i,q)];if(a&&(g.push(a),g.push(u)),"field"==n){var h=Ue(t,r)||{};g.push(h)}d=v.call.apply(v,[t.ctx].concat(g))}else d=no(r);return d}},Go=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,i=Ue(t,r)||{},l=qe(r,t),a=nt(r,t,n),u=t.settings.formatSpelField,s=Rt(r,t,e,n),c=a.map((function(e){var t,r=(0,w.A)(e,3),n=r[0],i=r[1],l=r[2];return l&&(t="!struct"==l.type||"!group"==l.type&&"struct"==l.mode?null!=i&&i.isSpelMap?"map":"class":"!group"==l.type?null!=i&&i.isSpelItemMap?"[map]":"[class]":"class"),{key:n,parent:t,isSpelVariable:null==i?void 0:i.isSpelVariable,fieldSeparator:o}}));return{value:u.call(t.ctx,s,n,l,c,i,t),valueSrc:"field",valueType:null==i?void 0:i.type}}},zo=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),u=Ie(t,l);if(u){var s={},c=[],d=[];for(var p in u.args){var f,v,g=u.args[p],h=Ue(t,g),m=g.defaultValue,y=g.isOptional,b=null!=m&&m.func?"func":"value",O=a?a.get(p):void 0,A=O?O.get("value"):void 0,S=O?O.get("valueSrc"):void 0;"func"!==S&&null!==(f=A)&&void 0!==f&&f.toJS&&(A=A.toJS());var F=O?O.get("asyncListValues"):void 0,j=null===(v=g.escapeForFormat)||void 0===v||v,w=null,E=Qe(t,g,w,S),C=He(t,g,w,E,S,{forExport:!0}),_=Wo(e,t,A,S,g.type,C,h,null,null,i,F);if(null!=A&&void 0===_)return void("func"!=S&&e.errors.push("Can't format value of arg ".concat(p," for func ").concat(l)));var L=void 0;if(void 0===_&&!y&&null!=m){var k=Qe(t,g,w,b),T=He(t,g,w,k,b,{forExport:!0});if(void 0===(L=Wo(e,t,m,b,g.type,T,h,null,null,i,F)))return void("func"!=b&&e.errors.push("Can't format default value of arg ".concat(p," for func ").concat(l)))}var P=null!=_?_:L;if(void 0!==P){if(c.length){var V,x=jo(c);try{for(x.s();!(V=x.n()).done;){var I=V.value;s[I]=void 0}}catch(e){x.e(e)}finally{x.f()}c=[]}s[p]=j?P:null!=A?A:m}else y||d.push(p),c.push(p)}if(!d.length){var D;if("function"==typeof u.spelFormatFunc){var R=u.spelFormatFunc,N=[s];D=R.call.apply(R,[t.ctx].concat(N))}else if(u.spelFunc){D=u.spelFunc.replace(/\${(\w+)}/g,(function(e,t){var r;return null!==(r=s[t])&&void 0!==r?r:e}));var q,M=Object.keys(u.args||{}).reverse().filter((function(e){return!!u.args[e].isOptional})),W=jo(M);try{for(W.s();!(q=W.n()).done;){var G=q.value;if(null!=s[G])break;D=D.replace(new RegExp("(, )?\\${"+G+"}","g"),"")}}catch(e){W.e(e)}finally{W.f()}D=D.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(l," is not supported"));return{value:D,valueSrc:"func",valueType:u.returnType}}}else e.errors.push("Func ".concat(l," is not defined in config"))};function Bo(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Uo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Uo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function $o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ho(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Jo=function(e,t){var r={errors:[],settings:{isForDisplay:arguments.length>2&&void 0!==arguments[2]&&arguments[2],isDebugMode:arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},n=bn(t,void 0,!1),o=Yo([],e,n,r,null);return r.errors.length&&console.warn("Errors while exporting to string:",r.errors),o},Yo=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(t){var i=t.get("type");return t.get("children1"),"group"===i||"rule_group"===i?Ko(e,t,r,n,o):"rule"===i?Qo(e,t,r,n,o):void 0}},Ko=function(e,t,r,n){var o,i,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=n.settings,u=a.isForDisplay,s=a.isDebugMode,c=t.get("type"),d=t.get("properties")||new _.T5,p=d.get("mode"),f=t.get("children1")||new _.B8,v=l,g="rule_group"===c,h=g&&"array"==p?d.get("field"):null,m="rule_group"===c?d.get("operator"):null,y=m?null!==(o=null===(i=r.operators[m])||void 0===i?void 0:i.cardinality)&&void 0!==o?o:1:void 0,b=g&&"array"===p&&y>=1,O=d.get("not"),A=f.map((function(o){return Yo([].concat((0,E.A)(e),[t]),o,r,n,null!=h?h:v)})).filter((function(e){return void 0!==e}));if(b||A.size||s){var S=d.get("conjunction");S||(S=Ot(r));var F,j=r.conjunctions[S],w=A.size?j.formatConj.call(r.ctx,A,S,O,u):null;if(h){var C=Qo(e,t,r,n,v,!0);if(C){var L,k=C.pop(),T=[w].concat((0,E.A)(C));F=(L=r.settings.formatAggr).call.apply(L,[r.ctx].concat((0,E.A)(T))),k&&(F=r.settings.formatReverse.call(r.ctx,F,null,null,null,null,u))}}else F=w;return s&&null==F&&(F="?"),F}},Qo=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=n.settings,a=l.isForDisplay,u=l.isDebugMode,s=t.get("properties")||new _.T5,c=s.get("field"),d=s.get("fieldSrc"),p=s.get("operator"),f=s.get("operatorOptions");if(null!=c&&null!=p||u){var v=Ue(r,c)||{},g=$e(r,p,c)||{},h=g.reversedOp,m=$e(r,h,c)||{},y=!1,b=g.formatOp;if(!b&&h&&(b=m.formatOp)){y=!0;var O=[h,p];p=O[0],h=O[1];var A=[m,g];g=A[0],m=A[1]}if(u&&!p&&(p="?"),b||(b=function(e,t,r){var n,o=r.settings.isDebugMode,i=(null==t?void 0:t.labelForFormat)||e,l=X(t);return 0==l?n=function(e,t,r,n,o,l,a,u){return"".concat(e," ").concat(i)}:1==l?n=function(e,t,r,n,l,a,u,s){return o&&"?"===t&&"?"===r?e&&"?"!==e?"".concat(e," ?"):"?":"".concat(e," ").concat(i," ").concat(r)}:2==l&&(n=function(e,t,r,n,o,l,a,u){var s,c,d=null==r||null===(s=r.first)||void 0===s?void 0:s.call(r),p=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(i," ").concat(d," AND ").concat(p)}),n}(p,g,n)),b){var S="func"===d?ei(r,n,c,o):Zo(r,n,c,o);if(null!=S){var F=function(e,t,r,n,o){var i,l,a=r.settings,u=(a.isForDisplay,a.isDebugMode),s=t.get("field"),c=t.get("valueSrc"),d=t.get("valueType"),p=Ue(e,s)||{},f=n||t.get("operator"),v=$e(e,f,s)||{},g=X(v),h=t.get("value"),m=t.get("asyncListValues"),y=[],b=[];return null!=h&&!((l=h.map((function(t,n){var i=c?c.get(n):null,l=d?d.get(n):null,a=u?t:Ht(t,i,e),g=Qe(e,s,f,i),h=He(e,s,f,g,i,{forExport:!0}),O=Xo(e,r,a,i,l,h,p,f,v,o,m);return void 0!==O&&(y.push(i),b.push(l)),O}))).filter((function(e){return void 0===e})).size>0)&&l.size===g&&(i=1==g?l.first():l),u&&!i&&(i=g>1?new _.B8(Array.from({length:g}).map((function(e,t){var r,n;return null!==(r=null===(n=l)||void 0===n?void 0:n.get(t))&&void 0!==r?r:"?"}))):"?"),[i,y.length>1?y:y[0],b.length>1?b:b[0]]}(r,s,n,p,o),j=(0,w.A)(F,3),E=j[0],C=j[1],L=j[2];if(void 0!==E){var k=[S,p,E,C,L,Q(g,M),f,a,v,y];if(i)return k;var T,P=(T=b).call.apply(T,[r.ctx].concat(k));return y&&(P=r.settings.formatReverse.call(r.ctx,P,p,h,g,m,a)),P}}}}},Xo=function(e,t,r,n,o,i,l,a,u){var s,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,d=arguments.length>10?arguments[10]:void 0,p=t.settings,f=p.isForDisplay,v=p.isDebugMode;if(void 0===r)return v?"array"===(null==i?void 0:i.jsType)?[]:"?":void 0;if("field"==n)s=Zo(e,t,r,c);else if("func"==n)s=ei(e,t,r,c);else if(null==r)s=void 0;else if("function"==typeof(null==i?void 0:i.formatValue)){var g,h=i.formatValue,m=[r,Ho(Ho({},Ae()(l,["fieldSettings","listValues"])),{},{asyncListValues:d}),Q(i,q),f];if(a&&(m.push(a),m.push(u)),"field"==n){var y=Ue(e,r)||{};m.push(y)}s=null===(g=null==l?void 0:l.escapeForFormat)||void 0===g||g?h.call.apply(h,[e.ctx].concat(m)):r}else s=r;return s},Zo=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=t.settings,l=i.isForDisplay,a=i.isDebugMode,u=e.settings,s=(u.fieldSeparator,u.fieldSeparatorDisplay),c=null;if(r){var d=Ue(e,r)||{},p=qe(r,e),f=It(r,e,o?n:null),v=f?f.join(s):null,g=d.label2||v;c=(0,e.settings.formatField)(Rt(r,e,t,o?n:null,{useTableName:!0}),p,g,d,e,l)}else a&&(c="?");return c},ei=function(e,t,r){var n,o,i,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.settings,u=a.isForDisplay,s=a.isDebugMode,c=null==r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func");if(!c)return s?"?()":void 0;var d=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),p=Ie(e,c);if(p||s){var f,v=qe(c,e),g=v[v.length-1],h=u&&(null==p?void 0:p.label)||g,m={},y=[],b=[],O={},A=Bo(p?Object.keys(p.args||{}):(null==d||null===(i=d.keySeq)||void 0===i?void 0:i.call(d).toArray())||[]);try{for(A.s();!(f=A.n()).done;){var S,F=f.value,j=null==p?void 0:p.args[F],E=(Ue(e,j),j||{}),C=E.defaultValue,_=E.isOptional,L=null!=C&&C.func?"func":"value",k=He(e,j,void 0,void 0,L,{forExport:!0}),T=u&&(null==j?void 0:j.label)||F,P=d?d.get(F):void 0,V=P?P.get("value"):void 0,x=P?P.get("valueSrc"):void 0;"func"!==x&&null!==(S=V)&&void 0!==S&&S.toJS&&(V=V.toJS());var I=P?P.get("asyncListValues"):void 0,D=Xo(e,t,V,x,null==j?void 0:j.type,k,j,null,null,l,I);null!=V&&void 0===D&&"func"!=x&&t.errors.push("Can't format value of arg ".concat(F," for func ").concat(c));var R=void 0;if(void 0===D&&!_&&null!=C&&void 0===(R=Xo(e,t,C,L,null==j?void 0:j.type,k,j,null,null,l,I)))return void("func"!=L&&t.errors.push("Can't format default value of arg ".concat(F," for func ").concat(c)));var N=null!=D?D:R;if(void 0!==N){if(y.length){var q,M=Bo(F);try{for(M.s();!(q=M.n()).done;){var W=(0,w.A)(q.value,2),G=W[0];W[1],m[G]=void 0}}catch(e){M.e(e)}finally{M.f()}y=[]}m[F]=N,O[T]=N}else _||b.push(F),y.push([F,T])}}catch(e){A.e(e)}finally{A.f()}if(!b.length||s){var z=null;if("function"==typeof(null==p?void 0:p.formatFunc)){var B=p.formatFunc,U=[m,u];z=B.call.apply(B,[e.ctx].concat(U))}else{var $=Object.entries(u?O:m).map((function(e){var t=(0,w.A)(e,2),r=t[0],n=t[1];return u?"".concat(r,": ").concat(n):"".concat(n)})).join(", ");z="".concat(h,"(").concat($,")")}return z}}else t.errors.push("Func ".concat(c," is not defined in config"))};function ti(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ri(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ti(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ni(e,t,r,n,o,i){if(e&&r&&null!=t){var l=r,a=n.operators[l];if(a){var u=a.elasticSearchQueryType,s=!1;!u&&a.reversedOp&&(s=!0,l=a.reversedOp,u=(a=n.operators[l]).elasticSearchQueryType);var c=Qe(n,e,l,o),d=n.widgets[c];if(d){var p,f,v=d.elasticSearchFormatValue;if(p="function"==typeof u?u(c):u)return f="function"==typeof v?v(p,t,l,e,n):function(e,t,r,n,o,i){var l=n;switch(e){case"filter":return{script:o.operators[r].elasticSearchScript(n,t)};case"exists":return{field:n};case"match":return(0,j.A)({},l,t[0]);case"term":return i===oi?(0,j.A)({},n,{value:t[0]}):(0,j.A)({},n,t[0]);case"geo_bounding_box":return(0,j.A)({},n,function(e){if(null==e)return null;var t=e.split(",").map(Number);return{top_left:{lat:t[0],lon:t[1]},bottom_right:{lat:t[2],lon:t[3]}}}(t[0]));case"range":return(0,j.A)({},n,function(e,t){if(e.length>1)return{gte:"".concat(e[0]),lte:"".concat(e[1])};var r=e[0];switch(t){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}(t,r));case"wildcard":return(0,j.A)({},n,function(e){return{value:"*"+e+"*"}}(t[0]));case"regexp":return(0,j.A)({},n,function(e){return{value:e}}(t[0]));default:return}}(p,t,l,e,n,i),s?{bool:{must_not:(0,j.A)({},p,ri({},f))}}:(0,j.A)({},p,ri({},f))}}}}var oi="ES_7_SYNTAX",ii="ES_6_SYNTAX";function li(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ii,n=bn(t,void 0,!1);if(e){var o=e.get("type"),i=e.get("properties")||new Map;if("rule"===o&&i.get("field")){var l,a,u,s=i.get("operator"),c=i.get("field"),d=i.get("fieldSrc"),p=null===(l=i.get("value"))||void 0===l?void 0:l.toJS(),f=(null===(a=i.get("valueType"))||void 0===a||a.get(0),null===(u=i.get("valueSrc"))||void 0===u?void 0:u.get(0));if("func"===f||"func"==d)return;return p&&Array.isArray(p[0])?p[0].map((function(e){return ni(c,[e],s,n,f,r)})):ni(c,p,s,n,f,r)}if("group"===o||"rule_group"===o){var v=i.get("not"),g=i.get("conjunction");return g||(g=Ot(n)),function(e,t,r,n,o,i){if(e&&e.size){var l=e.valueSeq().toArray(),a=function(e,t){switch(e){case"AND":return t?"must_not":"must";case"OR":return t?"should_not":"should";case"NOT":return t?"must":"must_not";default:return}}(t,r),u=l.map((function(e){return n(e,o,i)})).filter((function(e){return void 0!==e}));if(u.length){var s=u.flat(1/0);return{bool:(0,j.A)({},a,s)}}}}(e.get("children1"),g,v,li,n,r)}}}var ai=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e){var n=e;return n=n.toJS(),vt(n,t,r)}},ui=function(e){if(si(e))return e;if(ci(e))return st(bt(e));if("string"==typeof e&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if("string"==typeof e)return st(bt(JSON.parse(e)));throw new Error("Can't load tree!")},si=function(e){return _.T5.isMap(e)},ci=function(e){return"object"==(0,C.A)(e)&&("group"==e.type||"switch_group"==e.type)},di=r(34591);function pi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pi(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vi(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return gi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function gi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var hi,mi="jlField",yi="jlRawField",bi="jlHavingMarker",Oi=new Proxy({__name:"jlArgs",__test:function(e){var t,r=null==e||null===(t=e.match)||void 0===t?void 0:t.call(e,/jlArgs\[(\d+)\]/);if(r)return parseInt(r[1])}},{get:function(e,t){return isNaN(parseInt(t))?e[t]:"jlArgs["+t+"]"}}),Ai=["==","!=","datetime==","datetime!=","date==","date!="],Si=["<","<=",">",">="],Fi=["in","!in"],ji=["multiselect_equals","multiselect_not_equals","multiselect_contains","multiselect_not_contains"],wi=function(e){return{errors:[],settings:null==e?void 0:e.settings}},Ei=function(e,t){return Ci(e,t,!1)},Ci=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=wi();n.settings={allowUnknownFields:!1,returnErrors:r};var o=bn(t,void 0,!1),i=_i(o),l=e?Ti(e,i,o,["rule","group","switch","case_val"],n):void 0,a=l?ui(l):void 0;return n.errors=Array.from(new Set(n.errors)),r?[a,n.errors]:(n.errors.length&&console.warn("Errors while importing from JsonLogic:",n.errors),a)},_i=function(e){var t={},r={},n=function(n){var o=e.operators[n],i=X(o);if("string"==typeof o.jsonLogic){var l=o.jsonLogic+"/"+i;t[l]||(t[l]=[]),t[l].push(n)}else if("function"==typeof o.jsonLogic){var a,u,s,c,d;try{d=o.jsonLogic(mi,n,Oi,o,new _.Ay.Map({having:bi,groupField:yi}))}catch(e){return console.warn("Error while running JsonLogic template for op ".concat(n),e),1}var p=Object.keys(d)[0],f=null===(a=o.jsonLogic2)||void 0===a?void 0:a.startsWith("#"),v=null!==(u=null===(s=o.jsonLogic2)||void 0===s?void 0:s.replace(/^#/,""))&&void 0!==u?u:p;(null!==(c=o.jsonLogicOps)&&void 0!==c?c:[v]).map((function(e){var r=e+"/"+i;t[r]||(t[r]=[]),t[r].push(n)})),r[n]||(r[n]={}),r[n]={template:d,newOp:v,_jsonLogicIsExclamationOp:!!o._jsonLogicIsExclamationOp,isRevArgs:f}}};for(var o in e.operators)n(o);var i={};for(var l in e.conjunctions)i[e.conjunctions[l].jsonLogicConj||l.toLowerCase()]=l;var a,u={},s=vi(Le(e));try{for(s.s();!(a=s.n()).done;){var c=(0,w.A)(a.value,2),d=c[0],p=c[1],f=void 0;p.jsonLogicIsMethod?f="#"+p.jsonLogic:"string"==typeof p.jsonLogic&&(f=p.jsonLogic),f&&(u[f]||(u[f]=[]),u[f].push(d))}}catch(e){s.e(e)}finally{s.f()}var v=e.settings.jsonLogic,g=v.groupVarKey,h=v.altVarKey;return{operators:t,conjunctions:i,funcs:u,varKeys:["var",g,h],combinationOperators:r}},Li=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null!=t&&t.combinationOperators)for(var i=0,l=Object.entries(t.combinationOperators);i<l.length;i++){var a=(0,w.A)(l[i],2),u=a[0],s=a[1];if(null==o||o.includes(u)){var c=ki(s.template,e);c.match&&(n?r.errors.push("Operator matched against 2 templates: ".concat(n.newOp," and ").concat(u)):n=c,n.newOp=s.newOp)}}return n},ki=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{match:!0,jlField:null,jlArgs:[],jlHaving:null};if(null==e||null==t)return r.match=!1,r;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return r.match=!1,r;r.vals=[];for(var i=0;i<n.length;i++){var l=n[i],a=e[l];if(r.vals.push(t[l]),l!==o[i])return r.match=!1,r;var u=Oi.__test(a);if(void 0!==u)r.jlArgs[u]=t[l];else if(a===mi&&ce(t[l]))r.jlField=t[l];else if(a===yi)r.jlField={var:t[l]};else if(a===Oi)r.jlArgs.push(t[l]);else if(a===bi)r.jlHaving=t[l];else if("object"===(0,C.A)(a)&&null!==a||Array.isArray(a))r=ki(a,t[l],r);else if(a!==t[l])return r.match=!1,r}return r},Ti=function(e,t,r,n,o){var i,l,a,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;ce(e)&&(i=Object.keys(e)[0],l=e[i],Array.isArray(l)||(l=[l]));var p=o.errors.length,f=r.settings.jsonLogic.lockedOp,v="!"==i&&1==l.length&&l[0]&&ce(l[0])&&t.varKeys.includes(Object.keys(l[0])[0]),g=Li(e,t,o);g&&((l=[])[0]=g.jlField,g.jlHaving&&l.push(g.jlHaving),g.jlArgs.forEach((function(e){return l.push(e)})),i=g.newOp,Fi.includes(i)&&(l=g.vals));var h="!"==i&&!v,m=f&&i==f,y=n.includes("switch");if(m)a=Ti(l[0],t,r,n,o,u,s,c,d,!0);else if(h)a=Ti(l[0],t,r,n,o,!u,s,c,d);else if(n.includes("val"))a=Vi(i,l,t,r,u,o,d)||Ri(i,l,t,r,u,s,o,d)||Pi(e,s,c,r,o);else{var b=(0,E.A)(o.errors);n.includes("switch")&&(a=Gi(i,l,t,r,u,o,d)),null==a&&n.includes("group")&&(a=Ni(i,l,t,r,u,o,d,!1)),null==a&&n.includes("rule")&&(a=Mi(i,l,t,r,u,o,d));var O=(0,E.A)(o.errors);null==a&&n.includes("case_val")&&(o.errors=b,null==(a=Wi(i,l,t,r,u,o,d))&&(o.errors=O)),a&&y&&!["group","switch_group"].includes(a.type)&&(a=qi(a,r))}var A=o.errors.length;return"!"!=i&&void 0===a&&A==p&&o.errors.push("Can't parse logic ".concat(JSON.stringify(e))),m&&(a.properties.isLocked=!0),a},Pi=function(e,t,r,n,o){var i;if(void 0===e&&(e=null==t?void 0:t.defaultValue),void 0!==e){r=r||(null==t?void 0:t.mainWidget);var l=n.widgets[r],a=null==t?void 0:t.type;if(!a||l){if(!ce(e)){if(null!=l&&l.jsonLogicImport)try{var u;e=l.jsonLogicImport.call(n.ctx,e,fi(fi({},l),null!==(u=null==t?void 0:t.fieldSettings)&&void 0!==u?u:{}))}catch(t){var s;o.errors.push("Can't import value ".concat(e," using import func of widget ").concat(r,": ").concat(null!==(s=null==t?void 0:t.message)&&void 0!==s?s:t)),e=void 0}else{if("time"===a&&"number"==typeof e){var c=Math.floor(e/60/60)%24,d=Math.floor(e/60)%60,p=e%60,f=l.valueFormat;if(f){var v=new Date(e);v.setMilliseconds(0),v.setHours(c),v.setMinutes(d),v.setSeconds(p),e=x()(v).format(f)}else e="".concat(c,":").concat(d,":").concat(p)}if(["date","datetime"].includes(a)&&e&&!(e instanceof Date))try{var g="number"==typeof e||"string"==typeof e&&!isNaN(e),h=g&&"string"==typeof e?parseInt(e):e,m=new Date(g?h:e);if(m instanceof Date&&(e=m),isNaN(m))throw new Error("Invalid date")}catch(t){o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}}if(e instanceof Date&&t){var y=l.valueFormat;y&&(e=x()(e).format(y))}var b;return e&&null!=t&&null!==(i=t.fieldSettings)&&void 0!==i&&i.asyncFetch&&(b=Array.isArray(e)?e:[e]),{valueSrc:"value",value:e,valueType:null==l?void 0:l.type,asyncListValues:b}}o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)))}else o.errors.push("No widget for type ".concat(a))}},Vi=function(e,t,r,n,o,i){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(r.varKeys.includes(e)&&"string"==typeof t[0]){var a,u=Ve(n,t[0],l),s=Ue(n,u);return s||null!==(a=i.settings)&&void 0!==a&&a.allowUnknownFields?{valueSrc:"field",value:u,valueType:null==s?void 0:s.type}:void i.errors.push("No config for field ".concat(u))}},xi=function(e,t,r,n,o){var i,l,a,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,p=!!o.operators[e],f=Object.keys(t)[0],v=Object.values(t)[0],g=function(e,t){return Ii(e,t,n,o,u,c,d)||Di(e,t,n,o,u,s,c,d)},h=c.errors.length,m=g(f,v);if(m&&(i=m.field,l=m.fieldSrc),p&&(a=r[0],r=r.splice(1)),"reduce"==f&&Array.isArray(v)&&3==v.length){var y=v,b=(0,w.A)(y,3),O=b[0],A=b[1],S=b[2];if(ce(O)&&0==S&&ce(A)&&Array.isArray(A["+"])&&1==A["+"][0]&&ce(A["+"][1])&&"accumulator"==A["+"][1].var)if(f=Object.keys(O)[0],v=Object.values(O)[0],"filter"==f){var F=v,j=(0,w.A)(F,2),E=j[0],C=j[1];if(ce(E)){var _=g(f=Object.keys(E)[0],v=Object.values(E)[0]);_&&(i=_.field,l=_.fieldSrc,a=C,p=!0)}}else{var L=g(f,v);L&&(i=L.field,l=L.fieldSrc,p=!0)}}var k=c.errors.length;if(i||k!=h||c.errors.push("Unknown LHS ".concat(JSON.stringify(t))),i)return{field:i,fieldSrc:l,having:a,isGroup:p,args:r}},Ii=function(e,t,r,n,o,i){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Array.isArray(t)||(t=[t]);var a=Vi(e,t,r,n,o,i,l);if(a)return{fieldSrc:"field",field:a.value}},Di=function(e,t,r,n,o){var i=Ri(e,t,r,n,o,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6?arguments[6]:void 0,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null);if(i)return{fieldSrc:"func",field:i.value}},Ri=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6?arguments[6]:void 0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(e){var u,s,c,d="method"==e;if(d){var p,f,v=(0,di.A)(t);p=v[0],u=v[1],f=v.slice(2),s=[p].concat((0,E.A)(f))}else u=e,s=t;var g=(d?"#":"")+u,h=(null==i?void 0:i.type)||(null==i?void 0:i.returnType),m=(r.funcs[g]||[]).filter((function(e){return!i||Ie(n,e).returnType==h}));if(m.length)c=m[0];else{var y,b=(0,j.A)({},e,t),O=vi(Le(n));try{for(O.s();!(y=O.n()).done;){var A=(0,w.A)(y.value,2),S=A[0],F=A[1];if(F.jsonLogicImport&&(!h||F.returnType==h)){var C=void 0;try{C=F.jsonLogicImport.call(n.ctx,b)}catch(e){}C&&(c=S,s=C)}}}catch(e){O.e(e)}finally{O.f()}}if(c&&c){var _=Ie(n,c),L=Object.keys(_.args||{}),k=s.reduce((function(e,t,o){var i,u=L[o],s=_.args[u];return s&&(i=Ti(t,r,n,["val"],l,!1,s,null,a)),void 0!==i?fi(fi({},e),{},(0,j.A)({},u,i)):e}),{});for(var T in _.args){var P,V=_.args[T],x=k[T];if(void 0===x)if(void 0!==(x=null==V?void 0:V.defaultValue)&&(x={value:x,valueSrc:null!==(P=x)&&void 0!==P&&P.func?"func":"value",valueType:V.type}),void 0===x){if(null==V||!V.isOptional)return void l.errors.push("No value for arg ".concat(T," of func ").concat(c))}else k[T]=x}return{valueSrc:"func",value:{func:c,args:k},valueType:_.returnType}}}},Ni=function(e,t,r,n,o,i){var l,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=r.conjunctions[e],s=n.settings.fieldSeparator;if(u){var c=t.map((function(e){return Ti(e,r,n,["rule","group"],i,!1,null,null,a)})).filter((function(e){return void 0!==e})).reduce((function(e,t){return fi(fi({},e),{},(0,j.A)({},t.id,t))}),{}),d=Object.values(c).map((function(e){var t,r;return"field"==(null==e||null===(t=e.properties)||void 0===t?void 0:t.fieldSrc)&&(null==e||null===(r=e.properties)||void 0===r?void 0:r.field)})).filter((function(e){var t;return null==e||null===(t=e.includes)||void 0===t?void 0:t.call(e,s)})),p=Object.fromEntries((l=d,Array.from(new Set(l))).map((function(e){var t=e.split(s),r=Object.fromEntries(t.slice(0,-1).map((function(e,t,r){return[].concat((0,E.A)(r.slice(0,t)),[e])})).map((function(e){return[e.join(s),Ue(n,e)]})).filter((function(e){var t=(0,w.A)(e,2),r=(t[0],t[1]);return"!group"==(null==r?void 0:r.type)})));return[e,Object.keys(r)]}))),f={conjunction:u,not:o},v=k(),g={},h={};return Object.entries(c).map((function(e){var t=(0,w.A)(e,2),r=t[0],o=t[1];if("group"==(null==o?void 0:o.type)||"rule_group"==(null==o?void 0:o.type))g[r]=o;else{var i,l=null==o||null===(i=o.properties)||void 0===i?void 0:i.field,c=p[l]||[],d=c[c.length-1];if(d){var f=g,v=qe(a,n),m=qe(d,n);ee(v,m.slice(0,v.length))||(v=[]),d.split(s).slice(v.length).map((function(e,t,r){return[].concat((0,E.A)(v),(0,E.A)(r.slice(0,t)),[e]).join(s)})).map((function(e){return{f:e,fc:Ue(n,e)||{}}})).filter((function(e){return"!struct"!=e.fc.type})).map((function(e,t){var r=e.f,n=e.fc,o=h[r];o||(o=k(),h[r]=o,f[o]={type:"rule_group",id:o,children1:{},properties:{conjunction:u,not:!1,field:r,fieldSrc:"field",mode:n.mode}}),f=f[o].children1})),f[r]=o}else o&&(g[r]=o)}})),{type:"group",id:v,children1:g,properties:f}}},qi=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:k(),children1:(0,j.A)({},e.id,e),properties:{conjunction:St(t),not:r}}},Mi=function(e,t,r,n,o,i){var l,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(e){var s=Object.values(n.conjunctions).map((function(e){return e.jsonLogicConj})),c=function(e,t,r,n,o,i,l){var a=wi(l),u=function(e,t,r,n,o,i,l){var a,u=ji.map((function(e){var t;return null===(t=i.operators[e])||void 0===t?void 0:t.jsonLogic2})).includes(e),s=i.settings.groupOperators.find((function(t){var r=i.operators[t];return[t,"string"==typeof r.jsonLogic&&r.jsonLogic,r.jsonLogic2].includes(e)})),c=i.operators[s],d=s&&0==(null==c?void 0:c.cardinality)&&!u,p=null!==(a=null==c?void 0:c.cardinality)&&void 0!==a?a:t-1;!d&&Ai.includes(e)&&1==p&&null===r[1]&&(t=1,p=0,r=[r[0]]);var f=e+"/"+p,v=o.operators[f];if(v){var g,h=[],m=vi(v);try{for(m.s();!(g=m.n()).done;){var y,b,O=g.value,A=void 0,S=[];if(Si.includes(e)&&3==t)A=r[1],S=[r[0],r[2]];else{var F=r,j=(0,di.A)(F);A=j[0],S=j.slice(1)}if(null!==(y=o.combinationOperators[O])&&void 0!==y&&y.isRevArgs&&(A=r[r.length-1],S=r.slice(0,r.length-1)),ce(A)){var w=xi(s,A,S,o,i,null,null,l,n);if(w){var E=w.field,C=w.fieldSrc,_=w.having,L=(w.isGroup,w.args),k=Ue(i,E);if(!(k||null!==(b=l.settings)&&void 0!==b&&b.allowUnknownFields))return void l.errors.push("No config for LHS ".concat(E));var T=(null==k?void 0:k.operators)&&k.operators.includes(O);h.push({field:E,fieldSrc:C,fieldConfig:k,opKey:O,args:L,having:_,isValidOp:T})}}}}catch(e){m.e(e)}finally{m.f()}return h.sort((function(e){return e.isValidOp?-1:1})),h[0]}}(e,t,r,n,o,i,a);if(u)return u;l.errors.push(Array.from(new Set(a.errors)).join("; ")||"Unknown op ".concat(e,"/").concat(t))}(e,t.length,t,a,r,n,i);if(c){var d,p,f=c.field,v=c.fieldSrc,g=c.fieldConfig,h=c.opKey,m=c.args,y=c.having,b=Ue(n,a),O=n.operators[h],A=!!n.operators[null===(l=O)||void 0===l?void 0:l.reversedOp],S="!group"==g.type,F="!group"==(null==b?void 0:b.type),w=A&&(!!n.settings.reverseOperatorsForNot||S&&!y||!S&&F&&!u),E=o&&w||!1,C=!1,_=!!n.settings.reverseOperatorsForNot;if("!group"==(null==g?void 0:g.type)&&y){d=Object.keys(y)[0],p=y[d],Array.isArray(p)||(p=[p]);for(var L=Li(y,r,i);"!"==d&&!L&&!("!"==d&&1==p.length&&p[0]&&ce(p[0])&&r.varKeys.includes(Object.keys(p[0])[0]));){C=!C,y=y["!"],d=Object.keys(y)[0],p=y[d],_&&s.includes(d)&&1==p.length&&(y=y[d][0],d=Object.keys(y)[0],p=y[d]),L=Li(y,r,i)||L}Array.isArray(p)||(p=[p]),L&&((p=[])[0]=L.jlField,L.jlArgs.forEach((function(e){return p.push(e)})),d=L.newOp,Fi.includes(L.newOp)&&(p=L.vals))}E&&(o=!o,h=O.reversedOp,O=n.operators[h]);var T=Qe(n,f,h,null),P=m.map((function(e){return Ti(e,r,n,["val"],i,!1,g,T,a)}));if(!P.filter((function(e){return void 0===e})).length){var V,x=null==g?void 0:g.type;if("!group"!==x&&"!struct"!==x||(x=null),"!group"==(null==g?void 0:g.type)&&y){var I;if(void 0!==r.conjunctions[d]?V=Ni(d,p,r,n,C,i,f,!0):(V=Mi(d,p,r,n,C,i,f,!0))&&("rule_group"===V.type&&(null===(I=V.properties)||void 0===I?void 0:I.field)!==f&&(V=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e)return{type:"rule_group",id:k(),children1:(0,j.A)({},e.id,e),properties:{conjunction:o||St(n,r),not:i,field:t}}}(V,f,g,n)),Object.assign(V.properties,{conjunction:St(n,g)})),!V)return;V.type="rule_group",Object.assign(V.properties,{field:f,mode:g.mode,operator:h}),"array"==g.mode&&Object.assign(V.properties,{value:P.map((function(e){return e.value})),valueSrc:P.map((function(e){return e.valueSrc})),valueType:P.map((function(e){return e.valueType}))}),o&&(V=qi(V,n,o))}else if("!group"!=(null==g?void 0:g.type)||y){var D=P.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),R=D.length?D[0]:void 0;V={type:"rule",id:k(),properties:fi({field:f,fieldSrc:v,operator:h,value:P.map((function(e){return e.value})),valueSrc:P.map((function(e){return e.valueSrc})),valueType:P.map((function(e){return e.valueType}))},R?{asyncListValues:R}:{})},(o||u)&&(V=qi(V,n,o))}else V={type:"rule_group",id:k(),children1:{},properties:{conjunction:St(n,g),not:!1,mode:g.mode,field:f,operator:h}},"array"===g.mode&&Object.assign(V.properties,{value:P.map((function(e){return e.value})),valueSrc:P.map((function(e){return e.valueSrc})),valueType:P.map((function(e){return e.valueType}))}),o&&(V=qi(V,n,o));return V}}}},Wi=function(e,t,r,n,o,i){var l=(0,j.A)({},e,t),a=Ui(n,i,r,l);if(void 0!==a){var u=[Bi(null,a,n,i)];return{type:"switch_group",id:k(),children1:u,properties:{}}}},Gi=function(e,t,r,n,o,i){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("if"===(null==e?void 0:e.toLowerCase())){var a=zi(t).map((function(e){var t=(0,w.A)(e,2),o=t[0],a=t[1];return[o?Ti(o,r,n,["rule","group"],i,!1,null,null,l):null,Ui(n,i,r,a)]})).map((function(e){var t=(0,w.A)(e,2),r=t[0],o=t[1];return Bi(r,o,n,i)}));return{type:"switch_group",id:k(),children1:a,properties:{}}}},zi=function(e){var t=[];return function e(r){var n=(0,w.A)(r,3),o=n[0],i=n[1],l=n[2];t.push([o,i]);var a=ce(l)?Object.keys(l)[0]:null;"if"===(null==a?void 0:a.toLowerCase())?e(l[a]):t.push([void 0,l])}(e),t},Bi=function(e,t,r,n){var o;return e?(o=fi({},e)).type?("group"!=o.type&&(o=qi(o,r)),o.type="case_group"):(n.errors.push("Unexpected case: ".concat(JSON.stringify(o))),o=void 0):o={id:k(),type:"case_group",properties:{}},o&&(o.properties=fi(fi({},o.properties),t)),o},Ui=function(e,t,r,n){var o=Ue(e,"!case_value");if(o){var i=o.mainWidget,l=e.widgets[i];if(l){var a=Ti(n,r,e,["val","case_val"],t,!1,o,i);if(null!=a){var u=a.value,s=a.valueSrc,c=a.valueType;return{value:[u],valueSrc:[null!=s?s:"value"],valueType:[null!=c?c:null==l?void 0:l.type],field:"!case_value"}}}else t.errors.push("No widget ".concat(i," for case value"))}else t.errors.push("Missing caseValueField in settings")},$i=r(47768),Hi=r(64234),Ji=r.n(Hi),Yi=r(27893),Ki="EMPTY_GROUP",Qi="EMPTY_RULE_GROUP",Xi="EMPTY_QUERY",Zi="EMPTY_CASE",el="NO_CONFIG_FOR_FIELD",tl="NO_CONFIG_FOR_OPERATOR",rl="NO_CONFIG_FOR_FUNCTION",nl="INVALID_VALUE",ol="INVALID_FUNC_ARG_VALUE",il="UNSUPPORTED_FIELD_TYPE",ll="UNSUPPORTED_OPERATOR_FOR_FIELD",al="INVALID_VALUE_SRC",ul="INCOMPLETE_RULE",sl="INCOMPLETE_LHS",cl="INCOMPLETE_RHS",dl="BAD_MULTISELECT_VALUES",pl="BAD_SELECT_VALUE",fl="INCORRECT_VALUE_TYPE",vl="INCORRECT_VALUE_JS_TYPE",gl="VALUE_LENGTH_CONSTRAINT_FAIL",hl="VALUE_MIN_CONSTRAINT_FAIL",ml="VALUE_MAX_CONSTRAINT_FAIL",yl="NO_CONFIG_FOR_FIELD_VALUE",bl="CANT_COMPARE_FIELD_WITH_ITSELF",Ol="CANT_COMPARE_FIELD_WITH_FIELD",Al="INCORRECT_FIELD_TYPE",Sl="UNSUPPORTED_FUNCTION_FOR_FIELD",Fl="REQUIRED_FUNCTION_ARG",jl="INCORRECT_FUNCTION_RETURN_TYPE",wl="INVALID_RANGE",El="ITEM_POSITION",Cl="ITEM_POSITION_ROOT",_l="ITEM_POSITION_WITH_INDEX_PATH",Ll="ITEM_POSITION_IN_CASE",kl="range",Tl=(hi={},(0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)(hi,Ki,"Empty group"),Qi,"No conditions for group field {{field}}"),Xi,"Empty query"),Zi,"Empty case"),el,"No config for field {{field}}"),"FIXED_OPERATOR","Fixed operator {{from}} to {{to}} for field {{field}}"),tl,"No config for operator {{operator}}"),rl,"No config for function {{funcKey}}"),nl,"Invalid value"),ol,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),(0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)(hi,il,"Type of field {{field}} is not supported"),ll,"Operator {{operator}} is not supported for field {{field}}"),ul,"Incomplete rule"),sl,"Incomplete LHS"),cl,"Incomplete RHS"),al,"Invalid value src {{valueSrcs, list}}"),dl+"_one","Value {{badValues, list}} is not in the list of allowed values"),dl+"_other","Values {{badValues, list}} are not in the list of allowed values"),pl,"Value {{value}} is not in the list of allowed values"),fl,"Value should have type {{wType}}, but got value of type {{valueType}}"),(0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)(hi,vl,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),gl,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),hl,"Value {{value}} should be greater than or equal to {{fieldSettings.min}}"),hl+"_"+kl,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),ml,"Value {{value}} should be less than or equal to {{fieldSettings.max}}"),ml+"_"+kl,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),yl,"No config for field {{field}}"),bl,"Can't compare field {{field}} with itself"),Ol,"Can't compare field {{leftField}} with {{rightField}}"),Al,"Field {{field}} is of type {{type}}, but expected {{expected}}"),(0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)(hi,Sl,"Unsupported function {{funcKey}} for field {{field}}"),Fl,"Value of arg {{argName}} for func {{funcName}} is required"),jl,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),wl,"Invalid range"),Cl,"Root"),El+"__rule","Leaf #{{globalLeafNo}}"),El+"__group","Group #{{globalGroupNo}}"),El+"__rule_group","Rule-group #{{globalNoByType}}"),El+"__case_group","Case #{{globalNoByType}}"),El+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),(0,j.A)((0,j.A)((0,j.A)((0,j.A)((0,j.A)(hi,El+"__group__deleted","Deleted group #{{globalGroupNo}}"),El+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),El+"__case_group__deleted","Deleted case #{{globalNoByType}}"),Ll,"{{str}} in case #{{caseNo}}"),_l,"{{str}} (index path: {{indexPath, list}})")),Pl="raqbvalidation",Vl="".concat(Pl,":"),xl=Yi.Ay.createInstance();xl.init({fallbackLng:"en"}),xl.addResources("en",Pl,Tl);var Il=function(e,t){return null!=e&&e.str?e.str:null!=e&&e.key?Il(e.key,e.args):null===t?e:xl.t(e.includes(":")?e:Vl+e,t)};const Dl=xl;function Rl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Nl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rl(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ql=function(e,t){var r,n,o,i,l=e.validateValue,a=e.validateRange,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,d=arguments.length>5?arguments[5]:void 0,p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]&&arguments[7],v=arguments.length>8&&void 0!==arguments[8]&&arguments[8],g=arguments.length>9&&void 0!==arguments[9]&&arguments[9];u||(u=t);var h=t.settings,m=h.keepInputOnChangeFieldSrc,y=h.convertableWidgets,b=h.clearValueOnChangeField,O=h.clearValueOnChangeOp,A="!case_value"==c,S=s.get("field");!S&&A&&(S=c);var F,j=s.get("fieldType"),E=s.get("fieldSrc"),C=s.get("operator"),L=s.get("value"),k=s.get("valueSrc",new _.Ay.List),T=s.get("valueType",new _.Ay.List),P=s.get("valueError",new _.Ay.List),V=s.get("asyncListValues"),x=A,I=$e(u,C),D=$e(t,d,c),R=A?1:C?X(I):null,N=A?1:d?X(D):null,q=Ue(u,S),M=Ue(t,c),W=!S&&j&&m,G=(null==q?void 0:q.type)||j,z=(null==M?void 0:M.type)||!c&&W&&G,B=null==q?void 0:q.listValuesType,U=null==M?void 0:M.listValuesType,$=(null===(r=S)||void 0===r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func"))||S,H=((null===(o=c)||void 0===o||null===(i=o.get)||void 0===i?void 0:i.call(o,"func"))||c)!=$,J=[],Y=(S||W)&&(C&&d||x)&&null!=L;if((!G||!z||G!=z||"field"===p&&H&&b||"operator"===p&&O)&&(Y=!1),H&&_e.includes(z)&&(U&&U===B||(Y=!1)),x||(null!=L&&L.size||!N)&&(null==L||!L.size||N)||(Y=!1),"func"===E&&c){var K=l(t,null,null,d,c,z,E,V,f,v,g),Q=(0,w.A)(K,2),Z=Q[0],ee=Q[1],te=!(null!=ee&&ee.length),re=Z!==c,ne=!te&&re&&!ee.find((function(e){return!e.fixed})),oe=f&&!te&&!ne&&!!p&&c!==S;if(oe?c=S:re&&(c=Z),!te){var ie=!te&&!ne&&!oe,le=ee.find((function(e){return!e.fixed&&!e.ignore}));ie&&le&&(F=Il(le)),ee.map((function(e){return J.push(Nl(Nl({side:"lhs"},e),{},{fixed:e.fixed||oe||false}))}))}}for(var ae=0;ae<N;ae++){var ue=k.get(ae)||null,se=Qe(u,S,C,ue),ce=Qe(t,c,d,ue),de="value"===ue?se:Qe(u,S,C,"value"),pe="value"===ue?ce:Qe(t,c,d,"value");pe==de||(y[de]||[]).includes(pe)||!de&&W||(Y=!1)}C!=d&&[C,d].includes("proximity")&&(Y=!1);var fe=k.first(),ve=He(t,c,d,null,fe),ge=Xe(t,c,d,null);!c&&W&&(ge=Object.keys(t.settings.valueSourcesInfo));var me,ye=ge[0];1===N&&ve&&void 0!==ve.type?me=ve.type:1===N&&M&&void 0!==M.type&&(me="!group"===M.type?"number":M.type);var be=Y&&"operator"===p&&1===R&&2===N,Oe=[],Ae=[],Se=[],Fe=Array.from({length:N},(function(){return null}));if(Y)for(var je=function(e){var r=L.get(e),n=T.get(e)||null,o=k.get(e)||null;be&&1===e&&(r=void 0!==Oe[0]?Oe[0]:L.get(0),Oe[e]=r,n=T.get(0)||null,o=k.get(0)||null);var i=!o||void 0!==ge.find((function(e){return e==o})),a=l(t,c,c,d,r,n,o,V,f,v,g),u=(0,w.A)(a,2),s=u[0],p=u[1],h=!(null!=p&&p.length),m=s!==r,y=!h&&m&&!(null!=p&&p.find((function(e){return!e.fixed}))),b=!(null!=p&&p.find((function(e){return!e.fixed&&!e.ignore}))),O=!i||f&&!h&&!y&&(!b||H);h||null==p||p.map((function(t){return J.push(Nl(Nl({side:"rhs",delta:e},t),{},{fixed:t.fixed||O}))})),O&&(Oe[e]=null,0===e&&delete Oe[1]);var A=!h&&!m,S=null==p?void 0:p.find((function(e){return!e.fixed&&!e.ignore}));A&&S&&(Fe[e]=Il(S)),m&&(Oe[e]=s),!be||0!==e||h||m||(be=!1),be&&0===e&&["func","field"].includes(o)&&(be=!1)},we=0;we<N;we++)je(we);if(!Y)for(var Ee=0;Ee<N;Ee++)if(1===N){var Ce,Le,ke=he([null==M?void 0:M.defaultValue,null==M||null===(Ce=M.fieldSettings)||void 0===Ce?void 0:Ce.defaultValue,null==ve?void 0:ve.defaultValue]);Oe[Ee]=ke,(null!=ke&&ke.func||null!=ke&&null!==(Le=ke.get)&&void 0!==Le&&Le.call(ke,"func"))&&(Ae[Ee]="func")}for(var Te=0;Te<N;Te++){var Pe,Ve,xe=Y&&k.get(Te)||null,Ie=Y&&T.get(Te)||null,De=void 0!==Oe[Te]?Oe[Te]:Y?L.get(Te):void 0;Y&&be&&1===Te&&(xe=null!==(Pe=Ae[Te])&&void 0!==Pe?Pe:k.get(0),Ie=null!==(Ve=Se[Te])&&void 0!==Ve?Ve:T.get(0),Ae[Te]=xe,Se[Te]=Ie),ge.includes(xe)||(Ae[Te]=ye),Ie||(Se[Te]=me),null!=De&&De.func&&(Oe[Te]=bt(De),Ae[Te]="func")}var Re=L;(Oe.length>0||!Y||N<R)&&(Re=new _.Ay.List(Array.from({length:N},(function(e,t){return void 0!==Oe[t]?Oe[t]:Y?L.get(t):void 0}))));var Ne=k;(Ae.length>0||!Y||N<R)&&(Ne=new _.Ay.List(Array.from({length:N},(function(e,t){var r;return null!==(r=Ae[t])&&void 0!==r?r:Y&&k.get(t)||null}))));var qe=T;(Se.length>0||!Y||N<R)&&(qe=new _.Ay.List(Array.from({length:N},(function(e,t){var r;return null!==(r=Se[t])&&void 0!==r?r:Y&&T.get(t)||null}))));var Me=a(t,c,d,Re,Ne);if(Me){var We=Il(Me),Ge=f&&N>=2,ze=Re;Ge&&(Oe[1]=Re.get(0),Re=Re.set(1,Oe[1]),Fe[1]=Fe[0]),!Ge&&Fe.push(We),J.push(Nl(Nl({side:"rhs",delta:-1},Me),{},{fixed:Ge,fixedFrom:Ge?[ze.get(0),ze.get(1)]:void 0,fixedTo:Ge?[Re.get(0),Re.get(1)]:void 0}))}var Be=P,Je=(null==P?void 0:P.size)!==Fe.length||Fe.filter((function(e,t){return e!=P.get(t)})).length>0;return Je&&(Be=new _.Ay.List(Fe)),{canReuseValue:Y,newValue:Re,newValueSrc:Ne,newValueType:qe,operatorCardinality:N,fixedField:c,newValueError:Be,newFieldError:F,validationErrors:J}};function Ml(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Wl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wl(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var zl=function(e,t){return null==e||""==e?void 0:W(e)?Gl(Gl({},e),{},{title:e.title||e.value}):{value:e,title:void 0!==t?t:""+e}},Bl=function(e){var t=zl(e);return W(t)?Gl(Gl({},zl(e)),{},{isCustom:!0}):t},Ul=function(e){if(Array.isArray(e))return e.map((function(e){return zl(e)}));if(!W(e))return e;var t=[];for(var r in e){var n=e[r];t.push(zl(r,n))}return t},$l=function(e,t){return Array.isArray(e)?e.map((function(e){return zl(e)})).find((function(e){return""+e.value==""+t})):void 0!==e[t]?zl(t,e[t]):void 0},Hl=function(e,t){if(null==e)return t;var r=$l(e,t);return void 0!==r?r.title:t},Jl=function(e,t){if(null==e)return t;var r=$l(e,t);return void 0!==r?r.value:t},Yl=function(e,t){var r=[];if(Array.isArray(e)){var n,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ml(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ml(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,l=t(zl(i));null!=l&&r.push(l)}}catch(e){o.e(e)}finally{o.f()}}else for(var a in e){var u=t(zl(a,e[a]));null!=u&&r.push(u)}return r},Kl=function(e,t){return Yl(t,(function(t){return-1!="".concat(t.value).indexOf(e)||-1!=t.title.indexOf(e)?t:null})).filter((function(e){return null!==e})).shift()},Ql=function(e,t){return Yl(t,(function(t){return""+t.value==""+e?t:null})).filter((function(e){return null!==e})).shift()};function Xl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xl(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ea=function(e,t){return 0===ta(e,t).length},ta=function(e,t){var r=t.settings.showErrorMessage,n=[];return e&&function e(t,o,i){var l,a,u=t.get("id"),s=t.get("children1"),c=t.getIn(["properties","valueError"]),d=t.getIn(["properties","fieldError"]),p=t.getIn(["properties","field"]),f=null!==(l=null==p||null===(a=p.get)||void 0===a?void 0:a.call(p,"func"))&&void 0!==l?l:p;((null==c?void 0:c.size)>0&&c.filter((function(e){return null!=e})).size>0||!!d)&&r&&n.push(f),s&&s.map((function(t,r){t&&e(t,o.concat(u),i+1)}))}(e,[],0),Array.from(new Set(n))},ra=function(e,t){var r=bn(t,void 0,!0),n={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=la(e,null,r,r,n),i=o.fixedTree,l=o.allErrors;return o.isSanitized&&l.length&&console.warn("Tree check errors: ",l),i},na=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=bn(t,void 0,!0),o=Zl(Zl({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1});return la(e,null,n,n,o).allErrors},oa=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=bn(t,void 0,!0),o=Zl({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),i=la(e,null,n,n,o);return{fixedTree:i.fixedTree,fixedErrors:i.fixedErrors,nonFixedErrors:i.nonFixedErrors,allErrors:i.allErrors}},ia=function(e,t,r,n,o,i,l){void 0===o&&(o=r.settings.removeEmptyGroupsOnLoad),void 0===i&&(i=r.settings.removeEmptyRulesOnLoad),void 0===l&&(l=r.settings.removeIncompleteRulesOnLoad);var a=la(e,t,r,n,{removeEmptyGroups:o,removeEmptyRules:i,removeIncompleteRules:l,forceFix:!1}),u=a.fixedTree,s=(a.allErrors,a.fixedErrors);return a.nonFixedErrors,a.isSanitized&&s.length&&console.warn("Fixed tree errors: ",s),st(u)},la=function(e,t,r,n,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var i,l,a=o||{},u=a.removeEmptyGroups,s=a.removeEmptyRules,c=a.removeIncompleteRules,d=a.forceFix,p=a.translateErrors,f=void 0===p||p,v=a.includeStringifiedItems,g=void 0===v||v,h=a.stringifyFixedItems,m=void 0!==h&&h,y=a.stringifyItemsUserFriendly,b=void 0===y||y,O=a.includeItemsPositions,A=void 0===O||O,S={errors:{}},F=sa(e,[],null,S,{config:r,oldConfig:n,removeEmptyGroups:u,removeEmptyRules:s,removeIncompleteRules:c,forceFix:d}),j=S.sanitized,w=[];for(var E in A&&(i=dt(F,r).items),S.errors){var C=S.errors[E],_=C.path,L=C.errors;f&&(L=L.map((function(e){return Zl(Zl({},e),{},{str:Il(e)})})));var k={path:_,errors:L};if(g){var T=lt(m?F:e,_);if(1!==_.length&&"group"!==T.get("type")){var P=Jo(T,r,b,!0);k.itemStr=P}}if(A){var V=i[E],x=!V;if(x&&(l||(l=dt(e,r).items),V=l[E]),V){var I=Zl(Zl({},V.position),{},{index:V.index,type:V.type,isDeleted:x});k.itemPosition=I;var D=V.index?El+"__"+V.type+(x?"__deleted":""):Cl,R=Zl({},I);if(b){for(var N,q=0,M=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];q<M.length;q++){var W=M[q];null!=R[W]&&(R[W]=R[W]+1)}R.indexPath=null===(N=I.indexPath)||void 0===N?void 0:N.map((function(e){return e+1}))}k.itemPositionStr=Il(D,R),V.index&&(V.caseId&&"case_group"!==V.type&&(k.itemPositionStr=Il(Ll,Zl(Zl({},R),{},{str:k.itemPositionStr}))),"case_group"!==V.type&&(k.itemPositionStr=Il(_l,Zl(Zl({},R),{},{str:k.itemPositionStr}))))}}w.push(k)}for(var G=[],z=[],B=0,U=w;B<U.length;B++){var $=U[B],H=$.errors.filter((function(e){return!!e.fixed})),J=$.errors.filter((function(e){return!e.fixed&&"EMPTY_QUERY"!==e.key}));H.length&&G.push(Zl(Zl({},$),{},{errors:H})),J.length&&z.push(Zl(Zl({},$),{},{errors:J}))}return{fixedTree:F,allErrors:w,fixedErrors:G,nonFixedErrors:z,isSanitized:j}};function aa(e,t,r,n){var o=t.get("id");e.errors[o]||(e.errors[o]={path:[].concat((0,E.A)(r),[o]),errors:[]}),e.errors[o].errors.push(n)}function ua(e,t){var r=t.get("id");e.errors[r]&&e.errors[r].errors.map((function(e){e.fixed=!0}))}function sa(e,t,r,n,o){var i=null==e?void 0:e.get("type");return"group"===i||"rule_group"===i||"case_group"==i||"switch_group"==i?function(e,t,r,n,o){var i,l,a,u,s,c,d=o.removeEmptyGroups,p=o.removeIncompleteRules,f=(o.forceFix,o.config),v=(f.settings.showErrorMessage,e.get("id")),g=e.get("children1"),h=!t.length,m=g,y=e.get("type"),b=e.get("properties"),O=null==b?void 0:b.get("field"),A=null==b?void 0:b.get("mode"),S=null==b||null===(i=b.get)||void 0===i?void 0:i.call(b,"operator"),F="rule_group"===y&&"array"===A,j="case_group"===y,w=j&&null==g,E=S?null!==(l=null===(a=f.operators[S])||void 0===a?void 0:a.cardinality)&&void 0!==l?l:1:void 0,C=j?!w:F?0==E:d,_=F||j;!v&&r&&(v=r,e=e.set("id",v),n.sanitized=!0),_&&(e=ca(e,t,r,n,o));var L={errors:{}},k=null===(s=g=null===(u=g)||void 0===u?void 0:u.map((function(e,r){return sa(e,t.concat(v),r,L,o)})))||void 0===s?void 0:s.filter((function(e){return null!=e}));d&&(g=k);var T=L.sanitized||(null==m?void 0:m.size)!=(null===(c=g)||void 0===c?void 0:c.size),P=d&&!h;return F&&O&&(P=p),!(null!=k&&k.size)&&C&&(aa(n,e,t,{key:h?Xi:j?Zi:F?Qi:Ki,args:{field:O},fixed:P}),P&&(ua(n,e),e=void 0)),T&&(n.sanitized=!0),T&&e&&(e=e.set("children1",g)),n.errors=Zl(Zl({},n.errors),(null==L?void 0:L.errors)||{}),e}(e,t,r,n,o):"rule"===i?ca(e,t,r,n,o):e}function ca(e,t,r,n,o){var i=o.removeIncompleteRules,l=o.removeEmptyRules,a=o.forceFix,u=o.config,s=o.oldConfig,c=u.settings.showErrorMessage,d=!c||a,p=e.get("id"),f="case_group"===e.get("type"),v=e.get("properties");if(!v){if(!f)return void aa(n,e,t,{key:ul,args:{},fixed:i||l});v=new _.Ay.Map}var g=v.get("field")||null;f&&(g="!case_value");var h=v.get("fieldSrc")||null,m=v.get("operator")||null,y=v.get("operatorOptions"),b=v.get("valueSrc"),O=v.get("value"),A=v.get("valueError"),S=v.get("fieldError"),F=function(){var e,t;return{field:(null===(e=g)||void 0===e||null===(t=e.toJS)||void 0===t?void 0:t.call(e))||g,fieldSrc:h,operator:m,operatorOptions:y?y.toJS():{},valueSrc:b?b.toJS():null,value:O?O.toJS():null,valueError:A?A.toJS():null,fieldError:S||null}},j=F();!p&&r&&(p=r,e=e.set("id",p),n.sanitized=!0);var w=g?Ue(u,g):null;g&&!w&&(aa(n,e,t,{key:el,args:{field:g},side:"lhs",fixed:i||l}),g=null),null!=g||f||(v=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce((function(e,t){return e.delete(t)}),v),m=null),h||!g||f||(h=Be(g),v=v.set("fieldSrc",h)),"range_between"!==m&&"range_not_between"!==m||(m="range_between"===m?"between":"not_between",v=v.set("operator",m));var E=m?$e(u,m,g):null;m&&!E&&(aa(n,e,t,{key:tl,args:{operator:m},side:"op",fixed:i||l}),m=null);var C=g?tt(u,g):[];g&&!f&&(null!=C&&C.length?m&&-1==C.indexOf(m)&&("is_empty"===m||"is_not_empty"===m?(m="is_empty"===m?"is_null":"is_not_null",v=v.set("operator",m)):(aa(n,e,t,{key:ll,args:{operator:m,field:g},side:"lhs",fixed:i||l}),m=null)):(aa(n,e,t,{key:il,args:{field:g},side:"lhs",fixed:i||l}),m=null)),null!=m||f||(v=["operatorOptions","valueSrc","value","valueError"].reduce((function(e,t){return e.delete(t)}),v)),y=v.get("operatorOptions"),!m||y&&!E.options?(y=null,v=v.delete("operatorOptions")):m&&!y&&E.options&&(y=At(u,m,g),v=v.set("operatorOptions",y)),b=v.get("valueSrc"),O=v.get("value");var L=ql({validateValue:da,validateRange:ga},u,s,v,g,m,null,d,!0),k=L.newValue,T=L.newValueSrc,P=L.newValueError,V=L.validationErrors,x=L.newFieldError,I=L.fixedField;O=k,b=T,A=P,S=x,g=I,v=(v=(v=v.set("field",g)).set("value",O)).set("valueSrc",b),v=c?v.set("valueError",A).set("fieldError",S):v.delete("valueError").delete("fieldError");var D=F(),R=!Z(j,D),N=Ut(v.toObject(),u),q=f?N.parts.value:N.score>=3;if(R&&(n.sanitized=!0,e=e.set("properties",v)),null==V||V.map((function(r){return aa(n,e,t,r)})),!q)if(f);else{var M=N.score?i:l,W={key:ul,args:{}};if(N.parts.field){if(!N.parts.value){var G,z,B,U;W.key=cl,W.side="rhs",null!==(G=D.valueSrc)&&void 0!==G&&G[0]&&(null===(z=D.valueSrc)||void 0===z?void 0:z[0])!=(null===(B=j.valueSrc)||void 0===B?void 0:B[0])&&null!=(null===(U=D.value)||void 0===U?void 0:U[0])&&(W.key=al,W.args={valueSrcs:D.valueSrc})}}else W.key=sl,W.side="lhs";W.fixed=M,aa(n,e,t,W),M&&(ua(n,e),e=void 0)}return e}var da=function(e,t,r,n,o,i,l,a){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],s=arguments.length>9&&void 0!==arguments[9]&&arguments[9],c=arguments.length>10&&void 0!==arguments[10]&&arguments[10],d=[],p=o;if(null!=o){var f,v,g,h;if("field"===l){var m=fa(t,r,o,l,i,a,e,n,u,s),y=(0,w.A)(m,2);p=y[0],d=y[1]}else if("func"===l){var b=va(t,r,o,l,i,a,e,n,u,s,c),O=(0,w.A)(b,2);p=O[0],d=O[1]}else if("value"===l||!l){var A=pa(r,o,l,i,a,e,n,u,s),S=(0,w.A)(A,2);p=S[0],d=S[1]}var F=!(null!==(f=d)&&void 0!==f&&f.find((function(e){return!e.fixed})));if(r&&!["field","func"].includes(l)&&(null===(v=d)||void 0===v||!v.length||F)){var j=Qe(e,r,n,l),E=n?$e(e,n,r):null,_=He(e,r,n,j,l,{forExport:!0}),L="field"===l?Ue(e,o):null,k=_,T=_.validateValue;if("function"==typeof T){var P=[p,k,n,E];"field"===l&&P.push(L);var V,x,I=T.call.apply(T,[e.ctx].concat(P));"object"!==(0,C.A)(I)||null===I||Array.isArray(I)?"boolean"==typeof I?0==I&&d.push({key:nl,args:{}}):"string"==typeof I&&d.push({key:I,args:null}):(x=null!==(V=I.error)&&void 0!==V&&V.key?Zl({},I.error):{key:I.error,args:null},void 0!==I.fixedValue&&u&&(x.fixed=!0,x.fixedFrom=p,x.fixedTo=I.fixedValue,p=I.fixedValue),d.push(x))}}if(F=!(null!==(g=d)&&void 0!==g&&g.find((function(e){return!e.fixed}))),null!==(h=d)&&void 0!==h&&h.length&&!F&&u){var D=Ue(e,r),R=null==D?void 0:D.fieldSettings,N=null==R?void 0:R.defaultValue;if(void 0!==N){var q=d[d.length-1];q.fixed=!0,q.fixedFrom=p,q.fixedTo=N,p=N,d.map((function(e){e.fixed=!0}))}}}return[p,d]},pa=function(e,t,r,n,o,i){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=[],s=t;if(e){var c=Ue(i,e),d=Qe(i,e,l,r),p=i.widgets[d],f=null==p?void 0:p.type,v=null==p?void 0:p.jsType,g=null==c?void 0:c.fieldSettings,h=(null==g?void 0:g.treeValues)||(null==g?void 0:g.listValues),m=!(null==g||!g.asyncFetch),y=h||m;if(n&&f&&n!=f)return u.push({key:fl,args:{wType:f,valueType:n}}),[t,u];if(v&&!B(t,v)&&!y)return u.push({key:vl,args:{jsType:v,valueTypeof:z(t)}}),[t,u];if(g){var b=o||h;if(b&&!g.allowCustomValues&&"case_value"!==d){var O=function(e,t,r,n,o){var i=_.Ay.List.isList(e)?e.toJS():e instanceof Array?(0,E.A)(e):void 0,l=e,a=[];if(i){var u=i.reduce((function(e,r){var n=(0,w.A)(e,2),o=n[0],i=n[1],l=$l(t,r);return null==l?[o,[].concat((0,E.A)(i),[r])]:[[].concat((0,E.A)(o),[l.value]),i]}),[[],[]]),s=(0,w.A)(u,2),c=s[0],d=s[1],p=d.length>0;if(l=(r=r||!0===o)&&p?c:e,d.length){var f=r&&p;a.push({key:dl,args:{badValues:d,count:d.length},fixed:f,fixedFrom:f?i:void 0,fixedTo:f?l:void 0})}return[l,a]}var v=$l(t,e);return null==v?(l=r?null:e,a.push({key:pl,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?l:void 0})):l=v.value,[l,a]}(t,b,a,0,i.settings.removeInvalidMultiSelectValuesOnLoad),A=(0,w.A)(O,2);s=A[0],u=A[1]}g.maxLength>0&&null!=t&&String(t).length>g.maxLength&&(s=a?String(t).substring(0,g.maxLength):t,u.push({key:gl,args:{value:t,length:String(t).length,fieldSettings:g},fixed:a,fixedFrom:a?t:void 0,fixedTo:a?s:void 0}));var S=null!=g.min&&null!=g.max?kl:void 0;null!=g.min&&t<g.min&&(s=a?g.min:t,u.push({key:hl,args:{value:t,fieldSettings:g,context:S},fixed:a,fixedFrom:a?t:void 0,fixedTo:a?s:void 0})),null!=g.max&&t>g.max&&(s=a?g.max:t,u.push({key:ml,args:{value:t,fieldSettings:g,context:S},fixed:a,fixedFrom:a?t:void 0,fixedTo:a?s:void 0}))}}return[s,u]},fa=function(e,t,r,n,o,i,l){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=[],s=l.settings,c=s.fieldSeparator,d=s.canCompareFieldWithField,p="object"==(0,C.A)(t)&&(null==t?void 0:t._isFuncArg),f=Array.isArray(e)?e.join(c):e,v=Ue(l,e),g=Array.isArray(r)?r.join(c):r,h=Ue(l,r);return h?e&&g===f&&!p?(u.push({key:bl,args:{field:f}}),[r,u]):o&&o!=h.type?(u.push({key:Al,args:{field:g,type:h.type,expected:o}}),[r,u]):e&&!p&&d&&!d(f,v,g,h,a)?(u.push({key:Ol,args:{leftField:f,rightField:g}}),[r,u]):[r]:(u.push({key:yl,args:{field:g}}),[r,u])},va=function(e,t,r,n,o,i,l){var a,u,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9&&void 0!==arguments[9]&&arguments[9],p=arguments.length>10&&void 0!==arguments[10]&&arguments[10],f=r,v=[];if(!r)return[r];var g=null===(a=r.get)||void 0===a?void 0:a.call(r,"func");if(!g)return[r];var h=Ue(l,t);if(null!=h&&h.funcs&&!h.funcs.includes(g))return v.push({key:Sl,args:{funcKey:g,field:t}}),[r,v];var m=Ie(l,g);if(!m)return v.push({key:rl,args:{funcKey:g}}),[r,v];var y=null!==(u=m.label)&&void 0!==u?u:g;if(o&&m.returnType!=o)return v.push({key:jl,args:{funcKey:g,funcName:y,returnType:m.returnType,valueType:o}}),[r,v];for(var b in c=c||p,m.args){var O,A=m.args[b],S=f.get("args"),F=S?S.get(b):void 0,j=Ue(l,A),E=null!==(O=null==j?void 0:j.label)&&void 0!==O?O:b,C=F?F.get("value"):void 0,_=F?F.get("valueSrc"):void 0;if(void 0!==C){var L=da(l,e,j,s,C,A.type,_,i,c,d,p),k=(0,w.A)(L,2),T=k[0],P=k[1],V=!(null!=P&&P.length),x=c&&T!==C,I=c&&!V&&!x&&(d||p);if(x&&(f=f.setIn(["args",b,"value"],T)),I&&(f=f.deleteIn(["args",b]),f=Zt(l,f,m,b)),!V){var D,R,N=null!==(D=null!==(R=P.find((function(e){return!e.fixed&&!e.ignore})))&&void 0!==R?R:P.find((function(e){return!e.fixed})))&&void 0!==D?D:P[0],q=x||I,M=0===P.filter((function(e){return!e.ignore})).length;if(N){var W=Il(N);v.push({key:ol,args:{funcKey:g,funcName:y,argKey:b,argName:E,argValidationError:W,argErrors:P},ignore:M,fixed:q,fixedFrom:q?C:void 0,fixedTo:q?x?T:A.defaultValue:void 0})}}}else if(!A.isOptional&&(d||p)){var G=c&&void 0!==A.defaultValue&&(d||p);d&&v.push({key:Fl,args:{funcKey:g,funcName:y,argKey:b,argName:E},fixed:G,fixedTo:G?A.defaultValue:void 0,ignore:!G}),G&&(f=f.deleteIn(["args",b]),f=Zt(l,f,m,b))}}return[f,v]},ga=function(e,t,r,n,o){var i,l=$e(e,r,t),a=r?X(l):null,u=o.toJS?o.toJS():o,s=n.toJS?n.toJS():n,c=u.filter((function(e){return"value"==e||null==e})).length==a;if(null!=l&&l.validateValues&&c){var d=u[0],p=Qe(e,t,r,d),f=He(e,t,r,p,d),v=null!=f&&f.toJS?s.map((function(t){var r=f.toJS.call(e.ctx,t,f);return r instanceof Date&&(r=r.getTime()),r})):s,g=l.validateValues(v);"boolean"==typeof g&&0==g&&(i={key:wl,args:{jsValues:v,values:s}})}return i},ha=function(e,t,r,n){var o=r.settings.fieldSeparator;e=e||new _.Ay.Map,Array.isArray(t)&&(t=t.join(o));var i=e.get("func"),l=e.get("args");e=e.set("func",t);var a=t&&Ie(r,t),u=t&&xe(r,t),s=i&&xe(r,i),c=ba(s,u,l,r,n);return e=c.length?Object.keys(u.args).filter((function(e){return!c.includes(e)})).reduce((function(e,t){return e.deleteIn(["args",t])}),e):e.set("args",new _.Ay.Map),Xt(r,e,a)},ma=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new _.Ay.Map({valueSrc:r}))),e},ya=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t,"asyncListValues"],r)),e},ba=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return(null==e?void 0:e.returnType)!=(null==t?void 0:t.returnType)?[]:Object.keys(t.args).filter((function(i,l){var a=t.args[i],u=e.args[i];if(Object.keys(e.args).indexOf(i),!u&&(void 0!==a.defaultValue||a.isOptional))return!0;if((null==u?void 0:u.type)!=a.type)return!1;if(_e.includes(a.type)&&(!u.listValuesType||u.listValuesType!==a.listValuesType))return!1;if(r){var s,c=r.get(i),d=null==c?void 0:c.get("value"),p=null==c?void 0:c.get("valueSrc");if(p&&a.valueSources&&!a.valueSources.includes(p))return!1;var f=da(n,null,a,null,d,a.type,p,null,o,!0),v=(0,w.A)(f,2),g=(v[0],v[1]);if(null!=g&&null!==(s=g.filter((function(e){return!e.fixed})))&&void 0!==s&&s.length)return!1}return!0}))};function Oa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Aa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oa(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Sa=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=null,s=null,c=null,d=e.settings.showErrorMessage;i?(c=null==i||null===(t=i.properties)||void 0===t?void 0:t.fieldSrc,u=null==i||null===(r=i.properties)||void 0===r?void 0:r.field,s=null==i||null===(n=i.properties)||void 0===n?void 0:n.operator):l?(c=(u=jt(e,a,o))?te(u)?"func":"field":Et(e),s=Ct(e,u,!0)):c=Et(e);var p=new _.Ay.Map({fieldSrc:c,field:u,operator:s,value:new _.Ay.List,valueSrc:new _.Ay.List,operatorOptions:At(e,s,u)});if(d&&(p=p.set("valueError",new _.Ay.List)),u&&s){var f=ql({validateValue:da,validateRange:ga},e,e,p,u,s,"operator",!1),v=f.newValue,g=f.newValueSrc,h=f.newValueType,m=f.newValueError,y=f.newFieldError;p=p.set("value",v).set("valueSrc",g).set("valueType",h),d&&(p=p.set("valueError",m).set("fieldError",y))}var b=Ue(e,u);if("!group"===(null==b?void 0:b.type)){var O=St(e,b);p=p.set("conjunction",O)}return p},Fa=function(e,t){return"group"==(null==t?void 0:t.type)?Ft(e):Sa(e,null,t)},ja=function(e,t){return(0,j.A)({},e,new _.Ay.Map({type:"rule",id:e,properties:Sa(t)}))},wa=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new _.Ay.Map({type:"group",id:k(),children1:new _.Ay.OrderedMap(t?Aa({},ja(k(),e)):{}),properties:Ft(e)})},Ea=r(9885),Ca=r(8691),_a=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function La(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ka(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ta(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ka(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return function(){var n=(0,Ca.A)(be().mark((function n(o,i,l){var a,u,s,c,d,p,f;return be().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r){n.next=3;break}return n.next=3,de(r);case 3:if(null==l||!l.fetchSelectedValues||!Array.isArray(o)){n.next=7;break}return a=Ul(e).filter((function(e){var t=e.value;return o.includes(t)})),n.abrupt("return",{values:a});case 7:return u=null!=(null==l?void 0:l.pageSize)?l.pageSize:t,s=Ul(e).filter((function(e){var t=e.title,r=e.value;return null==o||-1!=t.toUpperCase().indexOf(o.toUpperCase())||-1!="".concat(r).toUpperCase().indexOf(o.toUpperCase())})),u&&Math.ceil(s.length/u),c=i||0,u&&Math.ceil(c/u),d=u?s.slice(c,c+u):s,p=u?c+d.length:null,f=!!u&&p<s.length,n.abrupt("return",{values:d,hasMore:f});case 16:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}()},Va=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)return e;var o=e||[],i=t.filter((function(e){return null==o.find((function(t){return""+t.value==""+e.value}))})).map((function(e){return n?Ta(Ta({},e),{},{isHidden:!0}):e}));return r?[].concat((0,E.A)(i),(0,E.A)(o)):[].concat((0,E.A)(o),(0,E.A)(i))},xa=function(e,t,r){var n,o=null==e||""==e?void 0:null!==(n=null==e?void 0:e.value)&&void 0!==n?n:e,i=Ql(o,t),l=r&&!i?Bl(o):void 0,a=i||l;return[o,a?[a]:void 0]},Ia=function(e,t,r){var n=e.map((function(e,n){var o,i=null==e||""==e?void 0:null!==(o=null==e?void 0:e.value)&&void 0!==o?o:e,l=Ql(i,t),a=r&&!l?Bl(i):void 0;return l||a})).filter((function(e){return null!=e})),o=n.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e}));return o.length||(o=void 0),[o,n]},Da=function(e){if(null==e)return null;var t=e.title,r=e.value,n=e.disabled,o=e.groupTitle,i=e.grouplabel,l=e.renderTitle,a=e.children,u=e.label,s=e.isCustom,c=e.isHidden,d=(0,Ea.A)(e,_a),p={value:r,title:t||u||a};return n&&(p.disabled=n),s&&(p.isCustom=s),c&&(p.isHidden=c),(o||i)&&(p.groupTitle=o||i),l&&(p.renderTitle=l),Ta(Ta({},p),d)},Ra=function(e){var t,r=[],n=[],o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return La(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?La(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{var i=function(){var e=t.value,o=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=(0,E.A)(e).reverse().findIndex(t);return-1==r?-1:e.length-1-r}(r,(function(t){var r,n;return(null!==(r=t.groupTitle)&&void 0!==r?r:"")==(null!==(n=e.groupTitle)&&void 0!==n?n:"")}));null==e.groupTitle||n.includes(e.groupTitle)||(n.push(e.groupTitle),1===n.length&&(r=r.map((function(e){return Ta(Ta({},e),{},{groupTitle:""})})))),null==e.groupTitle&&n.length&&(e=Ta(Ta({},e),{},{groupTitle:""})),-1!=o?r.splice(o+1,0,e):r.push(e)};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}return r};function Na(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Na(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Na(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ma(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Wa(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Wa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ga=Le,za=me,Ba=["between","not_between","is_empty","is_not_empty","is_null","is_not_null","some","all","none"],Ua=["proximity"],$a=function(e,t){var r,n=[],o="",i=e.type,l=e.methodName,a=(e.val,e.obj),u=e.args,s=e.isVar,c=e.cls,d=e.children,p=null==d?void 0:d[d.length-1],f=t[t.length-1];if("!func"===i){for(var v=a;v;){var g,h=$a(qa(qa({},v),{},{obj:null}),[{}]),m=(0,w.A)(h,2),y=m[0],b=m[1];if("?"!==y){var O={s:f.s,params:(0,E.A)(f.params),objs:(0,E.A)(f.objs)};f.objs.unshift("?"),f.params.unshift(v),t.push(O),f=t[t.length-1]}f.objs.unshift(y),(g=f.params).unshift.apply(g,(0,E.A)(b)),v="!func"===v.type?v.obj:null}var A,S=Ma(t);try{for(S.s();!(A=S.n()).done;){var F,j=A.value;n=[].concat((0,E.A)((null==j?void 0:j.params)||[]),(0,E.A)(u||[])),o="",null!=j&&null!==(F=j.objs)&&void 0!==F&&F.length&&(o+=j.objs.join(".")+"."),o+=(s?"#":"")+l,o+="("+(u||[]).map((function(e){return"?"})).join(", ")+")",j.s=o,j.params=n}}catch(e){S.e(e)}finally{S.f()}}else"!new"===i?(n=u||[],o="new ".concat(c.join("."),"(").concat(n.map((function(e){return"?"})).join(", "),")")):"!type"===i?o="T(".concat(c.join("."),")"):"compound"===i&&"property"===p.type&&(r=p.val,["length"].includes(r))?o=d.map((function(e){var t;if(e===p)return e.val;var r=$a(qa(qa({},e),{},{obj:null}),[{}]),o=(0,w.A)(r,2),i=o[0],l=o[1];return(t=n).push.apply(t,(0,E.A)(l)),i})).join("."):(n=[e],o="?");return f&&(f.s=o,f.params=n),[o,n]};function Ha(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ja(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ha(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ha(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ya=n.isObject,Ka=n.uuid,Qa=h.defaultConjunction,Xa=p.getFieldConfig,Za=p.getWidgetForFieldOp,eu=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:Ka(),children1:(0,j.A)({},e.id,e),properties:{conjunction:Qa(t),not:r||!1}}},tu=function(e,t,r,n,o){var i,l=nu(n,o,r,t,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null);return e?(i=e).type?("group"!=i.type&&"case_group"!=i.type&&(i=eu(i,n)),i.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(i))),i=void 0):i={id:Ka(),type:"case_group",properties:{}},i&&(i.properties=Ja(Ja({},i.properties),l)),i},ru=function(e,t,r,n){var o={},i=tu(null,e,t,r,n);return i&&(o[i.id]=i),{type:"switch_group",id:Ka(),children1:o,properties:{}}},nu=function(e,t,r,n){var o,i,l,a={},u=Xa(e,"!case_value");"case_value"===(null==n?void 0:n.valueType)?o="case_value":(o=null==u?void 0:u.mainWidget,i=e.widgets[o],n&&"value"===n.valueSrc&&(n.valueType=(null===(l=i)||void 0===l?void 0:l.type)||(null==u?void 0:u.type)||n.valueType));var s=e.widgets[o];if("case_value"===o){var c=null==s?void 0:s.spelImportValue;if(c){var d,p=c.call(e.ctx,n),f=(0,w.A)(p,2),v=f[0];f[1].map((function(e){return t.errors.push(e)})),null!=v&&(a={value:[v],valueSrc:["value"],valueType:[null!==(d=null==s?void 0:s.type)&&void 0!==d?d:"case_value"],field:"!case_value"})}}else null!=n&&null!=(null==n?void 0:n.value)&&(a={value:[n.value],valueSrc:[n.valueSrc],valueType:[n.valueType],field:"!case_value"});return a},ou=function(e,t,r,n,o,i){var l,a;if(!o.filter((function(e){return void 0===e})).length){var u=null!==(l=r)&&void 0!==l&&l.func?"func":"field";Ya(r)&&r.valueSrc&&(u=r.valueSrc,r=r.value);var s=Xa(e,r);if(s){var c=Xa(e,null==i?void 0:i._groupField),d="!group"==s.type,p=(d&&s.mode,"!group"==(null==c?void 0:c.type)),f=e.operators[n],v=e.operators[null===(a=f)||void 0===a?void 0:a.reversedOp],g=(null==i?void 0:i.not)&&["between"].includes(n),h=!!v&&(!!e.settings.reverseOperatorsForNot||g||!d&&p);((null==i?void 0:i.not)&&h||g)&&(n=f.reversedOp,f=e.operators[n],i.not=!i.not);var m=!(null==i||!i.not),y=Za(e,r,n),b=e.widgets[y||s.mainWidget],O=o.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),A=O.length?O[0]:void 0,S={type:"rule",id:Ka(),properties:Ja({field:r,fieldSrc:u,operator:n,value:o.map((function(e){return e.value})),valueSrc:o.map((function(e){return e.valueSrc})),valueType:o.map((function(e){return"value"==e.valueSrc&&((null==b?void 0:b.type)||(null==s?void 0:s.type))||e.valueType}))},A?{asyncListValues:A}:{})};return m&&(S=eu(S,e,i.not)),S}t.errors.push("No config for field ".concat(r))}};function iu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?iu(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var au=me,uu=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e.getType(),i=e.getChildren().map((function(r){return uu(r,t,e)}));if("op-or"!=o&&"op-and"!=o||(i=i.reduce((function(e,t){var r="op-and"==t.type&&2==t.children.length&&"op-ge"==t.children[0].type&&"op-le"==t.children[1].type,n="op-or"==t.type&&2==t.children.length&&"op-lt"==t.children[0].type&&"op-gt"==t.children[1].type,i=r||n,l=t.type!=o||t.not||i?[t]:t.children;return[].concat((0,E.A)(e),(0,E.A)(l))}),[])),"op-not"==o)return 1!=i.length&&t.errors.push("Operator NOT should have 1 child, but got ".concat(i.length,"}")),lu(lu({},i[0]),{},{not:!i[0].not});if("compound"==o){var l=(i=i.filter((function(e){return!("selection"==e.type&&1==e.children.length&&"boolean"==e.children[0].type&&1==e.children[0].val)}))).find((function(e){return"selection"==e.type}));l&&1!=l.children.length&&t.errors.push("Selection should have 1 child, but got ".concat(l.children.length));var a=l?l.children[0]:null,u=i[i.length-1],s="method"==u.type&&"size"==u.val.methodName||"!func"==u.type&&"size"==u.methodName,c="property"==u.type&&"length"==u.val,d=i.filter((function(e){return e!==l&&e!==u})),p={type:"compound",children:d};if((s||c)&&null!=cu(d))return{type:"!aggr",filter:a,source:p};if(i=(i=i.filter((function(e){var t="variable"==e.type&&"this"==e.val,r="variable"==e.type&&"root"==e.val;return!(t||r)}))).map((function(e){return"indexer"==e.type&&1==e.children.length?{type:"indexer",val:e.children[0].val,itype:e.children[0].type}:e})),"!func"==u.type){var f={},v=f;do{var g,h;Object.assign(v,u),i=i.filter((function(e){return e!==u})),"!func"==(null===(g=u=i[i.length-1])||void 0===g?void 0:g.type)?(v.obj={},v=v.obj):i.length>1?v.obj={type:"compound",children:i}:v.obj=u}while("!func"==(null===(h=u)||void 0===h?void 0:h.type));return f}}try{e.getRaw?r=e.getRaw():0==e.getValue.length&&(r=e.getValue())}catch(e){au.error("[spel2js] Error in getValue()",e)}if("ternary"==o&&(r=su(i)),"object"===(0,C.A)(r)&&null!==r&&(r.methodName||r.functionName)&&(r.args=r.args.map((function(r){return uu(r,t,e)}))),"list"==o&&(r=r.map((function(r){return uu(r,t,e)})),!n&&1==r.length))return r[0];if("constructorref"==o){var m=i.find((function(e){return"qualifiedidentifier"==e.type})),y=null==m?void 0:m.val;return y?{type:"!new",cls:y,args:i.filter((function(e){return"qualifiedidentifier"!=e.type}))}:void t.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(i)))}if("typeref"==o){var b=i.find((function(e){return"qualifiedidentifier"==e.type})),O=null==b?void 0:b.val;return O?(i.filter((function(e){return"qualifiedidentifier"!=e.type})),{type:"!type",cls:O}):void t.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(i)))}if("function"==o||"method"==o){var A=r,S=A.functionName,F=A.methodName,j=A.args;return{type:"!func",methodName:S||F,isVar:"function"==o,args:j}}return{type:o,children:i,val:r}},su=function(e){var t=[];return function e(r){var n=(0,w.A)(r,3),o=n[0],i=n[1],l=n[2];t.push([o,i]),"ternary"==(null==l?void 0:l.type)?e(l.children):t.push([void 0,l])}(e),t},cu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=e.map((function(e){if("variable"==e.type||"property"==e.type||"indexer"==e.type&&"string"==e.itype)return e.val;var o,i;n=!0,r&&(null==t||null===(o=t.errors)||void 0===o||null===(i=o.push)||void 0===i||i.call(o,"Unexpected item in field path compound: ".concat(JSON.stringify(e))))}));return n?void 0:o};function du(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return pu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function fu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fu(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var gu=n.isJsonCompatible,hu=n.isObject,mu=n.uuid,yu=n.logger,bu=p.getFieldConfig,Ou=p.getFuncConfig,Au=p.normalizeField,Su=p.iterateFuncs,Fu=p.getWidgetForFieldOp,ju={number:"number",string:"text",boolean:"boolean",null:"null"},wu={String:"text"},Eu=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(e){e._groupField=null!==(o=e._groupField)&&void 0!==o?o:null==i?void 0:i._groupField;var l,a=!0;if(0===e.type.indexOf("op-")||"matches"===e.type)l=Cu(e,t,r,n,i);else if("!aggr"==e.type){var u,s=Eu(e.source,t,r,n,e);e._groupField=null==s?void 0:s.value;var c=Eu(e.filter,t,r,n,e);"rule"==(null===(u=c)||void 0===u?void 0:u.type)&&(c=eu(c,r,e.filter.not)),l={groupFilter:c,groupFieldValue:s},i||(l=void 0,n.errors.push("Unexpected !aggr in root"),a=!1)}else if("ternary"==e.type){var d={};e.val.forEach((function(o){var i=(0,w.A)(o,2),l=i[0],a=i[1],u=Eu(l,t,r,n,e),s=Vu(a,t,r,n,e),c=tu(u,s,t,r,n,e);c&&(d[c.id]=c)})),l={type:"switch_group",id:mu(),children1:d,properties:{}}}if(!l&&a&&(l=_u(e,t,r,n,i)),l&&!l.type&&!i){var p=Vu(e,t,r,n),f=ru(p,t,r,n);f?l=f:(l=void 0,n.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return l}},Cu=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=e.type.startsWith("op-")?e.type.slice(3):e.type;if(("minus"==l||"plus"==l)&&1==e.children.length){var a=e.negative;return"minus"==l&&(a=!a),e.children[0].negative=a,Eu(e.children[0],t,r,n,i)}var u="and"==l&&2==e.children.length&&"op-ge"==e.children[0].type&&"op-le"==e.children[1].type,s="or"==l&&2==e.children.length&&"op-lt"==e.children[0].type&&"op-gt"==e.children[1].type;if(u||s){var c=(0,w.A)(e.children[0].children,2),d=c[0],p=c[1],f=(0,w.A)(e.children[1].children,2),v=f[0],g=f[1];if(Pu(d,v,e,t,r,n,i)){p.val,g.val;var h={type:"op-between",children:[d,p,g],not:s};return h._groupField=null==i?void 0:i._groupField,Cu(h,t,r,n,i)}}var m=t.operators[l];"eq"==l&&"null"==e.children[1].type?m=["is_null"]:"ne"==l&&"null"==e.children[1].type?m=["is_not_null"]:"le"==l&&"string"==e.children[1].type&&""==e.children[1].val?m=["is_empty"]:"gt"==l&&"string"==e.children[1].type&&""==e.children[1].val?m=["is_not_empty"]:"between"==l&&(m=["between"]);var y=function(){var o,i=e.children.map((function(o){return Eu(o,t,r,n,e)}));return i.length>=2&&"!compare"==(null===(o=i)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.type)&&(i=i[0].children),i};if("and"==l||"or"==l){var b={};y().forEach((function(e){if(e){var t=mu();e.id=t,null!=e.type?b[t]=e:n.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(e)))}})),o={type:"group",id:mu(),children1:b,properties:{conjunction:t.conjunctions[l],not:e.not}}}else if(m){var O,A,S,F=y(),j=F[0],E=F.slice(1),C=null==j||null===(O=j.groupFieldValue)||void 0===O?void 0:O.value,_=null===(A=E)||void 0===A?void 0:A[0],L=m[0];if(m.length>1){var k,T,P=(null===(k=F[0])||void 0===k?void 0:k.valueType)||(null===(T=F[1])||void 0===T?void 0:T.valueType),V=null==j?void 0:j.value,x=m.map((function(e){return{op:e,widget:Fu(r,V,e)}}));if("eq"==l||"ne"==l){var I=x.find((function(e){e.op;var t=e.widget;return t&&"field"!=t}));I&&(L=I.op)}else yu.warn("[spel] Spel operator ".concat(l," can be mapped to ").concat(m,"."),"widgets:",x,"vals:",F,"valueType=",P)}null!=j&&j.groupFieldValue&&(_&&_.groupFieldValue&&"field"==_.groupFieldValue.valueSrc&&_.groupFieldValue.value==C?(L="all",E=[]):"equal"==L&&"value"==_.valueSrc&&"number"==_.valueType&&0==_.value?(L="none",E=[]):"greater"==L&&"value"==_.valueSrc&&"number"==_.valueType&&0==_.value&&(L="some",E=[]));var D=r.operators[L],R=r.operators[null===(S=D)||void 0===S?void 0:S.reversedOp],N=e.not&&["between"].includes(L),q=!!R&&(!!r.settings.reverseOperatorsForNot||N);(e.not&&q||N)&&(L=D.reversedOp,D=r.operators[L],e.not=!e.not);var M=!!e.not;if(e.not=!1,j)if(j.groupFieldValue)"field"!=j.groupFieldValue.valueSrc&&n.errors.push("Expected group field ".concat(JSON.stringify(j))),o=function(e,t,r,n,o){var i=e.groupFilter,l=e.groupFieldValue;if("field"!=l.valueSrc)throw"Bad groupFieldValue: ".concat(JSON.stringify(l));var a=l.value,u=ou(n,o,a,t,r);if(u){var s,c=Xa(n,a),d=null==c?void 0:c.mode;return(s="group"===(null==i?void 0:i.type)?Ja(Ja({},i||{}),{},{type:"rule_group",properties:Ja(Ja(Ja({},u.properties),(null==i?void 0:i.properties)||{}),{},{mode:d})}):Ja(Ja({},u||{}),{},i?{type:"rule_group",children1:[i],properties:Ja(Ja({},u.properties),{},{mode:d})}:{type:"rule_group",properties:Ja(Ja({},u.properties),{},{mode:d})})).id||(s.id=Ka()),s}}(j,L,E,r,n);else{"field"!=j.valueSrc&&"func"!=j.valueSrc&&n.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(j)));var W=j.value;o=ou(r,n,W,L,E,e)}M&&("group"!==o.type?o=eu(o,r,!0):o.properties.not=!o.properties.not)}else if(!i){var G=Vu(e,t,r,n);o=ru(G,t,r,n)}return o},_u=function(e,t,r,n){var o,i,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null!=e){var a=r.settings.fieldSeparator;if(e._groupField=null!==(o=e._groupField)&&void 0!==o?o:null==l?void 0:l._groupField,"variable"==e.type||"property"==e.type){var u=Au(r,e.val,e._groupField),s=bu(r,u),c="variable"==e.type;return{valueSrc:"field",valueType:null==s?void 0:s.type,isVariable:c,value:u}}if("compound"==e.type){var d=cu(e.children,n);if(d){var p,f=Au(r,d.join(a),e._groupField),v=bu(r,f),g="variable"==(null===(p=e.children)||void 0===p||null===(p=p[0])||void 0===p?void 0:p.type);return{valueSrc:"field",valueType:null==v?void 0:v.type,isVariable:g,value:f}}}else{if(ju[e.type]){var h=e.val,m=ju[e.type];return e.negative&&(h=-h),{valueSrc:"value",valueType:m,value:h}}if("!new"==e.type&&wu[e.cls.at(-1)]){var y=e.args.map((function(o){return _u(o,t,r,n,e)})),b=null==y?void 0:y[0],O=wu[e.cls.at(-1)];return vu(vu({},b),{},{valueType:O})}if("list"==e.type){var A,S=e.val.map((function(o){return _u(o,t,r,n,e)}));return S.length&&(null===(A=S[0])||void 0===A||A.valueType),{valueSrc:"value",valueType:"multiselect",value:S.map((function(e){return null==e?void 0:e.value}))}}if("op-plus"===e.type&&"ternary"===(null==l?void 0:l.type)&&"case_value"===(null===(i=r.settings.caseValueField)||void 0===i?void 0:i.type))return xu(e,t,r,n)}var F=Lu(e,t,r,n,l);if(void 0!==F)return F;n.errors.push("Can't convert arg of type ".concat(e.type))}},Lu=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=function(o){return Eu(o,t,r,n,e)},a=function(e){var t=[{s:"",params:[],objs:[]}];return $a(e,t),t.map((function(e){return{s:e.s,params:e.params}})).reverse().filter((function(e){var t=e.s;return""!==t&&"?"!==t}))}(e),u=null==a||null===(o=a[0])||void 0===o?void 0:o.s;a.length&&yu.debug("Signatures for ",e,":",u,a);var s=ku(e,t,r,n,i,a,l);if(void 0!==s)return s;var c,d,p,f=Tu(e,t,r,n,i,a,l);if(void 0!==f)return f;var v,g=du(a);try{var h=function(){var e=v.value,n=e.s,o=e.params,i=t.funcs[n];if(i){c=i[0];var a=(d=Ou(r,c)).spelFunc,u=o.map(l),s=(0,E.A)(a.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,w.A)(e,2);return t[0],t[1]}));return p=Object.fromEntries(s.map((function(e,t){return[e,u[t]]}))),1}};for(g.s();!(v=g.n()).done&&!h(););}catch(e){g.e(e)}finally{g.f()}if(!c){var m,y=du(Su(r));try{for(y.s();!(m=y.n()).done;){var b=(0,w.A)(m.value,2),O=b[0],A=b[1];if(A.spelImport){var S=void 0;try{S=A.spelImport.call(r.ctx,e)}catch(e){yu.debug("Error while using spelImport for ".concat(O),e)}if(S){var F;for(var j in d=Ou(r,c=O),p={},S)p[j]=l(S[j]);var C=!0,_=null===(F=d)||void 0===F?void 0:F.returnType;if(["date","datetime"].includes(_)){var L,k,T=Object.keys(null!==(L=d.args)&&void 0!==L?L:[]).filter((function(e){return["date","datetime"].includes(d.args[e].type)})),P=du(T);try{for(P.s();!(k=P.n()).done;){var V,x=k.value,I=d.args[x].type,D=null===(V=p[x])||void 0===V?void 0:V.valueType;D&&D!=I&&(C=!1)}}catch(e){P.e(e)}finally{P.f()}}if(C)break}}}}catch(e){y.e(e)}finally{y.f()}}if(c){var R={};for(var N in d.args){var q,M=d.args[N],W=p[N];if(void 0===W)if(void 0===(W=null==M?void 0:M.defaultValue)){if(null==M||!M.isOptional)return void n.errors.push("No value for arg ".concat(N," of func ").concat(c))}else W={value:W,valueSrc:null!==(q=W)&&void 0!==q&&q.func?"func":"value",valueType:M.type};W&&(R[N]=W)}return{valueSrc:"func",value:{func:c,args:R},valueType:d.returnType}}e.methodName&&n.errors.push("Signature ".concat(u," - failed to convert"))},ku=function(e,t,r,n,o,i,l){var a,u,s,c=[];for(var d in r.widgets){var p=r.widgets[d].spelImportFuncs;if(p)for(var f=0;f<p.length;f++){var v=p[f];if(hu(v)){var g={};if(gu(v,e,g)){for(var h in g)g[h]=l(g[h]);c.push({s:"widgets.".concat(d,".spelImportFuncs[").concat(f,"]"),w:d,argsObj:g})}}}}var m,y=du(i);try{for(y.s();!(m=y.n()).done;){var b,O=m.value,A=O.s,S=O.params,F=du(t.valueFuncs[A]||[]);try{var j=function(){var e=b.value,t=e.w,r=e.argsOrder,n=S.map(l),o=Object.fromEntries(r.map((function(e,t){return[e,n[t]]})));c.push({s:A,w:t,argsObj:o})};for(F.s();!(b=F.n()).done;)j()}catch(e){F.e(e)}finally{F.f()}}}catch(e){y.e(e)}finally{y.f()}for(var E=0,C=c;E<C.length;E++){var _=C[E],L=_.s,k=_.w,T=_.argsObj,P=r.widgets[k],V=P.spelImportValue,x=P.type;for(var I in s=k,u=L,a=[],T)["value"].includes(T[I].valueSrc)||a.push("".concat(I," has unsupported value src ").concat(T[I].valueSrc));var D=T.v.value;if(V&&!a.length){var R=V.call(r.ctx,T.v,P,T),N=(0,w.A)(R,2);D=N[0],(a=N[1])&&!Array.isArray(a)&&(a=[a])}if(!a.length)return{valueSrc:"value",valueType:x,value:D}}s&&a.length&&n.errors.push("Signature ".concat(u," - looks like convertable to ").concat(s,", but: ").concat(a.join("; ")))},Tu=function(e,t,r,n,o,i,l){var a,u=[],s=du(i);try{for(s.s();!(a=s.n()).done;){var c,d=a.value,p=d.s,f=d.params,v=du(t.opFuncs[p]||[]);try{var g,h=function(){var e,t=c.value,n=t.op,i=t.argsOrder,a=f.map(l),s=[];if("!compare"===n){if(o.type.startsWith("op-")&&2==o.children.length&&"number"==o.children[1].type&&0===o.children[1].val)return{v:{type:"!compare",children:a}};s.push("Result of compareTo() should be compared to 0")}var d=r.operators[n].valueTypes,v=Object.fromEntries(i.map((function(e,t){return[e,a[t]]}))),g=v[0],h=Object.keys(v).filter((function(e){return parseInt(e)>0})).map((function(e){return v[e]})),m=null===(e=a.filter((function(e){return!!e&&e!==g})))||void 0===e||null===(e=e[0])||void 0===e?void 0:e.valueType;d&&m&&!d.includes(m)&&s.push("Op supports types ".concat(d,", but got ").concat(m)),u.push({opKey:n,foundSign:p,field:g,convertedArgs:h,errs:s})};for(v.s();!(c=v.n()).done;)if(g=h())return g.v}catch(e){v.e(e)}finally{v.f()}}}catch(e){s.e(e)}finally{s.f()}for(var m in r.operators){var y=r.operators[m],b=y.spelImportFuncs,O=y.valueTypes;if(b)for(var A=function(){var t=b[S];if(hu(t)){var r={};if(gu(t,e,r)){var n,o=[];for(var i in r)r[i]=l(r[i]);var a=r[0],s=Object.keys(r).filter((function(e){return parseInt(e)>0})).map((function(e){return r[e]})),c=null===(n=r[1])||void 0===n?void 0:n.valueType;O&&c&&!O.includes(c)&&o.push("Op supports types ".concat(O,", but got ").concat(c)),u.push({opKey:m,foundSign:"spelImportFuncs[".concat(S,"]"),field:a,convertedArgs:s,errs:o})}}},S=0;S<b.length;S++)A()}var F=u.find((function(e){return!e.errs.length}));if(F){var j=F.opKey,w=(F.foundSign,F.field),E=F.convertedArgs;return F.errs,ou(r,n,w,j,E,e)}if(u.length){var C=u.map((function(e){var t=e.foundSign,r=e.opKey,n=e.errs;return"Looks like convertable to ".concat(r," with signature ").concat(t,", but: ").concat(n.join("; "))})).join(".  ");n.errors.push(C)}},Pu=function(e,t,r,n,o,i){if(e.type==t.type){if("!aggr"==e.type){var l=[e.source,t.source].map((function(e){return _u(e,n,o,i,r)})),a=(0,w.A)(l,2),u=a[0],s=a[1];return u.value==s.value}var c=[e,t].map((function(e){return _u(e,n,o,i,r)})),d=(0,w.A)(c,2),p=d[0],f=d[1];return p.value==f.value}return!1},Vu=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"op-plus"===(null==e?void 0:e.type)&&"case_value"===(null===(o=r.settings.caseValueField)||void 0===o?void 0:o.type)?xu(e,t,r,n):_u(e,t,r,n,i)},xu=function(e,t,r,n){var o=[];return function i(l){l.map((function(l){if("op-plus"===l.type)i(l.children);else{var a=_u(l,t,r,n,e);a?o.push(a):n.errors.push("Can't convert ".concat(l.type," in concatenation"))}}))}(e.children),{valueSrc:"value",valueType:"case_value",value:o}},Iu=me,Du=bn,Ru=function(e,t){return Nu(e,t,!0)},Nu=function(e,t){var r,n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={errors:[]},l=Du(t,void 0,!1),a=function(e){var t={},r=function(r){var n=e.operators[r],o=n.spelOps?n.spelOps:n.spelOp?[n.spelOp]:void 0;if(o)o.forEach((function(e){var n=e;t[n]||(t[n]=[]),t[n].push(r)}));else{var i,l=null===(i=e.operators)||void 0===i?void 0:i[n.reversedOp];(null==l?void 0:l.spelOp)||(null==l?void 0:l.spelOps)||Ba.includes(r)||Ba.includes(n.reversedOp)||Ua.includes(r)||za.warn("[spel] No spelOp for operator ".concat(r))}};for(var n in e.operators)r(n);var o={};for(var i in e.conjunctions)o[e.conjunctions[i].spelConj||i.toLowerCase()]=i;var l,a={},u=Ma(Ga(e));try{var s=function(){var e=(0,w.A)(l.value,2),t=e[0],r=e[1],n=[],o=r.spelFunc;if("string"==typeof o){var i=Object.keys(r.args||{}).reverse().filter((function(e){return!!r.args[e].isOptional||null!=r.args[e].defaultValue})),u=o.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"})),s=i.reduce((function(e,t){return[].concat((0,E.A)(e),[[t].concat((0,E.A)(e[e.length-1]||[]))])}),[]).map((function(e){return o.replace(/(?:, )?\${(\w+)}/g,(function(t,r){return e.includes(r)?"":t})).replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"}))}));n=[u].concat((0,E.A)(s))}var c,d=Ma(n);try{for(d.s();!(c=d.n()).done;){var p=c.value;a[p]||(a[p]=[]),a[p].push(t)}}catch(e){d.e(e)}finally{d.f()}};for(u.s();!(l=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}var c={};for(var d in e.widgets){var p=e.widgets[d].spelImportFuncs;if(p){var f,v=Ma(p);try{for(v.s();!(f=v.n()).done;){var g=f.value;if("string"==typeof g){var h=g.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"})),m=(0,E.A)(g.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,w.A)(e,2);return t[0],t[1]}));c[h]||(c[h]=[]),c[h].push({w:d,argsOrder:m})}}}catch(e){v.e(e)}finally{v.f()}}}var y={},b=function(t){var r=e.operators[t],n=r.spelOps?r.spelOps:r.spelOp?[r.spelOp]:void 0;null==n||n.forEach((function(e){if(null!=e&&e.includes("${0}")){var r=e.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"})),n=(0,E.A)(e.matchAll(/\${(\w+)}/g)).map((function(e){var t=(0,w.A)(e,2);return t[0],t[1]}));y[r]||(y[r]=[]),y[r].push({op:t,argsOrder:n})}}))};for(var O in e.operators)b(O);var A=_o.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"}));return y[A]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:a,valueFuncs:c,opFuncs:y}}(l),u=void 0;try{r=$i.SpelExpressionEvaluator.compile(e)._compiledExpression}catch(e){i.errors.push(e)}r&&(n=uu(r,i),Iu.debug("convertedObj:",n,i),(u=Eu(n,a,l,i))&&"group"!=u.type&&"switch_group"!=u.type&&(u=eu(u,l,n.not)),Iu.debug("jsTree:",u));var s=u?ui(u):void 0;return o?[s,i.errors]:(i.errors.length&&console.warn("Errors while importing from SpEL:",i.errors),s)};const qu={utils:{SqlString:ao,moment:x(),mongoFormatOp1:Mn,mongoFormatOp2:Wn,mongoEmptyValue:qn,escapeRegExp:ie,sqlEmptyValue:uo,stringifyForDisplay:so,getTitleInListValues:Hl,spelEscape:no,spelFixList:lo,wrapWithBrackets:co}};function Mu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Wu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wu(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var zu={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,n,o,i,l,a,u){var s=a?"=":i.label;return"boolean"==o&&a?"No"==r?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(s," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},jsonLogic2:"==",jsonLogicOps:["==","datetime==","date=="],jsonLogic:function(e,t,r,n,o,i,l,a){return null!=a&&a.fixJsonLogicDateCompareOp&&["date","datetime"].includes(l)?(0,j.A)({},"".concat(l,"=="),[e,r]):{"==":[e,r]}},elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,n,o,i,l,a,u){return"boolean"==o&&a?"No"==r?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(i.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},jsonLogic2:"!=",jsonLogicOps:["!=","datetime!=","date!="],jsonLogic:function(e,t,r,n,o,i,l,a){return null!=a&&a.fixJsonLogicDateCompareOp&&["date","datetime"].includes(l)?(0,j.A)({},"".concat(l,"!="),[e,r]):{"!=":[e,r]}}},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(e){return e},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(e){return e},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return e},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(e){return e},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",sqlImport:function(e,t,r){if("LIKE"==(null==e?void 0:e.operator)||"NOT LIKE"==(null==e?void 0:e.operator)){var n,o="NOT LIKE"==(null==e?void 0:e.operator),i=e.children||[],l=(0,w.A)(i,2),a=(l[0],l[1]);if(null!=a&&null!==(n=a.valueType)&&void 0!==n&&n.endsWith("_quote_string")){if(null!=a&&a.value.startsWith("%")&&null!=a&&a.value.endsWith("%"))return a.value=this.utils.SqlString.unescapeLike(a.value.substring(1,a.value.length-1),r),e.operator=o?"not_like":"like",e;if(null!=a&&a.value.startsWith("%"))return a.value=this.utils.SqlString.unescapeLike(a.value.substring(1),r),e.operator="ends_with",e;if(null!=a&&a.value.endsWith("%"))return a.value=this.utils.SqlString.unescapeLike(a.value.substring(0,a.value.length-1),r),e.operator="starts_with",e}}},spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:function(e,t,r){return{in:[r,e]}},jsonLogic2:"#in",valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!0].concat(n))},jsonLogic:function(e,t,r){return{"!":{in:[r,e]}}},jsonLogic2:"#!in",_jsonLogicIsExclamationOp:!0,valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?"^"+t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e)+"$":void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1);return a?"".concat(e," BETWEEN ").concat(u," AND ").concat(s):"".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s)},spelFormatOp:function(e,t,r,n,o,i,l,a){var u=r[0],s=r[1];return"(".concat(e," >= ").concat(u," && ").concat(e," <= ").concat(s,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return"time"===e?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1);return a?"".concat(e," NOT BETWEEN ").concat(u," AND ").concat(s):"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},spelFormatOp:function(e,t,r,n,o,i,l,a){var u=r[0],s=r[1];return"(".concat(e," < ").concat(u," || ").concat(e," > ").concat(s,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",jsonLogic:function(e,t,r){return{"!":{"<=":[Array.isArray(r)?r[0]:r,e,Array.isArray(r)?r[1]:r]}}},jsonLogic2:"!<=",_jsonLogicIsExclamationOp:!0,validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this.utils.sqlEmptyValue(a);return"COALESCE(".concat(e,", ").concat(u,") = ").concat(u)},sqlImport:function(e,t,r){if("="===(null==e?void 0:e.operator)||"<>"===(null==e?void 0:e.operator)){var n,o=e.children||[],i=(0,w.A)(o,2),l=i[0],a=i[1];if(""===(null==a?void 0:a.value)&&"COALESCE"===(null==l?void 0:l.func)&&""===(null==l||null===(n=l.children)||void 0===n||null===(n=n[1])||void 0===n?void 0:n.value))return e.operator="="===(null==e?void 0:e.operator)?"is_empty":"is_not_empty",e.children=[l.children[0]],e}},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this.utils.sqlEmptyValue(a);return"COALESCE(".concat(e,", ").concat(u,") <> ").concat(u)},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",sqlImport:function(e,t,r){if("IS"===(null==e?void 0:e.operator)||"IS NOT"===(null==e?void 0:e.operator)){var n=e.children||[],o=(0,w.A)(n,2),i=o[0],l=o[1];if("null"==(null==l?void 0:l.valueType))return e.operator="IS"===(null==e?void 0:e.operator)?"is_null":"is_not_null",e.value=i,e}},cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,n,o,i,l,a){return a?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,l,a){var u=a?"=":"==";return"".concat(e," ").concat(u," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],formatOp:function(e,t,r,n,o,i,l,a){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):void 0},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e){return e},!1].concat(r))},reversedOp:"select_any_in",jsonLogic:function(e,t,r){return{"!":{in:[e,r]}}},jsonLogic2:"!in",_jsonLogicIsExclamationOp:!0},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",spelImportFuncs:[{obj:{type:"property",val:"CollectionUtils"},methodName:"containsAny",args:[{var:"0"},{var:"1"}]}],elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains",jsonLogic2:"!some-in",jsonLogic:function(e,t,r){return{"!":{some:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,l,a){var u=a?"=":"==";return"value"==n?"".concat(e," ").concat(u," [").concat(r.join(", "),"]"):"".concat(e," ").concat(u," ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this;return"value"==n?"".concat(e," = '").concat(r.map((function(e){return u.utils.SqlString.trim(e)})).join(","),"'"):void 0},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,l,a){return"value"==n?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=this;return"value"==n?"".concat(e," != '").concat(r.map((function(e){return u.utils.SqlString.trim(e)})).join(","),"'"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"multiselect_equals",jsonLogic2:"!all-in",jsonLogic:function(e,t,r){return{"!":{all:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1),c=null==l?void 0:l.get("proximity");return"".concat(e," ").concat(u," NEAR/").concat(c," ").concat(s)},sqlFormatOp:function(e,t,r,n,o,i,l,a){var u=r.first(),s=r.get(1),c=this.utils.SqlString.trim(u),d=this.utils.SqlString.trim(s),p=null==l?void 0:l.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(c,", ").concat(d,"), ").concat(p,")')")},sqlImport:function(e,t,r){if("CONTAINS"===(null==e?void 0:e.func)){var n,o=e.children||[],i=(0,w.A)(o,2),l=i[0],a=i[1];if(null!=a&&null!==(n=a.value)&&void 0!==n&&n.includes("NEAR(")){var u=a.value.match(/NEAR\(\((\w+), (\w+)\), (\d+)\)/);if(u)return delete e.func,e.operator="proximity",e.children=[l,{value:u[1]},{value:u[2]}],e.operatorOptions={proximity:parseInt(u[3])},e}}},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return 0},!1].concat(r))}}},Bu={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,n,o,i,l){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n,l):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n,l):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var n=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,n)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},price:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Price",valueLabels:[{label:"Price from",placeholder:"Enter price from"},{label:"Price to",placeholder:"Enter price to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var n=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,n)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return n?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=e.map((function(e){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e)}));return n?i.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o,i,l){var a=this;return e.map((function(e){return a.utils.SqlString.escape(e)}))},spelFormatValue:function(e,t,r,n,o){var i=o&&o.spelOp&&o.spelOp.startsWith("${1}"),l=this.utils.spelEscape(e);return i&&(l=this.utils.spelFixList(l)),l},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){var a=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(a.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD");return"T(java.time.LocalDate).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o,i,l;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&null!==(n=r.fmt)&&void 0!==n&&null!==(n=n.value)&&void 0!==n&&null!==(o=n.includes)&&void 0!==o&&o.call(n," ")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&null!==(l=i.toLowerCase)&&void 0!==l&&l.call(i).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var a=this.utils.moment(e.value,this.utils.moment.ISO_8601);return a.isValid()?[a.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment.utc(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);if(n.isValid())return{$dateFromString:{dateString:n.format("YYYY-MM-DD"),format:"%Y-%m-%d"}}}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){var a=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(a.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(i,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var n,o,i;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&r.fmt&&(null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.toLowerCase)||void 0===o||!o.call(n).includes("hh:mm")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&i.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var l=this.utils.moment(e.value,"HH:mm:ss");return l.isValid()?[l.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?60*r.get("hour")*60+60*r.get("minute")+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},elasticSearchFormatValue:function(e,t,r,n){return{script:{script:{source:"doc[".concat(n,"][0].getHour() >== params.min && doc[").concat(n,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){var a=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(a.toDate())},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD HH:mm:ss");return"T(java.time.LocalDateTime).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd HH:mm:ss","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o;if(!t)return[void 0,"No widget def to get value format"];if(null==r||null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.includes)||void 0===o||!o.call(n," "))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,this.utils.moment.ISO_8601);return i.isValid()?[i.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);if(n.isValid())return{$dateFromString:{dateString:n.format("YYYY-MM-DD HH:mm:ss"),format:"%Y-%m-%d %H:%M:%S"}}}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,n){return n?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,n,o,i,l){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,n,o,i,l){return n&&l.label||e},sqlFormatValue:function(e,t,r,n,o,i,l){return e},spelFormatValue:function(e,t,r,n,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(""===e?null:e)},spelImportValue:function(e){return[e.value,[]]},jsonLogic:function(e){return""===e?null:e}}},Uu=Gu(Gu({},ur),{},{convertableWidgets:{number:["slider","rangeslider","price"],slider:["number","rangeslider","price"],rangeslider:["number","slider","price"],price:["number","slider","rangeslider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,n,o,i){var l=this,a=n.map((function(e,t){var r=e.key,n=e.parent,o=e.fieldSeparator;return 0==t?"[map]"==n?"#this[".concat(l.utils.spelEscape(r),"]"):r:"map"==n||"[map]"==n?"[".concat(l.utils.spelEscape(r),"]"):"".concat(o).concat(r)})).join("");return o.fieldName&&(a=e),o.isSpelVariable&&(a="#"+a),a},sqlFormatReverse:function(e){if(null!=e)return"NOT"+this.utils.wrapWithBrackets(e)},spelFormatReverse:function(e){if(null!=e)return"!"+this.utils.wrapWithBrackets(e)},formatReverse:function(e,t,r,n,o,i){if(null!=e)return i?"NOT "+this.utils.wrapWithBrackets(e):"!"+this.utils.wrapWithBrackets(e)},formatAggr:function(e,t,r,n,o,i,l,a,u,s){var c=l.labelForFormat,d=l.cardinality;if(0==d){var p=e?" HAVE ".concat(e):"";return"".concat(c," OF ").concat(t).concat(p)}if(null==d||1==d){var f=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(f," ").concat(c," ").concat(n)}if(2==d){var v=e?" WHERE ".concat(e):"",g=n.first(),h=n.get(1);return"COUNT OF ".concat(t).concat(v," ").concat(c," ").concat(g," AND ").concat(h)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,n){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),$u=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={rangeslider:Yu,treeselect:Ku,treemultiselect:Qu,rangeable__date:Ju("date","date")},i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Mu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(t);try{for(i.s();!(r=i.n()).done;){var l=r.value,a=o[l];if(!a)throw new Error("Can't ".concat(n?"add":"remove"," mixin ").concat(l));e=a(e,n)}}catch(e){i.e(e)}finally{i.f()}return e},Hu=function(e,t){return $u(e,t,!0)},Ju=function(e,t){return function(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=r.types;return o=Gu(Gu({},o),{},(0,j.A)({},e,Gu(Gu({},o[e]),{},{widgets:Gu({},o[e].widgets)}))),n?o[e].widgets[t]=Gu({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],Gu(Gu({},r),{},{types:o})}},Yu=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Gu({},r),t?r.rangeslider=Gu({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},singleWidget:"slider",toJS:function(e,t){return e}},r.rangeslider):delete r.rangeslider,n=Gu(Gu({},n),{},{number:Gu(Gu({},n.number),{},{widgets:Gu({},n.number.widgets)})}),t?n.number.widgets.rangeslider=Gu({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},n.number.widgets.rangeslider):delete n.number.widgets.rangeslider,Gu(Gu({},e),{},{widgets:r,types:n})},Ku=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Gu({},r),t?r.treeselect=Gu({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,i=this.utils.getTitleInListValues(o,e);return n?this.utils.stringifyForDisplay(i):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,l){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treeselect):delete r.treeselect,n=Gu({},n),t?n.treeselect=Gu({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},n.treeselect):delete n.treeselect,Gu(Gu({},e),{},{widgets:r,types:n})},Qu=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=Gu({},r),t?r.treemultiselect=Gu({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,l=e.map((function(e){return o.utils.getTitleInListValues(i,e)}));return n?l.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o,i,l){var a=this;return e.map((function(e){return a.utils.SqlString.escape(e)}))},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treemultiselect):delete r.treemultiselect,n=Gu({},n),t?n.treemultiselect=Gu({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},n.treemultiselect):delete n.treemultiselect,Gu(Gu({},e),{},{widgets:r,types:n})},Xu={addMixins:Hu,removeMixins:function(e,t){return $u(e,t,!1)}},Zu={conjunctions:{AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,n){var o=e.size>1?e.join(" "+(n?"AND":"&&")+" "):e.first();return(e.size>1||r)&&(o=this.utils.wrapWithBrackets(o)),r&&(o="NOT "+o),o},sqlFormatConj:function(e,t,r){var n=e.size>1?e.join(" AND "):e.first();return(e.size>1||r)&&(n=this.utils.wrapWithBrackets(n)),r&&(n="NOT "+n),n},spelFormatConj:function(e,t,r,n){r&&(n=!1);var o=e.size>1?e.join(" && "):e.first();return(e.size>1||r)&&!n&&(o=this.utils.wrapWithBrackets(o)),r&&(o="!"+o),o}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){var n=e.size>1?e.join(" OR "):e.first();return(e.size>1||r)&&(n=this.utils.wrapWithBrackets(n)),r&&(n="NOT "+n),n},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" || ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},operators:zu,widgets:Bu,types:{text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},price:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{widgetProps:{}}}}},settings:Uu,ctx:qu};const es=Zu=Hu(Zu,["rangeslider","treeselect","treemultiselect"]);var ts="ADD_GROUP",rs="ADD_CASE_GROUP",ns="REMOVE_GROUP",os="REMOVE_GROUP_CHILDREN",is="SET_CONJUNCTION",ls="SET_NOT",as="ADD_RULE",us="REMOVE_RULE",ss="SET_FIELD",cs="SET_FIELD_SRC",ds="SET_OPERATOR",ps="SET_VALUE",fs="SET_VALUE_SRC",vs="SET_FUNC_VALUE",gs="SET_OPERATOR_OPTION",hs="SET_LOCK",ms="SET_TREE",ys="MOVE_ITEM",bs="after",Os="before",As="append",Ss="prepend",Fs="SET_DRAG_PROGRESS",js="SET_DRAG_START",ws="SET_DRAG_END",Es=r(97932),Cs=r.n(Es);function _s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ks(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ts(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ts(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}function Ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ps=function(e,t,r,n,o,i){var l,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(ot(t)))return e;var s=(null==o||null===(l=o.get)||void 0===l?void 0:l.call(o,"id"))||n,c=i.settings.shouldCreateEmptyGroup,d=t.push(s),p=!c,f=!(null==u||!u.isDefaultCase),v=e;return(e=Vs(e,t,r,s,Ft(i).merge((0,_.ss)(o)||{}),i,a))!==v&&(a||f||(e=e.setIn(ot(d,"children1"),new _.Ay.OrderedMap),p&&(e=Vs(e,d,"rule",k(),Sa(i,null==u?void 0:u.parentRuleGroupField),i))),e=st(e)),e},Vs=function(e,t,r,n,o,i){var l,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("switch_group"===r)throw new Error("Can't add switch_group programmatically");if(!e.getIn(ot(t)))return e;var u,s,c=(null==o||null===(l=o.get)||void 0===l?void 0:l.call(o,"id"))||n,d=i.settings,p=d.maxNumberOfCases,f=d.maxNumberOfRules,v=d.maxNesting,g="switch_group"===e.get("type"),h=g?e.getIn(ot(t.take(2))):null,m=ot(t,"children1"),y=e.getIn(m),b=!!y&&y.size,O=b?y.size:null;if("case_group"===r)u=O,s=p;else if("group"===r){var A=at(e,t);if(A.length){var S=A[0],F=S.path,w=S.field,E=Ue(i,w);u=t.size-F.length,s=null==E?void 0:E.maxNesting}else u=t.size,s=v}else{var C=at(e,t);if(C.length){var L=C[0],k=L.path,T=L.field,P=Ue(i,T),V=lt(e,k);s=null==P?void 0:P.maxNumberOfRules,u=ft(V)}else u=ft(g?h:e),s=f}var x=!s||!u||u<s,I={type:r,id:c,properties:o};Ns(i,I,a);var D="case_group"===r&&b&&null==y.last().get("children1");if(x){var R=new _.Ay.OrderedMap((0,j.A)({},c,new _.Ay.Map(I)));if(b)if(D){var N=y.last(),q=new _.Ay.OrderedMap((0,j.A)((0,j.A)({},c,new _.Ay.Map(I)),N.get("id"),N));e=(e=e.deleteIn(ot(m,"children1",N.get("id")))).mergeIn(m,q)}else e=e.mergeIn(m,R);else e=e.setIn(m,R);e=st(e)}return e},xs=function(e,t){return e=e.deleteIn(ot(t)),st(e)},Is=function(e,t,r,n,o){var i,l,a,u,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},c=e.getIn(ot(t));if(!c)return{state:e};var d=s.isEndValue,p=s.canDropArgs;if(!r)return{state:e=xs(e,t)};var f=n.settings,v=f.fieldSeparator,g=f.setOpOnChangeField,h=f.showErrorMessage;Array.isArray(r)&&(r=r.join(v));var m=c.get("type"),y=c.get("properties"),b="rule_group"==m,O=null==y?void 0:y.get("fieldSrc"),A=Ue(n,r);if(!A)return console.warn("No config for LHS ".concat(r)),{state:e};var S=A.type;"!group"!==S&&"!struct"!==S||(S=null);var F=null==y?void 0:y.get("operator"),j=null==y?void 0:y.get("operatorOptions"),w=null==y?void 0:y.get("field"),E="!group"==A.type,C=E&&"array"==A.mode,L=b!=E,T=A&&-1!==(null===(i=A.operators)||void 0===i?void 0:i.indexOf(F))?F:null,P="func"===O&&(null==w||null===(l=w.get)||void 0===l?void 0:l.call(w,"func"))===(null===(a=r)||void 0===a||null===(u=a.get)||void 0===u?void 0:u.call(a,"func"))&&!!T,V=null,x="func"===O?et(n,S):tt(n,r);if(x&&1==x.length)V=x[0];else if(P)V=T;else if(x&&x.length>1){var I,D=ks(g);try{for(D.s();!(I=D.n()).done;){var R=I.value;if("keep"!=R||L?"default"==R?V=Ct(n,r,!1):"first"==R&&(V=rt(n,r)):V=T,V)break}}catch(e){D.e(e)}finally{D.f()}}if(!E&&!A.operators)return console.warn("Type ".concat(A.type," is not supported")),{state:e};b&&!E&&(e=(e=(e=e.setIn(ot(t,"type"),"rule")).deleteIn(ot(t,"children1"))).setIn(ot(t,"properties"),new _.Ay.OrderedMap)),y||(e=e.setIn(ot(t,"properties"),new _.Ay.OrderedMap));var N=!h;if(E){e=e.setIn(ot(t,"type"),"rule_group");var q=ql({validateValue:da,validateRange:ga},n,n,y,r,V,"field",N,d,p),M=(q.canReuseValue,q.newValue),W=q.newValueSrc,G=q.newValueType,z=q.operatorCardinality,B=Ft(n,A,r).merge({field:r,fieldSrc:"field",mode:A.mode});C&&(B=B.merge({operator:V,value:M,valueSrc:W,valueType:G})),e=(e=e.setIn(ot(t,"children1"),new _.Ay.OrderedMap)).setIn(ot(t,"properties"),B),A.initialEmptyWhere&&1==z||(e=Vs(e,t,"rule",k(),Sa(n,r),n)),e=st(e)}else e=e.updateIn(ot(t,"properties"),(function(e){return e.withMutations((function(e){var t=ql({validateValue:da,validateRange:ga},n,n,e,r,V,"field",N,d,p),o=t.canReuseValue,i=t.newValue,l=t.newValueSrc,a=t.newValueType,u=t.newValueError,s=t.newFieldError,c=t.fixedField,f=r;c!==r&&(f=c),h&&(e=(e=e.set("fieldError",s)).set("valueError",u));var v=o?j:At(n,V,f);return e=e.set("field",f).delete("fieldType").set("fieldSrc",O).set("operator",V).set("operatorOptions",v).set("value",i).set("valueSrc",l).set("valueType",a),o||(e=e.delete("asyncListValues")),e}))}));return{state:e}},Ds=function(e,t,r,n,o,i,l){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(ot(t)))return{state:e};var u=a.canDropArgs,s=a.isEndValue,c=i.settings,d=c.fieldSeparator,p=c.showErrorMessage,f=e.getIn(ot(t,"properties","valueSrc",r+""))||null;"field"===f&&Array.isArray(n)&&(n=n.join(d));var v=e.getIn(ot(t,"properties","field"))||null,g=e.getIn(ot(t,"properties","operator"))||null,h=$e(i,g,v),m=g?X(h):null,y=o||Vt(n,f,i),b=da(i,v,v,g,n,y,f,l,!p,s,u),O=(0,w.A)(b,2),A=O[0],S=O[1],F=null==S?void 0:S.find((function(e){return!e.fixed&&!e.ignore})),j=F?Il(F):null,E=A!==n;E&&(n=A),e=Rs(e,t,i,m);var C=Array.from({length:m},(function(o,i){return i==r?n:e.getIn(ot(t,"properties","value",i+""))||null})),L=Array.from({length:m},(function(r,n){return e.getIn(ot(t,"properties","valueSrc",n+""))||null})),k=ga(i,v,g,C,L),T=k?Il(k):null;return(!!p||!j&&!T||E)&&(e=e.deleteIn(ot(t,"properties","asyncListValues")),void 0===n?e=(e=e.setIn(ot(t,"properties","value",r),void 0)).setIn(ot(t,"properties","valueType",r),null):(l&&(e=e.setIn(ot(t,"properties","asyncListValues"),l)),e=(e=e.setIn(ot(t,"properties","value",r),n)).setIn(ot(t,"properties","valueType",r),y))),p&&(e.getIn(ot(t,"properties","valueError"))||(e=e.setIn(ot(t,"properties","valueError"),new _.Ay.List(new Array(m)))),e=e.setIn(ot(t,"properties","valueError",r),j),m>=2&&(e=e.setIn(ot(t,"properties","valueError",m),T))),{state:e}},Rs=function(e,t,r,n){if(!n){var o=e.getIn(ot(t,"properties","field"))||null,i=e.getIn(ot(t,"properties","operator"))||null,l=$e(r,i,o);n=i?X(l):null}for(var a=0,u=["value","valueType","valueError","valueSrc"];a<u.length;a++){var s=u[a];e.getIn(ot(t,"properties",s))||(e=e.setIn(ot(t,"properties",s),new _.Ay.List(n?Array.from({length:n}):[])))}return e},Ns=function(e,t,r){r&&Array.isArray(r)&&(t.children1=new _.Ay.OrderedMap(r.reduce((function(t,r){var n,o=null!==(n=r.id)&&void 0!==n?n:k(),i=Ls(Ls({},r),{},{properties:Fa(e,r).merge((0,_.ss)(r.properties)||{}),id:o});return Ns(e,i,i.children1),Ls(Ls({},t),{},(0,j.A)({},o,new _.Ay.Map(i)))}),{})))},qs={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}};const Ms=function(e,t,r,n,o){var i=Ls({tree:t},qs);return function(){var t,l,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,u=arguments.length>1?arguments[1]:void 0,s=null!==(t=null!==(l=null==o?void 0:o())&&void 0!==l?l:null==u?void 0:u.config)&&void 0!==t?t:e,c={},d=function(e,t){if(!e||!e.type)return null;var r,n=[ms,js,Fs,ws],o=Cs()(Ji()(e,["config","asyncListValues"]),oe),i=e.path&&function(e,t){return e.getIn(ot(t,"properties","field"))||null}(t.tree,e.path)||e.field;return i&&(null!==(r=i)&&void 0!==r&&r.toJS&&(i=i.toJS()),o.affectedField=i),(n.includes(e.type)||0==e.type.indexOf("@@redux"))&&(o=null),o}(u,a);switch(null==u?void 0:u.type){case ms:var p=r(s,u.tree);c.tree=p;break;case rs:c.tree=Ps(a.tree,u.path,"case_group",u.id,u.properties,s,u.children,u.meta);break;case ts:c.tree=Ps(a.tree,u.path,"group",u.id,u.properties,s,u.children,u.meta);break;case ns:c.tree=function(e,t,r){if(!e.getIn(ot(t)))return e;e=xs(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1);return mt(e,o)||n||(e=ct(e),!ht(e)||n)||(e=Vs(e,new _.Ay.List,"rule",k(),Sa(r,void 0,void 0,!1,!1),r)),st(e)}(a.tree,u.path,s);break;case os:c.tree=function(e,t){return e.getIn(ot(t))?(e=function(e,t){return e=e.deleteIn(ot(t,"children1")),st(e)}(e,t),e=st(e)):e}(a.tree,u.path);break;case as:c.tree=Vs(a.tree,u.path,u.ruleType,u.id,u.properties,s,u.children);break;case us:c.tree=function(e,t,r){if(!e.getIn(ot(t)))return e;e=xs(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.pop(),i=e.getIn(ot(o)),l=i.getIn(["properties","field"]),a=i.getIn(["properties","operator"]),u=l?Ue(r,l):null,s=a?$e(r,a,l):null,c=l&&a&&0!=s.cardinality,d="rule_group"==i.get("type"),p=!mt(e,o),f=d?c&&u.initialEmptyWhere:n;return p&&!f&&(d&&(e=e.deleteIn(ot(o))),e=ct(e),ht(e)&&!n)&&(e=Vs(e,new _.Ay.List,"rule",k(),Sa(r,void 0,void 0,!1,!1),r)),st(e)}(a.tree,u.path,s);break;case is:c.tree=function(e,t,r){return e.getIn(ot(t))?e=e.setIn(ot(t,"properties","conjunction"),r):e}(a.tree,u.path,u.conjunction);break;case ls:c.tree=function(e,t,r){return e.getIn(ot(t))?e=e.setIn(ot(t,"properties","not"),r):e}(a.tree,u.path,u.not);break;case ss:var f=Is(a.tree,u.path,u.field,s,u.asyncListValues,u._meta).state;c.tree=f;break;case cs:c.tree=function(e,t,r,n){var o=e.getIn(ot(t));if(!o)return e;var i=n.settings.keepInputOnChangeFieldSrc,l=o.get("properties"),a=null==l?void 0:l.get("field"),u=null==l?void 0:l.get("fieldType"),s=Ue(n,a),c=(null==s?void 0:s.type)||u;c&&"!group"!==c&&"!struct"!==c||(c=null);var d=!_e.includes(c);return(e=i&&!Nt(o,n)&&d?(e=(e=e.setIn(ot(t,"properties","field"),null)).deleteIn(ot(t,"properties","fieldError"))).setIn(ot(t,"properties","fieldType"),c):e.setIn(ot(t,"properties"),Sa(n,null,null,!1))).setIn(ot(t,"properties","fieldSrc"),r)}(a.tree,u.path,u.srcKey,s);break;case hs:c.tree=function(e,t,r){return e.getIn(ot(t))?e=ut(e.setIn(ot(t,"properties","isLocked"),r)):e}(a.tree,u.path,u.lock);break;case ds:c.tree=function(e,t,r,n){var o=e.getIn(ot(t));if(!o)return e;var i=n.settings.showErrorMessage,l=o.get("properties"),a=o.get("children1"),u=l.get("field"),s=(l.get("fieldSrc"),Ue(n,u)),c="!group"==(null==s?void 0:s.type),d=$e(n,r,u),p=d?X(d):null;return e=e.updateIn(ot(t,"properties"),(function(e){return e.withMutations((function(e){var t=e.get("field"),o=e.get("operatorOptions"),l=(e.get("value",new _.Ay.List),e.get("valueSrc",new _.Ay.List),e.get("operator"),ql({validateValue:da,validateRange:ga},n,n,e,t,r,"operator",!0)),a=l.canReuseValue,u=l.newValue,s=l.newValueSrc,c=l.newValueType,d=l.newValueError;i&&(e=e.set("valueError",d));var p=a?o:At(n,r,t);return a||(e=e.delete("asyncListValues")),e.set("operator",r).set("operatorOptions",p).set("value",u).set("valueSrc",s).set("valueType",c)}))})),c&&0==p&&0==(null==a?void 0:a.size)&&(e=Vs(e,t,"rule",k(),Sa(n,u),n)),e}(a.tree,u.path,u.operator,s);break;case ps:var v=Ds(a.tree,u.path,u.delta,u.value,u.valueType,s,u.asyncListValues,u._meta).state;c.tree=v;break;case vs:var g=function(e,t,r,n,o,i,l,a,u){var s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:{},c=t.getIn(ot(r));if(!c)return t;var d,p=-1===n,f=c.get("properties"),v=f.get("field"),g=f.get("value"),h=[],m=p?v:g.getIn([n]),y=ks(o||[]);try{for(y.s();!(d=y.n()).done;){var b=(0,w.A)(d.value,2),O=b[0],A=b[1];if(h.push([O,A,m]),O!==m.get("func")){var S=h.map((function(e){var t=(0,w.A)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")||"root";throw new Error("In ".concat(p?"LHS":"RHS"," for path ").concat(S," expected func key ").concat(O," but got ").concat(m.get("func")))}m=m.getIn(["args",A,"value"])}}catch(e){y.e(e)}finally{y.f()}if(i){var F=m.get("func"),j=Ie(e,F).args[i];"!valueSrc"===a?m=ma(m,i,l,j,e):(m=Qt(m,i,l,j,e),u&&(m=ya(m,i,u,j,e)))}else m=ha(m,l,e,!0),s.canDropArgs=!0;for(var E=m;h.length;){var C=h.pop(),_=(0,w.A)(C,3),L=_[0],k=_[1],T=_[2],P=Ie(e,L).args[k];E=Qt(T,k,E,P,e)}return p?Is(t,r,E,e,void 0,s):Ds(t,r,n,E,void 0,e,void 0,s)}(s,a.tree,u.path,u.delta,u.parentFuncs,u.argKey,u.value,u.valueType,u.asyncListValues,u._meta),h=g.state;c.tree=h;break;case fs:c.tree=function(e,t,r,n,o){if(!e.getIn(ot(t)))return e;var i=o.settings.showErrorMessage,l=e.getIn(ot(t,"properties","field"))||null,a=e.getIn(ot(t,"properties","operator"))||null,u=$e(o,a,l),s=a?X(u):null;if(e=(e=(e=(e=Rs(e,t,o,s)).setIn(ot(t,"properties","value",r+""),void 0)).setIn(ot(t,"properties","valueType",r+""),null)).deleteIn(ot(t,"properties","asyncListValues")),i&&(e=e.setIn(ot(t,"properties","valueError",r),null),null!=u&&u.validateValues&&(e=e.setIn(ot(t,"properties","valueError",s),null))),e=void 0===n?e.setIn(ot(t,"properties","valueSrc",r+""),null):e.setIn(ot(t,"properties","valueSrc",r+""),n),n){var c=e.getIn(ot(t,"properties")),d=ql({validateValue:da,validateRange:ga},o,o,c,l,a,"valueSrc",!0),p=d.canReuseValue,f=d.newValue,v=d.newValueSrc,g=d.newValueType;d.newValueError,p||v.get(r)!=n||(e=(e=e.setIn(ot(t,"properties","value",r+""),f.get(r))).setIn(ot(t,"properties","valueType",r+""),g.get(r)))}return e}(a.tree,u.path,u.delta,u.srcKey,s,u._meta);break;case gs:c.tree=function(e,t,r,n){return e.getIn(ot(t))?e.setIn(ot(t,"properties","operatorOptions",r),n):e}(a.tree,u.path,u.name,u.value);break;case ys:c.tree=function(e,t,r,n){var o=lt(e,t),i=t.pop(),l=t.size>1?lt(e,i):null,a=l?l.get("children1"):null,u=lt(e,r),s=n==As||n==Ss?r:r.pop(),c=n==As||n==Ss?u:r.size>1?lt(e,s):null,d=c?c.get("children1"):null;if(!l||!c||!o)return e;var p=l.get("id")==c.get("id"),f=s.size<i.size&&Z(s.toArray(),i.toArray().slice(0,s.size)),v=s.size>i.size&&Z(i.toArray(),s.toArray().slice(0,i.size)),g=null,h=null;f?g=_.Ay.List(i.toArray().slice(s.size)):v&&(h=_.Ay.List(s.toArray().slice(i.size)));var m=d,y=a;return v||(y=y.delete(o.get("id"))),p?m=y:f&&(m=m.updateIn(it(g,"children1"),(function(e){return y}))),n==Os||n==bs?m=_.Ay.OrderedMap().withMutations((function(e){var t,r=ks(m.entries());try{for(r.s();!(t=r.n()).done;){var i=(0,w.A)(t.value,2),l=i[0],a=i[1];l==(null==u?void 0:u.get("id"))&&n==Os&&e.set(o.get("id"),o),e.set(l,a),l==(null==u?void 0:u.get("id"))&&n==bs&&e.set(o.get("id"),o)}}catch(e){r.e(e)}finally{r.f()}})):n==As?m=m.merge(_.Ay.OrderedMap((0,j.A)({},o.get("id"),o))):n==Ss&&(m=_.Ay.OrderedMap((0,j.A)({},o.get("id"),o)).merge(m)),v&&(y=(y=y.updateIn(it(h,"children1"),(function(e){return m}))).delete(o.get("id"))),p||f||(e=e.updateIn(ot(i,"children1"),(function(e){return y}))),v||(e=e.updateIn(ot(s,"children1"),(function(e){return m}))),st(e)}(a.tree,u.fromPath,u.toPath,u.placement);break;case js:c.dragStart=u.dragStart,c.dragging=u.dragging,c.mousePos=u.mousePos;break;case Fs:c.mousePos=u.mousePos,c.dragging=u.dragging;break;case ws:c.tree=function(e,t){return t.settings.canLeaveEmptyGroup||(e=ct(e)),e}(a.tree,s),c=Ls(Ls({},c),qs)}return d&&(c.__lastAction=d),n&&c.tree&&a.tree&&n(a.tree),Ls(Ls(Ls({},a),{__lastAction:void 0}),c)}};var Ws=function(e,t){return{type:ms,tree:t,config:e}},Gs=function(e,t,r){var n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return{type:as,ruleType:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rule",children:arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,path:ne(t),id:k(),properties:Sa(e,n).merge((0,_.ss)(r)||{}),config:e,meta:{parentRuleGroupField:n}}},zs=function(e,t){return{type:us,path:ne(t),config:e}},Bs=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:rs,path:ne(t),children:n,id:k(),properties:Ft(e).merge((0,_.ss)(r)||{}),config:e,meta:{isDefaultCase:!0}}},Us=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:rs,path:ne(t),children:n,id:k(),properties:Ft(e).merge((0,_.ss)(r)||{}),config:e}},$s=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return{type:ts,path:ne(t),children:n,id:k(),properties:Ft(e,o).merge((0,_.ss)(r)||{}),config:e,meta:{parentRuleGroupField:o}}},Hs=function(e,t){return{type:ns,path:ne(t),config:e}},Js=function(e,t){return{type:os,path:ne(t),config:e}},Ys=function(e,t,r,n){return{type:ys,fromPath:ne(t),toPath:ne(r),placement:n,config:e}},Ks=function(e,t,r){return{type:is,path:ne(t),conjunction:r}},Qs=function(e,t,r){return{type:ls,path:ne(t),not:r}},Xs=function(e,t,r){return{type:hs,path:ne(t),lock:r}},Zs=function(e,t,r,n,o){return{type:ss,path:ne(t),field:r,config:e,asyncListValues:n,_meta:o}},ec=function(e,t,r){return{type:cs,path:ne(t),srcKey:r,config:e}},tc=function(e,t,r){return{type:ds,path:ne(t),operator:r,config:e}},rc=function(e,t,r,n,o,i,l){return{type:ps,path:ne(t),delta:r,value:n,valueType:o,asyncListValues:i,config:e,_meta:l}},nc=function(e,t,r,n,o){return{type:fs,path:ne(t),delta:r,srcKey:n,config:e,_meta:o}},oc=function(e,t,r,n,o,i,l,a,u){return{type:vs,path:ne(t),delta:r,parentFuncs:n,argKey:o,value:i,valueType:l,asyncListValues:a,config:e,_meta:u}},ic=function(e,t,r,n){return{type:gs,path:ne(t),name:r,value:n,config:e}};function lc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ac(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lc(Object(r),!0).forEach((function(t){(0,j.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var uc=ac(ac(ac({},y),{},{Export:d,Import:b,ConfigMixins:Xu},d),b)},7736:()=>{},20039:()=>{},61507:(e,t,r)=>{var n={"./es-us":1748,"./es-us.js":1748,"./ru":60582,"./ru.js":60582};function o(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=61507},76569:(e,t,r)=>{"use strict";r.d(t,{d$:()=>_o,uu:()=>g.uu,M$:()=>_n,Rj:()=>u,XK:()=>ae,Aq:()=>Zo});var n={};r.r(n),r.d(n,{bindActionCreators:()=>Y,isUsingLegacyReactDomRender:()=>U,liteShouldComponentUpdate:()=>$,pureShouldComponentUpdate:()=>H,useOnPropsChanged:()=>J});var o={};r.r(o),r.d(o,{NumericFormat:()=>Qn.HG,addLeadingZeros:()=>no,addTrailingZeros:()=>oo,getNumberFormatProps:()=>eo,numericFormatter:()=>to,numericParser:()=>ro,useNumericFormat:()=>Qn.S2});var i={};r.r(i),r.d(i,{FuncWidget:()=>Bt,ValueFieldWidget:()=>Nn,VanillaBooleanWidget:()=>qn,VanillaButton:()=>co,VanillaButtonGroup:()=>fo,VanillaConjs:()=>uo,VanillaDateTimeWidget:()=>Un,VanillaDateWidget:()=>Gn,VanillaFieldSelect:()=>ao,VanillaIcon:()=>po,VanillaMultiSelectWidget:()=>Hn,VanillaNumberWidget:()=>Kn,VanillaPriceWidget:()=>io,VanillaProvider:()=>mo,VanillaSelectWidget:()=>Yn,VanillaSliderWidget:()=>lo,VanillaSwitch:()=>go,VanillaTextAreaWidget:()=>Wn,VanillaTextWidget:()=>Mn,VanillaTimeWidget:()=>zn,VanillaValueSources:()=>vo,vanillaConfirm:()=>ho});var l={};r.r(l),r.d(l,{ProximityOperator:()=>bo});var a={};r.r(a),r.d(a,{chroma:()=>Oo.Ay,generateCssVarsForLevels:()=>So,isColor:()=>jo,isDarkColor:()=>Fo,setColorOpacity:()=>Ao});var u={};r.r(u),r.d(u,{W:()=>Ko});var s=r(32645),c=r(30965),d=r(62662),p=r(63378),f=r(26477),v=r(67308),g=r(7262),h=r(5821),m=r.n(h);const y=g.kG,b=v.createContext();var O=r(80652),A=r(91761),S="after",F="before",j="append",w="prepend",E=function(e,t){return{type:"SET_DRAG_PROGRESS",mousePos:e,dragging:t}},C=function(e,t,r){return{type:"SET_DRAG_START",dragStart:e,dragging:t,mousePos:r}},_=function(){return{type:"SET_DRAG_END"}},L=g.aI.B2,k=g.aI.Os,T=g.aI.Hu,P=r(6467),V=r(2716),x=r(7736);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R=function(e,t,r){if(!t||!e||e.length<=t)return e;var n=e.substr(0,t-1);return(r?n.substr(0,n.lastIndexOf(" ")):n)+"..."},N=function(e,t){return e===t||(null==e?void 0:e.equals(t))},q=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++)if(!(r?q(e[o],t[o],r):e[o]===t[o]))return!1;return!0}(e,t,r):e&&"function"==typeof e.equals?e.equals(t):"object"===(0,V.A)(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var l=0;l<i;l++){var a=n[l];if(!(r?q(e[a],t[a],r):e[a]===t[a]))return!1}return!0}(e,t,r):e===t)};var M=void 0!==x&&"true"==(null==x||null===(x={NODE_ENV:"production"})||void 0===x?void 0:x.NODE_ENV_TEST)?D(D({},console),{},{log:function(){},debug:function(){},info:function(){}}):void 0!==x&&"development"==(null==x||null===(x={NODE_ENV:"production"})||void 0===x?void 0:x.NODE_ENV)?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}},W=g.Aq.Validation.validateAndFixTree,G=r(97932),z=r.n(G),B=function(e){if(e){var t,r=(t=e)._reactRootContainer?"root":Object.getOwnPropertyNames(t).filter((function(e){return e.startsWith("__reactContainer")})).length>0?"container":void 0;return void 0!==r?r:B(e.parentNode)}},U=function(e){return"root"===B(e)},$=function(e,t){return function(r,n){var o=e.props,i=e.state,l=r!=o||n!=i;if(l&&i==n&&o!=r){var a=[];for(var u in r){var s=r[u]!=o[u];s&&("ignore"==t[u]?s=!1:"shallow_deep"==t[u]?s=!q(r[u],o[u],!0):"shallow"==t[u]?s=!q(r[u],o[u]):"function"==typeof t[u]&&(s=t[u](r[u],o[u],r,o))),s&&a.push(u)}a.length||(l=!1)}return l}},H=function(e){return function(t,r){return!q(e.props,t)||!q(e.state,r)}},J=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=H(e)),16==(r=v.version.split(".").map(parseInt.bind(null,10)))[0]&&r[1]<3||r[0]<16)e.componentWillReceiveProps=function(t){e.onPropsChanged(t)};else{var t=e.shouldComponentUpdate;e.shouldComponentUpdate=function(r,n){return!q(e.props,r)&&e.onPropsChanged(r),t.call(e,r,n)}.bind(e)}var r},Y=function(e,t,r){return z()(e,(function(e){return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r(e.apply(void 0,[t].concat(o)))}}))};function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(X=function(){return!!e})()}r(12495);var Z=function(e){function t(e){var r,n,o,i;(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,X()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).shouldComponentUpdate=$(r,{tree:function(e){return e!==r.oldValidatedTree||r.oldValidatedTree!==r.validatedTree}}),J(r),r._updateActions(e),r.validatedTree=e.getMemoizedTree(e.config,e.tree,void 0,e.sanitizeTree),r.oldValidatedTree=r.validatedTree;var l=e.getBasicConfig(e.config);return e.onInit&&e.onInit(r.validatedTree,l,void 0,r.actions),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"_updateActions",value:function(e){var t=e.config,r=e.dispatch;this.actions=Y(Q(Q(Q({},L),k),T),t,r)}},{key:"onPropsChanged",value:function(e){var t=e.onChange,r=this.props.config,n=e.tree,o=(this.props.tree,e.config);if(this.oldValidatedTree=this.validatedTree,this.validatedTree=n,r!==o&&(this._updateActions(e),this.validatedTree=e.getMemoizedTree(o,n,r)),!N(this.validatedTree,this.oldValidatedTree)){var i=e.getBasicConfig(o);t&&t(this.validatedTree,i,e.__lastAction,this.actions)}}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.renderBuilder,n=e.dispatch;return r({tree:this.validatedTree,actions:this.actions,config:t,dispatch:n})}}])}(v.Component);Z.propTypes={config:m().object.isRequired,onChange:m().func,onInit:m().func,renderBuilder:m().func,tree:m().any};var ee=(0,A.Ng)((function(e){return{tree:e.tree,__lastAction:e.__lastAction}}),null,null,{context:b})(Z);ee.displayName="ConnectedQuery";const te=ee;function re(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(re=function(){return!!e})()}var ne=g.Aq.DefaultUtils.defaultRoot,oe=g.Aq.ConfigUtils,ie=oe.createConfigMemo,le=oe.extendConfig,ae=function(e){function t(e,r){var n,o,i,l,a,u;(0,s.A)(this,t),l=this,a=t,u=[e,r],a=(0,p.A)(a),(i=(0,d.A)(l,re()?Reflect.construct(a,u||[],(0,p.A)(l).constructor):a.apply(l,u))).setLastTree=function(e){i.prevTree&&(i.prevprevTree=i.prevTree),i.prevTree=e},i.getConfig=function(){return i.config},i.shouldComponentUpdate=$(i,{value:function(e,t){return!1}}),J(i);var c=ie({reactIndex:null!==(n=null===(o=i._reactInternals)||void 0===o?void 0:o.index)&&void 0!==n?n:-1,maxSize:2,canCompile:!0,extendConfig:le}),f=c.getExtendedConfig,v=c.getBasicConfig,g=c.clearConfigMemo;i.getMemoizedConfig=f,i.getBasicConfig=v,i.clearConfigMemo=g,i.getMemoizedTree=function(){var e,t,r;return function(n,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return o?n.__configId===r&&(N(o,e)||N(o,t))?t:(r=n.__configId,e=o,t=!1===l?W(o,null,n,i||n,!1,!1,!1):W(o,null,n,i||n)):null}}();var h=i.getMemoizedConfig(e),m=h.settings.shouldCreateEmptyGroup,b=ne(h,!m),A=!!e.value,S=e.value||b,F=i.getMemoizedTree(h,S,void 0,A),j=y(h,F,i.getMemoizedTree,i.setLastTree,i.getConfig),w=(0,O.y$)(j);return i.config=h,i.state={store:w},i.QueryWrapper=function(e){return h.settings.renderProvider(e,h.ctx)},i}return(0,f.A)(t,e),(0,c.A)(t,[{key:"componentWillUnmount",value:function(){this.clearConfigMemo()}},{key:"onPropsChanged",value:function(e){var t=this.props,r=this.config,n=this.getMemoizedConfig(e),o=r!==n,i=this.state.store.getState().tree,l=!N(e.value,this.props.value)&&!N(e.value,i),a=l?e.value||ne(e):i,u=l&&!N(e.value,this.prevTree)&&!N(e.value,this.prevprevTree);this.sanitizeTree=u||o;var s=o&&!l;if(o&&(t.settings.renderProvider!==e.settings.renderProvider&&(this.QueryWrapper=function(e){return n.settings.renderProvider(e,n.ctx)}),this.config=n),l||o){var c=this.getMemoizedTree(n,a,s?r:void 0,this.sanitizeTree);this.state.store.dispatch(L.setTree(n,c))}}},{key:"render",value:function(){var e=this.props,t=e.renderBuilder,r=e.get_children,n=e.onChange,o=e.onInit,i=this.state.store,l=this.config,a=this.QueryWrapper;return v.createElement(a,{config:l},v.createElement(A.Kq,{store:i,context:b},v.createElement(te,{config:l,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:n,onInit:o,renderBuilder:t||r})))}}])}(v.Component);ae.propTypes={conjunctions:m().object.isRequired,fields:m().object.isRequired,types:m().object.isRequired,operators:m().object.isRequired,widgets:m().object.isRequired,settings:m().object.isRequired,ctx:m().object.isRequired,onChange:m().func,onInit:m().func,renderBuilder:m().func,value:m().any};var ue=r(9885),se=r(42664),ce=r(73188),de=r(30395),pe=r.n(de);function fe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fe=function(){return!!e})()}var ve=g.Aq.ConfigUtils.getFieldConfig;function ge(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ge=function(){return!!e})()}var he=g.Aq.OtherUtils.clone,me=g.Aq.TreeUtils.getFlatTree,ye=!1,be=["isDraggingTempo","isDraggingMe","dragging"];function Oe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Oe=function(){return!!e})()}const Ae=function(e){return function(t){var r;return r=function(r){function n(e){var t,r,o,i;return(0,s.A)(this,n),r=this,o=n,i=[e],o=(0,p.A)(o),(t=(0,d.A)(r,Oe()?Reflect.construct(o,i||[],(0,p.A)(r).constructor):o.apply(r,i))).handleDraggerMouseDown=function(e){var r=t.props.id,n=t.wrapper.current;t.props.onDragStart&&t.props.onDragStart(r,n,e)},t.wrapper=v.createRef(),t}return(0,f.A)(n,r),(0,c.A)(n,[{key:"render",value:function(){var r=this.props,n=r.isDraggingTempo,o=r.isDraggingMe,i=r.dragging,l=(0,ue.A)(r,be),a=l.isTrueLocked,u={};o&&n&&(ye||(u={top:i.y,left:i.x,width:i.w}));var s=pe()(e,"group-or-rule",o&&n?"qb-draggable":null,o&&!n?"qb-placeholder":null,a?"locked":null,"level-"+this.props.lev);return v.createElement("div",{className:s,style:u,ref:this.wrapper,"data-id":this.props.id},v.createElement(t,(0,se.A)({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:o,isDraggingTempo:n},l)))}}])}(v.PureComponent),r.propTypes={isDraggingTempo:m().bool,isDraggingMe:m().bool,onDragStart:m().func,dragging:m().object,isLocked:m().bool,isTrueLocked:m().bool},r}};var Se=r(3511),Fe=r.n(Se),je=r(2691),we=r.n(je);function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ce=function(){return!!e})()}var _e=g.Aq.ConfigUtils,Le=_e.getFieldConfig,ke=_e.getOperatorConfig,Te=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,Ce()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).shouldComponentUpdate=$(r,{selectedField:function(e,t){return!1}}),J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.selectedField,o=e.selectedFieldType,i=e.selectedOperator,l=Le(r,n),a=(0,ce.A)((null==l?void 0:l.operators)||(null===(t=r.types[o])||void 0===t?void 0:t.operators)||[]);n||a.includes(i)||a.push(i);var u=z()(we()(r.operators,(function(e,t){return-1!==(null==a?void 0:a.indexOf(t))})),(function(e,t){return ke(r,t,n)})),s=this.buildOptions(r,u,a),c=u[i]||{},d=i?[i]:null;return{placeholder:this.props.config.settings.operatorPlaceholder,items:s,selectedKey:i,selectedKeys:d,selectedPath:d,selectedLabel:c.label,selectedAltLabel:c.label2||c.tooltip,selectedOpts:c,fieldConfig:l}}},{key:"buildOptions",value:function(e,t,r){return t&&r?Fe()(t).sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})).map((function(e){var r=t[e];return{key:e,path:e,label:r.label,altLabel:r.label2,tooltip:r.tooltip}})):null}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setOperator,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderOperator,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:l,config:t,customProps:r,readonly:o,setField:n},this.meta);return u.items?a(u,t.ctx):null}}])}(v.Component);Te.propTypes={id:m().string,groupId:m().string,config:m().object.isRequired,selectedField:m().any,selectedFieldId:m().string,selectedFieldType:m().string,selectedFieldSrc:m().string,selectedOperator:m().string,readonly:m().bool,customProps:m().object,setOperator:m().func.isRequired};var Pe=r(12024),Ve=["children"],xe=function(e){var t=e.children,r=(0,ue.A)(e,Ve);return v.createElement("div",r,t)},Ie=function(){},De=function(){return v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},v.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),v.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},Re=function(e){return function(t){var r=t.config.settings.useConfirm,n=r?r.call(t.config.ctx,t.config.ctx):null;return v.createElement(e,(0,se.A)({},t,{confirmFn:n}))}},Ne=function(e){var t=e.id,r=e.isLHS,n=e.delta;return[t,r?"L":"R",r?-1:n||0,(e.parentFuncs||[]).map((function(e){var t=(0,Pe.A)(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")].join(":")},qe=function(e,t){var r;return"function"==typeof t?(r=function(r){return null==t?void 0:t(r,e.ctx)}).displayName=t.name:r=t,r};function Me(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Me=function(){return!!e})()}var We=function(e){function t(){return(0,s.A)(this,t),e=this,r=t,n=arguments,r=(0,p.A)(r),(0,d.A)(e,Me()?Reflect.construct(r,n||[],(0,p.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.selectedOperator,l=e.setOperator,a=e.selectedFieldId,u=e.showOperator,s=e.showOperatorLabel,c=e.selectedFieldWidgetConfig,d=e.readonly,p=e.id,f=e.groupId;return[u&&v.createElement(xe,{key:"operators-for-"+a,className:"rule--operator"},t.settings.showLabels&&v.createElement("label",{className:"rule--label"},t.settings.operatorLabel),v.createElement(Te,{key:"operator",config:t,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,selectedFieldId:a,selectedOperator:i,setOperator:l,customProps:t.settings.customOperatorSelectProps,readonly:d,id:p,groupId:f})),s&&v.createElement(xe,{key:"operators-for-"+a,className:"rule--operator"},v.createElement("div",{className:"rule--operator-wrapper"},t.settings.showLabels?v.createElement("label",{className:"rule--label"}," "):null,v.createElement("div",{className:"rule--operator-text-wrapper"},v.createElement("span",{className:"rule--operator-text"},c.operatorInlineLabel))))]}}])}(v.PureComponent),Ge=r(75179),ze=r.n(Ge);function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ue=function(){return!!e})()}var $e=g.Aq.RuleUtils.getFieldPathLabels,He=g.Aq.ConfigUtils,Je=He.getFieldConfig,Ye=He.getFieldParts,Ke=He.getFieldPathParts,Qe=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,Ue()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).setField=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.props.id;if(!n.widgetId){var i=[o,"L",-1].join(":");n.widgetId=i}r.props.setField(e,t,n)},J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.config,o=e.parentField,i=t,l=n.settings,a=l.maxLabelsLength,u=l.fieldSeparatorDisplay,s=l.fieldPlaceholder,c=(l.fieldSeparator,!!t),d=c?null:R(s,a),p=c?Je(n,i):null,f=p||{},v=Ke(i,n),g=Ke(i,n,!0),h=this.getFieldLabel(p,i,n),m=$e(i,n),y=m?m.join(u):null;(y==h||o)&&(y=null);var b=f.label2||f.tooltip,O=Ye(o,n),A=o?Je(n,o):null,S=o?A&&A.subfields:n.fields,F=!c&&r,j=this.buildOptions(O,n,S,F,O),w=F?"Please select field":null;return i&&"object"===(0,V.A)(i)&&(i=void 0),{placeholder:d,items:j,parentField:o,selectedKey:i,selectedKeys:v,selectedPath:g,selectedLabel:h,selectedOpts:f,selectedAltLabel:b,selectedFullLabel:y,errorText:w}}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Ye(t,r),i=(null==e?void 0:e.label)||ze()(o);return R(i,n)}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!r)return null;var a=t.settings,u=a.fieldSeparator,s=a.fieldSeparatorDisplay,c=null!=i&&i.length?i.join(u)+u:"",d=function(e){return Object.keys(e||{}).reduce((function(t,r){var n=e[r];return"!struct"===n.type?t+d(n.subfields):t+(n.type===o?1:0)}),0)};return Fe()(r).map((function(a){var u=[].concat((0,ce.A)(null!=i?i:[]),[a]),p=r[a],f=n.getFieldLabel(p,u,t),v=$e(u,t).join(s);(v==f||null!=e&&e.length)&&(v=null);var g=p.label2,h=p.tooltip,m=p.disabled;if(!p.hideForSelect){if("!struct"==p.type){var y=n.buildOptions(e,t,p.subfields,o,u,{label:f,tooltip:h}),b=d(p.subfields)>0;return{disabled:m,key:a,path:c+a,label:f,fullLabel:v,altLabel:g,tooltip:h,items:y,matchesType:b}}var O=void 0!==o?p.type===o:void 0;return{disabled:m,key:a,path:c+a,label:f,fullLabel:v,altLabel:g,tooltip:h,grouplabel:null==l?void 0:l.label,group:l,matchesType:O}}})).filter((function(e){return!!e}))}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setFieldSrc,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderField;if(!this.meta.items)return null;var u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:l,config:t,customProps:r,readonly:o,setField:this.setField,setFieldSrc:n},this.meta);return a(u,t.ctx)}}])}(v.Component);function Xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ze(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ze=function(){return!!e})()}Qe.propTypes={id:m().string,groupId:m().string,config:m().object.isRequired,selectedField:m().any,selectedFieldSrc:m().string,selectedFieldType:m().string,parentField:m().string,customProps:m().object,readonly:m().bool,setField:m().func.isRequired,setFieldSrc:m().func};var et=g.Aq.clone,tt=g.Aq.ConfigUtils,rt=tt.getFieldConfig,nt=tt.getFuncConfig,ot=tt.getFieldParts,it=tt.getFieldPathParts,lt=tt.getWidgetForFieldOp,at=g.Aq.RuleUtils.getFuncPathLabels,ut=g.Aq.OtherUtils.shallowEqual,st=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),r=(0,d.A)(n,Ze()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i)),J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"].map((function(r){return"parentFuncs"===r?!ut(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0;(!this.meta||["config","field","fieldType","fieldSrc","value","isLHS"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r&&(this.items=this.getItems(e,this.meta))}},{key:"getItems",value:function(e,t){var r=e.config,n=e.field,o=e.fieldType,i=e.isLHS,l=e.operator,a=e.parentFuncs,u=e.fieldDefinition,s=e.isFuncArg,c=t.lookingForFieldType,d=r.settings.canUseFuncForField,p=this.filterFuncs(r,r.funcs,n,o,i,l,d,a,s,u);return this.buildOptions(r,p,c)}},{key:"getMeta",value:function(e){var t=e.config,r=(e._field,e.fieldType),n=e.value,o=e.isLHS,i=e.isFuncArg,l=t.settings,a=l.funcPlaceholder,u=l.fieldSeparatorDisplay,s=n,c=!!n,d=c?null:a,p=c?nt(t,s):null,f=p||{},v=it(s,t),g=it(s,t,!0),h=this.getFuncLabel(p,s,t),m=at(s,t),y=m?m.join(u):null;y==h&&(y=null);var b=o&&!i&&!c&&r;return{placeholder:d,selectedKey:s,selectedKeys:v,selectedPath:g,selectedLabel:h,selectedOpts:f,selectedFullLabel:y,errorText:b?"Please select function":null,lookingForFieldType:b}}},{key:"filterFuncs",value:function(e,t,r,n,o,i,l,a,u,s){t=et(t);var c,d=e.settings.fieldSeparator,p=rt(e,r),f=p,v=lt(e,r,i,"value");return v&&e.widgets[v],u?(f=s,c=null==s?void 0:s.type):p?c=p.type:o||(c=n),function t(n,o){for(var u in n){var s=n[u].subfields,v=(o||[]).concat(u),g=v.join(d),h=nt(e,g);if("!struct"==h.type)0==t(s,v)&&delete n[u];else{var m,y=!c||h.returnType==c;null!==(m=f)&&void 0!==m&&m.funcs&&(y=y&&f.funcs.includes(g)),l&&(y=y&&l(r,p,g,h,i)),!h.allowSelfNesting&&a&&a.map((function(e){var t=(0,Pe.A)(e,2),r=t[0];return t[1],r})).includes(g)&&(y=!1),y||delete n[u]}}return Fe()(n).length}(t,[]),t}},{key:"buildOptions",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!t)return null;var l=e.settings,a=l.fieldSeparator,u=l.fieldSeparatorDisplay,s=null!=o&&o.length?o.join(a)+a:"",c=function(e){return Object.keys(e||{}).reduce((function(t,r){var o=e[r];return"!struct"===o.type?t+c(o.subfields):t+(o.type===n?1:0)}),0)};return Fe()(t).map((function(l){var a=[].concat((0,ce.A)(null!=o?o:[]),[l]),d=t[l],p=r.getFuncLabel(d,a,e),f=at(a,e).join(u);f==p&&(f=null);var v=d.tooltip;if("!struct"==d.type){var g=r.buildOptions(e,d.subfields,n,a,{label:p,tooltip:v}),h=c(d.subfields)>0;return{key:l,path:s+l,label:p,fullLabel:f,tooltip:v,items:g,matchesType:h}}var m=void 0!==n?d.returnType===n:void 0;return{key:l,path:s+l,label:p,fullLabel:f,tooltip:v,grouplabel:null==i?void 0:i.label,group:i,matchesType:m}}))}},{key:"getFuncLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=ot(t,r),i=(null==e?void 0:e.label)||ze()(o);return R(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderFunc,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({config:t,customProps:r,readonly:o,setField:n,items:this.items,id:i,groupId:l},this.meta);return a(u,t.ctx)}}])}(v.Component);st.propTypes={id:m().string,groupId:m().string,config:m().object.isRequired,field:m().any,fieldType:m().string,fieldSrc:m().string,operator:m().string,customProps:m().object,value:m().string,setValue:m().func.isRequired,readonly:m().bool,parentFuncs:m().array,fieldDefinition:m().object,isFuncArg:m().bool,isLHS:m().bool};var ct=r(34978),dt=r.n(ct),pt=r(40222),ft=r.n(pt),vt=r(64234),gt=r.n(vt),ht=["widgetFactory"],mt=["factory"];function yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ot=g.Aq.ListUtils.getTitleInListValues,At=g.Aq.ConfigUtils._widgetDefKeysToOmit,St=g.Aq.TreeUtils,Ft=St._fixImmutableValue,jt=St.isImmutable,wt=(0,v.memo)((function(e){var t=e.widgetFactory,r=(0,ue.A)(e,ht),n=r.config,o=r.isFuncArg,i=r.fieldDefinition||{},l=i.fieldSettings,a=i.defaultValue,u=i.valueSources,s=o&&1==(null==u?void 0:u.length)&&"const"===(null==u?void 0:u[0]),c=(null==l?void 0:l.treeValues)||(null==l?void 0:l.listValues);return s&&a?"boolean"==typeof a?a?r.labelYes||"YES":r.labelNo||"NO":c?Array.isArray(a)?a.map((function(e){return Ot(c,e)||e})).join(", "):Ot(c,a)||a:""+a:t?t(r,n.ctx):"?"}));wt.displayName="WidgetFactoryMemo";var Et=function(e){var t=e.delta,r=e.parentDelta,n=e.isFuncArg,o=e.valueSrc,i=e.value,l=e.valueError,a=e.fieldError,u=e.asyncListValues,s=e.isSpecialRange,c=e.fieldDefinition,d=e.widget,p=e.widgetDefinition,f=e.widgetValueLabel,g=e.valueLabels,h=e.textSeparators,m=e.setValue,y=e.setFuncValue,b=e.config,O=e.field,A=e.fieldSrc,S=e.fieldPath,F=e.fieldType,j=e.isLHS,w=e.operator,E=e.readonly,C=e.parentField,_=e.parentFuncs,L=e.id,k=e.groupId,T=e.widgetId,P=p.factory,V=(0,ue.A)(p,mt),x=i?i.map((function(e){return Ft(e)})):void 0,I=(0,v.useMemo)((function(){if(s){var e=[null==x?void 0:x.get(0),null==x?void 0:x.get(1)];return void 0===e[0]&&void 0===e[1]&&(e=void 0),e}return null==x?void 0:x.get(t)}),[s,i]),D=(0,v.useMemo)((function(){var e;return l?s?[l.get(0),l.get(1),l.get(2)]:null==l||null===(e=l.get)||void 0===e?void 0:e.call(l,t):null}),[s,i]),R=j?a:D,N=(c||{}).fieldSettings,q=f.label,M=f.placeholder,W=g?g.placeholder:null,G=jt(O)?null:O,z=gt()(bt(bt(bt({},V),N),{},{config:b,field:G,fieldPath:S,fieldSrc:A,fieldType:F,isLHS:j,parentField:C,parentFuncs:_,fieldDefinition:c,operator:w,delta:t,parentDelta:r,isSpecialRange:s,isFuncArg:n,value:I,valueSrc:o,valueError:D,fieldError:a,errorMessage:R,label:q,placeholder:M,placeholders:W,textSeparators:h,setValue:m,setFuncValue:y,readonly:E,asyncListValues:u,id:L,groupId:k,widgetId:T,widgetFactory:P,widget:d}),[].concat((0,ce.A)(At),["toJS"]));return v.createElement(wt,(0,se.A)({widgetFactory:P},z))};Et.displayName="WidgetFactory";const Ct=Et;function _t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_t=function(){return!!e})()}var Lt=g.Aq.ConfigUtils,kt=Lt.getFieldConfig,Tt=Lt.getOperatorConfig,Pt=Lt.getFieldWidgetConfig,Vt=Lt.getWidgetForFieldOp,xt=Lt.getValueSourcesForFieldOp,It=g.Aq.RuleUtils.getValueLabel,Dt=g.Aq.DefaultUtils.createListWithOneElement,Rt=g.Aq.OtherUtils.shallowEqual,Nt=(g.Aq.TreeUtils.isImmutable,{cardinality:1}),qt=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,_t()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i)))._setValue=function(e,t,n,o,i,l){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(a.widgetId||(a.widgetId=o),e&&Array.isArray(i)){var u=[r.props.value.get(0),r.props.value.get(1)];u[0]!=i[0]&&r.props.setValue(0,i[0],n,l,a),u[1]!=i[1]&&r.props.setValue(1,i[1],n,l,a)}else r.props.setValue(t,i,n,l,a)},r._setValueSrc=function(e,t,n){var o={widgetId:t};r.props.setValueSrc(e,n,o)},r.renderWidget=function(e,t,r){var n=r.config,o=r.isFuncArg,i=r.leftField,l=r.operator,a=r.value,u=r.valueError,s=r.fieldError,c=r.readonly,d=r.parentField,p=r.parentFuncs,f=r.id,g=r.groupId,h=r.fieldSrc,m=r.fieldType,y=r.isLHS,b=r.setFuncValue,O=r.parentDelta,A=n.settings,S=t.widgets,F=t.iValues,j=t.aField,w=t.valueSources,E=o?F:a,C=o?i:j,_=S[e],L=_.valueSrc,k=_.valueLabel,T=_.widgetId,P=w.length>1&&!c,V=A.showLabels?v.createElement("label",{key:"label-"+T,className:"rule--label"},k.label):null;return v.createElement("div",{key:"wrapper-"+T,className:pe()("func"===L?"widget--func":"widget--widget",P?"widget--has-valuesrcs":"widget--has-no-valuesrcs")},"func"===L?null:V,v.createElement(Ct,(0,se.A)({key:T,id:f,groupId:g,widgetId:T,valueSrc:L,delta:e,value:E,valueError:u,fieldError:s,isFuncArg:o,isLHS:y},ft()(t,["isSpecialRange","fieldDefinition","asyncListValues"]),ft()(S[e],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValue"]),{setFuncValue:b,config:n,field:C,fieldSrc:h,fieldType:m,parentField:d,parentFuncs:p,parentDelta:null!=O?O:e,operator:l,readonly:c})))},r.renderValueSources=function(e,t,n){var o=n.config,i=n.isFuncArg,l=n.leftField,a=n.operator,u=n.readonly,s=o.settings,c=t.valueSources,d=t.widgets,p=t.aField,f=t.valueSourcesOptions,g=i?l:p,h=d[e],m=h.valueSrc,y=h.setValueSrc,b=r.ValueSources,O=s.showLabels?v.createElement("label",{className:"rule--label"}," "):null;return c.length>1&&!u&&v.createElement("div",{key:"wrapper-valuesrc-"+e,className:"widget--valuesrc"},O,v.createElement(b,{key:"valuesrc-"+e,delta:e,valueSources:f,valueSrc:m,config:o,field:g,operator:a,setValueSrc:y,readonly:u,title:s.valueSourcesPopupTitle}))},r.renderSep=function(e,t,r){var n=r.config,o=t.widgets,i=n.settings,l=o[e].sepText,a=i.showLabels?v.createElement("label",{className:"rule--label"}," "):null;return l&&v.createElement("div",{key:"widget-separators-"+e,className:pe()("widget--sep",0==e&&"widget--sep-first")},a,v.createElement("span",null,l))},r.renderWidgetDelta=function(e){return[r.renderSep(e,r.meta,r.props),r.renderValueSources(e,r.meta,r.props),r.renderWidget(e,r.meta,r.props)]},J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config),n=["config","id","parentFuncs","field","fieldId","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue","value","parentDelta"].filter((function(r){return"parentFuncs"===r?!Rt(e[r],t[r],!0):"field"===r?e.fieldId!==t.fieldId:e[r]!==t[r]}));if((!this.meta||n.length>0)&&(this.meta=this.getMeta(e,n)),r){var o=e.config,i=o.settings.renderValueSources;this.ValueSources=qe(o,i)}}},{key:"getMeta",value:function(e){var t,r,n,o,i=this,l=e.config,a=e.field,u=(e.fieldSrc,e.fieldType),s=e.fieldFunc,c=e.fieldArg,d=e.operator,p=e.valueSrc,f=e.value,v=e.isForRuleGroup,g=e.isCaseValue,h=e.isFuncArg,m=(e.leftField,e.asyncListValues),y=e.parentFuncs,b=e.isLHS,O=e.id,A=e.parentDelta,S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],F=l.settings.valueSourcesInfo,j=h?{func:s,arg:c}:a,w=!a&&u,E=p,C=f;(h||v||g)&&(E=Dt(p),C=Dt(f));var _=kt(l,j);!_&&w&&(_=l.types[u]);var L,k=Vt(l,j,d);!k&&w&&(k=null===(L=l.types[u])||void 0===L?void 0:L.mainWidget);var T=h?Nt:Tt(l,d,j);if((null==_||null==T)&&!g)return null;var P,V,x=null==T?void 0:T.isSpecialRange,I=x&&("field"===(null===(t=E)||void 0===t?void 0:t.get(0))||"field"===(null===(r=E)||void 0===r?void 0:r.get(1))),D=x&&!I,R=D?1:null!==(V=null==(P=T)?void 0:P.cardinality)&&void 0!==V?V:1;if(0===R)return null;var N=null===(n=this.meta)||void 0===n?void 0:n.valueSources,q=null===(o=this.meta)||void 0===o?void 0:o.valueSourcesOptions,M={value:"Value",field:"Field",func:"Function"};N&&!["field","operator","config","fieldDefinition","isForRuleGroup"].filter((function(e){return S.includes(e)})).length||(N=xt(l,j,d,_),v&&(N=["value"]),j||(N=Object.keys(F)),q=N.map((function(e){var t,r,n;return[e,{label:null!==(t=null!==(r=null===(n=F[e])||void 0===n?void 0:n.label)&&void 0!==r?r:M[e])&&void 0!==t?t:e}]})));var W=(h?[0]:dt()(0,R)).map((function(e){var t,r,n,o,a=null===(t=i.meta)||void 0===t||null===(t=t.widgets)||void 0===t?void 0:t[e],u=(null===(r=E)||void 0===r?void 0:r.get(e))||null,s=Vt(l,j,d,u),c=Pt(l,j,d,s,u);I&&(s=c.singleWidget,c=Pt(l,j,d,s,u)),!c&&w&&(s=["func","field"].includes(u)?u:k,c=l.widgets[s]);var p=null===(n=c)||void 0===n?void 0:n.type,f=It(l,j,d,e,u,D),v=It(l,j,d,e,null,D),g=null!=T&&T.textSeparators?null==T?void 0:T.textSeparators[e]:null,h=null,m=null;x&&(h={placeholder:[(h=[It(l,j,d,0),It(l,j,d,1)])[0].placeholder,h[1].placeholder],label:[h[0].label,h[1].label]},m=null==T?void 0:T.textSeparators);var S=Ne({id:O,isLHS:b,delta:null!=A?A:e,parentFuncs:y}),F=S+":VS",C=null==a?void 0:a.setValueSrc;C&&(null==a?void 0:a.widgetId)===S||(C=i._setValueSrc.bind(i,e,F));var _=null==a?void 0:a.setValue;return _&&(null==a?void 0:a.widgetId)===S&&(null==a?void 0:a.widgetType)===p&&(null===(o=i.meta)||void 0===o?void 0:o.isSpecialRange)===x||(_=i._setValue.bind(i,x,e,p,S)),{valueSrc:u,valueLabel:f,widget:s,sepText:g,widgetDefinition:c,widgetValueLabel:v,valueLabels:h,textSeparators:m,setValueSrc:C,setValue:_,widgetId:S,widgetType:p}}));return{defaultWidget:k,fieldDefinition:_,operatorDefinition:T,isSpecialRange:D,cardinality:R,valueSources:N,valueSourcesOptions:q,widgets:W,iValues:C,aField:j,asyncListValues:m}}},{key:"render",value:function(){if(!this.meta)return null;var e=this.meta,t=e.defaultWidget,r=e.cardinality,n=this.meta.isFuncArg;if(!t)return null;var o=t;return v.createElement(xe,{className:"rule--widget rule--widget--".concat(o.toUpperCase()),key:"widget-col-"+o},(n?[0]:dt()(0,r)).map(this.renderWidgetDelta))}}])}(v.Component);function Mt(e,t,r){return t=(0,p.A)(t),(0,d.A)(e,Wt()?Reflect.construct(t,r||[],(0,p.A)(e).constructor):t.apply(e,r))}function Wt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Wt=function(){return!!e})()}qt.propTypes={config:m().object.isRequired,value:m().any,valueSrc:m().any,valueError:m().any,fieldError:m().string,field:m().any,fieldSrc:m().string,fieldType:m().string,fieldId:m().string,operator:m().string,readonly:m().bool,asyncListValues:m().array,id:m().string,groupId:m().string,setValue:m().func,setValueSrc:m().func,setFuncValue:m().func,isFuncArg:m().bool,fieldFunc:m().string,fieldArg:m().string,leftField:m().any,isForRuleGroup:m().bool,parentField:m().string,parentFuncs:m().array,isLHS:m().bool,parentDelta:m().number,isCaseValue:m().bool};var Gt=g.Aq.ConfigUtils.getFuncConfig,zt=g.Aq.OtherUtils.shallowEqual,Bt=function(e){function t(e){var r;return(0,s.A)(this,t),(r=Mt(this,t,[e])).setFunc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.props,o=n.isLHS,i=n.parentDelta,l=n.parentFuncs,a=n.id;if(!t.widgetId){var u=Ne({id:a,isLHS:o,delta:i,parentFuncs:l});t.widgetId=u}r.props.setFuncValue(o?-1:i||0,l,null,e,"!func",void 0,t)},r.setArgValue=function(e,t,n,o,i){var l=r.props,a=(l.config,l.parentDelta),u=l.isLHS,s=l.parentFuncs;r.props.setFuncValue(u?-1:a||0,s,e,t,n,o,i)},r.setArgValueSrc=function(e,t,n){var o=r.props,i=(o.config,o.parentDelta),l=o.isLHS,a=o.parentFuncs;r.props.setFuncValue(l?-1:i||0,a,e,t,"!valueSrc",void 0,n)},r.renderFuncSelect=function(){var e,t,n=r.props,o=n.config,i=n.field,l=n.fieldType,a=n.fieldSrc,u=n.isLHS,s=n.operator,c=n.customProps,d=n.value,p=n.readonly,f=n.parentFuncs,g=n.id,h=n.groupId,m=n.isFuncArg,y=n.fieldDefinition,b=(n.parentDelta,{value:null!==(e=null==d||null===(t=d.get)||void 0===t?void 0:t.call(d,"func"))&&void 0!==e?e:null,setValue:r.setFunc,config:o,field:i,fieldType:l,fieldSrc:a,isLHS:u,operator:s,customProps:c,readonly:p,parentFuncs:f,isFuncArg:m,fieldDefinition:y,id:g,groupId:h}),O=o.settings,A=O.showLabels,S=O.funcLabel,F=A?v.createElement("label",{className:"rule--label"},S):null;return v.createElement(xe,{key:"func",className:"rule--func"},F,v.createElement(st,b))},r.renderArgLabel=function(e,t){var n=t.valueSources,o=t.type,i=t.showPrefix,l=t.label,a=r.props.config,u=n&&1==n.length&&"const"==n[0];return a.settings.showLabels||"boolean"!=o&&!u||!i?null:v.createElement(xe,{className:"rule--func--arg-label"},l||e)},r.renderArgLabelSep=function(e,t){var n=t.valueSources,o=t.type,i=t.showPrefix,l=r.props.config,a=n&&1==n.length&&"const"==n[0];return l.settings.showLabels||"boolean"!=o&&!a||!i?null:v.createElement(xe,{className:"rule--func--arg-label-sep"},":")},r.renderArgVal=function(e,t,n){var o=r.props,i=o.config,l=o.field,a=o.fieldType,u=o.fieldSrc,s=o.isLHS,c=(o.operator,o.value),d=o.readonly,p=o.parentFuncs,f=o.id,g=o.groupId,h=o.fieldError,m=o.valueError,y=o.setFuncValue,b=o.parentDelta,O=c?c.getIn(["args",t]):null,A=O?O.get("value"):void 0,S=1==n.valueSources.length?n.valueSources[0]:void 0,F={config:i,fieldFunc:e,fieldArg:t,leftField:l,fieldType:a,fieldSrc:u,fieldError:h,valueError:m,isLHS:s,operator:null,value:A,valueSrc:O?O.get("valueSrc")||S||"value":S,asyncListValues:null==O?void 0:O.get("asyncListValues"),setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:y,funcKey:e,argKey:t,argDefinition:n,readonly:d,parentFuncs:p,id:f,groupId:g,parentDelta:b};return v.createElement(xe,{className:"rule--func--arg-value"},v.createElement(Ut,F))},r.renderArgSep=function(e,t,r,n){var o=n.renderSeps;return r?v.createElement(xe,{className:"rule--func--arg-sep"},o?o[r-1]:", "):null},r.renderBracketBefore=function(e){var t=e.renderBrackets;return v.createElement(xe,{key:"before_args",className:"rule--func--bracket-before"},t?t[0]:"(")},r.renderBracketAfter=function(e){var t=e.renderBrackets;return v.createElement(xe,{key:"after_args",className:"rule--func--bracket-after"},t?t[1]:")")},r.renderFuncArgs=function(){var e=r.meta,t=e.funcDefinition,n=e.funcKey;if(!n)return null;var o=(t||{}).args;return o?v.createElement(v.Fragment,null,r.renderBracketBefore(t),v.createElement(xe,{key:"args-".concat(n),className:"rule--func--args rule--func--".concat(n,"--args")},Object.keys(o).map((function(e,i){return v.createElement(xe,{key:"arg-".concat(e,"-").concat(i),className:"rule--func--arg rule--func--".concat(n,"--arg--").concat(e)},r.renderArgSep(e,o[e],i,t),r.renderArgLabel(e,o[e]),r.renderArgLabelSep(e,o[e]),r.renderArgVal(n,e,o[e]))}))),r.renderBracketAfter(t)):null},J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","field","operator","value","fieldSrc","fieldType","isLHS"].map((function(r){return"parentFuncs"===r?!zt(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r,n=e.config,o=(e.field,e.operator,e.value),i=null!==(t=null==o||null===(r=o.get)||void 0===r?void 0:r.call(o,"func"))&&void 0!==t?t:null;return{funcDefinition:i?Gt(n,i):null,funcKey:i}}},{key:"render",value:function(){var e=this.props.parentFuncs,t=e?e.map((function(e){var t=(0,Pe.A)(e,2),r=t[0],n=t[1];return"".concat(r,"_").concat(n)})).join("-"):"root",r=(null==e?void 0:e.length)||0;return v.createElement(xe,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(t," rule--func--wrapper--lev-").concat(r)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(v.Component);Bt.propTypes={id:m().string,groupId:m().string,config:m().object.isRequired,field:m().any,fieldSrc:m().string,fieldType:m().string,fieldError:m().string,operator:m().string,customProps:m().object,value:m().object,setValue:m().func.isRequired,setFuncValue:m().func,readonly:m().bool,parentFuncs:m().array,parentDelta:m().number,fieldDefinition:m().object,isFuncArg:m().bool,isLHS:m().bool,valueError:m().string};var Ut=function(e){function t(e){var r;return(0,s.A)(this,t),(r=Mt(this,t,[e])).setValue=function(e,t,n,o,i){var l=r.props;(0,l.setValue)(l.argKey,t,n,o,i)},r.setValueSrc=function(e,t,n){var o=r.props;(0,o.setValueSrc)(o.argKey,t,n)},J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["parentFuncs","funcKey","argKey"].map((function(r){return"parentFuncs"===r?!zt(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.parentFuncs,r=e.funcKey,n=e.argKey;return{parentFuncs:[].concat((0,ce.A)(t||[]),[[r,n]])}}},{key:"render",value:function(){var e=this.meta.parentFuncs;return v.createElement(qt,(0,se.A)({},this.props,{parentDelta:this.props.parentDelta,setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:e}))}}])}(v.Component);function $t(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($t=function(){return!!e})()}Ut.propTypes={funcKey:m().string.isRequired,argKey:m().string.isRequired,setValue:m().func.isRequired,setValueSrc:m().func.isRequired,readonly:m().bool,isLHS:m().bool,parentFuncs:m().array,id:m().string,groupId:m().string};var Ht=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,$t()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).renderField=function(){var e=r.props,t=e.config,n=e.classname,o=e.selectedField,i=e.selectedFieldSrc,l=e.selectedFieldType,a=e.setField,u=e.setFuncValue,s=e.parentField,c=e.readonly,d=e.id,p=e.groupId,f=e.fieldError,g=e.valueError;if(!["func","field"].includes(i))return"?";var h="func"===i?v.createElement(Bt,{isLHS:!0,config:t,value:o,fieldSrc:i,fieldType:l,fieldError:f,valueError:g,parentField:s,setValue:a,setFuncValue:u,readonly:c,id:d,groupId:p,key:"field-func-"+d}):v.createElement(Qe,{config:t,selectedField:o,selectedFieldSrc:i,selectedFieldType:l,parentField:s,setField:a,customProps:t.settings.customFieldSelectProps,readonly:c,id:d,groupId:p,key:"field-"+d}),m="func"===i?t.settings.funcLabel:t.settings.fieldLabel,y=t.settings.showLabels&&"func"!==i&&v.createElement("label",{className:"rule--label"},m);return v.createElement("div",{key:i,className:n},y,h)},r.renderFieldSources=function(){if(!r.meta)return null;var e=r.props,t=e.config,n=e.readonly,o=e.selectedFieldSrc,i=e.setFieldSrc,l=e.id,a=r.meta.fieldSourcesOptions,u=t.settings,s=r.ValueSources,c=u.showLabels?v.createElement("label",{className:"rule--label"}," "):null;return a.length>1&&!n&&v.createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},c,v.createElement(s,{key:"fieldsrc-"+l,valueSources:a,valueSrc:o,config:t,setValueSrc:i,readonly:n,title:u.fieldSourcesPopupTitle}))},J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config);if((!this.meta||["config"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r){var n=e.config,o=n.settings.renderValueSources;this.ValueSources=function(e){return o(e,n.ctx)}}}},{key:"getMeta",value:function(e){var t=e.config,r={value:"Value",field:"Field",func:"Function"},n=t.settings,o=n.valueSourcesInfo;return{fieldSourcesOptions:n.fieldSources.map((function(e){var t,n,i;return[e,{label:null!==(t=null!==(n=null===(i=o[e])||void 0===i?void 0:i.label)&&void 0!==n?n:r[e])&&void 0!==t?t:e}]}))}}},{key:"render",value:function(){var e=this.props,t=(e.classname,e.canSelectFieldSource),r=t&&this.renderFieldSources(),n=this.renderField();return t?v.createElement(xe,{className:"rule--field-wrapper"},r,n):n}}])}(v.Component),Jt=["factory"];function Yt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Yt=function(){return!!e})()}var Kt=g.Aq.ConfigUtils.getOperatorConfig,Qt=function(e){function t(){return(0,s.A)(this,t),e=this,r=t,n=arguments,r=(0,p.A)(r),(0,d.A)(e,Yt()?Reflect.construct(r,n||[],(0,p.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var e=Kt(this.props.config,this.props.selectedOperator,this.props.selectedField);if(void 0===e.options)return null;var t=e.options,r=t.factory,n=(0,ue.A)(t,Jt),o=r(Object.assign({},n,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),this.props.config.ctx),i=this.props.selectedOperator;return v.createElement("div",{className:"rule--operator rule--operator--".concat(i.toUpperCase())},o)}}])}(v.PureComponent);function Xt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function er(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(er=function(){return!!e})()}Qt.propTypes={config:m().object.isRequired,operatorOptions:m().any.isRequired,selectedField:m().any,selectedFieldSrc:m().string,selectedOperator:m().string.isRequired,readonly:m().bool,setOperatorOption:m().func.isRequired};var tr=g.Aq.ConfigUtils,rr=tr.getFieldConfig,nr=tr.getOperatorConfig,or=tr.getFieldWidgetConfig,ir=tr.getFieldId,lr=g.Aq.RuleUtils.isEmptyRuleProperties,ar=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),r=(0,d.A)(n,er()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i)),J(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props,n=!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if((!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked","parentField","parentFieldCanReorder"].map((function(t){return e[t]!==r[t]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),n){var o=e.config,i=o.settings,l=i.renderIcon,a=i.renderButton,u=i.renderButtonGroup,s=i.renderSwitch,c=i.renderBeforeWidget,d=i.renderAfterWidget,p=i.renderRuleError;this.Icon=qe(o,l),this.Btn=qe(o,a),this.BtnGrp=qe(o,u),this.Switch=qe(o,s),this.BeforeWidget=qe(o,c),this.AfterWidget=qe(o,d),this.RuleError=qe(o,p)}this.doRemove=function(){t.props.removeSelf()}}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.selectedOperator,o=e.config,i=e.reordableNodesCnt,l=e.isLocked,a=e.parentField,u=e.parentFieldCanReorder,s=o.settings.keepInputOnChangeFieldSrc,c=ir(t,o),d=rr(o,t),p=d&&"!struct"===d.type,f=!!t||s&&r,v=f&&n,g=nr(o,n,t),h=g&&null!=g.options,m=or(o,t,n,null,null)||{},y=m.hideOperator,b=o.settings.canReorder&&i>1&&!l;return a&&(b=b&&u),{selectedFieldId:c,selectedFieldWidgetConfig:m,showDragIcon:b,showOperator:f&&!y,showOperatorLabel:f&&y&&m.operatorInlineLabel,showWidget:v&&!p,showOperatorOptions:v&&h}}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,i=n.removeRuleConfirmOptions;i&&!this.isEmptyCurrentRule()?o.call(r.ctx,Zt(Zt({},i),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"_buildWidgetProps",value:function(e,t){var r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.selectedOperator,l=e.operatorOptions,a=e.value,u=e.valueType,s=e.valueSrc,c=e.asyncListValues,d=e.valueError,p=e.fieldError,f=e.parentField;return{field:r,fieldSrc:n,fieldType:o,fieldId:t.selectedFieldId,operator:i,operatorOptions:l,value:a,valueType:u,valueSrc:s,asyncListValues:c,valueError:d,fieldError:p,parentField:f}}},{key:"isEmptyCurrentRule",value:function(){var e=this.props.config,t=this._buildWidgetProps(this.props,this.meta);return lr(t,e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.parentField,o=e.groupId,i=e.id,l=e.selectedFieldSrc,a=e.selectedField,u=e.selectedFieldType,s=e.setField,c=e.setFuncValue,d=e.setFieldSrc,p=e.fieldError,f=t.settings.immutableFieldsMode,g=this.meta.selectedFieldId;return v.createElement(Ht,{key:"field",classname:pe()("func"==l?"rule--field--func":"rule--field"),config:t,canSelectFieldSource:!n,selectedField:a,selectedFieldSrc:l,selectedFieldType:u,selectedFieldId:g,fieldError:p,setField:f?Ie:s,setFuncValue:f?Ie:c,setFieldSrc:f?Ie:d,parentField:n,readonly:f||r,id:i,groupId:o})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta,o=n.selectedFieldId,i=n.selectedFieldWidgetConfig,l=n.showOperator,a=n.showOperatorLabel,u=t.settings.immutableOpsMode;return v.createElement(We,{key:"operator",config:t,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedFieldId:o,selectedOperator:this.props.selectedOperator,setOperator:u?Ie:this.props.setOperator,showOperator:l,showOperatorLabel:a,selectedFieldWidgetConfig:i,readonly:u||r,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta.showWidget,o=t.settings.immutableValuesMode;if(!n)return null;var i=v.createElement(qt,(0,se.A)({key:"values"},this._buildWidgetProps(this.props,this.meta),{config:t,setValue:o?Ie:this.props.setValue,setValueSrc:o?Ie:this.props.setValueSrc,setFuncValue:o?Ie:this.props.setFuncValue,readonly:o||r,id:this.props.id,groupId:this.props.groupId}));return v.createElement(xe,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},i)}},{key:"renderOperatorOptions",value:function(){var e=this.props.config,t=this.meta.showOperatorOptions,r=e.settings,n=r.immutableOpsMode,o=r.immutableValuesMode;if(!t)return null;var i=v.createElement(Qt,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:n?Ie:this.props.setOperatorOption,config:e,readonly:o});return v.createElement(xe,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},i)}},{key:"renderBeforeWidget",value:function(){var e=this.BeforeWidget;return e?v.createElement(xe,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},v.createElement(e,this.props)):null}},{key:"renderAfterWidget",value:function(){var e=this.AfterWidget;return e?v.createElement(xe,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},v.createElement(e,this.props)):null}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=e.fieldError,o=t.settings.showErrorMessage,i=this.RuleError,l=[n].concat((0,ce.A)((null==r?void 0:r.toArray())||[])).filter((function(e){return!!e})).shift()||null;return o&&l&&v.createElement("div",{className:"rule--error"},i?v.createElement(i,{error:l}):l)}},{key:"renderDrag",value:function(){var e=this.props,t=e.handleDraggerMouseDown,r=e.config,n=e.isLocked,o=this.meta.showDragIcon,i=this.Icon,l=v.createElement(i,{type:"drag",config:r,readonly:n});return o&&v.createElement("div",{key:"rule-drag-icon",onMouseDown:t,className:"qb-drag-handler rule--drag-handler"},l)}},{key:"renderDel",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=t.settings,o=n.deleteLabel,i=n.immutableGroupsMode,l=n.canDeleteLocked,a=this.Icon,u=this.Btn;return!i&&(!r||r&&l)&&v.createElement(u,{key:"rule-del",type:"delRule",onClick:this.removeSelf,label:o,config:t,renderIcon:a})}},{key:"renderLock",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.isTrueLocked,o=e.id,i=t.settings,l=i.lockLabel,a=i.lockedLabel,u=i.showLock,s=this.Switch;return u&&!(r&&!n)&&v.createElement(s,{key:"rule-lock",type:"lock",id:o,value:r,setValue:this.setLock,label:l,checkedLabel:a,hideLabel:!0,config:t})}},{key:"render",value:function(){var e=this.meta,t=e.showOperatorOptions,r=e.selectedFieldWidgetConfig,n=this.props,o=n.valueSrc,i=n.value,l=n.config,a="value"==(null==o?void 0:o.first())&&!t&&1==i.size&&r.fullWidth,u=this.BtnGrp,s=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],c=v.createElement("div",{key:"rule-body",className:pe()("rule--body",a&&"can--shrink--value")},s),d=this.renderError(),p=this.renderDrag(),f=this.renderLock(),g=this.renderDel();return v.createElement(v.Fragment,null,p,v.createElement("div",{key:"rule-body-wrapper",className:"rule--body--wrapper"},c,d),v.createElement("div",{key:"rule-header-wrapper",className:"rule--header"},v.createElement(u,{key:"rule-header-group",config:l},f,g)))}}])}(v.Component);ar.propTypes={id:m().string.isRequired,groupId:m().string,selectedField:m().any,selectedFieldSrc:m().string,selectedFieldType:m().string,selectedOperator:m().string,operatorOptions:m().object,config:m().object.isRequired,value:m().any,valueSrc:m().any,valueType:m().any,asyncListValues:m().array,isDraggingMe:m().bool,isDraggingTempo:m().bool,parentField:m().string,valueError:m().any,fieldError:m().string,isLocked:m().bool,isTrueLocked:m().bool,handleDraggerMouseDown:m().func,setField:m().func,setFieldSrc:m().func,setOperator:m().func,setOperatorOption:m().func,setLock:m().func,removeSelf:m().func,setValue:m().func,setValueSrc:m().func,setFuncValue:m().func,reordableNodesCnt:m().number,totalRulesCnt:m().number,parentReordableNodesCnt:m().number,parentFieldCanReorder:m().bool};const ur=function(e){var t=(0,A.Ng)((function(e){return{dragging:e.dragging}}),null,null,{context:b})(function(e){var t;return t=function(t){function r(e){var t,n,o,i;return(0,s.A)(this,r),n=this,o=r,i=[e],o=(0,p.A)(o),(t=(0,d.A)(n,fe()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).dummyFn=function(){},t.removeSelf=function(){t.props.actions.removeRule(t.props.path)},t.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setLock(t.props.path,e)},t.setField=function(e,r,n){t.props.actions.setField(t.props.path,e,r,n)},t.setFieldSrc=function(e){t.props.actions.setFieldSrc(t.props.path,e)},t.setOperator=function(e){t.props.actions.setOperator(t.props.path,e)},t.setOperatorOption=function(e,r){t.props.actions.setOperatorOption(t.props.path,e,r)},t.setValue=function(e,r,n,o,i){t.props.actions.setValue(t.props.path,e,r,n,o,i)},t.setValueSrc=function(e,r,n){t.props.actions.setValueSrc(t.props.path,e,r,n)},t.setFuncValue=function(e,r,n,o,i,l,a){t.props.actions.setFuncValue(t.props.path,e,r,n,o,i,l,a)},t.pureShouldComponentUpdate=H(t),t.dummyFn.isDummyFn=!0,t}return(0,f.A)(r,t),(0,c.A)(r,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,l=[];for(var a in e){var u=e[a]!=r[a];"dragging"!=a||i||(u=!1),u&&l.push(a)}l.length||(o=!1)}return o}},{key:"render",value:function(){var t=this.props.path.size-1,r=this.props.dragging.id==this.props.id,n=ve(this.props.config,this.props.field),o=this.props.fieldType||(null==n?void 0:n.type)||null,i=this.props.config.settings.showErrorMessage,l=(n&&n.type,!r&&this.props.isDraggingTempo),a=this.props,u=a.valueError,s=null!=([a.fieldError].concat((0,ce.A)((null==u?void 0:u.toArray())||[])).filter((function(e){return!!e})).shift()||null)&&i;return v.createElement("div",{className:pe()("group-or-rule-container","rule-container",s?"rule-with-error":null),"data-id":this.props.id},[r?v.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,lev:t,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:o,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,v.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,lev:t,isDraggingMe:r,isDraggingTempo:l,onDragStart:this.props.onDragStart,setLock:l?this.dummyFn:this.setLock,removeSelf:l?this.dummyFn:this.removeSelf,setField:l?this.dummyFn:this.setField,setFieldSrc:l?this.dummyFn:this.setFieldSrc,setFuncValue:l?this.dummyFn:this.setFuncValue,setOperator:l?this.dummyFn:this.setOperator,setOperatorOption:l?this.dummyFn:this.setOperatorOption,setValue:l?this.dummyFn:this.setValue,setValueSrc:l?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:o,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(v.Component),t.propTypes={id:m().string.isRequired,groupId:m().string,config:m().object.isRequired,path:m().any.isRequired,operator:m().string,field:m().any,fieldSrc:m().string,fieldType:m().string,actions:m().object.isRequired,onDragStart:m().func,value:m().any,valueSrc:m().any,asyncListValues:m().array,valueError:m().any,fieldError:m().string,operatorOptions:m().object,reordableNodesCnt:m().number,parentField:m().string,isLocked:m().bool,isTrueLocked:m().bool,dragging:m().object,isDraggingTempo:m().bool},t}(e));return t.displayName="ConnectedRuleContainer",t}(Ae("rule")(Re(ar)));var sr=r(28198),cr=r.n(sr);function dr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dr=function(){return!!e})()}var pr=g.Aq.DefaultUtils.defaultGroupConjunction,fr=g.Aq.ConfigUtils.getFieldConfig;const vr=function(e,t){var r=(0,A.Ng)((function(e){return{dragging:e.dragging}}),null,null,{context:b})(function(e,t){var r;return r=function(r){function n(e){var r,o,i,l;return(0,s.A)(this,n),o=this,i=n,l=[e],i=(0,p.A)(i),(r=(0,d.A)(o,dr()?Reflect.construct(i,l||[],(0,p.A)(o).constructor):i.apply(o,l)))._selectedConjunction=function(e){return(e=e||r.props).conjunction||pr(e.config,e.field)},r.setConjunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setConjunction(r.props.path,e)},r.setNot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setNot(r.props.path,e)},r.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setLock(r.props.path,e)},r.dummyFn=function(){},r.removeSelf=function(){r.props.actions.removeGroup(r.props.path)},r.removeGroupChildren=function(){r.props.actions.removeGroupChildren(r.props.path)},r.addGroup=function(){var e="rule_group"==t?r.props.field:r.props.parentField;r.props.actions.addGroup(r.props.path,void 0,void 0,e)},r.addCaseGroup=function(){r.props.actions.addCaseGroup(r.props.path)},r.addDefaultCaseGroup=function(){r.props.actions.addDefaultCaseGroup(r.props.path)},r.addRule=function(){var e="rule_group"==t?r.props.field:r.props.parentField;r.props.actions.addRule(r.props.path,void 0,void 0,void 0,e)},r.setField=function(e,t,n){r.props.actions.setField(r.props.path,e,t,n)},r.setOperator=function(e){r.props.actions.setOperator(r.props.path,e)},r.setValue=function(e,t,n,o,i){r.props.actions.setValue(r.props.path,e,t,n,o,i)},r.setValueSrc=function(e,t,n){r.props.actions.setValueSrc(r.props.path,e,t,n)},r.setFuncValue=function(e,t,n,o,i,l,a){r.props.actions.setFuncValue(r.props.path,e,t,n,o,i,l,a)},r.pureShouldComponentUpdate=H(r),J(r),r.selectedConjunction=r._selectedConjunction(e),r.conjunctionOptions=r._getConjunctionOptions(e),r.dummyFn.isDummyFn=!0,r}return(0,f.A)(n,r),(0,c.A)(n,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,l=[];for(var a in e){var u=e[a]!=r[a];"dragging"!=a||i||(u=!1),u&&l.push(a)}l.length||(o=!1)}return o}},{key:"onPropsChanged",value:function(e){var t=e.config,r=(e.id,e.conjunction),n=this.props.config,o=this.props.conjunction;n==t&&o==r||(this.selectedConjunction=this._selectedConjunction(e),this.conjunctionOptions=this._getConjunctionOptions(e))}},{key:"_getConjunctionOptions",value:function(e){var t=this;return z()(e.config.conjunctions,(function(r,n){return{id:"conjunction-".concat(e.id,"-").concat(n),name:"conjunction[".concat(e.id,"]"),key:n,label:r.label,checked:n===t._selectedConjunction(e)}}))}},{key:"render",value:function(){var t=this.props.config.settings.showErrorMessage,r=this.props.dragging.id==this.props.id,n=this.props.path.size-1,o=this.props.path.size,i=this.props.config.settings.maxNesting,l=1==o;if(this.props.parentField&&this.props.parentFieldPathSize){var a=fr(this.props.config,this.props.parentField);o=this.props.path.size-this.props.parentFieldPathSize+1,i=null==a?void 0:a.maxNesting,l=!1}else if(this.props.field){var u=fr(this.props.config,this.props.field);o=1,i=null==u?void 0:u.maxNesting,l=!1}var s=!r&&this.props.isDraggingTempo,c=this.props.fieldType||null,d=this.props.valueError,p=null!=((0,ce.A)((null==d?void 0:d.toArray())||[]).filter((function(e){return!!e})).shift()||null)&&t,f=void 0===i||o<i,g=i&&o>i;return v.createElement("div",{className:pe()("group-or-rule-container","group-container",p?"group-with-error":null),"data-id":this.props.id},[r?v.createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:l,lev:n,allowFurtherNesting:f,isMaxNestingExceeded:g,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,removeGroupChildren:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:c,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,v.createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:r,isDraggingTempo:s,onDragStart:this.props.onDragStart,isRoot:l,lev:n,allowFurtherNesting:f,isMaxNestingExceeded:g,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:s?this.dummyFn:this.setConjunction,setNot:s?this.dummyFn:this.setNot,setLock:s?this.dummyFn:this.setLock,removeSelf:s?this.dummyFn:this.removeSelf,removeGroupChildren:s?this.dummyFn:this.removeGroupChildren,addGroup:s?this.dummyFn:this.addGroup,addCaseGroup:s?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:s?this.dummyFn:this.addDefaultCaseGroup,addRule:s?this.dummyFn:this.addRule,setField:s?this.dummyFn:this.setField,setFuncValue:s?this.dummyFn:this.setFuncValue,setOperator:s?this.dummyFn:this.setOperator,setValue:s?this.dummyFn:this.setValue,setValueSrc:s?this.dummyFn:this.setValueSrc,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:c,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(v.Component),r.propTypes={config:m().object.isRequired,actions:m().object.isRequired,path:m().any.isRequired,id:m().string.isRequired,groupId:m().string,not:m().bool,conjunction:m().string,children1:m().any,onDragStart:m().func,reordableNodesCnt:m().number,field:m().any,fieldSrc:m().string,fieldType:m().string,parentField:m().string,value:m().any,valueSrc:m().any,valueError:m().any,isLocked:m().bool,isTrueLocked:m().bool,dragging:m().object,isDraggingTempo:m().bool},r}(e,t));return r.displayName="ConnectedGroupContainer",r};function gr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gr=function(){return!!e})()}var hr={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},mr=function(e){function t(){return(0,s.A)(this,t),e=this,r=t,n=arguments,r=(0,p.A)(r),(0,d.A)(e,gr()?Reflect.construct(r,n||[],(0,p.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.removeSelf,i=e.setLock,l=e.isLocked,a=e.isTrueLocked,u=e.id,s=e.parentField,c=e.canAddGroup,d=e.canAddRule,p=e.canDeleteGroup,f=t.settings,g=f.immutableGroupsMode,h=f.addRuleLabel,m=f.addGroupLabel,y=f.addSubRuleLabel,b=f.addSubGroupLabel,O=f.delGroupLabel,A=f.groupActionsPosition,S=f.renderButton,F=f.renderIcon,j=f.renderSwitch,w=f.renderButtonGroup,E=f.lockLabel,C=f.lockedLabel,_=f.showLock,L=f.canDeleteLocked,k=function(e){return F(e,t.ctx)},T=function(e){return S(e,t.ctx)},P=function(e){return j(e,t.ctx)},V=function(e){return w(e,t.ctx)},x=hr[A||"topRight"],I=_&&!(l&&!a)&&v.createElement(P,{type:"lock",id:u,value:l,setValue:i,label:E,checkedLabel:C,config:t}),D=!g&&d&&!l&&v.createElement(T,{type:s?"addSubRule":"addRule",onClick:r,label:s?y:h,readonly:l,config:t,renderIcon:k}),R=!g&&c&&!l&&v.createElement(T,{type:s?"addSubGroup":"addGroup",onClick:n,label:s?b:m,readonly:l,config:t,renderIcon:k}),N=!g&&p&&(!l||l&&L)&&v.createElement(T,{type:"delGroup",onClick:o,label:O,config:t,renderIcon:k});return v.createElement("div",{className:"group--actions ".concat(x)},v.createElement(V,{config:t},I,D,R,N))}}])}(v.PureComponent);function yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?br(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ar=function(){return!!e})()}var Sr=g.Aq.ConfigUtils.getFieldConfig,Fr=g.Aq.RuleUtils.isEmptyGroupChildren,jr=g.Aq.TreeUtils,wr=(jr.getTotalReordableNodesCountInTree,jr.getTotalRulesCountInTree),Er=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,Ar()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return""},r.renderBeforeActions=function(){var e=r.BeforeActions;return null==e?null:v.createElement(e,(0,se.A)({key:"group-actions-before"},r.props))},r.renderAfterActions=function(){var e=r.AfterActions;return null==e?null:v.createElement(e,(0,se.A)({key:"group-actions-after"},r.props))},J(r),r.onPropsChanged(e),r.removeSelf=r.removeSelf.bind(r),r.removeGroupChildren=r.removeGroupChildren.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props;if(!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config)){var n=e.config,o=n.settings,i=o.renderIcon,l=o.renderConjs,a=o.renderBeforeActions,u=o.renderAfterActions;this.Icon=qe(n,i),this.Conjs=qe(n,l),this.BeforeActions=qe(n,a),this.AfterActions=qe(n,u)}this.doRemove=function(){t.props.removeSelf()}}},{key:"isGroupTopPosition",value:function(){return cr()(this.props.config.settings.groupActionsPosition||"topRight","top")}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeGroupChildren",value:function(){this.props.removeGroupChildren()}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,i=n.removeGroupConfirmOptions;i&&!this.isEmptyCurrentGroup()?o.call(r.ctx,Or(Or({},i),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config;return Fr(t,r)}},{key:"showNot",value:function(){var e=this.props,t=e.config,r=e.parentField,n=t.settings.showNot;if(r){var o,i=Sr(t,r);n=n&&(null===(o=null==i?void 0:i.showNot)||void 0===o||o)}return n}},{key:"showConjs",value:function(){var e=this.props.config.settings.forceShowConj,t=this.conjunctionOptions();return Object.keys(t).length>1&&!this.isOneChild()||this.showNot()||e}},{key:"isNoChildren",value:function(){var e=this.props.children1;return!e||0==e.size}},{key:"isOneChild",value:function(){var e=this.props.children1;return!e||e.size<2}},{key:"renderChildrenWrapper",value:function(){return this.props.children1&&v.createElement("div",{key:"group-children",className:pe()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var e=this.isGroupTopPosition();return v.createElement("div",{key:"group-header",className:pe()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),e&&this.renderBeforeActions(),e&&this.renderActions(),e&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){return!this.isGroupTopPosition()&&v.createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,l=e.id,a=e.parentField;return v.createElement(mr,{key:"group-actions",config:t,addRule:r,addGroup:n,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:l,parentField:a})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props,t=e.totalRulesCnt,r=e.isMaxNestingExceeded,n=e.parentField,o=this.props.config.settings.maxNumberOfRules;return n&&(o=Sr(this.props.config,n).maxNumberOfRules),!r&&(!o||t<o)}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var e=this.props.children1;return e?e.valueSeq().toArray().map(this.renderItem):null}},{key:"renderItem",value:function(e){if(e){var t=this.props,r=t.config,n=t.actions,o=t.onDragStart,i=t.isLocked,l=t.parentField,a=t.parentFieldPathSize,u=t.parentFieldCanReorder,s="group"==e.get("type")&&null!=e.getIn(["properties","field"])?"rule_group":e.get("type");return v.createElement(bn,(0,se.A)({key:e.get("id"),id:e.get("id"),groupId:t.id,path:e.get("path"),type:s,properties:e.get("properties"),config:r,actions:n,children1:e.get("children1"),parentField:l,parentFieldPathSize:a,parentFieldCanReorder:u,reordableNodesCnt:this.reordableNodesCntForItem(e),totalRulesCnt:this.totalRulesCntForItem(e),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:o,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:i},this.extraPropsForItem(e)))}}},{key:"extraPropsForItem",value:function(e){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return"rule_group"===e.get("type")?wr(e):this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var e=this.props,t=e.config,r=e.isRoot,n=e.isLocked,o=e.parentField,i=e.parentFieldCanReorder,l=this.reordableNodesCnt(),a=t.settings.canReorder&&!r&&l>1&&!n;return o&&(a=a&&i),a}},{key:"renderDrag",value:function(){var e=this.props,t=e.handleDraggerMouseDown,r=e.config,n=e.isLocked,o=this.Icon,i=v.createElement(o,{type:"drag",readonly:n,config:r});return this.showDragIcon()&&v.createElement("div",{key:"group-drag-icon",onMouseDown:t,className:"qb-drag-handler group--drag-handler"},i)}},{key:"conjunctionOptions",value:function(){var e=this.props,t=e.parentField,r=e.conjunctionOptions;return t?this.conjunctionOptionsForGroupField(t):r}},{key:"conjunctionOptionsForGroupField",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.props,r=t.config,n=t.conjunctionOptions,o=Sr(r,e);if(null!=o&&o.conjunctions){var i,l={},a=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return yr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw i}}}}(o.conjunctions);try{for(a.s();!(i=a.n()).done;){var u=i.value,s=n[u];s&&(l[u]=s)}}catch(e){a.e(e)}finally{a.f()}return l}return n}},{key:"canRenderConjs",value:function(){var e=this.props.children1;return!!this.showConjs()&&!(!e||!e.size)}},{key:"renderConjs",value:function(){var e=this.props,t=e.config,r=e.id,n=e.selectedConjunction,o=e.setConjunction,i=e.not,l=e.setNot,a=e.isLocked,u=t.settings,s=u.immutableGroupsMode,c=u.notLabel,d=this.conjunctionOptions();if(!this.canRenderConjs())return null;var p={disabled:this.isOneChild(),readonly:s||a,selectedConjunction:n,setConjunction:s?Ie:o,conjunctionOptions:d,config:t,not:i||!1,id:r,setNot:s?Ie:l,notLabel:c,showNot:this.showNot(),isLocked:a},f=this.Conjs;return v.createElement(f,(0,se.A)({key:"group-conjs"},p))}},{key:"renderHeader",value:function(){return v.createElement("div",{key:"group-conjunctions",className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"render",value:function(){return v.createElement(v.Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}}])}(v.Component);Er.propTypes={reordableNodesCnt:m().number,conjunctionOptions:m().object.isRequired,allowFurtherNesting:m().bool.isRequired,isMaxNestingExceeded:m().bool,isRoot:m().bool.isRequired,not:m().bool,selectedConjunction:m().string,config:m().object.isRequired,id:m().string.isRequired,groupId:m().string,path:m().any,children1:m().any,isDraggingMe:m().bool,isDraggingTempo:m().bool,isLocked:m().bool,isTrueLocked:m().bool,parentField:m().string,handleDraggerMouseDown:m().func,onDragStart:m().func,addRule:m().func.isRequired,addGroup:m().func.isRequired,removeSelf:m().func.isRequired,removeGroupChildren:m().func.isRequired,setConjunction:m().func.isRequired,setNot:m().func.isRequired,setLock:m().func.isRequired,actions:m().object.isRequired};const Cr=vr(Ae("group simple_group")(Re(Er)),"group");var _r=r(46335);function Lr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Lr=function(){return!!e})()}var kr=function(e){function t(){return(0,s.A)(this,t),e=this,r=t,n=arguments,r=(0,p.A)(r),(0,d.A)(e,Lr()?Reflect.construct(r,n||[],(0,p.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,i=e.removeSelf,l=e.setLock,a=e.isLocked,u=e.isTrueLocked,s=e.id,c=t.settings,d=c.immutableGroupsMode,p=c.addRuleLabel,f=c.delGroupLabel,g=c.renderButton,h=c.renderIcon,m=c.renderSwitch,y=c.renderButtonGroup,b=c.lockLabel,O=c.lockedLabel,A=c.showLock,S=c.canDeleteLocked,F=function(e){return h(e,t.ctx)},j=function(e){return g(e,t.ctx)},w=function(e){return m(e,t.ctx)},E=function(e){return y(e,t.ctx)},C=A&&!(a&&!u)&&v.createElement(w,{type:"lock",id:s,value:a,setValue:l,label:b,checkedLabel:O,hideLabel:!0,config:t}),_=!d&&n&&!a&&v.createElement(j,{type:"addSubRuleSimple",onClick:r,label:p,readonly:a,config:t,renderIcon:F}),L=!d&&o&&(!a||a&&S)&&v.createElement(j,{type:"delRuleGroup",onClick:i,label:f,config:t,renderIcon:F});return v.createElement("div",{className:"group--actions"},v.createElement(E,{config:t},C,_,L))}}])}(v.PureComponent);function Tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vr=function(){return!!e})()}function xr(e,t,r,n){var o=(0,_r.A)((0,p.A)(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}var Ir=g.Aq.ConfigUtils.getFieldConfig,Dr=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,Vr()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){xr(t,"onPropsChanged",this,3)([e])}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.children1;return(null==t?void 0:t.size)||0}},{key:"renderChildrenWrapper",value:function(){return v.createElement(v.Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),xr(t,"renderChildrenWrapper",this,3)([]))}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,l=e.setFuncValue,a=e.setFieldSrc,u=e.parentField,s=e.id,c=e.groupId,d=e.isLocked,p=t.settings.immutableFieldsMode;return v.createElement(Ht,{key:"field",classname:"group--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:l,setFieldSrc:a,parentField:u,readonly:p||d,id:s,groupId:c})}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,i=e.id;return v.createElement(kr,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:i})}},{key:"extraPropsForItem",value:function(e){var t,r=this.props,n=r.selectedField,o=r.lev,i=r.config,l=Ir(i,n);return{parentField:n,parentFieldPathSize:o+1,parentFieldCanReorder:null!==(t=null==l?void 0:l.canReorder)&&void 0!==t?t:i.settings.canReorder}}}])}(Er);Dr.propTypes=Pr(Pr({},Er.propTypes),{},{selectedField:m().any,selectedFieldSrc:m().string,parentField:m().string,setField:m().func,setFieldSrc:m().func,lev:m().number});const Rr=vr(Ae("group rule_group")(Re(Dr)),"rule_group");function Nr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Nr=function(){return!!e})()}var qr=function(e){function t(){return(0,s.A)(this,t),e=this,r=t,n=arguments,r=(0,p.A)(r),(0,d.A)(e,Nr()?Reflect.construct(r,n||[],(0,p.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.canAddRule,i=e.canAddGroup,l=e.canDeleteGroup,a=e.removeSelf,u=e.setLock,s=e.isLocked,c=e.isTrueLocked,d=e.id,p=t.settings,f=p.immutableGroupsMode,g=p.addSubRuleLabel,h=p.addSubGroupLabel,m=p.delGroupLabel,y=p.renderButton,b=p.renderIcon,O=p.renderSwitch,A=p.renderButtonGroup,S=p.lockLabel,F=p.lockedLabel,j=p.showLock,w=p.canDeleteLocked,E=function(e){return b(e,t.ctx)},C=function(e){return y(e,t.ctx)},_=function(e){return O(e,t.ctx)},L=function(e){return A(e,t.ctx)},k=j&&!(s&&!c)&&v.createElement(_,{type:"lock",id:d,value:s,setValue:u,label:S,checkedLabel:F,config:t}),T=!f&&o&&!s&&v.createElement(C,{type:"addSubRule",onClick:r,label:g,readonly:s,config:t,renderIcon:E}),P=!f&&i&&!s&&v.createElement(C,{type:"addSubGroup",onClick:n,label:h,readonly:s,config:t,renderIcon:E}),V=!f&&l&&(!s||s&&w)&&v.createElement(C,{type:"delRuleGroup",onClick:a,label:m,config:t,renderIcon:E});return v.createElement("div",{className:"group--actions group--actions--tr"},v.createElement(L,{config:t},k,T,P,V))}}])}(v.PureComponent);function Mr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Wr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Gr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Gr=function(){return!!e})()}var zr=g.Aq.ConfigUtils,Br=zr.getFieldConfig,Ur=zr.getFieldWidgetConfig,$r=g.Aq.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,Hr=g.Aq.TreeUtils.getTotalReordableNodesCountInTree,Jr=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,Gr()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canDeleteGroup=function(){return!0},r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var r,n,o;(r=t,n=this,"function"==typeof(o=(0,_r.A)((0,p.A)(r.prototype),"onPropsChanged",n))?function(e){return o.apply(n,e)}:o)([e])}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=Br(t,r),o=null==n?void 0:n.maxNumberOfRules,i=this.props.totalRulesCnt;return!o||i<o}},{key:"renderHeaderWrapper",value:function(){return v.createElement(v.Fragment,null,this.renderGroupField(),this.renderError(),this.renderGroupHeader())}},{key:"canRenderHeader",value:function(){return this.canRenderConjs()}},{key:"renderHeader",value:function(){return v.createElement("div",{className:"group--conjunctions"},this.renderConjs())}},{key:"renderGroupField",value:function(){return v.createElement("div",{className:pe()("group--field--count--rule",this.showDragIcon()?"with--drag":"hide--drag")},this.renderDrag(),this.renderField(),this.renderOperator(),this.renderWidget(),this.renderSelfActions())}},{key:"canRenderGroupHeader",value:function(){return this.canRenderHeader()&&this.canRenderChildrenActions()}},{key:"renderGroupHeader",value:function(){return this.canRenderGroupHeader()?v.createElement("div",{className:pe()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderChildrenActions()):null}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings,o=n.renderRuleError,i=n.showErrorMessage,l=(0,ce.A)((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return i&&l&&v.createElement("div",{className:"rule_group--error"},o?o({error:l},t.ctx):l)}},{key:"showNot",value:function(){var e,t=this.props,r=t.config,n=t.selectedField,o=Br(r,n);return null!==(e=null==o?void 0:o.showNot)&&void 0!==e?e:r.settings.showNot}},{key:"conjunctionOptions",value:function(){var e=this.props.selectedField;return this.conjunctionOptionsForGroupField(e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,l=e.setFieldSrc,a=e.setFuncValue,u=e.parentField,s=e.id,c=e.groupId,d=e.isLocked,p=t.settings.immutableFieldsMode;return v.createElement(Ht,{key:"field",classname:"rule--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:a,setFieldSrc:l,parentField:u,readonly:p||d,id:s,groupId:c})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedOperator,i=(e.setField,e.setOperator),l=e.isLocked,a=t.settings.immutableFieldsMode,u=Ur(t,r,o)||{},s=u.hideOperator,c=r&&s&&u.operatorInlineLabel,d=r&&!s;return v.createElement(We,{key:"operator",classname:"group--operator",config:t,selectedField:r,selectedFieldSrc:n,selectedOperator:o,setOperator:i,showOperator:d,showOperatorLabel:c,selectedFieldWidgetConfig:u,readonly:a||l,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config,n=this._buildWidgetProps(this.props);return $r(n,t,r)}},{key:"_buildWidgetProps",value:function(e){var t=e.selectedField,r=e.selectedFieldSrc,n=e.selectedFieldType,o=e.selectedOperator,i=e.operatorOptions,l=e.value,a=e.valueType,u=(e.valueSrc,e.asyncListValues,e.valueError);return e.fieldError,{field:t,fieldSrc:r,fieldType:n,operator:o,operatorOptions:i,value:l,valueType:a,valueSrc:["value"],valueError:u,fieldError:null,parentField:e.parentField}}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.isLocked,i=t.settings.immutableValuesMode;if(!r||!n)return null;var l=v.createElement(qt,(0,se.A)({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:t,setValue:i?Ie:this.props.setValue,setValueSrc:Ie,readonly:i||o,id:this.props.id,groupId:this.props.groupId}));return v.createElement(xe,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},l)}},{key:"showChildrenActionsAsSelf",value:function(){var e=this.props.config.settings.forceShowConj;return this.isNoChildren()||this.isOneChild()&&!e&&!this.showNot()||!this.showNot()&&!this.showConjs()}},{key:"canRenderChildrenActions",value:function(){return!this.showChildrenActionsAsSelf()&&(this.canAddRule()||this.canAddGroup())}},{key:"childrenAreRequired",value:function(){var e,t,r=this.props,n=r.config,o=r.selectedOperator;return 0==(null!==(e=null===(t=n.operators[o])||void 0===t?void 0:t.cardinality)&&void 0!==e?e:1)}},{key:"renderChildrenActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,l=e.id;return v.createElement(qr,{config:t,addRule:r,addGroup:n,canAddRule:!this.showChildrenActionsAsSelf()&&this.canAddRule(),canAddGroup:!this.showChildrenActionsAsSelf()&&this.canAddGroup(),removeSelf:this.removeGroupChildren,canDeleteGroup:!0,isLocked:o,isTrueLocked:i,id:l+"_children"})}},{key:"renderSelfActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,l=e.id;return v.createElement(qr,{config:t,addRule:r,addGroup:n,canAddRule:this.showChildrenActionsAsSelf()&&this.canAddRule(),canAddGroup:this.showChildrenActionsAsSelf()&&this.canAddGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,canDeleteGroup:this.canDeleteGroup(),id:l+"_self"})}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props,r=t.children1,n=t.id;return Hr({id:n,type:"rule_group",children1:r})}},{key:"extraPropsForItem",value:function(e){var t,r=this.props,n=r.selectedField,o=r.lev,i=r.config,l=Br(i,n);return{parentField:n,parentFieldPathSize:o+1,parentFieldCanReorder:null!==(t=null==l?void 0:l.canReorder)&&void 0!==t?t:i.settings.canReorder}}}])}(Er);Jr.propTypes=Wr(Wr({},Er.propTypes),{},{selectedField:m().any,selectedFieldSrc:m().string,selectedOperator:m().string,value:m().any,parentField:m().string,setField:m().func,setFieldSrc:m().func,setOperator:m().func,setValue:m().func,valueError:m().any,lev:m().number});const Yr=vr(Ae("group rule_group_ext")(Re(Jr)),"rule_group");function Kr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Kr=function(){return!!e})()}var Qr={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},Xr=function(e){function t(){return(0,s.A)(this,t),e=this,r=t,n=arguments,r=(0,p.A)(r),(0,d.A)(e,Kr()?Reflect.construct(r,n||[],(0,p.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.setLock,i=e.isLocked,l=e.isTrueLocked,a=e.id,u=e.canAddGroup,s=e.canAddDefault,c=t.settings,d=c.immutableGroupsMode,p=c.addCaseLabel,f=c.addDefaultCaseLabel,g=c.groupActionsPosition,h=c.renderButton,m=c.renderIcon,y=c.renderSwitch,b=c.renderButtonGroup,O=c.lockLabel,A=c.lockedLabel,S=c.showLock,F=function(e){return m(e,t.ctx)},j=function(e){return h(e,t.ctx)},w=function(e){return y(e,t.ctx)},E=function(e){return b(e,t.ctx)},C=Qr[g||"topRight"],_=S&&!(i&&!l)&&v.createElement(w,{type:"lock",id:a,value:i,setValue:o,label:O,checkedLabel:A,config:t}),L=!d&&u&&!i&&v.createElement(j,{type:"addCaseGroup",onClick:r,label:p,readonly:i,config:t,renderIcon:F}),k=!d&&s&&!i&&v.createElement(j,{type:"addDefaultCaseGroup",onClick:n,label:f,readonly:i,config:t,renderIcon:F});return v.createElement("div",{className:"group--actions ".concat(C)},v.createElement(E,{config:t},_,L,k))}}])}(v.PureComponent);function Zr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function en(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(en=function(){return!!e})()}var tn=g.Aq.TreeUtils,rn=tn.getTotalReordableNodesCountInTree,nn=tn.getTotalRulesCountInTree,on=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,en()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var e;return(null===(e=r.props.children1)||void 0===e?void 0:e.size)&&r.props.children1.filter((function(e){return null==e.get("children1")})).size>0},r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var r,n,o;(r=t,n=this,"function"==typeof(o=(0,_r.A)((0,p.A)(r.prototype),"onPropsChanged",n))?function(e){return o.apply(n,e)}:o)([e])}},{key:"canAddGroup",value:function(){var e,t=this.props.config.settings.maxNumberOfCases,r=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return!t||r<t}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var e,t=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return this.hasDefaultCase()&&t--,t}},{key:"totalRulesCntForItem",value:function(e){return nn(e)}},{key:"reordableNodesCntForItem",value:function(e){var t;if(this.props.isLocked)return 0;var r=this.props.config.settings,n=r.canLeaveEmptyCase,o=r.canRegroupCases,i=(null===(t=this.props.children1)||void 0===t?void 0:t.size)||0;this.hasDefaultCase()&&i--;var l=rn(e);return 1==l&&o&&n&&i>1&&(l=111),l}},{key:"showConjs",value:function(){return!0}},{key:"renderHeaderWrapper",value:function(){return v.createElement("div",{key:"group-header",className:pe()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return v.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){return this.props.config.settings.renderSwitchPrefix||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.isLocked,i=e.isTrueLocked,l=e.id;return v.createElement(Xr,{config:t,addCaseGroup:r,addDefaultCaseGroup:n,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:o,isTrueLocked:i,id:l})}}])}(Er);on.propTypes=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zr(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},Er.propTypes);const ln=vr(Ae("group switch_group")(Re(on)),"switch_group");function an(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function un(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?an(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):an(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(sn=function(){return!!e})()}function cn(e,t,r,n){var o=(0,_r.A)((0,p.A)(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}var dn=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,sn()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var r=this.props,n=!this.renderBeforeCaseValue||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if(cn(t,"onPropsChanged",this,3)([e]),n){var o=e.config,i=o.settings,l=i.renderBeforeCaseValue,a=i.renderAfterCaseValue,u=i.renderRuleError;this.BeforeCaseValue=qe(o,l),this.AfterCaseValue=qe(o,a),this.RuleError=qe(o,u)}}},{key:"isDefaultCase",value:function(){return null==this.props.children1}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return!this.isDefaultCase()&&cn(t,"showDragIcon",this,3)([])}},{key:"renderHeaderWrapper",value:function(){return v.createElement("div",{key:"group-header",className:pe()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:v.createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderBeforeValue(),this.renderValue(),this.renderAfterValue())}},{key:"renderHeaderLeft",value:function(){return this.isDefaultCase()?this.props.config.settings.defaultCaseLabel||"":v.createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag(),this.renderError())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:cn(t,"renderChildrenWrapper",this,3)([])}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?v.createElement("div",null,this.renderValue(),this.renderError()):null}},{key:"canAddGroup",value:function(){return!this.isDefaultCase()&&cn(t,"canAddGroup",this,3)([])}},{key:"canAddRule",value:function(){return!this.isDefaultCase()&&cn(t,"canAddRule",this,3)([])}},{key:"renderBeforeValue",value:function(){var e=this.BeforeCaseValue;return null==e?null:v.createElement(e,(0,se.A)({key:"values-before"},this.props))}},{key:"renderAfterValue",value:function(){var e=this.AfterCaseValue;return null==e?null:v.createElement(e,(0,se.A)({key:"values-after"},this.props))}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings.showErrorMessage,o=this.RuleError,i=(0,ce.A)((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return n&&i&&v.createElement("div",{className:"rule--error"},o?v.createElement(o,{error:i}):i)}},{key:"renderValue",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.value,o=e.valueSrc,i=e.valueError,l=e.setValue,a=e.setValueSrc,u=e.setFuncValue,s=e.id,c=t.settings.immutableValuesMode,d=v.createElement(qt,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:n,valueSrc:null!=o?o:"value",valueError:i,fieldError:null,config:t,setValue:c?Ie:l,setValueSrc:c?Ie:a,setFuncValue:c?Ie:u,readonly:c||r,id:s,groupId:null});return v.createElement(xe,{className:"case_group--value"},d)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addGroup,n=e.addRule,o=e.isLocked,i=e.isTrueLocked,l=e.id;return v.createElement(mr,{config:t,addGroup:r,addRule:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:l})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props.value,r=e&&e.size?e.get(0):null,n=null!=r&&(!Array.isArray(r)||r.length>0);return cn(t,"isEmptyCurrentGroup",this,3)([])&&!n}}])}(Er);dn.propTypes=un(un({},Er.propTypes),{},{parentReordableNodesCnt:m().number,value:m().any,setValue:m().func});const pn=vr(Ae("group case_group")(Re(dn)),"case_group");var fn=["type"];function vn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(vn=function(){return!!e})()}function gn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gn(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var mn=function(e){var t,r=(null===(t=e.properties)||void 0===t?void 0:t.toObject())||{},n=hn({},r);return e.isParentLocked&&(n.isLocked=!0),r.isLocked&&(n.isTrueLocked=!0),n},yn={rule:function(e){return v.createElement(ur,(0,se.A)({},mn(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},group:function(e){return v.createElement(Cr,(0,se.A)({},mn(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group:function(e){return v.createElement(Rr,(0,se.A)({},mn(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group_ext:function(e){return v.createElement(Yr,(0,se.A)({},mn(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},switch_group:function(e){return v.createElement(ln,(0,se.A)({},mn(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return v.createElement(pn,(0,se.A)({},mn(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},bn=function(e){function t(){return(0,s.A)(this,t),e=this,r=t,n=arguments,r=(0,p.A)(r),(0,d.A)(e,vn()?Reflect.construct(r,n||[],(0,p.A)(e).constructor):r.apply(e,n));var e,r,n}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){var e,t=this.props,r=t.type,n=(0,ue.A)(t,fn),o="array"==(null===(e=n.properties)||void 0===e?void 0:e.get("mode"))?"_ext":"",i=n.config.settings.renderItem,l=yn[r+o];return i?i(hn(hn({},n),{},{type:r,itemComponent:l}),n.config.ctx):l?l(n):null}}])}(v.PureComponent);function On(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(On=function(){return!!e})()}bn.propTypes={config:m().object.isRequired,id:m().string.isRequired,groupId:m().string,type:m().oneOf(["rule","group","rule_group","switch_group","case_group"]).isRequired,path:m().any.isRequired,properties:m().any,children1:m().any,actions:m().object.isRequired,reordableNodesCnt:m().number,onDragStart:m().func,parentField:m().string,isDraggingTempo:m().bool,isParentLocked:m().bool};var An=g.Aq.TreeUtils,Sn=An.getTotalReordableNodesCountInTree,Fn=An.getTotalRulesCountInTree,jn=g.Aq.DefaultUtils,wn=jn.createListWithOneElement,En=jn.emptyProperties,Cn=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),(r=(0,d.A)(n,On()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i))).pureShouldComponentUpdate=H(r),r._updPath(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.pureShouldComponentUpdate(e,t)}},{key:"_updPath",value:function(e){var t=e.tree.get("id");this.path=wn(t)}},{key:"render",value:function(){var e=this.props,t=e.tree,r=e.config,n=e.actions,o=e.onDragStart,i=t.get("type"),l="switch_group"==i,a=l?null:Sn(t),u=l?null:Fn(t),s=t.get("id");return v.createElement(bn,{key:s,id:s,path:this.path,type:i,properties:t.get("properties")||En(),config:r,actions:n,children1:t.get("children1")||En(),reordableNodesCnt:a,totalRulesCnt:u,parentReordableNodesCnt:0,onDragStart:o})}}])}(v.Component);Cn.propTypes={tree:m().any.isRequired,config:m().object.isRequired,actions:m().object.isRequired,onDragStart:m().func};const _n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(0,A.Ng)((function(e){return{dragging:e.dragging,dragStart:e.dragStart,mousePos:e.mousePos}}),{setDragStart:C,setDragProgress:E,setDragEnd:_},null,{context:b})(function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=function(t){function n(e){var t,o,i,l;return(0,s.A)(this,n),o=this,i=n,l=[e],i=(0,p.A)(i),(t=(0,d.A)(o,ge()?Reflect.construct(i,l||[],(0,p.A)(o).constructor):i.apply(o,l)))._getEventTarget=function(e,t){return e&&e.__mocked_window||document.body||window},t.onDragStart=function(e,r,n){var o=r.closest(".query-builder");if(o){void 0===t._isUsingLegacyReactDomRender&&(t._isUsingLegacyReactDomRender=U(o)),document.body.classList.add("qb-dragging"),o.classList.add("qb-dragging");var i,l=o.closest(".query-builder-container")||o,a=(l=t._getScrollParent(l)||document.body).scrollTop,u=(t._getDraggableNodeEl(o),t._getPlaceholderNodeEl(o),o.querySelectorAll(".group--children")),s=u.length?u[0]:null;s&&(i=window.getComputedStyle(s,null).getPropertyValue("padding-left"),i=parseInt(i));var c={id:e,x:r.offsetLeft,y:r.offsetTop,w:r.offsetWidth,h:r.offsetHeight,itemInfo:t.tree.items[e],paddingLeft:i},d={id:e,x:r.offsetLeft,y:r.offsetTop,scrollTop:a,clientX:n.clientX,clientY:n.clientY,itemInfo:he(t.tree.items[e]),treeEl:o,treeElContainer:l},p={clientX:n.clientX,clientY:n.clientY},f=t._getEventTarget(n,d);t.eventTarget=f,f.addEventListener("mousemove",t.onDrag),f.addEventListener("mouseup",t.onDragEnd),t.props.setDragStart(d,c,p)}else console.error("Please change renderBuilder implementation of <Query>: wrap <Builder> with div.query-builder for drag-n-drop support")},t.onDrag=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object.assign({},t.props.dragging),i=t.props.dragStart,l=o.paddingLeft,a=i.treeElContainer.scrollTop;if(o.itemInfo=t.tree.items[o.id],o.itemInfo){var u={clientX:e.clientX,clientY:e.clientY},s={clientX:i.clientX,clientY:i.clientY};if(e.__mock_dom){var c=i.treeEl,d=t._getDraggableNodeEl(c),p=t._getPlaceholderNodeEl(c);e.__mock_dom({treeEl:c,dragEl:d,plhEl:p})}if(!i.plX){var f=i.treeEl,v=t._getPlaceholderNodeEl(f);v&&(i.plX=v.getBoundingClientRect().left+window.scrollX,i.plY=v.getBoundingClientRect().top+window.scrollY)}var g=i.x,h=i.y,m=i.clientX,y=i.clientY,b=i.scrollTop,O={x:g+(e.clientX-m),y:h+(e.clientY-y)+(a-b)};o.x=O.x,o.y=O.y,o.paddingLeft=l,o.mousePos=u,o.startMousePos=s,t.props.setDragProgress(u,o),n&&t.handleDrag(o,e,r)||e.preventDefault&&e.preventDefault()}},t.onDragEnd=function(){var e=t.props.dragStart.treeEl;t.props.setDragEnd(),e.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),t._cacheEls={};var r=t.eventTarget||t._getEventTarget();r.removeEventListener("mousemove",t.onDrag),r.removeEventListener("mouseup",t.onDragEnd)},t.pureShouldComponentUpdate=H(t),J(t),t.onPropsChanged(e),t}return(0,f.A)(n,t),(0,c.A)(n,[{key:"onPropsChanged",value:function(e){this.tree=me(e.tree,e.config)}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=[];for(var l in e)e[l]!=r[l]&&"dragging"!=l&&"mousePos"!=l&&i.push(l);i.length||(o=!1)}return o}},{key:"componentDidUpdate",value:function(e,t){var r=this.props.dragging,n=this.props.dragStart;if(ye=!1,n&&n.id&&(r.itemInfo=this.tree.items[r.id],r.itemInfo&&(r.itemInfo.index!=n.itemInfo.index||r.itemInfo.parent!=n.itemInfo.parent))){var o=n.treeEl,i=n.treeElContainer,l=this._getPlaceholderNodeEl(o,!0);if(l){var a=l.getBoundingClientRect().left+window.scrollX,u=l.getBoundingClientRect().top+window.scrollY,s=n.plX,c=n.plY,d=i.scrollTop;n.plX=a,n.plY=u,n.itemInfo=he(r.itemInfo),n.y=l.offsetTop,n.x=l.offsetLeft,n.clientY+=u-c,n.clientX+=a-s,i!=document.body&&(n.scrollTop=d),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t)return null;this._cacheEls||(this._cacheEls={});var n=this._cacheEls[t];return n&&document.contains(n)&&!r||(n=e.querySelector('.group-or-rule-container[data-id="'+t+'"]'),this._cacheEls[t]=n),n}},{key:"_getDraggableNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.draggable;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-draggable");return r=n.length?n[0]:null,this._cacheEls.draggable=r,r}},{key:"_getPlaceholderNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.placeholder;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-placeholder");return r=n.length?n[0]:null,this._cacheEls.placeholder=r,r}},{key:"_isScrollable",value:function(e){var t=window.getComputedStyle(e)["overflow-y"];return("scroll"===t||"auto"===t)&&e.scrollHeight>e.offsetHeight}},{key:"_getScrollParent",value:function(e){return null==e?null:e===document.body||this._isScrollable(e)?e:this._getScrollParent(e.parentNode)}},{key:"handleDrag",value:function(e,t,r){var n,o,i,l,a=this,u=e.itemInfo,s=e.paddingLeft,c=null,d=this.props.dragStart.treeEl,p=e.id,f=this._getDraggableNodeEl(d),v=this._getPlaceholderNodeEl(d);if(f&&v){if(n=f.getBoundingClientRect(),!(o=v.getBoundingClientRect()).width)return;var g={hrz:0,vrt:0};n.top<o.top?g.vrt=-1:n.bottom>o.bottom&&(g.vrt=1),n.left>o.left?g.hrz=1:n.left<o.left&&(g.hrz=-1);var h,m={x:(l=d.getBoundingClientRect()).left+(l.right-l.left)/2,y:g.vrt>=0?n.bottom:n.top};if(t.__mocked_hov_container)h=t.__mocked_hov_container;else{var y=document.elementFromPoint(m.x,m.y-1);if(!(h=y?y.closest(".group-or-rule-container"):null)&&y&&y.classList.contains("query-builder-container")){var b,O=null==y||null===(b=y.firstChild)||void 0===b?void 0:b.firstChild;O&&O.classList.contains("group-or-rule-container")&&(h=O)}}if(h){var A=h.classList.contains("group-container"),E=h.getAttribute("data-id"),C=h,_=!1,L=!1;if(C){var k=(i=C.getBoundingClientRect()).bottom-i.top,T=this.tree.items[E];if(!T)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var P=null,V=null,x=null,I=null;if(0==g.vrt)x=u,(V=v)&&(P=V.getBoundingClientRect());else if(A){if(g.vrt>0){var D=h.getElementsByClassName("group--header"),R=D.length?D[0]:null;if(R){var N=R.getBoundingClientRect(),q=N.bottom-N.top;n.bottom-N.top>3*q/4&&T.top>e.itemInfo.top&&(x=T,P=N,V=R,L=!0)}}else g.vrt<0&&T.lev>=u.lev&&i.bottom-n.top>=2&&T.top<e.itemInfo.top&&(x=T,P=i,V=C,_=!0);(g.vrt<0?i.bottom-n.top>k-5:n.bottom-i.top>k-5)&&(L||_||(x=T,P=i,V=C),I=T)}else(g.vrt<0?i.bottom-n.top>k/2:n.bottom-i.top>k/2)&&(x=T,P=i,V=C);var W=x&&x.id==p;if(P){var G=n.left-l.left,z=(P.left,l.left,Math.max(0,Math.round(G/s))),B=[],U=[];if(W);else{if(A&&(_?B.push([j,x,x.lev+1]):L&&B.push([w,x,x.lev+1]),I)){var $=0==I.lev,H="case_group"==I.type&&"case_group"!=u.type,J=I.prev&&this.tree.items[I.prev].caseId,Y=I.next&&this.tree.items[I.next].caseId;u.caseId==J&&(J=null),u.caseId==Y&&(Y=null);var K=J&&this.tree.items[J],Q=Y&&this.tree.items[Y];g.vrt>0?$?U.push([j,I,I.lev+1]):H&&Q?U.push([w,Q,Q.lev+1]):U.push([S,I,I.lev]):g.vrt<0&&($?U.push([w,I,I.lev+1]):H&&K?U.push([j,K,K.lev+1]):U.push([F,I,I.lev]))}_||L||(g.vrt<0?B.push([F,x,x.lev]):g.vrt>0&&B.push([S,x,x.lev]))}var X=function(e){var t=e[1],r=u.caseId?a.tree.items[u.caseId]:null,n=t.caseId?a.tree.items[t.caseId]:null;return[].concat((0,ce.A)(e),[r,n])};B=B.map(X),U=U.map(X);var Z=null,ee=(B=B.filter((function(e){var t=e[0],r=e[1];if((t==F||t==S)&&null==r.parent)return!1;if(r.collapsed&&(t==j||t==w))return!1;var n=r.id==u.id;if(!n)for(var o=r;o.parent;)if((o=a.tree.items[o.parent]).id==u.id){n=!0;break}return!n})).map((function(e){var t=e[0],r=e[1],n=(e[2],e[3],e[4],null);return(n=t==j||t==w?r:a.tree.items[r.parent])&&null==n.parent&&(n=null),e[5]=n,e}))).filter((function(e){return a.canMove(u,e[1],e[0],e[3],e[4],e[5],r)}));0==ee.length&&U.length>0&&(ee=U.filter((function(e){return a.canMove(u,e[1],e[0],e[3],e[4],e[5],r)})));var te=ee.map((function(e){return e[2]})),re=u.lev,ne=te.concat(re),oe=null;-1!=ne.indexOf(z)?oe=z:z>Math.max.apply(Math,(0,ce.A)(ne))?oe=Math.max.apply(Math,(0,ce.A)(ne)):z<Math.min.apply(Math,(0,ce.A)(ne))&&(oe=Math.min.apply(Math,(0,ce.A)(ne))),Z=ee.find((function(e){return e[2]==oe})),W||Z||!ee.length||(Z=ee[0]),c=Z}}}else M.log("out of tree bounds!")}return!!c&&(this.move(u,c[1],c[0],c[3]),!0)}},{key:"canMove",value:function(e,t,r,n,o,i,l){if(!e||!t)return!1;if(e.id===t.id)return!1;var a=this.props.config.settings,u=a.canRegroup,s=a.canRegroupCases,c=a.maxNesting,d=a.maxNumberOfRules,p=a.canLeaveEmptyCase,f=(i?i.nextAtomicLev:t.atomicLev)+(e.closestRuleGroupId?0:e.depth||("group"==e.type?1:0)),v=r==F||r==S,g=r==w||r==j,h=v&&1==t.lev||g&&0==t.lev,m=e.parent!=t.parent,y=g||m,b="rule_group"==e.type||!!e.closestRuleGroupId||"rule_group"==t.type||!!t.closestRuleGroupId,O=g&&"rule_group"==t.type?t.id:t.closestRuleGroupId,A=g&&"rule_group"==t.type?t.maxNesting:t.closestRuleGroupMaxNesting,E=0!=(g&&"rule_group"==t.type?t.canRegroup:t.closestRuleGroupCanRegroup),C=g&&"rule_group"==t.type?t.lev:t.closestRuleGroupLev,_=(i?i.lev+1:t.lev)+(e.depth||("group"==e.type?1:0))-(C||0),L=b&&e.closestRuleGroupId!=O,k="case_group"==e.type&&!h||"case_group"!=e.type&&"case_group"==t.type&&v||"case_group"!=e.type&&"switch_group"==t.type||!s&&e.caseId!=t.caseId||L,T=t.isLocked||e.isLocked||i&&i.isLocked;if(c&&f>c)return!1;if(A&&_>A)return!1;if(y&&(!u||k||T))return!1;if(b&&y&&!E)return!1;if("case_group"!=e.type&&e.caseId!=t.caseId){var P=!!n&&2==n._height,V=o?o.atomicRulesCountInCase+1:0;if(d&&V>d)return!1;if(P&&!p)return!1}if("case_group"==e.type&&(e.isDefaultCase||t.isDefaultCase||"switch_group"==t.type&&r==j))return!1;var x=!0;return l&&(x=l(e.node.toJS(),t.node.toJS(),r,i?i.node.toJS():null)),x}},{key:"move",value:function(e,t,r,n){this._isUsingLegacyReactDomRender||(ye=!0),this.props.actions.moveItem(e.path,t.path,r)}},{key:"render",value:function(){return v.createElement(e,(0,se.A)({},this.props,{onDragStart:this.onDragStart}))}}])}(v.Component),t.propTypes={tree:m().any.isRequired,actions:m().object.isRequired},t}(e,t));return r.displayName="ConnectedSortableContainer",r}(Cn);function Ln(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function kn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(kn=function(){return!!e})()}var Tn=g.Aq.OtherUtils.clone,Pn=g.Aq.ConfigUtils,Vn=Pn.getFieldConfig,xn=Pn.getFieldParts,In=Pn.getFieldPathParts,Dn=Pn.getWidgetForFieldOp,Rn=g.Aq.RuleUtils.getFieldPathLabels,Nn=function(e){function t(e){var r,n,o,i;return(0,s.A)(this,t),n=this,o=t,i=[e],o=(0,p.A)(o),r=(0,d.A)(n,kn()?Reflect.construct(o,i||[],(0,p.A)(n).constructor):o.apply(n,i)),J(r),r.onPropsChanged(e),r}return(0,f.A)(t,e),(0,c.A)(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0,n=!this.meta||["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0;r&&(this.items=this.getItems(e)),n&&(this.meta=this.getMeta(e))}},{key:"getItems",value:function(e){var t=e.config,r=e.field,n=e.fieldType,o=e.operator,i=e.parentField,l=e.isFuncArg,a=e.fieldDefinition,u=t.settings.canCompareFieldWithField,s=xn(i,t),c=i?Vn(t,i):null,d=i?null==c?void 0:c.subfields:t.fields,p=this.filterFields(t,d,r,i,s,o,u,l,a,n);return this.buildOptions(s,t,p,s)}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.field,o=(e.fieldType,e.operator,e.value),i=e.placeholder,l=e.isFuncArg,a=e.parentField,u=r.settings,s=u.fieldPlaceholder,c=u.fieldSeparatorDisplay,d=o,p=!!o,f=n?Vn(r,n):{},v=null==f||null===(t=f.widgets)||void 0===t?void 0:t.field,g=(null==v?void 0:v.widgetProps)||{},h=p?null:l&&i||g.valuePlaceholder||s,m=p?Vn(r,d):null,y=m||{},b=In(d,r),O=In(d,r,!0),A=this.getFieldLabel(m,d,r),S=Rn(d,r),F=S?S.join(c):null;return(F==A||a)&&(F=null),{placeholder:h,selectedKey:d,selectedKeys:b,selectedPath:O,selectedLabel:A,selectedOpts:y,selectedAltLabel:y.label2||y.tooltip,selectedFullLabel:F}}},{key:"filterFields",value:function(e,t,r,n,o,i,l,a,u,s){t=Tn(t);var c,d=e.settings.fieldSeparator,p=Vn(e,r),f=Dn(e,r,i,"value"),v=(e.widgets[f],e.operators[i]);return c=a?null==u?void 0:u.type:null!=v&&v.valueTypes?null==v?void 0:v.valueTypes[0]:p?p.type:s,function t(n,o){for(var u in n){var s=n[u].subfields,f=(o||[]).concat(u),v=f.join(d),g=Vn(e,v);if(g)if("!struct"==g.type||"!group"==g.type)0==t(s,f)&&delete n[u];else{var h=!(c&&g.type!=c||!a&&v==r),m=l||e.settings.canCompareFieldWithField;m&&(h=h&&m(r,p,v,g,i)),h||delete n[u]}else delete n[u]}return Fe()(n).length}(t,o||[]),t}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!r)return null;var l=t.settings,a=l.fieldSeparator,u=l.fieldSeparatorDisplay,s=null!=o&&o.length?o.join(a)+a:"";return Fe()(r).map((function(l){var a=[].concat((0,ce.A)(null!=o?o:[]),[l]),c=r[l],d=n.getFieldLabel(c,a,t),p=Rn(a,t).join(u);(p==d||e)&&(p=null);var f=c.label2,v=c.tooltip;if(!c.hideForCompare)return"!struct"==c.type||"!group"==c.type?{key:l,path:s+l,label:d,fullLabel:p,altLabel:f,tooltip:v,items:n.buildOptions(e,t,c.subfields,a,{label:d,tooltip:v}),grouplabel:null==i?void 0:i.label,group:i}:{key:l,path:s+l,label:d,fullLabel:p,altLabel:f,tooltip:v,grouplabel:null==i?void 0:i.label,group:i}})).filter((function(e){return!!e}))}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=xn(t,r),i=(null==e?void 0:e.label)||ze()(o);return R(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,l=e.groupId,a=t.settings.renderField,u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ln(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isValueField:!0,config:t,customProps:r,setField:n,readonly:o,items:this.items,id:i,groupId:l},this.meta);return a(u,t.ctx)}}])}(v.Component);Nn.propTypes={id:m().string,groupId:m().string,setValue:m().func.isRequired,config:m().object.isRequired,field:m().any,fieldSrc:m().string,fieldType:m().string,value:m().string,operator:m().string,customProps:m().object,readonly:m().bool,parentField:m().string,fieldDefinition:m().object,isFuncArg:m().bool};const qn=function(e){var t=e.value,r=e.setValue,n=(e.config,e.labelYes),o=e.labelNo,i=e.readonly,l=(e.widgetId,e.customProps),a=void 0===l?{}:l,u=a.radioYes||{},s=a.radioNo||{},c=function(e){return r("true"==e.target.value)};return v.createElement(v.Fragment,null,v.createElement("input",(0,se.A)({type:"radio",value:!0,checked:!!t,disabled:i,onChange:c},u))," ",n,v.createElement("input",(0,se.A)({type:"radio",value:!1,checked:!t,disabled:i,onChange:c},s))," ",o)},Mn=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,l=e.customProps,a=t||"";return v.createElement("input",(0,se.A)({type:"text",value:a,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i},l))},Wn=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,l=(e.maxRows,e.fullWidth),a=e.customProps,u=t||"";return v.createElement("textarea",(0,se.A)({value:u,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i,style:{width:l?"100%":void 0}},a))};g.Aq.moment;const Gn=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.readonly),o=e.customProps;return v.createElement("input",(0,se.A)({type:"date",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))},zn=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.use12Hours,e.readonly),o=e.customProps;return v.createElement("input",(0,se.A)({type:"time",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))};var Bn=g.Aq.moment;const Un=function(e){var t,r=e.value,n=e.setValue,o=(e.config,e.valueFormat),i=(e.use12Hours,e.readonly),l=e.customProps;return t=r?Bn(r).format("YYYY-MM-DDTHH:mm"):"",v.createElement("input",(0,se.A)({type:"datetime-local",value:t,disabled:i,onChange:function(e){var t=e.target.value;t=""==t?void 0:Bn(new Date(t)).format(o),n(t)}},l))};var $n=g.Aq.ListUtils.mapListValues;const Hn=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps;return v.createElement("select",(0,se.A)({multiple:!0,onChange:function(e){return n(function(e){for(var t=[],r=e.options,n=0;n<r.length;n++){var o=r[n];o.selected&&t.push(o.value)}return t.length||(t=void 0),t}(e.target))},value:r,disabled:o},gt()(i,["showSearch","input","showCheckboxes"])),$n(t,(function(e){var t=e.title,r=e.value;return v.createElement("option",{key:r,value:r},t)})))};var Jn=g.Aq.ListUtils.mapListValues;const Yn=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps,l=null!=r;return v.createElement("select",(0,se.A)({onChange:function(e){return n(e.target.value)},value:l?r:"",disabled:o},gt()(i,["showSearch","input"])),!l&&v.createElement("option",{disabled:!0,value:""}),Jn(t,(function(e){var t=e.title,r=e.value;return v.createElement("option",{key:r,value:r},t)})))},Kn=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,l=e.step,a=e.placeholder,u=e.customProps,s=null==t?"":t;return v.createElement("input",(0,se.A)({type:"number",value:s,placeholder:a,disabled:n,min:o,max:i,step:l,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},u))};var Qn=r(39762);function Xn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Zn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xn(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var eo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=["prefix","suffix","thousandsGroupStyle","thousandSeparator","allowLeadingZeros","allowNegative","decimalScale","decimalSeparator","fixedDecimalScale","allowEmptyFormatting","format","mask","patternChar"].filter((function(r){return!t.includes(r)&&void 0!==e[r]})),n=Object.fromEntries(r.map((function(t){return[t,e[t]]})));return e.min>=0&&(n.allowNegative=!1),n},to=function(e,t){return null==e?"":(0,Qn.KP)(""+e,t)},ro=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=null!==(r=null==t?void 0:t.decimalSeparator)&&void 0!==r?r:".",l=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=null!==(r=null==t?void 0:t.decimalSeparator)&&void 0!==r?r:".",i=e;return null!=n&&n.endsWith(".")&&0===e.indexOf(n)&&(i=n.substring(0,n.length-1)+o+e.substring(n.length)),i}(e,t,n),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return null!=t?Zn(Zn({},function(e,t){for(var r=0,n=0,o=e.length,i=t.length;e[r]===t[r]&&r<o;)r++;for(;e[o-1-n]===t[i-1-n]&&i-n>r&&o-n>r;)n++;return{from:{start:r,end:o-n},to:{start:r,end:i-n}}}(t,e)),{},{lastValue:e}):Zn(Zn({},{from:{start:0,end:0},to:{start:0,end:e.length},lastValue:""}),{},{lastValue:null!=e?e:""})}(l,n),u=a.to.end-a.to.start==1&&[i,"."].includes(l[a.to.start]),s=(0,Qn.VN)(l,a,t),c=parseFloat(s);null!=(c=!isNaN(c)&&isFinite(c)?c:void 0)&&(c=function(e,t){var r,n=null==t?void 0:t.decimalScale,o=e<0,i=Math.abs(o?Math.ceil(e):Math.floor(e)),l=null!==(r=(""+e).split(".")[1])&&void 0!==r?r:"",a=null!=l?parseFloat("0."+l):void 0;return n&&l.length>n&&(l=l.substring(0,n),a=parseFloat("0."+l)),(o?-1:1)*(i+a)}(c,t));var d=t.max,p=t.min,f=u&&c!=o,v=null!=c&&(null==d||c<=d)&&(null==p||c>=p),g=t.allowLeadingZeros?function(e,t){var r,n=null===(r=e.match(/^-?(0+).+/))||void 0===r||null===(r=r[1])||void 0===r?void 0:r.length,o=n?n-(function(e){var t=e<0;return 0===Math.abs(t?Math.ceil(e):Math.floor(e))}(t)?1:0):void 0;return o}(s,c):void 0,h=f?void 0:function(e){var t,r=e.split(".");if(null!==(t=r[1])&&void 0!==t&&t.match(/^0+$/))return r[1].length}(s);return{str:e,num:c,extraLeadingZeros:g,trailingZeros:h,isValid:v}},no=function(e,t){var r=e.startsWith("-"),n=r?e.replace(/^[-]+/,""):e;return(r?"-":"")+"".padStart(t,"0")+n},oo=function(e,t){var r=e.endsWith(".");return e+(r?"":".")+"".padStart(t,"0")};const io=function(e){var t=e.value,r=e.setValue,n=e.readonly,o=e.placeholder,i=(e.min,e.max,e.customProps),l=eo(e),a=null==t?"":t;return v.createElement(Qn.HG,(0,se.A)({value:a,placeholder:o,disabled:n,onValueChange:function(e){var t=e.floatValue;r(void 0!==t?t:void 0)}},i,l))},lo=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,l=e.step,a=e.placeholder,u=e.customProps,s=void 0===u?{}:u,c=s.input||{},d=s.slider||s,p=function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},f=null==t?"":t;return v.createElement("div",{style:{display:"inline-flex"}},v.createElement("input",(0,se.A)({key:"number",type:"number",value:f,placeholder:a,disabled:n,min:o,max:i,step:l,onChange:p},c)),v.createElement("input",(0,se.A)({key:"range",type:"range",value:f,disabled:n,min:o,max:i,step:l,onChange:p},d)))},ao=function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,i=e.errorText,l=function(e){return e.map((function(e){var t=e.items,r=e.path,n=e.label,o=e.disabled,i=e.matchesType;if(t)return v.createElement("optgroup",{disabled:o,key:r,label:n},l(t));var a=i?{fontWeight:"bold"}:{};return v.createElement("option",{disabled:o,key:r,value:r,style:a},n)}))},a=null!=n;return v.createElement("select",{onChange:function(e){return r(e.target.value)},value:a?n:"",disabled:o,style:{color:i?"red":null}},!a&&v.createElement("option",{disabled:!0,value:""}),l(t))},uo=function(e){var t,r=e.id,n=e.not,o=e.setNot,i=e.conjunctionOptions,l=e.setConjunction,a=e.disabled,u=e.readonly,s=e.config,c=e.showNot,d=e.notLabel,p=Object.keys(i).length,f=a,g=s.settings.forceShowConj||p>1&&!f,h=function(e){return l(e.target.value)};return[c&&(t="not",[v.createElement("input",{key:r+t,type:"checkbox",id:r+t,checked:n,disabled:u,onChange:function(e){return o(e.target.checked)}}),v.createElement("label",{key:r+t+"label",htmlFor:r+t},d||"NOT")]),g&&Object.keys(i).map((function(e){var t=i[e],r=t.id,n=t.name,o=t.label,s=t.checked,c=l.isDummyFn?"__dummy":"";return!u&&!a||s?[v.createElement("input",{key:r+c,type:"radio",id:r+c,name:n+c,checked:s,disabled:u||a,value:e,onChange:h}),v.createElement("label",{key:r+c+"label",htmlFor:r+c},o)]:null}))]};var so={addSubRuleSimple:"+",addSubRule:"+",addSubGroup:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const co=function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,i=r||so[t];return v.createElement("button",{onClick:n,type:"button",disabled:o},i)},po=function(e){var t=e.type,r={}[t]||null;return r||"drag"!==t||(r=v.createElement(De,null)),r},fo=function(e){var t=e.children;return e.config,v.createElement(v.Fragment,null,t)},vo=function(e){e.config;var t=e.valueSources,r=e.valueSrc,n=(e.title,e.setValueSrc),o=e.readonly;return v.createElement("select",{onChange:function(e){return n(e.target.value)},value:r||"",disabled:o},function(e){return e.map((function(e){var t=(0,Pe.A)(e,2),r=t[0],n=t[1];return v.createElement("option",{key:r,value:r},n.label)}))}(t))},go=function(e){var t=e.value,r=e.setValue,n=e.label,o=e.id,i=(e.config,e.type);return[v.createElement("input",{key:o+i,type:"checkbox",id:o+i,checked:!!t,onChange:function(e){return r(e.target.checked)}}),v.createElement("label",{key:o+i+"label",htmlFor:o+i},n)]},ho=function(e){var t=e.onOk,r=(e.okText,e.cancelText,e.title);confirm(r)&&t()};var mo=function(e){var t,r=e.config,n=e.children,o=null!==(t=r.settings.themeMode)&&void 0!==t?t:"light",i=r.settings.compactMode,l=r.settings.liteMode;return v.createElement("div",{className:"qb-".concat(o," ").concat(i?"qb-compact":""," ").concat(l?"qb-lite":"")},n)};function yo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yo=function(){return!!e})()}var bo=function(e){function t(){var e,r,n,o;(0,s.A)(this,t);for(var i=arguments.length,l=new Array(i),a=0;a<i;a++)l[a]=arguments[a];return r=this,n=t,o=[].concat(l),n=(0,p.A)(n),(e=(0,d.A)(r,yo()?Reflect.construct(n,o||[],(0,p.A)(r).constructor):n.apply(r,o))).handleChange=function(t){e.props.setOption("proximity",parseInt(t))},e}return(0,f.A)(t,e),(0,c.A)(t,[{key:"render",value:function(){var e=this.props,t=e.defaults,r=e.options,n=e.config,o=e.optionLabel,i=e.optionPlaceholder,l=e.customProps,a=e.minProximity,u=e.maxProximity,s=e.optionTextBefore,c=e.readonly,d=n.settings,p=n.widgets,f=n.ctx,g=t?t.proximity:void 0,h=d.showLabels,m=r.get("proximity",g),y=dt()(a,u+1).map((function(e){return{title:e,value:e}})),b=p.select.factory,O=function(e){return b(e,f)};return v.createElement("div",{className:"operator--PROXIMITY"},v.createElement("div",{className:"operator--options"},h&&v.createElement("label",{className:"rule--label"},o),!h&&s&&v.createElement("div",{className:"operator--options--sep"},v.createElement("span",null,s)),v.createElement(O,(0,se.A)({config:n,value:m,listValues:y,setValue:this.handleChange,readonly:c,placeholder:i},l))),v.createElement("div",{className:"operator--widgets"},this.props.children))}}])}(v.PureComponent);bo.propTypes={config:m().object.isRequired,setOption:m().func.isRequired,options:m().any.isRequired,minProximity:m().number,maxProximity:m().number,optionPlaceholder:m().string,optionTextBefore:m().string,optionLabel:m().string,customProps:m().object,readonly:m().bool},bo.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};var Oo=r(34252),Ao=function(e,t){return(0,Oo.Ay)(e).alpha(t).hex()},So=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=e?.2:.85;return Object.fromEntries(Array.from({length:21},(function(e,t){return t})).map((function(i){var l="".concat(t,"-").concat(i),a=(0,Oo.Ay)(e&&null!=n?n:r),u=(i+1)/21*o;return[l,(e?a.tint(u):a.shade(u)).hex()]})))},Fo=function(e){if(e&&"transparent"!==e)return(0,Oo.Ay)(e).luminance()<.5},jo=function(e){try{return(0,Oo.Ay)(e),!0}catch(e){return!1}};function wo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Eo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wo(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Co={conjunctions:Eo({},g.q0.conjunctions),operators:Eo(Eo({},g.q0.operators),{},{proximity:Eo(Eo({},g.q0.operators.proximity),{},{options:Eo(Eo({},g.q0.operators.proximity.options),{},{factory:function(e,t){return(0,t.RCE)(t.O.ProximityOperator,e)}})})}),widgets:{text:Eo(Eo({},g.q0.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}}),textarea:Eo(Eo({},g.q0.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextAreaWidget,e)}}),number:Eo(Eo({},g.q0.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaNumberWidget,e)}}),price:Eo(Eo({},g.q0.widgets.price),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaPriceWidget,e)}}),slider:Eo(Eo({},g.q0.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSliderWidget,e)}}),select:Eo(Eo({},g.q0.widgets.select),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSelectWidget,e)}}),multiselect:Eo(Eo({},g.q0.widgets.multiselect),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaMultiSelectWidget,e)}}),date:Eo(Eo({},g.q0.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateWidget,e)}}),time:Eo(Eo({},g.q0.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTimeWidget,e)}}),datetime:Eo(Eo({},g.q0.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateTimeWidget,e)}}),boolean:Eo(Eo({},g.q0.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaBooleanWidget,e)}}),field:Eo(Eo({},g.q0.widgets.field),{},{factory:function(e,t){return(0,t.RCE)(t.W.ValueFieldWidget,e)},customProps:{showSearch:!0}}),func:Eo(Eo({},g.q0.widgets.func),{},{factory:function(e,t){return(0,t.RCE)(t.W.FuncWidget,e)},customProps:{}}),case_value:Eo(Eo({},g.q0.widgets.case_value),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}})},types:Eo(Eo({},g.q0.types),{},{select:Eo(Eo({},g.q0.types.select),{},{widgets:Eo(Eo({},g.q0.types.select.widgets),{},{select:Eo(Eo({},g.q0.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),settings:Eo(Eo({},g.q0.settings),{},{renderField:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderOperator:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.VanillaConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.VanillaSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.VanillaButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.VanillaIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.VanillaButtonGroup,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.VanillaProvider,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderConfirm:function(e,t){return(0,t.W.vanillaConfirm)(e)},renderSwitchPrefix:"IF",renderBeforeCaseValue:function(e,t){return(0,t.RCE)("span",{children:[" then "]})},customFieldSelectProps:{showSearch:!0},customOperatorSelectProps:{},designSettings:{canInheritThemeFromOuterProvider:!0,useThickLeftBorderOnHoverItem:!1,useShadowOnHoverItem:!1,generateCssVarsFromThemeLibrary:!0},themeMode:void 0,liteMode:!0,compactMode:!1,renderSize:"small",defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),ctx:Eo(Eo({},g.q0.ctx),{},{W:Eo({},i),O:Eo({},l),RCE:function(e,t){return v.createElement(e,t)},utils:Eo(Eo({},g.q0.ctx.utils),{},{ColorUtils:a})})};const _o=Co=g.Aq.ConfigMixins.removeMixins(Co,["rangeslider","treeselect","treemultiselect"]);var Lo=r(8691),ko=r(80920),To=r.n(ko),Po=r(89012),Vo=r.n(Po);function xo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Io(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xo(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Do=g.Aq.Autocomplete,Ro=Do.mergeListValues,No=Do.listValueToOption,qo=Do.optionToListValue,Mo=Do.optionsToListValues,Wo=Do.fixListValuesGroupOrder,Go=g.Aq.ListUtils,zo=Go.mapListValues,Bo=Go.listValuesToArray,Uo=Go.getListValue,$o=Go.makeCustomListValue,Ho=Go.searchListValue,Jo=Go.getItemInListValues;function Yo(e){return new Promise((function(t){setTimeout(t,e)}))}const Ko=function(e,t){var r,n,o,i=e.asyncFetch,l=e.useLoadMore,a=e.useAsyncSearch,u=e.forceAsyncSearch,s=e.fetchSelectedValuesOnInit,c=e.asyncListValues,d=e.listValues,p=e.allowCustomValues,f=e.value,g=e.setValue,h=e.placeholder,m=e.config,y=(e.field,t.debounceTimeout),b=t.multiple,O=t.uif,A=t.isFieldAutocomplete,S=t.dontFixOptionsOrder,F=["LOAD_MORE","LOADING_MORE"],j=null!==(r=m.settings.loadMoreLabel)&&void 0!==r?r:"Load more...",w=null!==(n=m.settings.loadingMoreLabel)&&void 0!==n?n:"Loading more...",E=u?null!==(o=m.settings.typeToSearchLabel)&&void 0!==o?o:"Type to search":h;i&&s&&!c&&null!=f&&(c=Array.isArray(f)?f:[f]);var C=v.useState(!1),_=(0,Pe.A)(C,2),L=_[0],k=_[1],T=v.useState(void 0),P=(0,Pe.A)(T,2),x=P[0],I=P[1],D=v.useState(0),R=(0,Pe.A)(D,2),N=R[0],q=R[1],M=v.useState(!1),W=(0,Pe.A)(M,2),G=W[0],z=W[1],B=v.useState(""),U=(0,Pe.A)(B,2),$=U[0],H=U[1],J=v.useState(void 0),Y=(0,Pe.A)(J,2),K=Y[0],Q=Y[1],X=v.useRef(0),Z=v.useRef(0),ee=v.useRef(!1),te=v.useRef();te.current=f,v.useRef().current=$;var re=v.useMemo((function(){return Bo(c)}),[c]),ne=c&&Array.isArray(c)&&c.filter((function(e){return null!==e&&"object"!==(0,V.A)(e)})).length>0,oe=v.useMemo((function(){return i?c?Ro(K,re,!0):K:Bo(d)}),[i,c,K,d]),ie=i?K:Bo(d);p&&$&&!Ho($,K)&&(ie=Ro(ie,[$o($)],!0)),!i||K||!c||$||L||"antd"!==O||(ie=oe),i&&!p&&c&&"mui"===O&&(ie=Ro(ie,re,!0,!0));var le=N>0,ae=s&&!L&&i&&ne&&null!=f,ue=L&&i&&void 0===K&&(!u||$),se=(ue||ae)&&le,de=!se&&oe&&oe.length>0&&x&&x.hasMore&&(x.filter||"")===$,pe=!le&&de,fe=zo(ie,No),ve=null!=f,ge=!b&&ve?Uo(f,oe):null,he=function(){var e=(0,Lo.A)(To().mark((function e(){var t,r,n,o,a,u,s,c,d,p,f,v,g,h,y=arguments;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=y.length>0&&void 0!==y[0]?y[0]:null,!(r=y.length>1&&void 0!==y[1]&&y[1])&&x&&I(void 0),n=r&&K?K.length:0,o=r&&x||!l&&{pageSize:0},a=++X.current,e.next=8,i.call(null==m?void 0:m.ctx,t,n,o);case 8:if(u=e.sent,X.current==a&&Z.current){e.next=12;break}return e.abrupt("return",null);case 12:return s=null!=u&&u.values?u:{values:u},c=s.values,d=s.hasMore,p=s.meta,f=Bo(c),r?(g=Ro(K,f,!1),v=g.length>K.length):(g=f,l&&(v=g.length>0)),(h=null!=d||null!=p||null!=v?Io(Io(Io(Io({},null!=v?{hasMore:v}:{}),null!=d?{hasMore:d}:{}),null!=p?p:{}),{},{filter:t}):void 0)&&I(h),e.abrupt("return",g);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=(0,Lo.A)(To().mark((function e(){var t,r,n,o,l,a,u,s;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=null==te.current?[]:b?te.current:[te.current]).length){e.next=3;break}return e.abrupt("return",null);case 3:return r={fetchSelectedValues:!0},n=++X.current,e.next=7,i.call(null==m?void 0:m.ctx,t,-1,r);case 7:if(o=e.sent,X.current==n&&Z.current){e.next=11;break}return e.abrupt("return",null);case 11:return l=null!=o&&o.values?o:{values:o},a=l.values,u=null==te.current?[]:b?te.current:[te.current],s=u.map((function(e){var t;return null!==(t=Jo(a,e))&&void 0!==t?t:$o(e)})),e.abrupt("return",s.length?s:null);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=(0,Lo.A)(To().mark((function e(){var t;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q((function(e){return e+1})),e.next=3,me();case 3:if(t=e.sent,Z.current){e.next=6;break}return e.abrupt("return");case 6:null!=t&&g(te.current,t),q((function(e){return e-1}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),be=function(){var e=(0,Lo.A)(To().mark((function e(){var t,r,n,o=arguments;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:null,r=o.length>1&&void 0!==o[1]&&o[1],q((function(e){return e+1})),z(r),e.next=6,he(t,r);case 6:if(n=e.sent,Z.current){e.next=9;break}return e.abrupt("return");case 9:null!=n&&Q(n),q((function(e){return e-1})),z(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=v.useCallback(Vo()(be,y),[]);v.useEffect((function(){return Z.current++,function(){Z.current--}}),[]),v.useEffect((function(){ue&&0==N&&(0,Lo.A)(To().mark((function e(){return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be();case 2:case"end":return e.stop()}}),e)})))(),ae&&0==N&&(0,Lo.A)(To().mark((function e(){return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye();case 2:case"end":return e.stop()}}),e)})))()}),[ue,ae,N]);var Ae=function(){k(!0)},Se=function(){var e=(0,Lo.A)(To().mark((function e(t){var r;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=ee.current)?(ee.current=!1,b&&k(!1)):k(!1),"mui"!==O||r){e.next=6;break}return e.next=6,je(null,"","my-reset");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=function(){var e=(0,Lo.A)(To().mark((function e(t,r,n){var o,l,a,u,s,c,d,v,h,m,y,S,F,j,w,E,C,_,T;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=b&&"mui"===O&&"clear"===n,u=!b&&"mui"===O&&"clear"===n&&"change"===(null==t?void 0:t.type),s=!b&&"mui"===O&&"clear"===n&&"change"!==(null==t?void 0:t.type),"mui"===O&&(n=r,r=b?n.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e})):null!==(c=null===(d=n)||void 0===d?void 0:d.value)&&void 0!==c?c:n),v=b&&Array.isArray(n)&&n.map((function(e){return null==e?void 0:e.specialValue})).find((function(e){return!!e}))||(null===(o=n)||void 0===o?void 0:o.specialValue),b&&r&&!Array.isArray(r)&&(r=[].concat((0,ce.A)(f||[]),[r]),n=null),h=b&&(null===(l=r)||void 0===l?void 0:l.length)&&new Set(r).size!==r.length,m=b&&"antd"===O&&null===t&&null===n&&h,!(a&&0===r.length&&$&&L||u||m)){e.next=11;break}return e.abrupt("return");case 11:if(y=b&&r.length&&r.length>(f||[]).length&&r[r.length-1]==$&&!Uo($,K),"LOAD_MORE"!=v){e.next=19;break}return H($),ee.current=!0,e.next=17,be($,!0);case 17:e.next=39;break;case 19:if("LOADING_MORE"!=v){e.next=23;break}ee.current=!0,e.next=39;break;case 23:if(!b){e.next=33;break}if(S=Mo(r,oe,p),F=(0,Pe.A)(S,2),j=F[0],w=F[1],g(j,i?w:void 0),!y){e.next=31;break}return e.next=29,Yo(0);case 29:return e.next=31,je(null,"","my-reset");case 31:e.next=39;break;case 33:if(E=qo(r,oe,p),C=(0,Pe.A)(E,2),_=C[0],T=C[1],g(_,i?T:void 0),!s||!A){e.next=39;break}return e.next=38,Yo(0);case 38:k(!1);case 39:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),je=function(){var e=(0,Lo.A)(To().mark((function e(t,r,n){var o,i,l,s,c;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="mui"===O&&"removeOption"===n&&""===r&&b,i="mui"===O&&"selectOption"===n&&""===r&&b,l="mui"===O&&!b&&"blur"===n&&r===(null==ge?void 0:ge.title),s="mui"===O&&"reset"===n||i||o||l,(c=r)!==j&&c!==w&&!s){e.next=7;break}return e.abrupt("return");case 7:if("mui"!==O||b||"selectOption"!==n||""===r){e.next=9;break}return e.abrupt("return");case 9:if(r==$){e.next=18;break}if(H(c),!a||u&&!c){e.next=17;break}return e.next=15,Oe(c);case 15:e.next=18;break;case 17:a&&u&&Q([]);case 18:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();return{options:"mui"!==O||S?fe:Wo(fe),listValues:oe,hasValue:ve,selectedListValue:ge,open:L,onOpen:Ae,onClose:Se,onDropdownVisibleChange:function(e){e?Ae():Se()},onChange:Fe,inputValue:$,onInputChange:je,canShowLoadMore:pe,isInitialLoading:se,isLoading:le,isLoadingMore:G,isSpecialValue:function(e){var t=(null==e?void 0:e.specialValue)||(null==e?void 0:e.value);return F.includes(t)},extendOptions:function(e){var t=(0,ce.A)(e);return l&&(pe?t.push({specialValue:"LOAD_MORE",title:j}):G&&t.push({specialValue:"LOADING_MORE",title:w,disabled:!0})),t},getOptionSelected:function(e,t){if(null==t)return!1;var r=null!=t.value?t.value:t;return e.value===r},getOptionDisabled:function(e){return e&&e.disabled},getOptionIsCustom:function(e){var t;if(null!=e&&e.isCustom)return!0;var r=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e,n=Uo(r,oe);return(null==n?void 0:n.isCustom)||null==n},getOptionLabel:function(e){if(null==e)return null;var t=null!=e.value?e:No(Uo(e,oe));return!t&&e.specialValue?e.title:!t&&p?e.toString():t?t.title||t.label||t.value.toString():e.toString()},aPlaceholder:E}};function Qo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qo(Object(r),!0).forEach((function(t){(0,P.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Zo=Xo(Xo({},g.Aq),{},{ReactUtils:n,NumberFormat:o,DragIcon:De,ColorUtils:a})}}]);
//# sourceMappingURL=773.bundle.js.map